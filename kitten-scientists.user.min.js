let run=function(){const O="1.5.1";const f="小猫珂学家版本"+O;const i=localStorage["com.nuclearunicorn.kittengame.language"]==="zh"?"zh":"en";const r={en:{"option.observe":"Observe Astro Events","option.festival":"Hold Festivals","option.praise":"Auto Praise","option.shipOverride":"Force Ships to 243","option.autofeed":"Feed Leviathans","option.hunt":"Hunt","option.crypto":"Trade Blackcoin","option.embassies":"Build Embassies (Beta)","option.style":"View Full Width","option.steamworks":"Turn on Steamworks","filter.build":"Building","filter.craft":"Crafting","filter.upgrade":"Upgrading","filter.research":"Researching","filter.trade":"Trading","filter.hunt":"Hunting","filter.praise":"Praising","filter.faith":"Order of the Sun","filter.festival":"Festivals","filter.star":"Astronomical Events","filter.misc":"Miscellaneous","dispose.necrocorn":"Kittens disposed of inefficient necrocorns","blackcoin.buy":"Kittens sold your Relics and bought {0} Blackcoins","blackcoin.sell":"Kittens sold your Blackcoins and bought {0} Relics","act.feed":"Kittens fed the Elders. The elders are pleased","act.observe":"Kitten Scientists have observed a star","act.hunt":"Sent {1} on {0} hunts","act.build":"Kittens have built a new {0}","act.builds":"Kittens have built a new {0} {1} times.","act.craft":"Kittens have crafted {0} {1}","act.trade":"Kittens have traded {0}x with {1}","upgrade.space.mission":"Kittens conducted a mission to {0}","upgrade.space":"Kittens conducted a {0}","upgrade.race":"Kittens met the {0}","upgrade.building.pasture":"Upgraded pastures to solar farms!","upgrade.building.aqueduct":"Upgraded aqueducts to hydro plants!","upgrade.building.library":"Upgraded libraries to data centers!","upgrade.building.amphitheatre":"Upgraded amphitheatres to broadcast towers!","upgrade.upgrade":"Kittens have bought the upgrade {0}","upgrade.limited":"Optimize {0}","upgrade.unlimited":"All {0}","upgrade.tech":"Kittens have bought the tech {0}","upgrade.policy":"Kittens have passed {0}","festival.hold":"Kittens begin holding a festival","festival.extend":"Kittens extend the festival","build.embassy":"Built {0} embassy for {1}","build.embassies":"Built {0} embassies for {1}","act.praise":"Praised the sun! Accumulated {0} faith to {1} worship","act.sun.discover":"Kittens have discovered {0}","act.sun.discovers":"Kittens have discovered {0} {1} times.","ui.items":"items","ui.disable.all":"disable all","ui.enable.all":"enable all","ui.craft.resources":"resources","ui.trigger":"trigger","ui.trigger.set":"Enter a new trigger value for {0}. Should be in the range of 0 to 1.","ui.limit":"Limited","ui.trigger.shipOverride.set":"Enter a new trigger value for {0}. Corresponds to the amount of ship needed before the exchange is made.","ui.trigger.missions.set":"Enter a new trigger value for missions. Should be in the range of 0 to 13. Corresponds to each planet sort","ui.trigger.crypto.set":"Enter a new trigger value for {0}. Corresponds to the amount of Relics needed before the exchange is made.","ui.engine":"Enable Scientists","ui.build":"Bonfire","ui.space":"Space","ui.craft":"Crafting","ui.upgrade":"Unlocking","ui.trade":"Trading","ui.faith":"Religion","ui.time":"Time","ui.options":"Options","ui.filter":"Filters","ui.distribute":"Kitten Resources","ui.max":"Max: {0}","ui.upgrade.upgrades":"Upgrades","ui.upgrade.techs":"Techs","ui.upgrade.races":"Races","ui.upgrade.missions":"Missions","ui.upgrade.buildings":"Buildings","ui.upgrade.policies":"Policies","ui.upgrade.policies.load":"Load","ui.upgrade.policies.show":"Show","ui.faith.addtion":"addition","option.faith.best.unicorn":"Build Best Unicorn Building First","option.faith.best.unicorn.desc":"Include auto Sacrifice Unicorns if tears are not enough to build the best unicorn building","option.faith.transcend":"Auto Transcend","act.transcend":"Spend {0} epiphany, Transcend to T-level: {1}","summary.transcend":"Transcend {0} times","filter.transcend":"Transcend","option.faith.adore":"Auto Adore the Galaxy","act.adore":"Adore the galaxy! Accumulated {0} worship to {1} epiphany","summary.adore":"Accumulated {0} epiphany by adore the galaxy","filter.adore":"Adoring","adore.trigger.set":"Enter a new trigger value for AutoAdore. Should be in the range of 0 to 1.\nKS will AutoAdore if the Solar Revolution Bonus brought by praising the sun once after adore can reach the trigger of maximum.\n\nNote: The solar revolution bonus will diminish after reaching 75% of the maximum.","resources.add":"add resources","resources.clear.unused":"clear unused","resources.stock":"Stock: {0}","resources.consume":"Consume: {0}","resources.del":"del","resources.stock.set":"Stock for {0}","resources.consume.set":"Consume rate for {0}","resources.del.confirm":"Delete resource controls for {0}?","status.ks.enable":"Enabling the kitten scientists!","status.ks.disable":"Disabling the kitten scientists!","status.sub.enable":"Enabled {0}","status.auto.enable":"Enable Auto {0}","status.sub.disable":"Disabled {0}","status.auto.disable":"Disable Auto {0}","trade.limited":"Trading with {0}: limited to only occur when profitable based off relative production time","trade.unlimited":"Trading with {0}: unlimited","trade.seasons":"seasons","trade.season.enable":"Enabled trading with {0} in the {1}","trade.season.disable":"Disabled trading with {0} in the {1}","filter.enable":"Enable {0} Filter","filter.disable":"Disabled {0} Filter","craft.limited":"Crafting {0}: limited to be proportional to cost ratio","craft.unlimited":"Crafting {0}: unlimited","distribute.limited":"Distribute to {0}: stop when reach max","distribute.unlimited":"Distribute to {0}: unlimited","distribute.leaderJob":"Leader Job: {0} ","distribute.leaderTrait":"Choose {0} Leader","distribute.makeLeader":"Make Leader","act.distribute":"Distribute a kitten to {0}","act.distributeLeader":"Make a {0} kitten leader","ui.max.set":"Maximum for {0}","summary.distribute":"Help {0} kittens to find job","filter.distribute":"Distribute","option.promote":"Promote Leader","act.promote":"Kittens' leader has been promoted to rank {0}","filter.promote":"Promote leader","summary.promote":"Promoted leader {0} times","ui.timeCtrl":"Time Control","option.accelerate":"Tempus Fugit","act.accelerate":"Accelerate time!","filter.accelerate":"Tempus Fugit","summary.accelerate":"Accelerate time {0} times","option.time.skip":"Time Skip","act.time.skip":"Kittens combust Time crystal, {0} years skipped!","ui.cycles":"cycles","ui.maximum":"Maximum","time.skip.cycle.enable":"Enable time skip in cycle {0} and allow skip over this cycle","time.skip.cycle.disable":"Disable time skip in cycle {0} and disallow skip over this cycle","time.skip.season.enable":"Enable time skip in the {0}","time.skip.season.disable":"Disable time skip in the {0}","time.skip.trigger.set":"Enter a new trigger value for Time Skip (Combust time crystal). Should be a positive integer.","summary.time.skip":"Skip {0} years","filter.time.skip":"Time Skip","option.time.reset":"Reset Timeline (Danger!)","status.reset.check.enable":"Enable check {0} before Reset Timeline","status.reset.check.disable":"Disable check {0} before Reset Timeline","ui.min":"Min: {0}","reset.check.trigger.set":"Enter a new trigger value for {0}.\n-1 meaning must build this building until exceeding resource limit.","reset.check":"Trigger for {0} : {1}, you have {2}","reset.checked":"All conditions are met, the timeline will restart in next few seconds!","reset.tip":'You can cancel this reset by disable "Kitten Scientists" or "Time Control" or "Reset Timeline"',"reset.countdown.10":"10 - Harvesting catnip","reset.countdown.9":"&nbsp;9 - Sacrificing Unicorns","reset.countdown.8":"&nbsp;8 - Releasing lizards","reset.countdown.7":"&nbsp;7 - Disassembling rail-guns","reset.countdown.6":"&nbsp;6 - Starting time engines","reset.countdown.5":"&nbsp;5 - Melting blackcoins","reset.countdown.4":"&nbsp;4 - Turning off satellite","reset.countdown.3":"&nbsp;3 - Opening temporal rifts","reset.countdown.2":"&nbsp;2 - Boosting the chronoforge","reset.countdown.1":"&nbsp;1 - Time engine start","reset.countdown.0":"&nbsp;0 - Temporal rifts opened!","reset.last.message":"See you next poinciana recurrence","reset.after":"Nice to meet you, the cute Kittens Scientists will serve you","reset.cancel.message":"Timeline Reset canceled.","reset.cancel.activity":"Meoston, We Have a Problem.","summary.time.reset.title":"Summary of the last {0} timelines","summary.time.reset.content":"Gain {0} Karma.<br>Gain {1} Paragon.","ui.close":"close","option.fix.cry":"Fix Cryochamber","act.fix.cry":"Kittens fix {0} Cryochambers","summary.fix.cry":"Fix {0} Cryochambers","summary.festival":"Held {0} festivals","summary.stars":"Observed {0} stars","summary.praise":"Accumulated {0} worship by praising the sun","summary.hunt":"Sent adorable kitten hunters on {0} hunts","summary.embassy":"Built {0} embassies","summary.feed":"Fed the elders {0} necrocorns","summary.tech":"Researched: {0}","summary.upgrade":"Upgraded: {0}","summary.building":"Built: +{0} {1}","summary.sun":"Discovered: +{0} {1}","summary.craft":"Crafted: +{0} {1}","summary.trade":"Traded: {0}x {1}","summary.year":"year","summary.years":"years","summary.separator":" and ","summary.day":"day","summary.days":"days","summary.head":"Summary of the last {0}","summary.show":"Show activity"},zh:{"option.observe":"观测天文现象","option.festival":"举办节日","option.praise":"赞美太阳","option.shipOverride":"无视贸易船平衡","option.autofeed":"献祭死灵兽","option.hunt":"派出猎人","option.crypto":"黑币交易","option.embassies":"建造大使馆","option.style":"占满屏幕","option.useWorkers":"启用后台满速珂学家","filter.build":"建筑","filter.craft":"工艺制作","filter.upgrade":"工坊升级","filter.research":"科学研究","filter.policy":"政策","filter.upgBld":"营火建筑升级","filter.trade":"贸易","filter.embassy":"大使馆","filter.hunt":"狩猎","filter.praise":"赞美太阳","filter.adore":"赞美群星","filter.transcend":"次元超越","filter.sacrifice":"献祭","filter.faith":"太阳教团","filter.accelerate":"光阴似箭","filter.time.skip":"时间跳转","filter.festival":"举办节日","filter.star":"天文现象","filter.distribute":"猫猫分配","filter.leader":"领袖相关","filter.misc":"喵喵喵",time:"{1}处理用时：{0}ms","dispose.necrocorn":"小猫帮你处理掉了影响效率的多余死灵兽","act.feed":"小猫向利维坦献上祭品。古神很高兴","blackcoin.buy":"小猫花掉 {1} 遗物，加仓了 {0} 黑币","blackcoin.sell":"小猫抛售 {1} 黑币，套现了 {0} 遗物","act.observe":"小猫观测了天文现象","act.hunt":"{0} 波{1}去打猎","act.hunt.unicorn":"小猫急着派出猎人帮独角兽配种","act.hunt.trade":"小猫贸易后决定去打猎","act.hunt.mint":"毛皮或羊皮纸处于低储量","act.build":"小猫建造了一个 {0}","act.builds":"小猫建造了 {1} 个新的 {0}","act.craft":" {0} {1}","act.trade":" {1} 交易 {0} 次","upgrade.space.mission":"小猫执行了 {0} 的任务","upgrade.space":"小猫执行了 {0}","upgrade.race":"小猫探险遇到了新的文明：{0}","upgrade.upgrade":"{1}发明了 {0}","upgrade.limited":"优化 {0}","upgrade.unlimited":"全部 {0}","upgrade.tech":"{1}研究了 {0}","upgrade.policy":"小猫通过了 {0} 法案","festival.hold":"呜呼，小猫的节日开始了","festival.extend":"小猫加了一年钟","build.embassy":"在 {1} 设立了 {0} 个大使馆","build.embassies":"在 {1} 设立了 {0} 个大使馆","act.praise":"赞美太阳! 转化 {0} 信仰为 {1} 虔诚","parise.trigger.set":"输入新的赞美太阳的触发值，取值范围为 0 到 1的纯小数\n 当为0.98时且点出太阳革命，若虔诚太少小猫每天赞美太阳","summary.praise.msg":"虔诚的小猫每天都会赞美太阳，直到太阳革命加成大于 {0} % (说你了虔诚太低了!)","act.sun.discover":"小猫在宗教祷告了 {0} ","act.sun.discovers":"小猫在宗教祷告了 {0} {1} 次","act.sun.discovers.leader":"哲学家小猫在宗教祷告了 {0} {1} 次","ui.items":"项目","ui.disable.all":"全部禁用","ui.enable.all":"全部启用","ui.craft.resources":"资源","ui.trigger":"触发条件","ui.trigger.set":"输入新的 {0} 触发条件，取值范围为 0 到 1 的小数。（触发条件：当前触发资源 / 触发资源上限）","ui.trigger.resource":"触发资源为","ui.none":"无","ui.limit":"限制","ui.craftLimit":"AI平衡","ui.upgradesLimit":"优选","ui.trigger.shipOverride.set":"输入一个新的 强制贸易船 触发值，\n即贸易船数量低于触发条件时，相当于未勾选贸易船AI平衡。","ui.trigger.missions.set":"输入一个新的 探索星球 触发值,取值范围为 0 到 13 的整数。\n分别对应13颗星球。\n\n默认优先碧池探索，会暂时跳过沙丘","ui.trigger.crypto.set":"输入一个新的 {0} 触发值，\n支持3个参数：-符号隔开数字参数\n第一个数字：当遗物数量大于触发值才会进行黑币交易\n第二个数字：买入的最高价（超过这价格就不会买了）\n第三个数字：卖出最低的价格。（低于这价格就不会卖出）\n默认10000-881-1060","ui.engine":"启用小猫珂学家","ui.build":"营火","ui.space":"太空","ui.craft":"工艺","ui.upgrade":"升级","ui.trade":"贸易","ui.faith":"宗教","ui.time":"时间","ui.options":"小喵选项","ui.filter":"日志过滤","ui.distribute":"喵喵管理","ui.max":"Max: {0}","msg.catnip":"如果寒冬猫薄荷产量低于0，小猫珂学家会停止消耗猫薄荷","ui.upgrade.upgrades":"工坊升级","ui.upgrade.techs":"科学科技","ui.upgrade.races":"探险者出发!","ui.upgrade.missions":"探索星球","ui.upgrade.buildings":"升级建筑","ui.upgrade.policies":"政策","ui.upgrade.policies.load":"读取","ui.upgrade.policies.show":"列表","ui.faith.addtion":"附加选项","option.faith.best.unicorn":"自动最佳独角兽建筑","option.faith.best.unicorn.desc":"自动献祭独角兽，并会以独角兽或象牙来决定建造独角兽牧场~象牙塔...太阳尖顶<br>当象牙不足时会切换成象牙模式具体可以点击小猫总结看到(概览还未更新象牙模式)",unicornSacrifice:"小猫献祭了 {0} 独角兽，收集了 {1} 滴独角兽的眼泪","option.faith.transcend":"自动最佳次元超越","summary.transcend.catnip":"喵喵喵，你也不想次元超越再赞美群星后让小喵饿死吧？（猫薄荷产量将是：{0}）","act.transcend":"消耗 {0} 顿悟，达到次元超越 {1}","summary.transcend":"次元超越了 {0} 次","option.faith.adore":"赞美群星","act.adore":"赞美群星! 转化 {0} 虔诚为 {1} 顿悟","act.adore.last":"下次小猫赞美群星，会等到虔诚大于 {0} ","summary.adore":"通过赞美群星积累了 {0} 顿悟","summary.adore.catnip":"喵喵喵，你也不想赞美群星后让小喵饿死吧？（猫薄荷产量将是：{0}）","summary.adore.solar":"聪明的小猫已经会算期望了，当太阳革命加成到达：{0}% 后才会赞美群星","summary.adore.last":"下次赞美群星会等到虔诚大于{0} ","adore.trigger.set":"赞美群星再赞美太阳后的太阳革命加成 ≥ 触发条件 * 1000%，\n触发条件取值范围为 0 到 1 的小数（0.001为自动模式）\n\n同时满足以下条件珂学家将自动赞美群星。\n1. 当前信仰 / 信仰上限 ≥ 0.98(赞美太阳触发条件设置0.98配合使用)\n2.有月球前哨\n3.赞美群星后的猫薄荷产量＞0。\n推荐启用该功能多放几个农民，喵喵保护协会不允许饿死喵喵喵\n优先次元超越 => 赞美群星 => 赞美太阳","resources.add":"添加资源","resources.clear.unused":"清除未使用","resources.stock":"库存: {0}","resources.consume":"消耗率: {0}","resources.del":"删除","resources.stock.set":"设置 {0} 的库存","resources.consume.set":"设置 {0} 的消耗率","resources.del.confirm":"确定要取消 {0} 的库存控制?","status.ks.enable":"神说，要有猫猫珂学家!","status.ks.disable":"太敬业了，该歇了","status.sub.enable":"启用 {0}","status.auto.enable":"启用自动化 {0}","status.sub.disable":"禁用 {0}","status.auto.disable":"禁用自动化 {0}","trade.limited":"贸易获得数量大于产量时才与 {0} 贸易，次数自动限制","trade.limitedTitle":"根据产量和贸易获得数量","trade.unlimited":"{1}与 {0} 的 贸易","trade.seasons":"季节","trade.season.enable":"启用在 {1} 与 {0} 的贸易","trade.season.disable":"停止在 {1} 与 {0} 的贸易","trade.catnip":"ฅ'ω'ฅ，你也不想让小喵饿死吧？与鲨鱼贸易喽","filter.enable":"过滤 {0}","filter.disable":"取消过滤 {0}","craft.force":"为了研究{1}，喵喵偷偷拿了资源合成了{0}，她才不会心痛了","craft.forceSteel":"小猫为了工坊升级{0}，偷偷多使用了一些材料合成了钢","craft.limited":"平衡{0}（理解为小猫AI控制触发条件、消耗率，挂机效率会比较高）","craft.limitedTitle":"根据原材料和目标材料的数量","craft.unlimited":"触发资源：{1}{0}","craft.winterCatnip":"呐呐呐，你也不想让寒冬时小喵饿死吧？喵粮上交","distribute.limited":"分配 {0} 不会超过Max","distribute.leaderJob":"领袖工作为 {0} ","distribute.leaderTrait":"领袖的特质为 {0} ","distribute.unlimited":"分配 {0} 允许超过MAX","distribute.makeLeader":"分配领袖","act.distribute":"分配一只猫猫成为 {0}","act.distribute.catnip":"担心你的猫猫没有猫薄荷吸并强制分配到农民","act.distributeLeader":"分配一只 {0} 猫猫领袖","ui.max.set":"设置 {0} 的最大值","summary.distribute":"帮助 {0} 只偷吃猫薄荷的猫猫找到工作","set.leader":"{0}，喵喵喵！","option.promote":"提拔领袖等级","act.promote":"领袖被提拔到 {0} 级","summary.promote":"提拔领袖 {0} 次","ui.trigger.useWorkers.alert":"比如天文事件没观测、烧水晶慢，珂学家后台大概10才运行1次\n勾选将会在后台满速运行，注意会导致使用内存增多。\n电脑不好、内存< 8G的建议禁用\n推荐过滤全部日志会减少性能的消耗。\n\n需满足浏览器支持且游戏选项的web worker启用。\n确认后会自动重新勾选启用珂学家","ui.timeCtrl":"时间操纵","option.accelerate":"光阴似箭","act.accelerate":"固有时制御，二倍速!","act.accelerate.acl":"抓稳了，猫猫要开始加速了!","act.accelerate.slow":"不行了，要减速了","summary.accelerate":"小猫加速时间 {0} 次","option.time.skip":"时间跳转","act.time.skip":"燃烧时间水晶, 跳过接下来的 {0} 年!","ui.cycles":"周期","ui.maximum":"单次数量","time.skip.cycle.enable":"启用在 {0} 跳转时间并允许跳过该周期","time.skip.cycle.disable":"停止在 {0} 跳转时间并禁止跳过该周期","time.skip.season.enable":"启用在 {0} 跳转时间","time.skip.season.disable":"停止在 {0} 跳转时间","time.skip.trigger.set":"拥有时间水晶数量大于该触发值才会燃烧时间水晶，取值范围为正整数。\n注意会计算时间水晶库存\n周期默认全勾就行，珂学家会自动判断是否停在红月\n每2秒烧水晶次数固定为 0.04x时计炉(无千禧年0.02)，故单次数量进一法就行\n如果资源回复后资源一直是满的，建议过滤大部分日志\n\n故长挂推荐：触发条件500，单次数量1，周期全勾","summary.time.skip":"跳过 {0} 年","option.time.reset":"重启时间线 (弃用)","status.reset.check.enable":"在重启时间线前检查 {0}","status.reset.check.disable":"在重启时间线前不检查 {0}","ui.min":"Min: {0}","reset.check.trigger.set":"为 {0} 设置新的触发值.\n-1 表示必须将此建筑建造至超过资源上限为止","reset.check":"{0} 的触发值: {1}, 现在共有 {2}","reset.checked":"所有条件都已满足，时间线将在几秒后重启!","reset.tip":'你可以通过取消 "启用小猫珂学家" 或 "时间操控" 或 "重启时间线" 以取消此次重启',"reset.countdown.10":"10 - 正在收获猫薄荷","reset.countdown.9":"&nbsp;9 - 正在献祭独角兽","reset.countdown.8":"&nbsp;8 - 正在放生蜥蜴","reset.countdown.7":"&nbsp;7 - 正在拆解电磁炮","reset.countdown.6":"&nbsp;6 - 正在启动时间引擎","reset.countdown.5":"&nbsp;5 - 正在融化黑币","reset.countdown.4":"&nbsp;4 - 正在关闭卫星","reset.countdown.3":"&nbsp;3 - 正在打开时空裂隙","reset.countdown.2":"&nbsp;2 - 正在启动时间锻造","reset.countdown.1":"&nbsp;1 - 时间引擎已启动!","reset.countdown.0":"&nbsp;0 - 时空裂缝已打开!","reset.last.message":"我们下个庞加莱回归再见","reset.after":"初次见面，可爱的猫猫珂学家为您服务","reset.cancel.message":"重启时间线计划取消.","reset.cancel.activity":"喵斯顿，我们有麻烦了.","summary.time.reset.title":"过去 {0} 个时间线的总结","summary.time.reset.content":"获得 {0} 业.<br>获得 {1} 领导力.","ui.close":"关闭","auto.countdown":"{0} 秒后将会自动启用珂学家","auto.tip":'你可以通过取消 "首次自启珂学家" 以取消此次自动开启',"option.fix.cry":"修复冷冻仓","act.fix.cry":"小猫修复了 {0} 个冷冻仓","summary.fix.cry":"修复了 {0} 个冷冻仓","summary.auto.biolab":"小猫为了节省合金发展，轨道测地学前不建造，太空制造前生物实验室优先级降低","summary.auto.broadcastTower":"小猫为了节省钛用来发展，太空制造解锁后建造更多的广播塔","summary.auto.craftLimited":"每次运行都会合成工艺(即无视触发条件)，数量AI自动。挂机发展速度会远大于触发条件的。","summary.auto.harbor":"港口需要的金属板太多，小猫会少造亿点点(一定是斑马的阴谋","summary.auto.hunter":"未发明弩和导航学，小猫当猎人欲望降低","summary.auto.ironwood":"喵喵喵把铁收起来，希望住上向往的铁木小屋","summary.auto.kittens":"计划生育! 猫粮产量不够了","summary.auto.leader":"喵喵自觉顶替领袖，做特质相关项目。（领袖特质的具体效果可以参考右下角：百科-游戏标签-村庄-猫口普查）","summary.auto.lower":"未研究轨道测地学，小猫为了发展更快，故降低牧场、水渠、图书馆、研究院、粮仓、港口、油井、仓库的优先度","summary.auto.mansion":"小猫为了节省钛和钢用来发展，宅邸优先度降低（2倍多资源）","summary.auto.oxidation":"为菈妮氧化反应，小猫把钢全存起来了","summary.auto.pasture":"喵喵喵嫌弃了牧场，木材还是用来发展的好，真的是最后1个了","summary.auto.steamworks":"小猫曰：蒸汽工房要与磁电机成双成对","summary.auto.temple":"祷告太阳革命后才会建造神殿，真的不是偷懒喵","summary.auto.tradepost":"祷告太阳革命前，交易所开摆","summary.auto.workshop":"工坊只是解锁升级的 猫玩具罢了，现在小猫只愿意造1个工坊哦","summary.auto.scienceBld":"天文台、研究院、生物实验室科学上限快满了才会建造。","summary.auto.smelter":"神学前，冶炼专精的小猫会根据木材和矿物产量来控制熔炉上限","summary.auto.academy":"小猫当科学快满了才会继续建造研究院","summary.auto.unicorn":"最佳独角兽建筑：{0}","summary.auto.upgPasture":"当勾选太阳能发电站了，并有足够钛的产量、且缺电、且猫薄荷产量足够高时，小猫会贴心的帮你卖出全部牧场后，升级太阳能发电站!","summary.auto.upgAqueduct":"当勾选水电站了，有太阳能发电站、且缺电、且猫薄荷产量足够高时，小猫会贴心的帮你卖出全部水渠后，升级水电站!","summary.auto.upgLibrary":"当勾选数据中心了，概要数量大于 150X图书馆数量 时，小猫会贴心的帮你卖出全部图书馆后，升级数据中心!","summary.auto.upgAmphitheatre":"当有贸易船或者钛产量足够高时，小猫会贴心的帮你卖出全部剧场后，升级广播塔!","summary.upgrade.building.pasture":"卖出牧场 并升级为 太阳能发电站 !","summary.upgrade.building.aqueduct":"卖出水渠 并升级为 水电站 !","summary.upgrade.building.library":"卖出图书馆 并升级为 数据中心!","summary.upgrade.building.amphitheatre":"卖出剧场 并升级为 广播塔!","summary.resource":"小猫自动调整资源: {0} 的消耗率","summary.moon":"小猫停在红月周期散热 {0} 次","summary.time.skip.moon":"由于燃烧时间水晶支出大于收入，小猫决定攒难得素，停留在红月 {0} 次!","summary.blackcoin.buy":"小猫出售遗物并买入 {0} 次黑币","summary.blackcoin.sell":"小猫出售黑币并买入了 {0} 次遗物","summary.accelerator":"电量寄了，大概只有加速器能关闭了（不会影响库存","summary.catnip":"呐，你的猫猫没有猫薄荷吸并强制分配 {0} 个农民","summary.calciner":"小猫因为你工坊升级了钢铁工厂，故关闭了煅烧炉自动化（其效果铁和煤转化钢没有100%~具体右下角参考百科）（她真的好温柔，😭）","summary.mint":"秋梨膏别开铸币厂了，它现在真的很不行（具体右下角参考百科 游戏标签-其它建筑-铸币厂，其转化效率与喵力上限有关）","summary.pumpjack":"小猫担心冬季电不够并关闭了 {0} 次油井自动化","summary.biolab":"小猫担心冬季电不够并关闭了 {0} 个生物实验室(关了后科学上限和科学加成还会加成)","summary.biolab.test":" {0} 个生物实验室(非常没用的工坊升级)","summary.temporalAccelerator":"小猫担心卡顿打开了时空加速器的自动化","summary.reactor":"小猫向反应堆投入了铀开始发光呐","summary.factory":"小猫为了空间的发展，把工厂全部启用呐","summary.steamworks":"小猫向蒸汽工房加了煤开始排蒸汽呐","summary.breweryOn":"已举办文化节，喵星人重新打开了酿酒厂~嗝","summary.breweryOff":"节日没呐，小猫拒奢守俭，暂时关闭了酿酒厂","summary.brewery":"小猫根据节日调整了 {0} 次酿酒厂","summary.chronocontrolOn":"小猫开启了时间操纵延长时间悖论的持续天数","summary.chronocontrolOff":"小猫关闭了时间操纵节省电力","summary.chronocontrol":"小猫根据时间悖论调整了 {0} 次时间操纵","summary.marker":"没有黑金字塔小猫拒绝了神印的建造","summary.festival":"举办了 {0} 次节日","summary.stars":"观测了 {0} 次天文事件","summary.praise":"通过赞美太阳积累了 {0} 虔诚","summary.hunt":"派出了 {0} 批可爱的小猫","summary.hunt.manager":"管理者领袖派出了 {0} 批可爱的小猫","summary.embassy":"设立了 {0} 个大使馆","summary.feed":"向利维坦献祭 {0} 只死灵兽","summary.tech":"{0}","summary.upgrade":"{0}","summary.build":"建造了 {0} 个 {1}","summary.faith":"{1} {0} 次","summary.craft":"制作了{0} 个 {1}","summary.craftLeader":"工匠制作了 {0} 个 {1}","summary.craftManuscript":"小猫偷偷使用了 {0} 次材料合成手稿，为了科学","summary.craftCompedium":"小猫偷偷使用了 {0} 次材料合成概要，为了科学","summary.craftBlueprint":"小猫偷偷使用了 {0} 次材料合成蓝图，为了科学","summary.trade":"{1} 贸易了 {0} 次","summary.year":"年","summary.years":"年","summary.separator":" ","summary.day":"天","summary.days":"天","summary.head":"过去 {0} 的总结","summary.show":"小猫总结"}};if(!r[i]){console.error(i+" not found");r[i]=r["en"]}const j=function(e,t){if(e[0]==="$"){return $I(e.slice(1))}let a=r[i][e];if(typeof a==="undefined"){a=r["en"][e];if(!a){console.error('key "'+e+'" not found');return"$"+e}console.error('Key "'+e+'" not found in '+i)}if(t){for(let e=0;e<t.length;e++){a=a.replace("{"+e+"}",t[e])}}return a};const H={debug:false,interval:2e3,msgcolor:"#aa50fe",summarycolor:"#009933",activitycolor:"#E65C00",stockwarncolor:"#DD1E00",copyTrait:false,countdown:120,renderTime:0,consume:.6,auto:{engine:{enabled:false},unicorn:{items:{unicornPasture:{require:false,enabled:true,variant:"zp",label:j("$buildings.unicornPasture.label"),checkForReset:true,triggerForReset:-1},unicornTomb:{require:false,enabled:false,variant:"z",label:j("$religion.zu.unicornTomb.label"),checkForReset:true,triggerForReset:-1},ivoryTower:{require:false,enabled:false,variant:"z",label:j("$religion.zu.ivoryTower.label"),checkForReset:true,triggerForReset:-1},ivoryCitadel:{require:false,enabled:false,variant:"z",label:j("$religion.zu.ivoryCitadel.label"),checkForReset:true,triggerForReset:-1},skyPalace:{require:false,enabled:false,variant:"z",label:j("$religion.zu.skyPalace.label"),checkForReset:true,triggerForReset:-1},unicornUtopia:{require:"gold",enabled:false,variant:"z",label:j("$religion.zu.unicornUtopia.label"),checkForReset:true,triggerForReset:-1},sunspire:{require:"gold",enabled:false,variant:"z",label:j("$religion.zu.sunspire.label"),checkForReset:true,triggerForReset:-1}}},faith:{enabled:false,trigger:0,transcendCatnip:0,adoreCatnip:0,addition:{bestUnicornBuilding:{enabled:true,misc:true,label:j("option.faith.best.unicorn"),confirm:0},autoPraise:{enabled:true,misc:true,label:j("option.praise"),subTrigger:.98,msg:0,time:0,expect:0},adore:{enabled:true,misc:true,label:j("option.faith.adore"),subTrigger:.001},transcend:{enabled:true,misc:true,label:j("option.faith.transcend")}},items:{marker:{require:"unobtainium",enabled:false,max:-1,variant:"z",checkForReset:true,triggerForReset:-1},unicornGraveyard:{require:false,enabled:false,max:-1,variant:"z",checkForReset:true,triggerForReset:-1},unicornNecropolis:{require:false,enabled:false,max:-1,variant:"z",checkForReset:true,triggerForReset:-1},blackPyramid:{require:"unobtainium",enabled:false,max:-1,variant:"z",checkForReset:true,triggerForReset:-1},solarchant:{require:"faith",enabled:true,max:-1,variant:"s",checkForReset:true,triggerForReset:-1},scholasticism:{require:"faith",enabled:true,max:3,variant:"s",checkForReset:true,triggerForReset:-1},goldenSpire:{require:"faith",enabled:true,max:-1,variant:"s",checkForReset:true,triggerForReset:-1},sunAltar:{require:"faith",enabled:true,max:-1,variant:"s",checkForReset:true,triggerForReset:-1},stainedGlass:{require:"faith",enabled:true,max:1,variant:"s",checkForReset:true,triggerForReset:-1},solarRevolution:{require:"faith",enabled:true,max:1,variant:"s",checkForReset:true,triggerForReset:-1},basilica:{require:"faith",enabled:true,max:5,variant:"s",checkForReset:true,triggerForReset:-1},templars:{require:"faith",enabled:true,max:5,variant:"s",checkForReset:true,triggerForReset:-1},apocripha:{require:"faith",enabled:true,max:1,variant:"s",checkForReset:true,triggerForReset:-1},transcendence:{require:"faith",enabled:true,max:1,variant:"s",checkForReset:true,triggerForReset:-1},blackObelisk:{require:false,enabled:false,max:-1,variant:"c",checkForReset:true,triggerForReset:-1},blackNexus:{require:false,enabled:false,max:-1,variant:"c",checkForReset:true,triggerForReset:-1},blackCore:{require:false,enabled:false,max:-1,variant:"c",checkForReset:true,triggerForReset:-1},singularity:{require:false,enabled:false,max:-1,variant:"c",checkForReset:true,triggerForReset:-1},blackLibrary:{require:false,enabled:false,max:-1,variant:"c",checkForReset:true,triggerForReset:-1},blackRadiance:{require:false,enabled:false,max:-1,variant:"c",checkForReset:true,triggerForReset:-1},blazar:{require:false,enabled:false,max:-1,variant:"c",checkForReset:true,triggerForReset:-1},darkNova:{require:false,enabled:false,max:-1,variant:"c",checkForReset:true,triggerForReset:-1},holyGenocide:{require:false,enabled:false,max:-1,variant:"c",checkForReset:true,triggerForReset:-1}}},build:{enabled:false,trigger:0,items:{field:{require:"catnip",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},workshop:{require:"minerals",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},factory:{require:"titanium",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},hut:{require:"wood",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},logHouse:{require:"minerals",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},mansion:{require:"titanium",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},steamworks:{require:false,enabled:true,max:-1,checkForReset:true,triggerForReset:-1},magneto:{require:false,enabled:true,max:-1,checkForReset:true,triggerForReset:-1},reactor:{require:"titanium",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},smelter:{require:"minerals",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},calciner:{require:"titanium",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},mine:{require:"wood",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},lumberMill:{require:"minerals",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},oilWell:{require:"coal",enabled:true,max:200,checkForReset:true,triggerForReset:-1},quarry:{require:"coal",enabled:true,max:300,checkForReset:true,triggerForReset:-1},library:{require:"wood",enabled:true,max:-1,stage:0,checkForReset:true,triggerForReset:-1},dataCenter:{require:false,enabled:true,max:150,stage:1,name:"library",checkForReset:true,triggerForReset:-1},academy:{require:"wood",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},observatory:{require:"iron",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},biolab:{require:"science",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},pasture:{require:"catnip",enabled:true,max:150,stage:0,checkForReset:true,triggerForReset:-1},solarFarm:{require:"titanium",enabled:true,max:-1,stage:1,name:"pasture",checkForReset:true,triggerForReset:-1},aqueduct:{require:"minerals",enabled:true,max:250,stage:0,checkForReset:true,triggerForReset:-1},hydroPlant:{require:"titanium",enabled:true,max:-1,stage:1,name:"aqueduct",checkForReset:true,triggerForReset:-1},amphitheatre:{require:"minerals",enabled:true,max:60,stage:0,checkForReset:true,triggerForReset:-1},broadcastTower:{require:"titanium",enabled:true,max:-1,stage:1,name:"amphitheatre",checkForReset:true,triggerForReset:-1},tradepost:{require:"gold",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},chapel:{require:"minerals",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},temple:{require:"gold",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},mint:{require:"gold",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},ziggurat:{require:false,enabled:true,max:110,checkForReset:true,triggerForReset:-1},chronosphere:{require:"unobtainium",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},aiCore:{require:false,enabled:false,max:-1,checkForReset:true,triggerForReset:-1},brewery:{require:false,enabled:true,max:-1,checkForReset:true,triggerForReset:-1},barn:{require:"wood",enabled:true,max:15,checkForReset:true,triggerForReset:-1},harbor:{require:false,enabled:true,max:200,checkForReset:true,triggerForReset:-1},warehouse:{require:false,enabled:true,max:200,checkForReset:true,triggerForReset:-1},accelerator:{require:"titanium",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},zebraOutpost:{require:"bloodstone",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},zebraWorkshop:{require:"bloodstone",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},zebraForge:{require:"bloodstone",enabled:false,max:-1,checkForReset:true,triggerForReset:-1}}},space:{enabled:false,trigger:0,items:{spaceElevator:{require:"unobtainium",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},sattelite:{require:"titanium",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},spaceStation:{require:"oil",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},moonOutpost:{require:"uranium",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},moonBase:{require:"unobtainium",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},planetCracker:{require:"science",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},hydrofracturer:{require:"science",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},spiceRefinery:{require:"science",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},researchVessel:{require:"titanium",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},orbitalArray:{require:"science",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},sunlifter:{require:"science",enabled:true,max:-1,checkForReset:true,triggerForReset:-1},containmentChamber:{require:"science",enabled:false,max:5,checkForReset:true,triggerForReset:-1},heatsink:{require:"thorium",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},sunforge:{require:false,enabled:false,max:-1,checkForReset:true,triggerForReset:-1},cryostation:{require:"eludium",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},spaceBeacon:{require:"antimatter",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},terraformingStation:{require:"antimatter",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},hydroponics:{require:"kerosene",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},hrHarvester:{require:"antimatter",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},entangler:{require:"antimatter",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},tectonic:{require:"antimatter",enabled:false,max:-1,checkForReset:true,triggerForReset:-1},moltenCore:{require:"uranium",enabled:false,max:-1,checkForReset:true,triggerForReset:-1}}},time:{enabled:false,trigger:0,items:{temporalBattery:{require:false,enabled:false,max:0,variant:"chrono",checkForReset:true,triggerForReset:-1},blastFurnace:{require:false,enabled:false,max:-1,variant:"chrono",checkForReset:true,triggerForReset:-1},timeBoiler:{require:false,enabled:false,max:-1,variant:"chrono",checkForReset:true,triggerForReset:-1},temporalAccelerator:{require:false,enabled:false,max:1,variant:"chrono",checkForReset:true,triggerForReset:-1},temporalImpedance:{require:false,enabled:false,max:-1,variant:"chrono",checkForReset:true,triggerForReset:-1},ressourceRetrieval:{require:false,enabled:false,max:-1,variant:"chrono",checkForReset:true,triggerForReset:-1},temporalPress:{require:false,enabled:false,max:0,variant:"chrono",checkForReset:true,triggerForReset:-1},cryochambers:{require:false,enabled:false,max:-1,variant:"void",checkForReset:true,triggerForReset:-1},voidHoover:{require:"antimatter",enabled:false,max:-1,variant:"void",checkForReset:true,triggerForReset:-1},voidRift:{require:false,enabled:false,max:-1,variant:"void",checkForReset:true,triggerForReset:-1},chronocontrol:{require:"temporalFlux",enabled:false,max:-1,variant:"void",checkForReset:true,triggerForReset:-1},voidResonator:{require:false,enabled:false,max:-1,variant:"void",checkForReset:true,triggerForReset:-1}}},timeCtrl:{enabled:false,items:{accelerateTime:{enabled:true,subTrigger:1,misc:true,label:j("option.accelerate")},timeSkip:{enabled:true,subTrigger:500,misc:true,label:j("option.time.skip"),maximum:1,0:true,1:true,2:true,3:true,4:true,5:true,6:true,7:true,8:true,9:true,spring:true,summer:false,autumn:false,winter:false,wait:false,adore:false,craft:false,moonMsg:-1}}},craft:{enabled:false,trigger:.95,items:{wood:{require:"catnip",max:0,limited:true,limRat:.5,enabled:true},beam:{require:"wood",max:0,limited:true,limRat:.5,enabled:true},slab:{require:"minerals",max:0,limited:true,limRat:.5,enabled:true},steel:{require:"coal",max:0,limited:true,limRat:.5,enabled:true},plate:{require:"iron",max:0,limited:true,limRat:.5,enabled:true},alloy:{require:"titanium",max:0,limited:true,limRat:.5,enabled:true},concrate:{require:false,max:0,limited:true,limRat:.2,enabled:true},gear:{require:false,max:0,limited:true,limRat:.5,enabled:true},scaffold:{require:false,max:0,limited:true,limRat:.5,enabled:true},ship:{require:false,max:0,limited:true,limRat:.5,enabled:true},tanker:{require:false,max:0,limited:true,limRat:.5,enabled:false},parchment:{require:false,max:0,limited:false,limRat:.5,enabled:true},manuscript:{require:"culture",max:0,limited:true,limRat:.5,enabled:true},compedium:{require:"science",max:0,limited:true,limRat:.5,enabled:true},blueprint:{require:"science",max:0,limited:true,limRat:.5,enabled:true},kerosene:{require:"oil",max:0,limited:true,limRat:.5,enabled:true},megalith:{require:false,max:0,limited:true,limRat:.5,enabled:true},eludium:{require:"unobtainium",max:0,limited:true,limRat:.5,enabled:true},thorium:{require:"uranium",max:0,limited:false,limRat:.5,enabled:true}},autoConsume:{}},trade:{cache:false,enabled:false,trigger:.98,items:{dragons:{enabled:false,require:"titanium",allowCapped:false,limited:true,summer:true,autumn:true,winter:true,spring:true},zebras:{enabled:true,require:false,allowCapped:false,limited:true,summer:true,autumn:true,winter:true,spring:true},lizards:{enabled:false,require:"minerals",allowCapped:false,limited:true,summer:true,autumn:false,winter:false,spring:false},sharks:{enabled:false,require:"iron",allowCapped:false,limited:true,summer:false,autumn:false,winter:true,spring:false},griffins:{enabled:true,require:"wood",allowCapped:false,limited:true,summer:false,autumn:true,winter:false,spring:false},nagas:{enabled:true,require:false,allowCapped:false,limited:true,summer:false,autumn:false,winter:false,spring:true},spiders:{enabled:false,require:false,allowCapped:false,limited:true,summer:false,autumn:true,winter:false,spring:false},leviathans:{enabled:true,require:"unobtainium",allowCapped:true,limited:true,summer:true,autumn:true,winter:true,spring:true}}},upgrade:{enabled:false,items:{techs:{enabled:true,limited:true},upgrades:{enabled:true,limited:true,cache:false},policies:{enabled:false},races:{enabled:true},missions:{enabled:true,subTrigger:4},buildings:{enabled:true}}},options:{catnipMsg:0,enabled:true,items:{style:{enabled:true,misc:true,label:j("option.style")},hunt:{enabled:true,subTrigger:.95,require:"manpower",misc:true,label:j("option.hunt")},buildEmbassies:{enabled:true,subTrigger:.94,require:"culture",misc:true,label:j("option.embassies")},shipOverride:{enabled:true,subTrigger:170,misc:true,label:j("option.shipOverride")},festival:{enabled:true,misc:true,label:j("option.festival")},promote:{enabled:true,misc:true,label:j("option.promote")},autofeed:{enabled:true,misc:true,label:j("option.autofeed")},observe:{enabled:true,misc:true,label:j("option.observe")},gameFilter:{enabled:true,misc:true,label:"游戏日志过滤"},crypto:{enabled:false,subTrigger:1e4,misc:true,label:j("option.crypto")},fixCry:{enabled:false,misc:true,label:j("option.fix.cry")},saves:{enabled:false,misc:true,label:"导出配置文件"},donate:{enabled:false,misc:true,label:"显示捐赠原作者图标"},useWorkers:{enabled:false,misc:true,label:j("option.useWorkers")},wiki:{enabled:false,misc:true,label:"珂学家使用说明书（百科链接🐱）"},autoScientists:{enabled:false,misc:true,label:"首次自启珂学家"}}},distribute:{religion:false,enabled:false,items:{woodcutter:{enabled:true,max:29,limited:true},farmer:{enabled:true,max:1,limited:true},scholar:{enabled:true,max:9,limited:true},hunter:{enabled:true,max:24,limited:true},miner:{enabled:true,max:24,limited:true},priest:{enabled:true,max:3,limited:false},geologist:{enabled:true,max:40,limited:true},engineer:{enabled:false,max:1,limited:false},leader:{enabled:true,leaderJob:"farmer",leaderTrait:"manager"}}},filter:{enabled:false,console:{},items:{buildFilter:{enabled:false,label:j("filter.build"),variant:"ks-activity type_ks-build"},researchFilter:{enabled:false,label:j("filter.research"),variant:"ks-activity type_ks-research"},upgradeFilter:{enabled:false,label:j("filter.upgrade"),variant:"ks-activity type_ks-upgrade"},craftFilter:{enabled:false,label:j("filter.craft"),variant:"ks-activity type_ks-craft"},policyFilter:{enabled:false,label:j("filter.policy"),variant:"ks-activity type_ks-policy"},upgBldFilter:{enabled:false,label:j("filter.upgBld"),variant:"ks-activity type_ks-upgBld"},tradeFilter:{enabled:false,label:j("filter.trade"),variant:"ks-activity type_ks-trade"},embassyFilter:{enabled:false,label:j("filter.embassy"),variant:"ks-activity type_ks-embassy"},huntFilter:{enabled:false,label:j("filter.hunt"),variant:"ks-activity type_ks-hunt"},faithFilter:{enabled:false,label:j("filter.praise"),variant:"ks-activity type_ks-praise"},adoreFilter:{enabled:false,label:j("filter.adore"),variant:"ks-activity type_ks-adore"},transcendFilter:{enabled:false,label:j("filter.transcend"),variant:"ks-activity type_ks-transcend"},unicornSacrificeFilter:{enabled:false,label:j("filter.sacrifice"),variant:"ks-activity type_ks-sacrifice"},faithBuildFilter:{enabled:false,label:j("filter.faith"),variant:"ks-activity type_ks-faith"},accelerateFilter:{enabled:false,label:j("filter.accelerate"),variant:"ks-activity type_ks-accelerate"},tcShatterFilter:{enabled:false,label:j("filter.time.skip"),variant:"ks-activity type_ks-timeSkip"},festivalFilter:{enabled:false,label:j("filter.festival"),variant:"ks-activity type_ks-festival"},astronomicalEventFilter:{enabled:false,label:j("filter.star"),variant:"ks-activity type_ks-star"},distributeFilter:{enabled:false,label:j("filter.distribute"),variant:"ks-activity type_ks-distribute"},leaderFilter:{enabled:false,label:j("filter.leader"),variant:"ks-activity type_ks-leader"},miscFilter:{enabled:false,label:j("filter.misc"),variant:"ks-activity"}}},resources:{furs:{enabled:true,stock:350,checkForReset:false,stockForReset:Infinity},timeCrystal:{enabled:false,stock:0,checkForReset:true,stockForReset:5e5}},policies:[],cache:{dataTimer:{},cacheSum:{},resources:{},trait:{},upgrade:undefined,science:"",resUpg:{}}}};game.console.maxMessages=1e3;let Y=game.resPool.resourceMap;const X=function(t){if(H.auto.filter.enabled){let e=H.auto.filter.items;for(const i in e){const r=e[i];if(r.enabled&&r.variant===t[1]){return}}}const e=t.pop();t[1]=t[1]||"ks-default";let a=game.msg.apply(game,t);$(a.span).css("color",e);if(H.debug&&console){console.log(t)}};const l=function(){let e=Array.prototype.slice.call(arguments);e.push("ks-default");e.push(H.msgcolor);X(e)};const Z=function(){let e=Array.prototype.slice.call(arguments);let t=e.length>1?" type_"+e.pop():"";e.push("ks-activity"+t);e.push(H.activitycolor);X(e)};const p=function(){const e=Array.prototype.slice.call(arguments);e.push("ks-summary");e.push(H.summarycolor);X(e)};const s=function(){const e=Array.prototype.slice.call(arguments);e.unshift("Warning!");if(console){console.log(e)}};const S=function(e,t,a){l(j(e,t),a)};const Q=function(e,t,a){Z(j(e,t),a)};const d=function(e,t,a){p(j(e,t),a)};const b=e=>{if(!H.auto.cache.upgrade){H.auto.cache.upgrade={}}let r=e.upgrades;for(let i in r){if(!H.auto.cache.upgrade[i]){H.auto.cache.upgrade[i]=[]}let a=H.auto.cache.upgrade[i];for(let t in r[i]){let e=r[i][t];if(a.indexOf(e)===-1){a.push(e)}}}};let ee=e=>{let t=Y[e];return t.value/t.maxValue};let h=e=>{};const v=function(){this.upgradeManager=new y;this.buildManager=new q;this.spaceManager=new A;this.craftManager=new t;this.bulkManager=new a;this.tradeManager=new x;this.religionManager=new B;this.timeManager=new C;this.villageManager=new e("Village");this.cacheManager=new n};v.prototype={upgradeManager:undefined,buildManager:undefined,spaceManager:undefined,craftManager:undefined,bulkManager:undefined,tradeManager:undefined,religionManager:undefined,timeManager:undefined,villageManager:undefined,cacheManager:undefined,now:undefined,loop:undefined,huntID:undefined,renderID:undefined,worker:undefined,toolText:undefined,tooltip:undefined,start:function(e=true){H.interval=Math.ceil(100/game.getTicksPerSecondUI())*100;if(game.isWebWorkerSupported()&&game.useWorkers&&H.auto.options.items.useWorkers.enabled){if(this.worker){return}const t=new Blob(["onmessage = function(e) { setInterval(function(){postMessage('miaowu')}, '"+H.interval+"' ); }"]);const a=window.URL.createObjectURL(t);this.worker=new Worker(a);this.worker.addEventListener("message",this.iterate.bind(this));this.worker.postMessage("miaowu");if(e){l("后台珂学家上钟了~ ＞▽＜")}}else{if(this.loop){return}this.loop=setInterval(this.iterate.bind(this),H.interval);if(e){S("status.ks.enable")}}},stop:function(e=true){if(game.isWebWorkerSupported()&&this.worker){if(e){l("后台珂学家爪巴了")}this.worker.terminate();this.worker=undefined}if(!this.loop){return}clearInterval(this.loop);this.loop=undefined;if(e){S("status.ks.disable")}},iterate:async function(){clearTimeout(this.renderID);if(!game.mobileSaveOnPause||game.loadingSave||game.isPaused){return}let e=0;this.beforeStart();let t=H.auto;let a=t.options;if(a.enabled&&a.items.observe.enabled){this.observeStars()}if(t.upgrade.enabled){e+=~~this.upgrade()}if(a.enabled&&a.items.festival.enabled){this.holdFestival()}if(t.timeCtrl.enabled){e+=~~this.timeCtrl()}if(t.build.enabled){e+=~~this.build()}if(t.space.enabled){e+=~~this.space()}if(t.faith.enabled){e+=~~this.worship()}if(e>0||t.cache.upgrade){this.gameUpgrade()}if(t.craft.enabled){this.craft()}if(a.enabled&&a.items.hunt.enabled){this.delay()}if(a.enabled&&a.items.autofeed.enabled){this.autofeed()}if(t.trade.enabled){this.trade()}if(t.time.enabled){e+=~~this.chrono()}if(a.enabled&&a.items.crypto.enabled){this.crypto()}if(H.copyTrait){this.setTrait()}if(a.enabled&&a.items.promote.enabled){this.promote()}if(a.enabled){e+=~~this.miscOptions()}if(t.distribute.enabled){e+=~~this.distribute()}if(e>0){this.delay("render")}},beforeStart:function(){let t=game.resPool;let a=t.resources;for(let e of a){t.addRes(e,Math.max(e.perTickCached,0),false)}},delay:function(e){if(e){let e=this.tooltip;if(!e){return this.tooltip=dojo.byId("tooltip")}let t=e.innerText;if(H.renderTime+6e5<Date.now()||this.toolText!==t){this.renderID=setTimeout(()=>{let e=game.ui.activeTabId;if(e==="Village"||e==="Nummon"){return}H.renderTime=Date.now();this.toolText=t;game.ui.render()},Math.min(197,197-Date.now()+game.timer.timestampStart))}}else{this.huntID=setTimeout(()=>{this.hunt()},H.interval*.5)}},reset:async function(){},timeCtrl:function(){const b=H.auto.timeCtrl.items;let k=0;if(b.accelerateTime.enabled&&game.science.get("calendar").researched){const e=Y["temporalFlux"];if(e.value>=Math.max(e.maxValue*b.accelerateTime.subTrigger,1)&&!game.time.isAccelerated){game.time.isAccelerated=true;Q("act.accelerate",[],"ks-accelerate");ie("accelerate",1)}if(H.interval!==Math.ceil(100/game.getTicksPerSecondUI())*100){I.stop(false);if(H.auto.engine.enabled){if(H.interval===2e3){Q("act.accelerate.acl")}else{Q("act.accelerate.slow")}I.start(false)}}}e:if(b.timeSkip.enabled&&game.workshop.get("chronoforge").researched){let t=Y["timeCrystal"].value;let e=b.timeSkip.maximum;const v=game.getEffect("heatMax");let a=game.time.heat;if(!e){return 0}let i=game.challenges.getChallenge("1000Years").researched?5:10;if(a-15*game.getEffect("heatPerTick")<0){e=Math.ceil(Math.max(50/i*game.getEffect("heatPerTick")/game.getTicksPerSecondUI(),e))}const y=b.timeSkip.subTrigger;let r=Math.max(y,this.craftManager.getStock("timeCrystal"),e);const x=game.calendar.cycle;const R=game.calendar.year;const w=game.calendar.day;if(t<r||w<0||!b.timeSkip[x]||a>=v){break e}let l=game.prestige.getPerk("numerology").researched;if(x===5&&b.timeSkip[x]&&l&&game["nummon"]){let e=game["nummon"]["getTradeTC"]();let t=game.calendar.cycleEffectsFestival({unobtainium:1})["unobtainium"];let a=game.calendar.cycleEffectsBasics({unobtainiumPerTickSpace:1},"moonOutpost")["unobtainiumPerTickSpace"];let i=(56.5+12*game.getEffect("festivalRatio"))/50;let r=game.calendar.cycleYear;let l=e*i/(t*a);if(l<1||game.getEffect("heatPerTick")<.02){if(r!==b.timeSkip.moonMsg){b.timeSkip.moonMsg=r;Q("summary.time.skip.moon",[1]);ie("time.skip.moon",1)}break e}}let s=game["timeTab"].cfPanel.children[0].children[0];if(!s.model.enabled){return s.controller.updateEnabled(s.model)}let n=game.calendar.season;let o=b.timeSkip.wait;if(!b.timeSkip[game.calendar.seasons[n].name]||o!==false&&x===5){if(o===1&&x===5){b.timeSkip.wait=game.calendar.year;break e}else if(o===false||o===R||o===1){break e}else if(o!==R){b.timeSkip.wait=false}}let c=4*e*i;let u=game.time.heat>game.getEffect("heatMax")-Math.min(c,20*game.time.getCFU("blastFurnace").on+20);let g=b.timeSkip[5];if(g&&l&&b.timeSkip.wait===false&&u){b.timeSkip.wait=1;Q("summary.moon",[1]);ie("moon",1)}let d=game.calendar.yearsPerCycle;let m=d-game.calendar.cycleYear;let f=game.calendar.cyclesPerEra;let p=Math.min(Math.floor((v-a)/i),e);let h=0;if(p<m){h=p}else{h+=m;p-=m;let e=1;while(p>d&&b.timeSkip[(x+e)%f]){h+=d;p-=d;e+=1}if(b.timeSkip[(x+e)%f]&&p>0){h+=p}}if(h>0){h=Math.min(h,Math.max(500,game.getEffect("temporalPressCap")*25));if(game.time.getCFU("ressourceRetrieval").val){b.timeSkip.adore=true;H.auto.options.items.hunt.time=true;this.skipCtrlRes()}let e=game.calendar.year;this.setTrait();s.controller.doShatterAmt(s.model,h);h=game.calendar.year-e;if(!h){return}ie("timeCrystal",t-Y["timeCrystal"].value,"resConsume");k=-100;Q("act.time.skip",[h],"ks-timeSkip");ie("time.skip",h)}}return k},promote:function(){let r=game.village;let l=r.leader;if(game.science.get("civil").researched&&l){if(r.jobs[5].unlocked){l.exp+=5*game.getEffect("skillXP")}let e=H.auto.distribute;let t=e.items.leader;let a=l.rank;let i=this.craftManager.getValueAvailable("gold",true);if(r.sim.goldToPromote(a,a+1,i)[0]&&r.sim.promote(l,a+1)===1){let e=game["villageTab"].censusPanel.census;Q("act.promote",[a+1],"ks-leader");e.renderGovernment(e.container);e.update();ie("gold",25+25*a,"resConsume");ie("promote",1)}}},distribute:function(){const c=H.auto.distribute.items;let l=c.leader;let s=0;let u=game.village;if(l.enabled&&game.science.get("civil").researched&&!game.challenges.isActive("anarchy")&&!H.copyTrait){let a=l.leaderTrait;let e=game.prestige.getPerk("vitruvianFeline").researched;let i=l.leaderJob;i=i==="farmer"&&e&&a==="manager"&&!game.challenges.isActive("atheism")?"priest":i;if(a==="none"&&i==="engineer"){l.leaderTrait="manager"}if(u.leader===null&&u.sim.kittens.length){game["villageTab"].censusPanel.census.makeLeader(u.sim.kittens[0])}let t=false;if(H.auto.upgrade.items.policies.enabled){t=H.policies===undefined?false:H.policies.some(e=>e==="theocracy")}if(t||game.science.getPolicy("theocracy").researched){i="priest"}let r=u.getJob(i);if(u.leader==null||!(u.leader.job===i&&u.leader.trait.name===a)){let t=u.sim.kittens.filter(e=>e.trait.name===a);if(t.length!==0){if(r.unlocked&&r.value<u.getJobLimit(i)){let e=t.sort(function(e,t){return t.rank-e.rank===0?t.exp-e.exp:t.rank-e.rank})[0];if(r.value>=c[i].max&&c[i].limited&&r.value){u.sim.removeJob(i,1)}u.unassignJob(e);e.job=i;u.getJob(i).value++;game["villageTab"].censusPanel.census.makeLeader(e);s+=1;Q("act.distributeLeader",[j("$village.trait."+a)],"ks-distribute");ie("distribute",1)}}}}let t=H.auto.distribute.items.miner;let e=game.science.get("agriculture").researched;let a=u.happiness;let i=this.craftManager.getPotentialCatnip(false)<=.85*a||u.jobs[1].value===0&&c["farmer"].enabled;let r=u.getFreeKittens();let n=u.jobs[4];let o=H.auto.distribute;if(!r){let e=u.getJob("woodcutter").value;if(t.enabled&&n.unlocked&&!n.value&&e>1&&u.sim.kittens.length){u.sim.removeJob("woodcutter")}if(o.religion&&e>2){u.sim.removeJob("woodcutter")}else{return s}}let g=Y["catnip"];let d=Y["kittens"];let m=g.value-1800*a*d.value<0||d.maxValue-d.value===1||r>1;if(o.religion||i&&e&&m&&g.value<=g.maxValue){o.religion=false;u.assignJob(u.getJob("farmer"),1);Q("act.distribute.catnip",[],"ks-distribute");Q("act.distribute",[j("$village.job."+"farmer")],"ks-distribute");ie("catnip",1);return s}let f="";let p=Infinity;let h=0;let b=game.religion.getSolarRevolutionRatio();let k=H.auto.faith.addition.autoPraise.expect;let v=game.workshop.get("spaceManufacturing").researched||Y["starchart"].value>1e4;k=k&&k>5&&b<k*.3&&u.jobs[5].unlocked;for(let o=u.jobs.length-1;o>=0;o--){let e=u.jobs[o];let t=e.unlocked;if(!t){continue}let a=e.name;let i=c[a];if(!i.enabled){continue}let r=u.getJobLimit(a);let l=e.value;if(l>=r){continue}let s=Math.max(0,i.max);let n=i.limited;if(a==="hunter"){let e=game.getEffect("manpowerJobRatio");if(e<.5){s=u.maxKittens>10?2:0}else if(e<=.75&&!game.science.get("navigation").researched||k){s=Math.round(s*.42);if(!k&&!te.other["auto.hunter"]){let e=game.msg($I("village.job.hunter.flavor"),null,null,true);$(e.span).css("color","#ff589c");ae("hunter")}}else{ae("hunter",true)}}if(a==="geologist"){if(!game.workshop.get("geodesy").researched&&Y["iron"].perTickCached<50){s=Math.round(s*.5)}if(!game.science.get("mechanization").unlocked&&!game.workshop.get("geodesy").researched){s=1}}if(a==="scholar"&&n){if(!game.getEffect("shatterTCGain")&&v){s=Math.max(s,18)}if(ee("science")>.6){continue}}if(a==="miner"&&!game.science.get("writing").researched){s=Math.round(s*.3)}if(a==="priest"&&Y["starchart"].value>1e4&&b<3){s=Math.max(s,20)}if(!n||l<s){h=l/s;if(h<p){p=h;f=a}}}if(f){u.assignJob(u.getJob(f),1);s=1;Q("act.distribute",[j("$village.job."+f)],"ks-distribute");ie("distribute",1)}if(s){game["villageTab"].updateTab();u.updateResourceProduction();return 1}},autofeed:function(){const e=game.diplomacy.get("leviathans");const t=Y["necrocorn"];if(!(e.unlocked&&t.value>0)){return}if(e.energy===game.diplomacy.getMarkerCap()){return}if(t.value>=1){game.diplomacy.feedElders();Q("act.feed",[],"ks-sacrifice");ie("feed",1)}else if(.25*(1+game.getEffect("corruptionBoostRatio"))<1){ie("feed",t.value);game.diplomacy.feedElders();Q("dispose.necrocorn")}},crypto:function(){let e=game.calendar.cryptoPrice;let a=Y["relic"].value;let i=Y["blackcoin"].value;if(!game.science.get("blackchain").researched&&!i>0||!game.diplomacy.get("leviathans").unlocked){return}let t=H.auto.options.items.crypto;let r=t.subTrigger==null?"10000-860-1060":H.auto.options.items.crypto.subTrigger.toString().split("-");let l=parseFloat(r[0]);let s=parseFloat(r[1]);let n=parseFloat(r[2]);if(r.length!==3||!l||!s||!n){if(!l){l=1e4}H.auto.options.items.crypto.subTrigger=l+"-881-1060";return L()}if(e<s&&a>l){game.diplomacy.buyBcoin();let e=Y["blackcoin"].value;let t=game.getDisplayValueExt(e-i);Q("blackcoin.buy",[t,game.getDisplayValueExt(a)],"ks-trade");ie("blackcoin.buy",1)}else if(e>n&&Y["blackcoin"].value>0){game.diplomacy.sellBcoin();let e=Y["relic"].value;let t=game.getDisplayValueExt(e-a);Q("blackcoin.sell",[t,game.getDisplayValueExt(i)],"ks-trade");ie("blackcoin.sell",1)}},worship:function(){const l=H.auto.faith.items;const e=this.buildManager;const c=this.craftManager;let u=this.religionManager;const d=H.auto.faith.addition;let m=game.religion;let f=0;let t,g;let p=game.prestige.getPerk("voidOrder").researched;if(d.bestUnicornBuilding.enabled){let r=this.getBestUnicornBuilding();let s=game.bld.get("ziggurat").on;let n=Y["tears"].value;let o=Y["unicorns"].value;if(r){let a=!n&&o>=1e3&&s;let i;if(r.name==="unicornPasture"&&!a){if(o>=Math.pow(r.priceRatio+game.getEffect("priceRatio"),r.val)*2){e.build(r.name,undefined,1)}}else{let t;let e=0;if(!a){i=dojo.clone(r.prices);for(g=0;g<i.length;g++){let e=i[g];e.val*=Math.pow(1.15,r.on);if(e.name==="tears"){e.val+=c.getStock("tears")+.01;t=e.val}if(e.name==="gold"){e.val*=1-game.getEffect("goldCostReduction")}}}t=a?1:t;if(m.getZU("sunspire").on>4&&l["blackPyramid"].enabled&&Y["sorrow"].value<5){t+=1e4}if(t>n){let e=Math.floor((o-c.getStock("unicorns"))/2500);let l=Math.ceil((t-n)/s);if(l<=e){let i=game["religionTab"].sacrificeBtn;if(!i||!i.model){return game["religionTab"].render()}let r=i.model.prices[0].val*l;if(o>r){let e=s*l;let t=i.controller.controllerOpts;game.resPool.addResEvent(i.model.prices[0].name,-r);game.resPool.addResEvent(t.gainedResource,e);game.stats.getStat("unicornsSacrificed").val+=r;ie("unicorns",r,"resConsume");ie("tears",e,"resGain");let a=[game.getDisplayValueExt(r),game.getDisplayValueExt(e)];game.msg($I(t.logTextID,a),"notice",t.logfilterID);Z(j("unicornSacrifice",a),"ks-sacrifice")}}}if(!a&&game.resPool.hasRes(i)&&s){u.build(r.name,"z",1);f=1}}}}else{if(Y["alicorn"].value<50||d.bestUnicornBuilding.confirm<3){$("#toggle-bestUnicornBuilding").click();d.bestUnicornBuilding.confirm+=1}if(H.auto.unicorn.items.unicornPasture.enabled){this.build({unicornPasture:{require:false,enabled:true}})}t=JSON.parse(JSON.stringify(H.auto.unicorn.items));t=Object.assign(t,H.auto.faith.items);delete t.unicornPasture}f+=this._worship(t||l);let r=c.getResource("faith");let s=ee("faith");let h=m.getRU("transcendence");let b=h.on;let k=m.transcendenceTier;let v=b?k:0;let y=m.faith;let x=m.faithRatio;let R=m.getSolarRevolutionRatio();let w=game.getEffect("solarRevolutionLimit");let T=10+w;let D=d.adore.subTrigger;let U=T*D;let F=y/1e6*(v+1)*(v+1)*1.01;let I=x+F;let O=.01+r.value*(1+game.getUnlimitedDR(I,.1)*.1);let M=game.getLimitedDR(game.getUnlimitedDR(O,1e3)/100,T);let E=false;let a=d.autoPraise.enabled;let P=d.adore.enabled;let n=H.auto.timeCtrl.items.timeSkip.adore;let S=n&&a&&P;let i=d.autoPraise.subTrigger;let B=game.space.getBuilding("moonOutpost").val;let C=B&&y>=1e5;let q=m.getRU("apocripha").on;let z=v||!x&&y>2e5;C=C&&q&&z&&P;if(B&&y>=1e5&&C&&i<.98&&i){d.autoPraise.subTrigger=.98}if(Math.min(.999,Math.max(.98,i))<=s||S){if(d.transcend.enabled&&b){let c;let e=m._getTranscendTotalPrice(v+1)-m._getTranscendTotalPrice(v);if(v>10){c=1}else if(v<11&&B&&y>1e5&&q&&this.catnipForReligion(e)>0){c=4}else{c=0}while(c){x=m.faithRatio;v=m.transcendenceTier;let e=Math.pow((v+2)/(v+1),2);let t=m._getTranscendTotalPrice(v+1)-m._getTranscendTotalPrice(v);let a=t;let i=m.getTU("blackObelisk").val;let r=((v+1)*5*i+1e3)/(v*5*i+1e3);let l=e*r;let s=(1-l+Math.sqrt(80*(l*l-1)*a+(l-1)*(l-1)))*l/(40*(l+1)*(l+1)*(l-1))+a+a/(l*l-1);let n=x>s&&y>Math.min((v-3)*1e6,0)+1e6;let o=y*2.02*v+3.03*y>1e6*t&&x>t;if(n||o){m.faithRatio-=t;m.tcratio+=t;m.transcendenceTier+=1;let e=game.challenges.getChallenge("atheism");e.calculateEffects(e,game);i=m.getTU("blackObelisk");i.calculateEffects(i,game);game.msg($I("religion.transcend.msg.success",[m.transcendenceTier]));v=m.transcendenceTier;if(v<8){E=true}for(let t=0;t<m.transcendenceUpgrades.length;t++){let e=m.transcendenceUpgrades[t];if(!e.unlocked&&v>=e.tier&&e.name!=="mausoleum"){e.unlocked=true;f=1}}c--;Q("act.transcend",[game.getDisplayValueExt(t),v],"ks-transcend");ie("transcend",1)}else{c=0}}}let e=game.resPool.isStorageLimited(h.prices);let t=H.auto.faith.items.transcendence;if(!t.enabled&&y>h.faith&&P&&e){t.enabled=true;X(["小猫贴心得无视超越按钮禁用","ks-default",H.activitycolor])}let a=!m.faithRatio||v;let i=k>9||this.catnipForReligion()>0;let r=game.prestige.getParagonProductionRatio();let l=r<2.25?Math.max(2.25/game.prestige.getParagonProductionRatio(),2.25):1;let s=.5*Math.log(m.faithRatio)+3.45;let n=game.time.getCFU("ressourceRetrieval").val;let o=a<10||n?1.65+Math.log1p(w):1.3;let c=game.getLimitedDR(l*o*Math.pow(Math.E,.65*s),100*T);let u=d.adore.subTrigger;let g=R*100<c;if(u===.001&&C&&g&&v){let e=M<=Math.max(1,c*.01-.5);if(e){C=false}c=Math.floor(c*100)/100;let t=!n||!p;if(c!==te.other["adore.solar"]&&t&&e){Z(j("summary.adore.solar",[c]));te.other["adore.solar"]=c}}if(C&&u!==.001){C=u*10<M}if(C&&i||E){if(S){H.auto.timeCtrl.items.timeSkip.adore=false}E=true;m._resetFaithInternal(1.01);Q("act.adore",[game.getDisplayValueExt(y),game.getDisplayValueExt(F)],"ks-adore");ie("adore",F)}}let J=.525*Math.log(m.faithRatio)+3.45;let o=p?1:.3;o=o*game.prestige.getPerk("vitruvianFeline").researched?1:.5;o=game.workshop.get("spaceManufacturing").researched?5:o;let A=game.getLimitedDR(.3*Math.pow(Math.E,.65*J)*o,80*T);d.autoPraise.expect=A*.01;let V=m.getRU("solarRevolution").on;let W=m.getRU("stainedGlass").on||Y["gold"]<250||r.perTickCached<2||game.getEffect("culturePerTickBase")<.9;if(V&&i===.98&&R<A*.01&&W){i=0}let L=1+game.getUnlimitedDR(x,.1)*.1;let K=!R&&!p;let G=r.value>(1e3-y)/L&&y<1e3;E=G||r.value>(150-y)/L&&y<150&&!p;E&=K;let _=s<.98||!p||V;let N=a&&s>=i&&r.value>.001&&_;if(N||E){if(d.autoPraise.subTrigger===.98&&!E&&s<.98&&Date.now()>d.autoPraise.time+2e5&&!n){d.autoPraise.time=Date.now();let e=game.getDisplayValueExt(A);Z(j("summary.praise.msg",[e]));te.other["praise.msg"]=e}let e=m.getApocryphaBonus();let t=r.value;let a=t*(1+e);ie("praise",a);ie("faith",t,"resConsume");Q("act.praise",[game.getDisplayValueExt(r.value),game.getDisplayValueExt(a)],"ks-praise");m.praise();let i=Y["faith"];i.value=Math.max(Math.min(Y["faith"].maxValue,i.value+2*Y["faith"].perTickCached),0)}return f},_worship:function(e){let t=JSON.parse(JSON.stringify(e||H.auto.faith.items));let s=this.religionManager;let a=this.bulkManager;let n=game.religion;this.setTrait("wise");let i=n.getRU("solarRevolution");let r=1-game.getLimitedDR(.09+.01*(1+game.prestige.getBurnedParagonRatio()),1);let l=(n.faith>i.faith||game.prestige.getPerk("voidOrder").researched)&&Y["faith"].maxValue>750&&Y["gold"].maxValue>500;let o=!i.on&&l&&n.getRU("solarchant").on&&n.transcendenceTier?1.1:H.auto.faith.trigger;if(!i.on&&l&&H.auto.faith.items.solarRevolution.enabled){s.build("solarRevolution","s",1)}if(!n.getRU("basilica").on&&t["basilica"].enabled){if(!game.religion.getRU("sunAltar").on){t["goldenSpire"].enabled=false}if(game.religion.faith>1e4){t["sunAltar"].enabled=false}if(!game.religion.getRU("stainedGlass").on&&Y["science"].maxValue>65e3){t["scholasticism"].enabled=false}}if(!game.ironWill&&!game.workshop.get("orbitalGeodesy").researched){t["templars"].enabled=false}if(n.getSolarRevolutionRatio()>9.98+.9*game.getEffect("solarRevolutionLimit")&&game.workshop.get("spaceManufacturing").researched&&te.other.adore){let e=["scholasticism","goldenSpire","stainedGlass","basilica","templars"];e.forEach(e=>{t[e].max=-1})}let c={};for(let l in t){let i=t[l];let r=s.getBuild(l,i.variant);c[l]=r;let e=s.getBuildButton(l,i.variant);if(!e||!e.model.metadata){if(!game.bld.getBuildingExt("ziggurat").on&&i.variant==="z"){continue}game["religionTab"].render();continue}if(e){let e=s.getBuildButton(l,i.variant).model;let t=i.variant==="c"?game.science.get("cryptotheology").researched:true;let a=i.variant==="s"?n.faith>=r.faith:e.visible;if(a&&!e.enabled&&(!e.metadata.noStackable||e.metadata.noStackable&&!e.metadata.on)){s.getBuildButton(l,i.variant).controller.updateEnabled(e)}c[l].rHidden=i.variant==="s"?!a:!(a&&e.enabled&&t)}else{c[l].rHidden=true}}const u=a.bulk(t,c,o);let g=0;let d;for(let e in u){if(u[e].count>0){if(u[e].id==="marker"){if(!n.getZU("blackPyramid").getEffectiveValue(game)){if(!te.other["marker"]){Z(j("summary.marker"));ie("marker")}continue}}d=n.getRU("solarRevolution").on?u[e].count:1;s.build(u[e].id,u[e].variant,d);g+=1}}return g},chrono:function(){if(!game["timeTab"].visible){return 0}if(!game.science.get("voidSpace").researched||!game.workshop.get("chronoforge").researched){return 0}let t=0;const l=H.auto.time.items;const s=this.timeManager;const e=this.bulkManager;let a=H.auto.time.trigger;const n={};for(let r in l){let e=l[r];n[r]=s.getBuild(r,e.variant);let t=s.getBuildButton(r,e.variant);if(!t||!t.model.metadata){if(r==="cryochambers"){continue}game["timeTab"].render();continue}if(!t.model.enabled){t.controller.updateEnabled(t.model);continue}let a=t.model;let i=e.variant==="chrono"?s.manager.tab.cfPanel:s.manager.tab.vsPanel;n[r].tHidden=!a.visible||!a.enabled||!i.visible}const i=e.bulk(l,n,a);for(let e in i){if(i[e].count>0){s.build(i[e].id,i[e].variant,i[e].count);t=1}}return t},upgrade:function(){let n,i,l;const s=H.auto.upgrade.items;const o=this.upgradeManager;const u=this.craftManager;const g=this.bulkManager;const d=this.buildManager;let c=game.workshop.get("geodesy").researched;let m=game.workshop.get("orbitalGeodesy").researched;let f=game.religion.getSolarRevolutionRatio();let p=0;this.setTrait("scientist");if(s.techs.enabled&&game["libraryTab"].visible){const e=game.science.techs;s.techs.limited=true;let i=game.science.get("nanotechnology").researched;e:for(let a of e){if(a.researched||!a.unlocked){continue}if(s.techs.limited){let e=a.name;let t=Y["titanium"].value;if(e==="biology"&&Y["compedium"].value<2e3){continue}if(e==="ecology"&&t<6e3){continue}if(e==="ai"&&t<1e4){continue}if(e==="oilProcessing"&&!i&&t<1e4){continue}if(e==="drama"&&u.getTickVal(u.getResource("parchment"),true)<1){continue}if(e==="cryptotheology"&&Y["relic"].value>105){continue}if(e==="particlePhysics"&&!i&&t<1e3){continue}}let e=dojo.clone(a.prices);e=game.village.getEffectLeader("scientist",e);for(let t of e){let e=t.name;if(o.getValue(e)<t.val){continue e}}p=1;o.build(a,"science")}}if(s.upgrades.enabled&&game["workshopTab"].visible){if(!game["workshopTab"].domNode){p=2}const a=game.workshop.upgrades;s.upgrades.limited=true;let r=[];if(s.upgrades.limited){let e=Y["starchart"];let t;r=["biofuel","gmo","invisibleBlackHand"];if(!game.bld.getBuildingExt("pasture").meta.on||game.bld.getBuildingExt("pasture").meta.stage===0){r=r.concat(["photovoltaic","thinFilm","qdot"])}if(!game.bld.getBuildingExt("aqueduct").meta.on||game.bld.getBuildingExt("aqueduct").meta.stage===0){r.push("hydroPlantTurbines")}let a=["factoryAutomation","advancedAutomation","pneumaticPress"];if(game.bld.get("steamworks").on<6&&!game.challenges.isActive("pacifism")){r=r.concat(["printingPress","offsetPress","photolithography"],a);if(!game.bld.get("steamworks").on){r.push("combustionEngine")}}else if(!game.opts.enableRedshift){r=r.concat(a)}let i=game.bld.getBuildingExt("magneto").meta;if(i.on===i.val){r.push("carbonSequestration")}if(game.village.getJob("engineer").value<5&&!game.workshop.getCraft("eludium").value){r=r.concat(["spaceEngineers","aiEngineers","chronoEngineers","amFission","factoryRobotics","factoryOptimization"])}if(game.time.getCFU("ressourceRetrieval").val<8){r.push("steelPlants")}if(!game.religion.getRU("solarRevolution").on&&Y["faith"].maxValue>=750&&game.religion.faith>1e3){r.push("caravanserai")}if(game.resPool.energyProd-game.resPool.energyCons-100<=0){r=r.concat(["carbonSequestration"])}if(game.globalEffectsCached["titaniumPerTickAutoprod"]<.002&&Y["ship"].value<40&&f>1){r=r.concat(["titaniumAxe","silos","combustionEngine","astrolabe"])}t=f>8||m;if(t&&!game.space.meta[0].meta[3].val&&e.value<1600&&f>6){r.push("geodesy");if(ee("coal")>.8&&!m){r.push("fuelInjectors")}}if(f<7&&!c&&e.value>400){r.push("titaniumSaw")}if(!c){r=r.concat(["seti","refrigeration"])}if(Y["oil"].value<75e3&&!c){r=r.concat(["offsetPress","photolithography"]);if(ee("coal")>.8&&ee("oil")<.95&&!m){r.push("fuelInjectors")}}if(game.bld.getBuildingExt("factory").meta.val<3){r.push("factoryLogistics")}if(!game.workshop.get("mWReactor").researched){r=r.concat(["eludiumReflectors","amBases","coldFusion","amReactors","cryocomputing"])}if(game.bld.getBuildingExt("library").meta.stage===0){r=r.concat(["starlink","uplink","cryocomputing"])}if(game.bld.getBuildingExt("accelerator").meta.val<5){r=r.concat(["darkEnergy","stasisChambers","voidEnergy","tachyonAccelerators","lhc"])}if(game.bld.getBuildingExt("aiCore").meta.val<5){r=r.concat(["machineLearning","aiBases"])}if(!game.bld.getBuildingExt("reactor").meta.val||Y["ship"].value<169){r.push("reactorVessel")}if(game.space.getBuilding("sattelite").val<6){r=r.concat(["solarSatellites","satelliteRadio"])}if(e.perTickCached){if(game.challenges.isActive("blackSky")&&e.perTickCached<1){r=r.concat(["geodesy"])}}else{r=r.concat(["hubbleTelescope"])}if(Y["thorium"].value<3e4){r.push("thoriumReactors")}t=Y["science"].maxValue>19e4&&e.value<2075;if(t||Y["titanium"].value<15){r=r.concat(["astrolabe","unobtainiumReflectors","lhc","titaniumMirrors"])}if(game.challenges.isActive("anarchy")){r=r.concat(["logistics","augumentation","internet","neuralNetworks","register"])}if(game.ironWill){r=r.concat(["logistics","augumentation","internet","neuralNetworks","mineralHoes","ironHoes","miningDrill","mineralAxes","ironAxes","steelAxe","titaniumAxe","alloyAxe","ironwood","concreteHuts","unobtainiumHuts","eludiumHuts","geodesy","register","unobtainiumDrill","assistance","astrophysicists","register"])}else if(!game.workshop.get("concreteHuts").researched){r=r.concat(["concreteWarehouses","concreteBarns"])}}e:for(let t of a){if(t.researched||!t.unlocked){continue}let e=t.name;if(r.indexOf(e)!==-1){continue}i=dojo.clone(t.prices);i=game.village.getEffectLeader("scientist",i);for(l of i){if(o.getValue(l.name,e)<l.val){continue e}}p+=1;o.build(t,"workshop")}}if(s.policies.enabled&&game["libraryTab"].visible){(function(){const i=game.science.policies;let r=n=0;const l=i.length;const s=[];let t=game.science.get("astronomy").researched?1:3;for(n in H.policies){let a=H.policies[n];for(let t in i){t=parseInt(t);let e=i[(t+r)%l];if(e.name===a){r=t+r+1;if(!e.researched){if(e.blocked){continue}if(e.unlocked){if(e.requiredLeaderJob===undefined||game.village.leader!=null&&game.village.leader.job===e.requiredLeaderJob){s.push(e)}}}break}}}for(n of s){for(let e of n.prices){if(u.getValueAvailable(e.name,true)<e.val*t){continue}o.build(n,"policy")}}})()}if(s.missions.enabled&&game["spaceTab"].visible){let t=s.missions.subTrigger;let e=Math.min(game.space.meta[0].meta.length,t);let a=0;const r=game.space.meta[0].meta;e:for(n=0;n<e;n++){let e=r[n];if(e.val){a++}if(!(e.unlocked&&e.val<1)){continue}if(!m&&!game.ironWill&&!c){break}if(game["spaceTab"].planetPanels.length!==a){game["spaceTab"].render()}const h=game["spaceTab"].GCPanel.children[n];if(!h||!h.model.metadata){game["spaceTab"].render();continue}if(!r[3].val&&n===2&&t!==3&&!game.challenges.isActive("blackSky")){continue}if(h.model.metadata.val||h.model.metadata.on){continue}i=h.model.prices;for(l of i){if(u.getValueAvailable(l.name,true)<l.val){continue e}}if(!h.model.enabled){h.controller.updateEnabled(h.model);continue}p+=1;h.controller.build(h.model,1);k(i);if(n===7||n===12){Z(j("upgrade.space.mission",[r[n].label]))}else{Z(j("upgrade.space",[r[n].label]))}}}if(s.races.enabled&&game.diplomacy.hasUnlockedRaces()){let a=game.diplomacy.get("leviathans").unlocked?8:7;if(game["diplomacyTab"].racePanels.length<a){let e=function(e){if(game.diplomacy.get(e).unlocked){return}let t=u.getValueAvailable("manpower",true);if(t>=1e3){Y["manpower"].value-=1e3;a="render";Q("upgrade.race",[game.diplomacy.unlockRandomRace().title],"ks-trade");ie("manpower",1e3,"resConsume")}};if(game.challenges.isActive("pacifism")||!game.village.sim.kittens.length||Y["gold"].value>15){e("lizards");e("sharks");e("griffins")}if(Y["culture"].value>=1500){e("nagas")}if(Y["ship"].value>=1){e("zebras")}if(Y["ship"].value>=100&&Y["science"].maxValue>125e3){e("spiders")}if(game.science.get("nuclearFission").researched){e("dragons")}if(!game["diplomacyTab"].racePanels.length||a==="render"){game["diplomacyTab"].render()}}}if(s.buildings.enabled){let t=game.calendar.season===1?game.resPool.energyProd:game.resPool.energyWinterProd;let a=t&&t-5<game.resPool.energyCons;let i=game.bld.getBuildingExt("pasture").meta;let r=i.stage===0?i.val:0;let l=game.bld.getBuildingExt("aqueduct").meta;let s=l.stage===0?l.val:0;let n=(e,t)=>{let a=t.stages[1].prices;if(g.singleBuildPossible(t,a,1)){d.sellBuild(e);game.resPool.payPrices(a);t.stage=1;t.on=1;t.val=1;if(t.upgrades){if(t.updateEffects){t.updateEffects(t,game)}b(t)}game.bld.getBuildingExt(e)._metaCache=null;game.bld.getBuildingExt(e)._metaCacheStage=1;d.manager.render();Q("summary.upgrade.building."+e,[],"ks-upgBld");ie("upgrade.building."+e);ae("upg"+e.charAt(0).toUpperCase()+e.slice(1),true);return 2}};if(i.stage===0){if(i.stages[1].stageUnlocked){let e=game.bld.getBuildingExt("amphitheatre").meta.stage===1;let t=a&&e&&game.getResourcePerTick("titanium",true)>25;if(u.getPotentialCatnip(true,0,s)>45&&t&&H.auto.build.items.solarFarm.enabled){return n("pasture",i)}else{ae("upgPasture","","ks-upgBld")}}}if(l.stage===0){if(l.stages[1].stageUnlocked){let e=u.getPotentialCatnip(true,r,0)>90;if(e&&a&&i.stage===1&&H.auto.build.items.hydroPlant.enabled){return n("aqueduct",l)}else{ae("upgAqueduct","","ks-upgBld")}}}let o=game.bld.getBuildingExt("library").meta;let c=.1*o.totalEffectsCached.scienceMax/(1+game.prestige.getParagonProductionRatio());if(o.stage===0){if(o.stages[1].stageUnlocked){let e=1+game.bld.get("biolab").val*.01;e=Y["compedium"].value*3>c/e&&game.bld.getEffect("scienceMax")>2e6;e|=u.getTickVal(Y["concrate"])>600;if(e&&H.auto.build.items.dataCenter.enabled){let e=game.challenges.isActive("energy")?2:1;if(t>=game.resPool.energyCons+150*e){return n("library",o)}}else{ae("upgLibrary","","ks-upgBld")}}}let e=game.bld.getBuildingExt("amphitheatre").meta;if(e.stage===0){if(e.stages[1].stageUnlocked){if(game.getResourcePerTick("titanium",true)>2||Y["ship"].value>200){return n("amphitheatre",e)}else{ae("upgAmphitheatre","","ks-upgBld")}}}}return p},build:function(a){const i=this.buildManager;const L=this.craftManager;const e=this.bulkManager;let t=H.auto.build.trigger;let r=0;let D=game.challenges.isActive("blackSky");let l=game.prestige.getPerk("vitruvianFeline").researched;let U=game.challenges.isActive("atheism");let I=game.workshop.get("geodesy").researched;let O=game.workshop.get("orbitalGeodesy").researched;let z=game.workshop.get("spaceManufacturing").researched;let J=game.religion.getRU("solarRevolution");let W=game.religion.getSolarRevolutionRatio();let K=game.science;let G=K.get("theology").researched;let _={};let N;if(typeof a!="object"){N={};let l=JSON.parse(JSON.stringify(H.auto.build.items));const j={amphitheatre:l["amphitheatre"],reactor:l["reactor"],magneto:l["magneto"],steamworks:l["steamworks"]};l=Object.assign(j,l);let e=Y["science"];let s=e.value/e.maxValue;let t=(e,t,a)=>{let i=l[e];let r=i.max;if(e){if(s<a){i.max=r===-1?t:Math.min(t,r);if(game.bld.getBuildingExt(e).meta.val>=t&&!z){ae("scienceBld")}}else{i.max=r===-1?game.bld.getBuildingExt(e).meta.val+2:r}}};if(W<50){t("observatory",300,.98);t("academy",Math.max(22*(game.prestige.getParagonProductionRatio()+1),100),.99);t("biolab",200,1)}let i=L.getPotentialCatnip(false);let a=K.get("machinery").researched;let r=K.get("astronomy");let n=game.stats.getStat("totalResets").val&&!r.researched;if(s<.98&&n&&(!a||r.unlocked)&&Y["minerals"].value){l["academy"].max=6*(game.prestige.getParagonProductionRatio()+1);ae("academy")}if(z){l["barn"].max=-1}let o=l["pasture"];let c=l["smelter"];if(G){ae("smelter",true);ae("pasture",true)}else{let e=game.bld.getBuildingExt("smelter").meta;c.max=1;if(Math.ceil(Y["wood"].perTickCached*2)>e.val&&Math.ceil(Y["minerals"].perTickCached)>e.val){c.max=e.val+1;ae("smelter")}let t=game.bld.getBuildingExt("pasture").meta;if(t.unlocked&&t.val>10){ae("pasture")}if(!i){l["pasture"].max=20}let a=game.bld.getBuildingExt("hut").meta.val-2;l["library"].max=a>0?Math.floor(a*11):l["library"].max}if(!K.get("writing").researched&&Y["minerals"].value){l["workshop"].max=1;ae("workshop")}else{ae("workshop",true)}if(!game["workshopTab"].visible&&!game.challenges.isActive("winterIsComing")&&K.get("animal").researched){c.max=0;if(o.max===-1){l["pasture"].enabled=false;ae("pasture")}}let u=l["reactor"];let g=game.space.getBuilding("sattelite").on;if(!z&&Y["titanium"].maxValue>125e3||!g){u.max=25+10*D}if(Y["uranium"].value<100){u.max=0}let d=game.getEffect("priceRatio");let m=game.bld.getBuildingExt("ziggurat").meta;let f=Math.pow(m.priceRatio+d,m.val);if(m.val>10&&Y["blueprint"].value<2*f&&!z){l["ziggurat"].max=0}if(D&&Y["science"].maxValue>3e5&&!O){l["observatory"].max=0}let p=l["steamworks"];if(!game.challenges.isActive("pacifism")&&!game.bld.get("magneto").val){if(game.bld.get("steamworks").unlocked&&p.enabled&&Y["gear"].value>19){ae("steamworks");p.enabled=false}}else{ae("steamworks",true)}let h=l["brewery"];if(!K.get("metalurgy").researched){h.max=5}if(!game.calendar.festivalDays){h.max=0}let b=l["temple"];let k=l["tradepost"];let v=game.religion.faith>J.faith||game.prestige.getPerk("voidOrder").researched;let y=Y["gold"].value/Y["gold"].maxValue;if(!D&&Y["titanium"].value<25){b.max=Math.max(30,10*(1+W))}let x=game.workshop.get("caravanserai");if(x.unlocked&&!x.researched&&Y["ivory"].value>1e4){b.enabled=false;k.max=21}if(!G&&K.get("philosophy").researched&&y<.96&&!U){let e=game.village.happiness<4&&game.bld.get("temple").val===1&&game.prestige.getPerk("renaissance").researched;b.max=e?1:Math.floor(7.5/(1+game.prestige.getParagonStorageRatio()));k.max=12;ae("tradepost")}if(!J.on&&!U&&G){if(H.auto.faith.items.solarRevolution.enabled&&Y["faith"].maxValue>750&&Y["gold"].maxValue>560){if(K.get("philosophy").researched){ae("temple");b.max=Math.floor(7.5/(1+game.prestige.getParagonStorageRatio()));if(Y["gold"].value>560){b.max=game.bld.getBuildingExt("temple").meta.val+1}}}if(game.religion.transcendenceTier){k.max=12;if(Y["gold"].value>525){k.max=Math.min(18,game.bld.getBuildingExt("tradepost").meta.val+1)}}ae("tradepost")}else if(G){ae("temple",true);ae("tradepost",true)}let R=game.religion.getRU("stainedGlass").on&&game.religion.getRU("basilica").on;let w=H.auto.faith.addition.autoPraise.expect;if(!R&&game.religion.faith>1e4&&Y["gold"].maxValue>780&&W){b.max=22-Math.min(10,W*10);k.max=30-Math.min(12,W*10)}let T=l["calciner"];let F=T.max;if(O){if(!z||!g){T.max=F===-1?Math.min(47+47*game.getEffect("productionRatio"),65+10*D):Math.min(50,F)}}else{if(e.maxValue>15e4&&Y["oil"].maxValue>35e3){T.max=F===-1?25:Math.min(25,F)}else{let e=(1+game.prestige.getParagonProductionRatio()*7)*Math.max(1,Math.log(W));T.max=F===-1?e:Math.min(e,F)}}if(game.getResourcePerTick("oil",true)<.24){T.max=0;l["magneto"].max=0}let M=l["solarFarm"];let E=game.calendar.season===1?game.resPool.energyProd:game.resPool.energyWinterProd;if(!z&&Y["titanium"].maxValue>125e3&&E>game.resPool.energyCons){M.enabled=false}let P=l["mansion"];let S=l["broadcastTower"];let B=K.get("archeology").researched;let C=Y["ship"].value;let q=O||C>600;if(K.get("electronics").researched&&!z){ae("broadcastTower");S.max=8;P.max=80}else{ae("broadcastTower",true)}let $=Y["titanium"];let A=l["biolab"];if(!I&&!O){if(Y["starchart"].value>1e5){l["observatory"].max=50;l["amphitheatre"].max=17;l["academy"].max=60;l["logHouse"].max=game.bld.getBuildingExt("logHouse").meta.val+1;l["hut"].max=game.bld.getBuildingExt("hut").meta.val+1;c.max=60;l["ziggurat"].max=1}if(!D&&$.value>1&&P.max){ae("mansion");P.max=10}if(Y["alloy"].value>25&&K.get("biology").researched){A.max=2;ae("biolab")}}else{if(q&&!P.max&&ee("titanium")===1){P.max=45;ae("mansion")}if(z){ae("biolab",true);ae("mansion",true);ae("scienceBld",true)}else{A.max=10*W;if($.value/$.maxValue<=.96){A.max=10;P.max=Math.max(135-game.village.maxKittens,Math.floor(17*(game.prestige.getParagonProductionRatio()+1)));ae("mansion")}}}if(!game.challenges.isActive("pacifism")){let e=l["mint"];let t=Y["manpower"].maxValue;let a=game.bld.getBuildingExt("mint").meta.val;if(t<=2e4){e.enabled=false}else if(!a){e.max=2}else if(!O&&(!I||!game.workshop.get("miningDrill").researched)){e.enabled=false}}let V=["library","academy","pasture","barn","harbor","oilWell","warehouse","broadcastTower","accelerator","mansion","quarry","aqueduct","chapel","lumberMill","factory","biolab"];for(let t in l){let e=l[t];if(!e.enabled||!e.max){continue}if(V.indexOf(t)===-1){N[t]=e}else{_[t]=e}}}const s={};a=N||a;for(let t in a){let e=a[t];s[t]=i.getBuild(e.name||t).meta}const n=e.bulk(a,s,t,"bonfire");let o=game.bld.getBuildingExt("calciner").meta;if(D&&H.auto.build.items.calciner.enabled&&o.unlocked&&!o.val){i.build("calciner",undefined,1)}if(n){for(let a=0;a<n.length;a++){let e=n[a].count;let t=n[a].id;e=i.count(t,e);if(e>0){i.build(n[a].name||t,n[a].stage,e);r+=1}}}if(JSON.stringify(_)!=="{}"){r+=this.build(_)}return r},space:function(){const a=JSON.parse(JSON.stringify(H.auto.space.items));const i=this.spaceManager;const e=this.craftManager;const t=this.bulkManager;let r=H.auto.space.trigger;let l=game.challenges.isActive("blackSky");let s=game.religion.getSolarRevolutionRatio();let n=Y["starchart"].value;if(l){a["researchVessel"].enabled=false;if(a["spaceStation"].enabled){$("#toggle-spaceStation").click()}}else if(!r&&s>6&&!game.space.meta[0].meta[3].val&&n<2e3){r=9}let o=l||s>5;if(!r){let e=game.space.getBuilding("spaceStation").val;let t=3e3*Math.pow(1.12,e);if(n>t){a["spaceStation"].max=e+1}if(n<t){a["spaceStation"].max=0}if(ee("unobtainium")<.8){a["moonBase"].max=0}else{a["moonBase"].max=game.space.getBuilding("moonBase").val+1}if(!game.getEffect("lunarOutpostRatio")){a["spaceElevator"].max=11}}if(game.ironWill){a["spaceStation"].max=0}if(game.space.getBuilding("sattelite").val<3+2*(s>9.7)&&o){i.build("sattelite",1)}if(l||s>6){if(!l&&game.space.getBuilding("researchVessel").val<1&&a.sattelite.enabled){i.build("researchVessel",1)}if(game.space.getBuilding("researchVessel").val<4){a["spaceStation"].max=0}}const c={};for(let e in a){c[e]=i.getBuild(e)}const u=t.bulk(a,c,r,"space");let g=0;for(let e in u){let t=u[e];if(t.count>0){let e=t.id;if(e==="containmentChamber"){let e=Y["antimatter"];let t=game.getEffect("antimatterProduction");let a=game.resPool.energyProd<game.resPool.energyCons;if(t*500+e.value<e.maxValue||a){continue}}if(e==="idsattelites"&&s<5&&!game.space.getProgram("piscineMission").val){t.count=Math.floor(t.count*.2)}i.build(t.id,t.count);g=1}}return g},craft:function(){const e=H.auto.craft.items;const t=this.craftManager;const a=["ship","beam","wood","slab","alloy","gear","concrate","steel","plate","scaffold","tanker","parchment","manuscript","compedium","blueprint","kerosene","megalith","eludium","thorium"];let i=H.auto.craft.trigger;let r=!game.science.get("construction").researched||!game.bld.getBuildingExt("workshop").meta.on;let l,s,n;this.setTrait("metallurgist");this.setTrait("chemist");this.setTrait("engineer");for(const c of a){s=e[c];n=s.require?t.getResource(s.require):"noRequire";l=0;if(!s.enabled){continue}if(r&&c!=="wood"){continue}if(!t.getCraft(c).unlocked){continue}if(n==="noRequire"||n.value/n.maxValue>=i&&n.value<=2*n.maxValue){l=t.getLowestCraftAmount(c,s.limited,s.limRat,n)}else if(s.limited){l=t.getLowestCraftAmount(c,s.limited,s.limRat,false)}if(l>=1){t.craft(c,l)}}let o=H.auto.upgrade.items.upgrades;if(o.cache&&game.workshop.get(o.cache).researched){o.cache=false}},holdFestival:function(){if(!game.science.get("drama").researched||game.calendar.festivalDays>=400){return}if(!game.prestige.getPerk("carnivals").researched&&game.calendar.festivalDays>0){return}if(game.village.getKittens()<5&&!Y["zebras"].value){return}let e=this.craftManager;let t=4e3*e.getTickVal(Y["manpower"],true)>1500;let a=4e3*e.getTickVal(Y["culture"],true)>5e3;let i=4e3*e.getTickVal(Y["parchment"],true)>2500*2;if(!(t&&a&&(Y["parchment"].value>=7500||i))){return}if(game.science.getPolicy("carnivale").researched){let e=!Y["furs"].value||!Y["ivory"].value||!Y["spice"].value;if(e){return}}let r=game["villageTab"];let l=r.festivalBtn;if(!l||!l.model){return r.render()}let s=l.model.prices;if(game.resPool.hasRes(s)){game.resPool.payPrices(s);game.village.holdFestival(1);H.auto.trade.festival=undefined;ie("festival",1);k(s);if(game.calendar.festivalDays>400){Q("festival.extend",[],"ks-festival")}else{Q("festival.hold",[],"ks-festival")}}else{H.auto.trade.festival=true}},observeStars:function(){let a=game.calendar;if(a.observeBtn!=null&&!game.workshop.get("seti").researched){let e=Y["science"].value;let t=Y["starchart"].value;a.observeHandler();ie("science",Y["science"].value-e,"resGain");ie("starchart",Y["starchart"].value-t,"resGain");Q("act.observe",[],"ks-star");ie("stars",1)}},hunt:function(){clearTimeout(this.huntID);let a=this.craftManager.getResource("manpower");if(a.value<100||game.challenges.isActive("pacifism")){return}if(ee("manpower")>3&&game.getEffect("hunterRatio")<3){return}let e=Y["unicorns"].value;let t=game.achievements.get("unicornConspiracy").unlocked||e;let i=game.bld.getBuildingExt("unicornPasture").meta.val;let r=!i&&t&&a.value>700&&e<3&&game.getEffect("craftRatio")>.06;let l=this.craftManager.getAverageHunt();let s=Math.floor(a.value/100);let n=game.science.get("writing").researched;let o=!Y["furs"].value||Y["parchment"].value<25?Math.max(30,Math.floor(.5*s)):0;let c=n&&s>o&&o>0;let u=H.auto.options.items.hunt;let g=u.subTrigger<=a.value/a.maxValue;let d=!g&&H.auto.trade.cache;if(g||c||r||d||u.time){if(c){s=o;Q("act.hunt.mint","","ks-hunt")}if(r){s=7;Z(j("act.hunt.unicorn"))}if(d){s=Math.min(s,Math.max(Math.floor(a.perTickCached/50),1));H.auto.trade.cache=false;Q("act.hunt.trade","","ks-hunt")}else if(u.time){u.time=false}if(s<=0){return}let e=game.ironWill?Y["zebras"].title:$I("effectsMgr.statics.maxKittens.title");game.resPool.addResEvent("manpower",-s*100);ie("manpower",s*100,"resConsume");let t={};for(let e in l){t[e]=Y[e].value}this.setTrait("manager");game.village.gainHuntRes(s);this.setTrait();if(s>=1e3&&!game.challenges.getChallenge("pacifism").unlocked){game.challenges.getChallenge("pacifism").unlocked=true}if(H.auto.cache.trait["manager"]){Q("act.hunt",["管理者派出"+s,e],"ks-hunt");ie("hunt.manager",s)}else{ie("hunt",s);Q("act.hunt",[s,e],"ks-hunt")}const m={};for(let e in l){const f=this.craftManager.getResource(e);m[e]=l[e]*s;ie(e,Y[e].value-t[e],"resGain")}this.cacheManager.pushToCache({materials:m})}},trade:function(){let a={};for(let e in Y){a[e]=Y[e].value}let i;const c=this.craftManager;const u=this.tradeManager;const e=this.cacheManager;e.checkForTimer();let r=c.getResource("gold");let g=[];let d=H.auto.trade;let m=d.trigger;if(!u.singleTradePossible(undefined)){return}let f=game.calendar.getCurSeason().name;let p=m<=r.value/r.maxValue;let h;this.setTrait("merchant");let b=0;let k=game.religion.getRU("solarRevolution");let v=game.challenges.anyChallengeActive();let y=game.prestige.getPerk("renaissance").researched;let x=game.calendar.year>2e3||y&&Y["alicorn"].value;let R,w,T,F;for(T in d.items){R=d.items[T];w=u.getRace(T);if(!w.unlocked){continue}if(!game["diplomacyTab"].racePanels[b]){game["diplomacyTab"].render()}b++;if(!R.enabled){continue}if(!R[f]){continue}let e=u.getTradeButton(w.name);if(!e||!u.singleTradePossible(T)){continue}if(T==="nagas"&&!game.ironWill&&x){continue}F=R.require?c.getResource(R.require):false;let t=u.getProfitability(T);if(T==="zebras"&&!t&&game.calendar.season===2&&ee("titanium")>.5){continue}if(T==="sharks"&&w.embassyLevel<10){t=false}let a=Y["faith"].value;let i=k.on||v||!y;let r=game.religion.getRU("transcendence").on||!H.auto.faith.items.transcendence.enabled;let l=game.religion.getRU("apocripha").on||!H.auto.faith.items.apocripha.enabled;let s=game.workshop.get("miningDrill").researched;let n=r&&l||game.religion.transcendenceTier>2;let o=n||!game.space.getBuilding("moonOutpost").val||!s;if(R.limited&&t&&i&&o){g.push(T);h=true}else if((!F||m<=F.value/F.maxValue)&&p){g.push(T)}}let l=Y["catnip"].value+100*game.getResourcePerTick("catnip",true);let s=u.getLowestTradeAmount("sharks");if(l<0&&s&&game.deadKittens<1e3){let e=game.diplomacy.get("sharks");let t=u.getAverageTrade(e).catnip;u.trade("sharks",Math.max(Math.ceil(l/-t),s));Q("trade.catnip")}if(g.length===0){return}h=h&&!p?.25:1;let n=Math.floor(u.getLowestTradeAmount(undefined,true,false)*h);if(d.festival){return}if(n<1){return}let t=Y["spice"].value+60*game.getResourcePerTick("spice",true)<0;if(t&&game.calendar.festivalDays){n=Math.ceil(n*.3)}const o=[];for(i=0;i<g.length;i++){T=g[i];R=H.auto.trade.items[T];F=R.require?c.getResource(R.require):false;let e=(!F||m<=F.value/F.maxValue)&&m<=r.value/r.maxValue;let t=Math.floor(u.getLowestTradeAmount(T,R.limited,e)*h);if(t<1){g.splice(i,1);i--;continue}o[i]=t}if(g.length===0){return}const M={};while(g.length>0&&n>=1){if(n<g.length){let e=Math.floor(Math.random()*g.length);if(!M[g[e]]){M[g[e]]=0}M[g[e]]+=1;n-=1;g.splice(e,1);o.splice(e,1);continue}let e=Math.floor(n/g.length);let t=0;for(i=0;i<g.length;i++){if(o[i]<e){e=o[i];t=i}}if(!M[g[t]]){M[g[t]]=0}M[g[t]]+=e;n-=e;g.splice(t,1);o.splice(t,1)}if(M.length===0){return}const E={};for(T in M){w=u.getRace(T);let a=p?1:M[T]*.6;let t=u.getMaterials(T);for(let e in t){if(!E[e]){E[e]=0}E[e]-=t[e]*a}let i=u.getAverageTrade(w);for(let t in i){let e=c.getResource(t);if(!E[t]){E[t]=0}E[t]+=e.maxValue>0?Math.min(i[t]*a,Math.max(e.maxValue-e.value,0)):i[t]*a}}e.pushToCache({materials:E});if(ee("gold")>=.98){d.cache=true}for(let e in M){if(M[e]>0){u.trade(e,M[e])}}for(let t in Y){let e=Y[t].value-a[t];if(e>0){ie(t,e,"resGain")}if(e<0){ie(t,-e,"resConsume")}}},miscOptions:function(){const o=this.craftManager;const e=this.buildManager;const i=H.auto.options.items;let c=0;let t=H.auto.filter;if(i.gameFilter.enabled&&t.enabled){let i=t.items;let r=t.console;let l=game.console.filters;for(let a in l){let e=i[a+"Filter"];let t=l[a];if(!t.unlocked||e&&!e.enabled||r[a]){continue}t.enabled=false;r[a]=true;c=1}if(c){game.ui.renderFilters()}}e:if(i.buildEmbassies.enabled&&!!game.diplomacy.races[0].embassyPrices){let e=o.getResource("culture");let t=e.value/e.maxValue;let a=i.buildEmbassies.subTrigger;let n=t>=.98;if(i.buildEmbassies.subTrigger<=t&&t<2){let a,i,t,r;const v=game["diplomacyTab"].racePanels;let l=o.getValueAvailable("culture",true);const y={};const x=[];const R=v.length-(game.diplomacy.get("leviathans").unlocked?1:0);let s=H.auto.trade.items;for(a=R-1;a>-1;a--){if(!v[a].embassyButton){game["diplomacyTab"].render();continue}i=v[a].race.name;t=game.diplomacy.get(i);if(!n&&!s[i].enabled){continue}let e=1-game.getEffect("embassyCostReduction");y[i]={val:0,basePrice:t.embassyPrices[0].val*e,currentEm:t.embassyLevel,priceSum:0,race:t};x.push(i)}if(x.length===0){break e}while(x.length>0){for(a=0;a<x.length;a++){i=x[a];r=y[i];let e=r.currentEm+r.val;let t=r.basePrice*Math.pow(1.15,e+game.getEffect("embassyFakeBought"));e=n||e<15&&game.science.get("astronomy").researched;if(t<=l&&e){l-=t;r.priceSum+=t;r.val+=1;if(n){x.splice(a,1);a--}}else{x.splice(a,1);a--}}}for(i in y){r=y[i];if(r.val===0){continue}l=o.getValueAvailable("culture",true);if(r.priceSum>l){continue}Y["culture"].value-=r.priceSum;ie("culture",r.priceSum,"resConsume");r.race.embassyLevel+=r.val;ie("embassy",r.val);c+=1;if(r.val===1){Z(j("build.embassy",[r.val,r.race.title]),"ks-embassy")}else{Z(j("build.embassies",[r.val,r.race.title]),"ks-embassy")}}}}if(i.fixCry.enabled&&game.time.getVSU("usedCryochambers").val>0){let e=0;const w=game["timeTab"].vsPanel.children[0].children[0];while(w.controller.buyItem(w.model,{},function(){})){e+=1}if(e>0){Q("act.fix.cry",[e],"ks-fixCry");ie("fix.cry",e)}}let a=(e,t)=>{Z(j("summary."+e,[t]));ie(e,t)};let r=game.bld.getBuildingExt("mint").meta;if(r.on!==r.val&&Y["manpower"].maxValue>2e4){r.on=r.val}if(r.on&&Y["manpower"].maxValue<2e4&&!game.challenges.isActive("pacifism")){if(r.on>2&&!game.opts.enableRedshift){r.on=0;a("mint")}}let l;let s=game.bld.getBuildingExt("steamworks").meta;let n=game.bld.getBuildingExt("magneto").meta;if(s.val&&s.on!==s.val&&n.on>9){l=e.getBuildButton("steamworks");l.controller.onAll(l.model);a("steamworks")}let u=game.bld.getBuildingExt("reactor").meta;let g=game.getResourcePerTick("uranium",true);if(u.val&&u.on!==u.val&&g>0){l=e.getBuildButton("reactor");l.controller.onAll(l.model);a("reactor")}let d=game.bld.getBuildingExt("factory").meta;if(d.val&&d.on!==d.val&&game.workshop.get("spaceManufacturing").researched){l=e.getBuildButton("factory");l.controller.onAll(l.model);a("factory")}let m=game.time.getCFU("temporalAccelerator");if(m.on&&game.time.testShatter===0){m.isAutomationEnabled=true;game.time.testShatter=1;a("temporalAccelerator")}let f=game.calendar.season===1?game.resPool.energyProd:game.resPool.energyWinterProd;let p=game.bld.getBuildingExt("biolab").meta;let h=p.on&&game.workshop.get("biofuel").researched;let b=H.auto.distribute.religion||o.getPotentialCatnip()<0;if(h&&b){p.on=0}if(f&&f<game.resPool.energyCons){if(h&&p.on){let e="冬季产出电:"+game.getDisplayValueExt(f)+"，冬季消耗电:"+game.getDisplayValueExt(game.resPool.energyCons)+"，小猫担心电不够并关闭了";let t=p.on;Q("summary.biolab.test",[e+t]);p.on=0;ie("biolab.test",e+t);return 1}let e=game.bld.getBuildingExt("oilWell").meta;if(e.isAutomationEnabled&&game.workshop.get("pumpjack").researched){e.isAutomationEnabled=false;game.upgrade({buildings:["oilWell"]});game.resPool.update();a("pumpjack",1);return 1}let t=game.bld.getBuildingExt("accelerator").meta;if(t.on){t.on=0;a("accelerator",1)}}const k=[{name:"brewery",metadata:game.bld.get("brewery"),Button:e.getBuildButton("brewery"),conditionOn:game.calendar.festivalDays,conditionOff:game.bld.get("brewery").on}];if(!game.opts.enableRedshift){k.push({name:"chronocontrol",metadata:game.time.getVSU("chronocontrol"),Button:this.timeManager.getBuildButton("chronocontrol"),conditionOn:game.calendar.futureSeasonTemporalParadox<1&&game.calendar.day>98,conditionOff:game.time.getVSU("chronocontrol").on&&game.calendar.day>0});let e=game.bld.getBuildingExt("calciner").meta;if(!game.time.getCFU("ressourceRetrieval").on&&e.isAutomationEnabled){e.isAutomationEnabled=false;game.upgrade({buildings:["calciner"]});a("calciner")}}for(let e=0;e<k.length;e++){let t=k[e];if(t.metadata.val>0){if(t.conditionOn){let e=t.metadata.val-t.metadata.on;if(e){t.Button.controller.onAll(t.Button.model);Q("summary."+t.name+"On");ie(t.name)}}else if(t.conditionOff){t.Button.controller.offAll(t.Button.model);Q("summary."+t.name+"Off");ie(t.name)}}}return c},gameUpgrade:function(){let e=H.auto;let t=e.upgrade.items.upgrades;let a=e.cache;let i=a.upgrade;if(i){game.upgrade(i);for(let e in i){delete i[e]}a.upgrade=null}else{game.updateCaches()}if(t.update){game.updateCaches();t.update=null}},setTrait:function(i){let t=game.village.leader;if(i){if(game.science.get("civil").researched&&t&&!game.challenges.isActive("anarchy")){let a=H.auto.cache;let e=game.village.traits.some(e=>{return e.title===$I("village.trait."+i)});if(!a.trait[i]){if(e){a.trait[i]=true;let e=$I("village.bonus.desc."+i);let t=["当"+e.slice(0,2)+"项目时"+$I("village.trait."+i)+"猫猫自觉顶替当前领袖，其效果为"+e];if(game.ticks>1e4){ae("leader",true)}else{ae("leader","","ks-leader")}Q("set.leader",[t],"ks-leader")}}if(!H.copyTrait){let e=t.trait.name;H.copyTrait=e;a.trait[e]=true}if(!e){a.trait[i]=false}if(e||H.copyTrait===i){t.trait.name=i}}}else if(H.copyTrait&&t){if($I("village.trait."+H.copyTrait)===t.trait.title){t.trait.name=H.copyTrait;H.copyTrait=undefined}}},skipCtrlRes:function(){let e=H.auto.timeCtrl.items.timeSkip;if(e.craft){return}const t=["catnip","coal","iron","oil","uranium","science"];let a="";t.forEach(e=>{H.auto.craft.autoConsume[e]=true;a=a+Y[e].title+"，"});e.craft=true;Q("summary.resource",[a]);ie("resource")},catnipForReligion:function(e){let t=e||0;let a=1;let i=game.religion.getRU("transcendence").on;let r=i?game.religion.transcendenceTier:0;if(t){r+=1}let l=game.religion.faithRatio;let s=game.religion.faith/1e6*(r+1)*(r+1)*1.01;let n=l+s-t;let o=.01+Y["faith"].value*(1+game.getUnlimitedDR(n,.1)*.1);let c=game.getLimitedDR(game.getUnlimitedDR(o,1e3)/100,10+game.getEffect("solarRevolutionLimit"));if(r<10){a=game.village.getResConsumption()["catnip"]*(1+game.getEffect("catnipDemandRatio"));if(game.village.sim.kittens.length>0&&game.village.happiness>1){a+=a*Math.max(game.village.happiness*(1+game.getEffect("hapinnessConsumptionRatio"))-1,0)*(1+game.getEffect("catnipDemandWorkerRatioGlobal"))}let e=1+game.religion.getSolarRevolutionRatio()*(1+game.bld.pollutionEffects["solarRevolutionPollution"]);a=(Y["catnip"].perTickCached-a)*(1+c)/e+a+game.globalEffectsCached.catnipPerTickCon}if(a<0){let e=H.auto.faith;if(!H.auto.distribute.religion){H.auto.distribute.religion=true}if(t){Q("summary.transcend.catnip",[game.getDisplayValueExt(a*5)]);te.other["transcend.catnip"]=a*5}if(!t){Q("summary.adore.catnip",[game.getDisplayValueExt(a*5)]);te.other["adore.catnip"]=a*5}}return a},getBestUnicornBuilding:function(){let u=game.bld.getBuildingExt("unicornPasture").meta;if(!u.unlocked){return}let g=Infinity;let d="";let m=1-game.getEffect("goldCostReduction");let e=game.bld.getBuildingExt("ziggurat").meta.on;let f=Math.max(e,1);let p=game.getEffect("unicornsRatioReligion")+1;let t=500*(.9+p*.1);let h=game.prestige.getPerk("unicornmancy").researched?1.1:1;let b=game.getEffect("riftChance")*h/2e4*t;let a="unicorns";let k=Y["unicorns"];let i=k.perTickCached;let r=game.calendar.cycleEffectsFestival({unicorns:1})["unicorns"];let v=k.perTickCached*game.getTicksPerSecondUI()/r;if(!v){return u}let l=v/Math.max(1,u.val);let y=2*Math.pow(u.priceRatio+game.getEffect("priceRatio"),u.val);l=y/l;let s=1.5*game.prestige.getParagonProductionRatio()+1.5;let x=Y["tears"].value+k.value*2500/f>s*Y["ivory"].value;x=x||Y["ivory"].perTickCached*s*r<i&&Y["ivory"].perTickCached>0;let R="tears";if(x&&Y["alicorn"].value){R="ivory";a="ivory"}l=x?l*3e3:l;if(l<g){g=l;d=u}e:for(let e=0;e<6;e++){let c=game.religion.meta[0].meta[e];if(c.unlocked){let r,l=0;let s=p;if(!c.effects["unicornsRatioReligion"]){continue}if(x&&!c.effects["alicornChance"]){continue}let n=Math.pow(1.15,c.on);for(let i=0;i<c.prices.length;i++){let e=c.prices[i];let t=e.name;let a=e.val;if(t===R){l+=a*n*2500/f;s+=c.effects["unicornsRatioReligion"]}if(t==="gold"&&a*m*n>Y["gold"].maxValue){continue e}if(t==="tears"){r=a*n*2500/f}}let e=game.getEffect("riftChance");let t=c.effects;if(t.riftChance){e+=t.riftChance}let a=50*s+450;let i=e*h/2e4*a;i-=b;let o=v*s/p;o-=v;o+=i;o=l/o;if(x&&t.tcRefineRatio){o*=.5-t.tcRefineRatio}if(o<g){g=o;d=c}if(x&&k.value>r+y){d=u}}}if(e){let e=d.label||"独角兽牧场";e+="("+j("$resources."+a+".title")+"性价比)";if(te.other["auto.unicorn"]!==e){te.other["auto.unicorn"]=e;Q("summary.auto.unicorn",[e],"ks-sacrifice")}}return d}};let e=function(e){this.setTab(e)};e.prototype={tab:undefined,render:function(){if(this.tab&&game.ui.activeTabId!==this.tab.tabId&&!this.tab._inherited){this.tab.render()}},setTab:function(e){for(const t in game.tabs){if(game.tabs[t].tabId===e){this.tab=game.tabs[t];break}}this.tab?this.render():s("unable to find tab "+e)}};let B=function(){this.manager=new e("Religion");this.bulkManager=new a};B.prototype={manager:undefined,bulkManager:undefined,build:function(e,t,a){let i=this.getBuild(e,t);let r=this.getBuildButton(e,t);if(!r||!r.model.metadata){return game["religionTab"].render()}if(!r.model.enabled){r.model.prices=r.controller.getPrices(r.model);r.controller.updateEnabled(r.model);if(!r.model.enabled){return}}a=this.bulkManager.construct(r.model,r,a);if(a===0){return}k(r.model.prices);game.stats.getStat("totalClicks").val+=1;let l=i.label;if(t==="s"){if(H.auto.cache.trait["wise"]){ie("哲学家小猫祷告了 "+l,a,"faith");return Q("act.sun.discovers.leader",[l,a],"ks-faith")}if(a===1){Q("act.sun.discover",[l],"ks-faith")}else{Q("act.sun.discovers",[l,a],"ks-faith")}ie("小猫祷告了 "+l,a,"faith")}else{ie(l,a,"build");if(a===1){Q("act.build",[l],"ks-build")}else{Q("act.builds",[l,a],"ks-build")}}},getBuild:function(e,t){switch(t){case"z":return game.religion.getZU(e);case"s":return game.religion.getRU(e);case"c":return game.religion.getTU(e)}},getBuildButton:function(e,t){let a,i,r;switch(t){case"z":a=this.manager.tab.zgUpgradeButtons;break;case"s":a=this.manager.tab.rUpgradeButtons;break;case"c":a=this.manager.tab.children[0].children[0].children}let l=this.getBuild(e,t);for(i=0;i<a.length;i++){if(!a[i]){continue}r=a[i].model.name;if(r.indexOf(l.label)!==-1){return a[i]}}}};let C=function(){this.manager=new e("Time");this.crafts=new t;this.bulkManager=new a};C.prototype={manager:undefined,crafts:undefined,bulkManager:undefined,build:function(e,t,a){let i=this.getBuild(e,t);let r=this.getBuildButton(e,t);if(!r||!r.model.metadata){return game["timeTab"].render()}if(!r.model.enabled){return r.controller.updateEnabled(r.model)}let l=a;let s=i.label;a=this.bulkManager.construct(r.model,r,a);if(a===0){return}k(r.model.prices);ie(s,a,"build");if(a===1){Q("act.build",[s],"ks-build")}else{Q("act.builds",[s,a],"ks-build")}},getBuild:function(e,t){if(t==="chrono"){return game.time.getCFU(e)}else{return game.time.getVSU(e)}},getBuildButton:function(e,t){let a;if(t==="chrono"){a=this.manager.tab.children[2].children[0].children}else{a=this.manager.tab.children[3].children[0].children}const i=this.getBuild(e,t);for(let t in a){let e=a[t].model.name;if(e.indexOf(i.label)!==-1){return a[t]}}}};let y=function(){this.workManager=new e("Workshop");this.sciManager=new e("Science");this.crafts=new t};y.prototype={manager:undefined,crafts:undefined,build:function(t,e){let a;const i=this.getBuildButton(t,e);if(!i||!i.model.metadata){if(e==="workshop"){game["workshopTab"].render()}else{game["libraryTab"].render()}return}if(!i.model.enabled){i.model.prices=i.controller.getPrices(i.model);i.controller.updateEnabled(i.model);if(!i.model.enabled){return}}if(e==="policy"){let t=i.model.metadata;if(game.village.leader&&t.requiredLeaderJob&&game.village.leader.job!==t.requiredLeaderJob){let e=game.village.getJob(t.requiredLeaderJob).title;game.msg($I("msg.policy.wrongLeaderJobForResearch",[t.label,e]),"important");return}else if(t.name==="transkittenism"&&game.bld.getBuildingExt("aiCore").meta.effects["aiLevel"]>=15){game.msg($I("msg.policy.aiNotMerges"),"alert","ai");return}else if(t.blocked===false){for(a=0;a<t.blocks.length;a++){if(game.science.getPolicy(t.blocks[a]).researched){t.blocked=true;return}}}}let r=H.auto.upgrade.items.upgrades;i.model.prices=i.controller.getPrices(i.model);i.controller.payPrice(i.model,{},function(){});k(i.model.prices);let l=i.model.metadata;l.researched=true;if(l.handler){l.handler(game,l)}if(l.unlocks){game.unlock(l.unlocks)}if(l.blocks){for(a in l.blocks){let e=game.science.getPolicy(l.blocks[a]);e.blocked=true}}if(l.onResearch){l.onResearch(game)}if(l.upgrades){if(e==="workshop"&&!r.update){r.update=true}b(l)}game.stats.getStat("totalClicks").val+=1;let s=t.label;let n=H.auto.cache.trait["scientist"];let o=n?"科学家小猫":"小猫";n=n?1:0;if(e==="workshop"){ie(s,n,"upgrade");Q("upgrade.upgrade",[s,o],"ks-upgrade");let e=t.name;if(e===r.cache){r.cache=false;let t=H.auto.cache.resUpg;for(let e in H.auto.cache.resUpg){delete t[e]}}}else if(e==="science"){ie(s,n,"research");Q("upgrade.tech",[s,o],"ks-research")}else if(e==="policy"){Q("upgrade.policy",[s],"ks-policy")}},getValue:function(e,t){let a=H.auto.resources[e];switch(t){case"oxidation":a=null;break}let i=a&&a.enabled?a.stock:0;let r=H.auto.upgrade.items.upgrades.cache;if(e==="titanium"&&t!=="rotaryKiln"){if(t!=="rotaryKiln"){if(!game.workshop.metaCache["rotaryKiln"].researched&&game.workshop.get("orbitalGeodesy").researched){i+=5e3}}if(r==="orbitalGeodesy"&&r!==t){i+=1e3}}if(e==="iron"&&t!=="ironwood"){if(te.other["auto.ironwood"]){i+=3e3}}if(e==="alloy"){if(r&&r!==t){i+=H.auto.cache.resUpg[e]}}if(e==="oil"){if(t!=="orbitalGeodesy"&&game.bld.get("calciner").val>20&&!game.workshop.metaCache["orbitalGeodesy"].researched){i+=35e3}}return Math.max(Y[e].value-i,0)},getBuildButton:function(a,e){let i;if(e==="workshop"){i=this.workManager.tab.buttons}else if(e==="science"){i=this.sciManager.tab.buttons}else if(e==="policy"){i=this.sciManager.tab.policyPanel.children}for(let t of i){let e=t.model.name;if(e===a.label){return t}}}};let q=function(){this.manager=new e("Bonfire");this.crafts=new t;this.bulkManager=new a};q.prototype={manager:undefined,crafts:undefined,bulkManager:undefined,build:function(e,t,a){let i=this.getBuild(e);let r=this.getBuildButton(e,t);if(!i.meta.unlocked){return}if(!r||!r.model.metadata){game["bldTab"].activeGroup="all";if(!r||!r.model.metadata){return game["bldTab"].render()}}if(!r.model.enabled){return r.controller.updateEnabled(r.model)}let l=i.meta.label?i.meta.label:i.meta.stages[t].label;a=this.bulkManager.construct(r.model,r,a);if(a===0){return}k(r.model.prices);ie(l,a,"build");game.stats.getStat("totalClicks").val+=1;if(a===1){Q("act.build",[l],"ks-build")}else{Q("act.builds",[l,a],"ks-build")}},count:function(e,t){if(!t){return}let a;let i=game.challenges.isActive("atheism");let r=game.religion.getRU("solarRevolution");let l=game.workshop.get("geodesy").researched;let s=game.workshop.get("orbitalGeodesy").researched;let n=game.workshop.get("spaceManufacturing").researched;let o=game.prestige.getPerk("vitruvianFeline").researched;let c=Y["minerals"].value>Y["minerals"].maxValue*.94;let u=Y["wood"].value>Y["wood"].maxValue*.94;let g=Y["titanium"].value>=.95*Y["titanium"].maxValue;let d=game.science.metaCache;let m=this.crafts.getPotentialCatnip(false);let f=game.bld.getBuildingExt("amphitheatre").meta;let p=game.space.getProgram("moonMission");switch(e){case"chapel":if(e==="chapel"){if(game.bld.getBuildingExt(e).meta.val<18){break}else{if(!game.calendar.festivalDays){t=0}if(!s){t=Math.floor(t*.4);a=true}}}break;case"aqueduct":if(m<2||game.challenges.isActive("winterIsComing")){break}else if(!n){t=Math.floor(t*.4)}case"library":if(e==="library"&&!d["writing"].unlocked){break}case"academy":case"pasture":case"barn":if(e==="barn"&&Y["minerals"].maxValue<1600){break}if(c&&u){break}case"warehouse":if(e==="warehouse"){if(Y["minerals"].maxValue<5e4){if(game.workshop.get("deepMining").researched||game.bld.getBuildingExt(e).meta.val<20){break}}else if(o&&!n){t=Math.floor(t*.3)}}case"lumberMill":if(e==="lumberMill"){if(game.bld.getBuildingExt(e).meta.val<35){if(!game.getEffect("lumberMillRatio")&&game.bld.getEffect("woodRatio")>3.1&&Y["iron"].maxValue>1200){t=0}if(Y["gold"].value||game.getEffect("ironPerTickAutoprod")<.3){break}}else if(!n){a=true}}case"oilWell":if(e==="oilWell"){if(game.bld.getBuildingExt(e).meta.val<8||Y["oil"].maxValue<2e4){break}if(Y["oil"].maxValue>55e3&&Y["oil"].value>2e4){t=Math.floor(t*.5)}if(game.bld.getBuildingExt("calciner").meta.val>20&&!s){break}}case"quarry":if(o){if(!s&&game.bld.get(e).val){a=true;ae("lower")}else if(s){ae("lower",true)}}break;case"harbor":if(e==="harbor"){if(game.bld.getBuildingExt(e).meta.val<8){ae("harbor");a=true}else if(game.bld.getBuildingExt("reactor").meta.val<20&&game.religion.getSolarRevolutionRatio()>7.5){a=true}else if(!s&&!game.workshop.get("geodesy").researched){a=true}else if(n){ae("harbor",true)}if(game.bld.getBuildingExt(e).meta.val>50&&Y["plate"].value<6e3){t=Math.floor(t*.5)}}break;case"logHouse":if(!f.stage&&f.val<5&&game.village.happiness<3&&game.village.maxKittens>18){a=true}break;case"biolab":if(!n){t=1}break;case"factory":if(!o){break}if(n){if(!game.space.getBuilding("sattelite").val&&game.bld.get(e).val){H.auto.space.times["sattelite"].enabled=true;t=0}}else{if(Y["titanium"].maxValue<13e4&&game.bld.get(e).val&&Y["titanium"].perTickCached<150){t=0}if(game.bld.get(e).val>2&&!g&&!l){t=Math.floor(t*.4);a=true}}break;case"accelerator":if(!o){break}if(!game.workshop.get("energyRifts").researched){t=0}if(!n&&Y["titanium"].maxValue>13e4){t=0}break;case"mansion":o=o||!o&&game.workshop.get("orbitalGeodesy").researched&&e==="mansion"&&game.village.sim.kittens.length<130;if(!n&&game.stats.getStat("totalResets").val>1&&!g&&o){a=true}if(Y["starchart"].perTickCached<4&&e==="mansion"&&!g&&o){a=true}break}if(a){t=Math.floor(t*.5)}else if(!r.on&&!i){t=Math.ceil(t*.5)}m=m<.85&&Y["catnip"].value/Math.abs(m)<1e3;m&=Y["kittens"].value>2&&H.auto.distribute.items.farmer.enabled;if((e==="hut"||e==="logHouse")&&t){if(m){t=0;ae("kittens")}else{ae("kittens",true)}}return t},getBuild:function(e){return game.bld.getBuildingExt(e)},getBuildButton:function(e,t){let a=this.manager.tab.children;let i=this.getBuild(e);let r=typeof t==="undefined"?i.meta.label:i.meta.stages[t].label;for(const l in a){let e=a[l].model.name;if(e.indexOf(r)!==-1){return a[l]}}},getSumPrices:function(e,t){let a=e.priceRatio?e.priceRatio:e.stages[e.stage].priceRatio;let i=a+game.getEffect("priceRatio");return(t.val-t.val*Math.pow(i,e.val-1))/(1-i)},sellBuild:function(e){let i=this.getBuild(e).meta;let r=i.stages[i.stage].prices;for(let a=0;a<r.length;a++){let t=r[a];let e=Y[t.name];if(e.isRefundable()&&!t.isTemporary&&i.val){let e=this.getSumPrices(i,t);game.resPool.addResEvent(t.name,e*.5)}}i.on=0;i.val=0}};let A=function(){this.manager=new e("Space");this.crafts=new t;this.bulkManager=new a};A.prototype={manager:undefined,crafts:undefined,bulkManager:undefined,build:function(e,t){let a=this.getBuild(e);let i=this.getBuildButton(e);if(!a.unlocked||!H.auto.space.items[e].enabled){return}if(!i||!i.model.metadata){return game["spaceTab"].render()}if(!i.model.enabled){return i.controller.updateEnabled(i.model)}let r=t;let l=a.label;t=this.bulkManager.construct(i.model,i,t);if(t===0){return}k(i.model.prices);ie(l,t,"build");game.stats.getStat("totalClicks").val+=1;if(t===1){Q("act.build",[l],"ks-build")}else{Q("act.builds",[l,t],"ks-build")}},getBuild:function(e){return game.space.getBuilding(e)},getBuildButton:function(t){const a=this.manager.tab.planetPanels;for(const i in a){for(let e in a[i].children){if(a[i].children[e].id===t){return a[i].children[e]}}}}};let t=function(){this.cacheManager=new n};t.prototype={craft:function(t,a){a=Math.floor(a);if(!t||a<1){return}if(!this.canCraft(t,a)){return}let e=this.getCraft(t);let i=game.getResCraftRatio(e.name)+1;let r=H.auto.cache.trait["engineer"]&&game.village.leader;let l=r?"工匠小猫制作了 ":"小猫制作了 ";a=Math.ceil(a);let s=a*i;let n=dojo.clone(game.workshop.getCraftPrice(e));for(let t=n.length-1;t>=0;t--){let e=n[t];e.val*=a;ie(e.name,e.val,"resConsume")}if(r){let e=game.village.getEffectLeader("engineer",0);if(r&&Y[t].tag==="metallurgist"&&H.auto.cache.trait["metallurgist"]){s+=a*e;l="冶金学家小猫制作了 "}if(Y[t].tag==="chemist"&&H.auto.cache.trait["chemist"]){s+=.5*a*e;l="化学家小猫制作了 "}}game.resPool.payPrices(n);game.resPool.addResEvent(e.name,s);if(e.upgrades){b(e.upgrades)}game.stats.getStat("totalCrafts").val++;game.stats.getStatCurrent("totalCrafts").val++;game.stats.getStat("totalClicks").val+=1;let o=Y[t].title;a=s;if(r){ie(o,a,"craftLeader")}else{ie(o,a,"craft")}Q("act.craft",[l+game.getDisplayValueExt(a),o],"ks-craft")},canCraft:function(e,r){let t=this.getCraft(e);let l=false;if(t.unlocked){l=true;let i=game.workshop.getCraftPrice(t);for(let a in i){let e=i[a];let t=Y[e.name].value;if(t<e.val*r){l=false}}}return l},getCraft:function(e){return game.workshop.getCraft(e)},getLowestCraftAmount:function(l,a,e,i){let s=Number.MAX_VALUE;let n=game.workshop;let r=this.getMaterials(l);if(!r){return 0}if(Y[l].value===Infinity){return 0}let o=this.getValueAvailable(l,true);let c,u,g;let d=game.bld.get("temple");let m=Math.pow(d.priceRatio+game.getEffect("priceRatio"),d.val);let f=game.prestige.getPerk("renaissance").researched;let t=this.getCraft(l);let p=game.getResCraftRatio(t.name)+1;let h=H.auto.craft.trigger;let b=Y["ship"].value;if(l==="ship"){u=H.auto.options.enabled&&H.auto.options.items.shipOverride.enabled;let e=H.auto.options.items.shipOverride.subTrigger;let t=n.get("geodesy").researched;let a=game.religion.getSolarRevolutionRatio();e=t?Math.max(243,e):100/Math.max(.5,Math.log1p(a));u&=b<e;u&=!n.get("oxidation").researched&&!H.auto.craft.oxidation}let k=Number.MAX_VALUE/p+Number.MAX_VALUE/Math.pow(2,53)/p;let v=game.science;let y=v.meta[0];let x;let R=H.auto.cache;let w=t=>{let a=R.science?R.science:"科学";u=true;if(a==="油气处理"){return}if(!H.auto.filter.items.miscFilter.enabled){let e=game.msg(j("craft.force",[Y[t].title,a]),null,null,true);$(e.span).css("color","#ff589c")}ie("craft"+D(t),1)};if(l==="beam"||l==="slab"){c=Object.keys(r)[0];if(ee(c)<2){H.auto.craft.autoConsume[c]=0;if(Y["scaffold"].value>500&&h>.9&&a){H.auto.craft.autoConsume[c]=1}if(!Y[l].value&&Y["slab"].value){u=true}}}if(l==="megalith"&&a&&Y[l].unlocked&&game.diplomacy.get("nagas").embassyLevel>15&&!game.calendar.season){s=1;u=true}if(l==="plate"&&a&&H.auto.craft.items["steel"].enabled){let t=game.getResourcePerTick("coal",true);let a=this.getResource("coal").maxValue*h;if(t>0&&Y["iron"].value!==Y["iron"].maxValue&&o>150){if(this.getValueAvailable("plate")/this.getValueAvailable("steel")>.8){let e=(a-this.getValue("coal"))/t*Math.max(game.getResourcePerTick("iron",true),0);s=(this.getValueAvailable("iron")-Math.max(a-e,0))/125}}if(Y["faith"].maxValue<750&&Y["gold"].value>30&&Y[l].value<23&&p>3){u=true}if(!b&&p>3&&Y["starchart"].value>=25&&o<150){s=Math.ceil(Math.min(Y["iron"].value/100,(150-o)/p));u=true}}let T=this.getValueAvailable("science",true);let F=Y["science"].value/Y["science"].maxValue;let M=Y["culture"].value/Y["culture"].maxValue;if(l==="manuscript"&&a){let l=R.resources["manuscript"];x=l?17:19;for(c=16;c<x;c++){let i=y.meta[c];let r=l||i.prices[1].val;if(!i.researched||l>0){let e=c===16&&game.village.happiness<4&&d.val===1&&f;e=e||Y["faith"].maxValue>750||Y["plate"].value<15;r=e?r:10*m;let t=game.science.getPolicy("tradition").researched?20:25;s=Math.ceil((r-o)/p);let a=this.getValueAvailable("parchment",true);if(a>s*t&&s>=1&&Y["culture"].value>t*16*s){R.science=l>0?R.science:i.label;R.science=e?R.science:"神殿";w("manuscript");R.resources["manuscript"]=0}break}}if(!y.meta[18].researched&&M>.9&&o<65){u=true}if(i&&4e3*this.getTickVal(this.getResource("parchment"),true)<2500){a=false}}let E=Y["gold"].maxValue<500||game.religion.getRU("solarRevolution").on&&game.religion.faith>1e3;if(l==="compedium"&&a&&v.get("navigation").researched&&E){let r=R.resources["compedium"];x=r?19:27;for(c=18;c<x;c++){if(game.prestige.getPerk("numerology").researched&&!game.calendar.festivalDays&&game.science.get("drama").unlocked){break}let i=y.meta[c];if(!i.researched||r>0){if(i.name==="metaphysics"||i.name==="drama"){continue}if(i.prices[1].name===l||r){let e=r||i.prices[1].val;s=Math.ceil((e-o)/p);let t=this.getValueAvailable("manuscript",true);let a=T>1e4*s||F>=1;if(t>s*50&&s>=1&&a){R.science=r>0?R.science:i.label;w("compedium");R.resources["manuscript"]=0;R.resources["compedium"]=0}else if(s>=1){R.resources["manuscript"]=s*50;R.science=r>0?R.science:i.label}}break}}if(!y.meta[32].researched&&M>.98&&o<100&&F>.98){u=true}}if(l==="blueprint"&&a&&v.get("electricity").researched){for(c=30;c<44;c++){let a=y.meta[c];if(!a.researched){let e=a.name;let t=["quantumCryptography","blackchain","ecology","ai"];if(t.indexOf(e)>-1){continue}if(a.prices[1].name===l){s=Math.ceil((a.prices[1].val-o)/p);let e=this.getValueAvailable("compedium",true);let t=T>25e3*s||F>=1;if(e>s*25&&s>=1&&t){R.science=a.label;w("blueprint");R.resources["manuscript"]=0;R.resources["compedium"]=0}else if(s>=1){R.resources["compedium"]=s*25;R.science=a.label}}break}}}let P=this.getLimRat(l,a,e);if(l==="parchment"){a=p<2.1;if(!Y[l].value&&p>1.5){u=true;s=2}if(!v.get("navigation").researched){if(o>300){a=true}if(o>500){s=0}}}for(c in r){g=0;let e=r[c];let t=!a||u||Y[c].maxValue>0&&i;if(t){g=this.getValueAvailable(c,u)/e}else{g=P*((this.getValueAvailable(c,true)+e/p*o)/e)-o/p}k=Math.min(g,k,s)}if(l==="steel"&&a){let t=game.bld.getBuildingExt("calciner").meta;let e=this.getValueAvailable("steel");let a=!game.ironWill&&!game.getEffect("hutPriceRatio")&&Y["iron"].maxValue>3e3&&n.get("ironwood").unlocked;if((o>500||a)&&this.getValueAvailable("plate")/e<1.25){k=0}let l=(i,r)=>{let l;if(i){l=n.get(i);r=l.prices;if(!l.unlocked){return}}if(!i||!l.researched){let t;for(let e in r){if(r[e].name==="steel"){t=r[e].val}}let e=Math.ceil((t-o)/p);if(i==="oxidation"&&e>0){if(e/Math.min(Y["iron"].perTickCached,Y["coal"].perTickCached)<21){H.auto.resources["steel"]={enabled:true,stock:5e3};H.auto.craft.oxidation=true;ae("oxidation")}if(H.auto.craft.oxidation&&Y["iron"].value>100*e&&Y["coal"].value>100*e){H.auto.craft.oxidation=null;t=true}}let a=this.getValueAvailable("iron",true)>100*e&&this.getValueAvailable("coal",true)>100*e||t===true;if(e>0&&a){k=e;u=true;if(i){Q("craft.forceSteel",[l.label])}}}};if(H.auto.resources["steel"]&&H.auto.resources["steel"].checkForReset===undefined){let e=n.get("oxidation");if(!e.unlocked||e.researched){delete H.auto.resources["steel"];delete H.auto.resources["iron"];delete H.auto.resources["coal"];L()}}l("steelSaw");l("steelAxe");l("steelArmor");let s=t.val;if(s){if(!t.isAutomationEnabled){let e=.003*game.bld.get("reactor").on*(1+game.getEffect("calcinerRatio"))*.1*game.bld.getAutoProductionRatio()*(1+game.getEffect("ironPolicyRatio"))*game.calendar.cycleEffectsFestival({iron:1})["iron"]*t.val*(1+game.getEffect("ironPolicyRatio"));k=k<=0?e:Math.min(k+e,Y["coal"].value/100)}if(s>1){l("oxidation");let a=H.auto.upgrade.items.upgrades;if(n.get("oxidation").researched&&a.cache==="oxidation"){a.cache=false;let t=H.auto.cache.resUpg;for(let e in t){delete t[e]}}let i=Y["alloy"].value;let e=n.get("orbitalGeodesy");if(e.unlocked&&!e.researched&&Y["oil"].value>17e3&&Y["oil"].maxValue>35e3){let e=Math.ceil((1e3-i)/p);e=e>0&&Y["titanium"].value>e*5||Y["alloy"].value>300&&s>20;if(e>0&&Y["titanium"].value>e*5&&!a.cache){H.auto.cache.resUpg["alloy"]=1e3;a.cache="orbitalGeodesy"}}let t=n.get("fluidizedReactors");if(t.unlocked&&!t.researched&&!a.cache){let e=Math.ceil((200-i)/p);let t=Y["titanium"].value>e*10||Y["alloy"].value>50||e/Y["titanium"].perTickCached<60;if(e>0&&s>9&&t){H.auto.cache.resUpg["alloy"]=200;a.cache="fluidizedReactors"}}let r=H.auto.cache.resUpg["alloy"];if(r){let e=Math.ceil((r-i)/p);l("",[{name:"steel",val:e*75}])}}}else if(game.challenges.isActive("blackSky")){l("",[{name:"steel",val:1100}])}}if(l==="alloy"&&a){let e=(e,t)=>{let a=n.get(e);let i=H.auto.craft.oxidation&&!game.workshop.get("oxidation").researched;if(a.researched||!a.unlocked||i){return}let r=Math.ceil((t-Y["alloy"].value)/p);if(r>1&&Y["steel"].value>r*75&&Y["titanium"].value>r*10){k=r;u=true;Q("craft.forceSteel",[a.label])}};if(Y["oil"].value>35e3){e("orbitalGeodesy",1e3)}e("fluidizedReactors",200);e("alloyAxe",25)}if(k<=0){return 0}let S=Y[l].maxValue;let B=Y[l].value;if(S>0&&k*p>S-B){k=(S-B)/p}if(a&&!u&&(!i||i==="noRequire")){k*=Math.max(Math.min(Math.log(p-1),1),.2)}return k},getMaterials:function(e){let t={};let a=this.getCraft(e);if(!a){return}let i=game.workshop.getCraftPrice(a);for(const r in i){let e=i[r];t[e.name]=e.val}return t},getTickVal:function(l,e){let s=game.getResourcePerTick(l.name,true);if(l.name==="timeCrystal"){let e=game.getEffect("alicornChance");let t=game.getResourcePerTick("alicorn");let a=.04*(1+game.getEffect("tcRefineRatio"));e*=1+game.getLimitedDR(game.getEffect("alicornPerTickRatio"),1.2);let i=Math.min(e,1)*.2*(1+game.timeAccelerationRatio());s+=(i+t)*a}if(l.craftable){let i=Number.MAX_VALUE;let r=this.getMaterials(l.name);for(let a in r){let e=(1+game.getResCraftRatio(l.name))/r[a];let t=this.getTickVal(this.getResource(a));i=Math.min(t*e,i)}s+=i===Number.MAX_VALUE?0:i}let t=l.name==="spice"||l.name==="blueprint";if(s<=0&&t){return"ignore"}if(!e){s+=this.cacheManager.getResValue(l.name)}return s},getAverageHunt:function(){let e={};let t=game.getEffect("hunterRatio")+game.village.getEffectLeader("manager",0);e["furs"]=40+32.5*t;e["ivory"]=50*Math.min(.225+.01*t,.5)+40*t*Math.min(.225+.01*t,.5);e["unicorns"]=.05;if(this.getValue("zebras")>=10){e["bloodstone"]=this.getValue("bloodstone")===0?.05:5e-4}if(game.ironWill&&game.workshop.get("goldOre").researched){e["gold"]=.625+.625*t}return e},getResource:function(e){let t=Y[e];if(t){return t}s("unable to find resource "+e);return null},getValue:function(e){return this.getResource(e).value},getStock:function(r){let e=H.auto.resources[r];let l=e&&e.enabled?e.stock:0;let a=game.workshop;let s=e=>{let t=a.metaCache[e];return t.unlocked&&!t.researched};if(r==="iron"){let i=game.bld.get("lumberMill").val>19-40*game.getEffect("priceRatio");let e=Y["gold"].value<50&&i;if(game.bld.getBuildingExt("temple").meta.on>2||Y["faith"].maxValue>749||e||Y["plate"].value>18){let e=s("reinforcedSaw")&&Y[r].value>200&&Y[r].maxValue>1e3;if(e){l+=1e3}let t=s("crossbow")&&i&&Y[r].maxValue>1500;if(t){l+=1500}let a=s("ironwood")&&Y[r].value>800&&Y[r].maxValue>3e3&&Y["science"].maxValue>3e4;a&=!game.ironWill;if(a){l+=3e3;ae("ironwood")}else{ae("ironwood",true)}}}let i=H.auto.cache.resUpg[r];if(r==="steel"){let e=s("steelAxe")&&Y["coal"].value>3e3;if(e&&(game.bld.get("lumberMill").val>30||Y[r].value>10)){l+=75}let t=s("steelSaw")&&Y[r].value>350;if(t){l+=750}let a=H.auto.cache.resUpg["steel"];if(a){l+=a}if(i){l+=i*75/game.getEffect("craftRatio")}}if(r==="alloy"){if(i){l+=i}}if(r==="titanium"){if(s("rotaryKiln")&&a.get("orbitalGeodesy").researched){l+=5e3}if(s("spaceManufacturing")&&game.bld.get("reactor").val>24&&Y["titanium"].maxValue>125e3){l+=13e5}}if(r==="gear"){if(s("rotaryKiln")&&a.get("orbitalGeodesy").researched){l+=5e3}if(s("fuelInjectors")&&ee("coal")<.8&&Y["oil"].value>2e4){l+=250}}if(r==="beam"){if(s("deepMining")&&Y["iron"].value>1200){l+=5e3}}return l?l:0},getValueAvailable:function(i,e,r){let l=this.getValue(i);let s=this.getStock(i);let a;if(!r&&r!==0){if(r===undefined){a=1}else{a=H.auto.craft.trigger}}else{a=r}if(i==="catnip"){let e=this.getPotentialCatnip(false);let t=game.calendar.season!==0||this.getResource(i).maxValue*a<l||game.getResourcePerTick("catnip",true)<0;if(e<0&&t){s-=e*1500;if(H.auto.options.catnipMsg+6e5<Date.now()){if(game.stats.getStat("totalResets").val<5){Z(j("msg.catnip"))}Z(j("craft.winterCatnip"));H.auto.options.catnipMsg=Date.now()}}}l=Math.max(l-s,0);let n=r&&!e&&i==="slab"?l:this.getResource(i).maxValue;if(!e&&n>0){let e=H.auto.resources[i];let t=e&&e.enabled&&e.consume!==undefined?e.consume:H.consume;let a=H.auto.craft.autoConsume;if(a[i]&&!r){t=1;a[i]=0}l-=Math.min(n,l)*(1-t);if(i==="unobtainium"&&l+s<1e3&&this.getResource(i).value===n&&this.getResource(i).value>=1e3){l=this.getResource(i).value}}return l},getLimRat:function(e,t,l){let r=Y[e];let s=Y["ship"].value;let i=game.prestige.getPerk("renaissance").researched;let n=game.space;let o=game.bld.get("reactor");let c=game.getEffect("priceRatio");let u=game.bld.get("steamworks");let a=game.bld.get("magneto");if(!t){return l}let g=game.science.get("navigation");if(e==="wood"){l=.09+r.perTickCached<Y["catnip"].perTickCached/game.workshop.getCraft("wood").prices[0].val&&this.getPotentialCatnip()?1:l}if(e==="beam"){let e=g.unlocked||Y["gold"].maxValue<500||Y["iron"].value>1e3&&!Y["coal"].value;l=e?l:.005;l=Y["scaffold"].value<500?l:.02}if(e==="slab"){let e=Y["faith"].maxValue<750&&r.value<51&&Y["gold"].value>35;l=Y["scaffold"].value||e||o.val&&r.value<2500?l:.005;l=Y["scaffold"].value<500?l:.1;l=Y["scaffold"].value>2500?.02:l}if(e==="ship"){let e=5*o.val+225;let t=Y["titanium"].maxValue;let a=!n.meta[0].meta[3].on&&n.getBuilding("sattelite").val<9;let i=game.religion.getSolarRevolutionRatio();let r=a&&i>6&&t<125e3;a=a&&i>6&&t>12e4;l=s>e*.75&&i>3?.3:l;l=s>e*5||r?.05:l;l=a&&(!game.workshop.get("satnav").researched||t>123e3)?0:l;l=.03*s>t?0:l}if(e==="plate"){let e=Y["titanium"].value>3500&&Y["uranium"].value>250&&!o.val;l=game.getEffect("calcinerRatio")?l:.3;l=r.value<150&&g.researched&&Y["starchart"].value>15&&Y["scaffold"].value>50||e?.9:l;l=H.auto.craft.oxidation&&!game.workshop.get("oxidation").researched?0:l}if(e==="alloy"){let e=game.globalEffectsCached["titaniumPerTickAutoprod"];l=u.on<a.on||e===5e-4?l:.75;let t=Math.pow(a.priceRatio+c,a.val);l=r.value>Math.max(1250,10*t)&&H.auto.build.items.magneto.enabled?.01:l;l=Y["titanium"].value<19&&!e?0:l}if(e==="eludium"){let e=game.time.getCFU("ressourceRetrieval").on;l=e?.1:l;l=r.value<125&&game.getEffect("hutPriceRatio")>-1.06?1:l}if(e==="megalith"){let e=game.bld.getBuildingExt("ziggurat").meta;let t=Math.pow(e.priceRatio+c,e.val);let a=Math.pow(o.priceRatio+c,o.val);l=i?l:.2;l=r.value>Math.max(100,50*t)?.005:l;l=Y["plate"].value<Math.max(5e3,50*a)?.1:l;if(r.value>50||e.on||Y["unicorns"].value<1e3){if(!game.workshop.get("orbitalGeodesy").researched){l=.01}}}if(e==="concrate"){let e=n.getBuilding("moonOutpost").val;e=150*Math.pow(1.12,e);let t=Math.pow(o.priceRatio+c,o.val);l=o.val?l:.3;l=r.value>Math.max(e,50*t)?.01:l;l=!r.unlocked&&game.diplomacy.get("nagas").embassyLevel>10&&!game.calendar.season&&Y["titanium"].value>500?1:l}if(e==="gear"){let e=Math.pow(u.priceRatio+c,u.val);let t=game.workshop.get("logistics");let a=game.workshop.get("fuelInjectors");a=!a.researched&&a.unlocked;let i=Y["oil"].value>2e4&&ee("coal")<.5&&r.value<250&&a;l=r.value>30&&(!t.unlocked&&t.researched)?.3:l;l=i?.7:l;l=r.value>Math.max(500,20*e)?.005:l;l=u.val||game.science.get("chemistry").researched?l:0}if(e==="kerosene"){l=n.meta[0].meta[1].val?l:0;l=!game.space.getProgram("piscineMission").on&&r.value>250?0:l}if(e==="manuscript"){l=game.prestige.getPerk("numerology").researched&&!game.calendar.festivalDays&&game.science.get("drama").unlocked?.25:l;let e=game.bld.getBuildingExt("chapel").meta;e=Math.pow(e.priceRatio+c,e.val);l=Y["parchment"].value>Math.max(1e6,250*c)&&o.val?1:l}if(e==="compedium"){l=game.science.get("architecture").unlocked?l:0}if(e==="blueprint"){l=game.science.get("industrialization").unlocked?l:0}if(e==="scaffold"){let e=game.bld.get("observatory");let t=Math.pow(e.priceRatio+c,e.val);l=r.value<100&&game.science.get("navigation").unlocked&&Y["iron"].value>750?1:l;l=game.science.get("navigation").unlocked?l:0}return l},getPotentialCatnip:function(e,t,a){let i=game.getEffect("catnipPerTickBase");if(e){i*=.1;i*=1+game.getLimitedDR(game.getEffect("coldHarshness"),1);if(game.science.getPolicy("communism").researched){i=0}}else{let e=game.calendar.year<4?0:.15;i*=game.calendar.seasons[3].modifiers.catnip-e}let r=game.village.getResProduction().catnip?game.village.getResProduction().catnip*(1+game.getEffect("catnipJobRatio")):0;let l=i+r;if(a===undefined){l*=1+game.getEffect("catnipRatio")}else{let e=game.space.getBuilding("hydroponics");let t=e.effects["catnipRatio"];l*=1+game.bld.getBuildingExt("aqueduct").meta.stages[0].effects["catnipRatio"]*a+t*e.val}let s=game.challenges.isActive("winterIsComing")?0:game.prestige.getParagonProductionRatio();l*=1+s;l*=1+game.religion.getSolarRevolutionRatio()*(1+game.bld.pollutionEffects["solarRevolutionPollution"]);l*=1+game.getEffect("blsProductionBonus")*Y["sorrow"].value;l=game.calendar.cycleEffectsFestival({catnip:l})["catnip"];l*=1+game.bld.pollutionEffects["catnipPollutionRatio"];let n=game.village.getResConsumption()["catnip"];let o=game.bld.getBuildingExt("unicornPasture").meta.val;if(t===undefined){n*=1+game.getEffect("catnipDemandRatio")}else{n*=1+game.getLimitedDR(t*-.005+o*-.0015,1)}if(game.village.sim.kittens.length>0&&game.village.happiness>1){let e=Math.max(game.village.happiness*(1+game.getEffect("hapinnessConsumptionRatio"))-1,0);if(game.challenges.isActive("anarchy")){n*=1+e*(1+game.getEffect("catnipDemandWorkerRatioGlobal"))}else{n*=1+e*(1+game.getEffect("catnipDemandWorkerRatioGlobal"))*(1-game.village.getFreeKittens()/game.village.sim.kittens.length)}}l+=n;l+=game.getResourcePerTickConvertion("catnip");return l}};let a=function(){this.craftManager=new t};a.prototype={craftManager:undefined,bulk:function(t,a,r,o){let c;let u,g,d,l,s;const m=[];const f=[];let n=0;for(const b in t){s=t[b];u=a[b];if(!s.enabled){continue}if(s.max!==-1&&s.max<=u.val){continue}if(u.tHidden===true){continue}if(u.rHidden===true){continue}if(u.rHidden===undefined&&!u.unlocked){continue}if(b==="cryochambers"&&(game.time.getVSU("usedCryochambers").val>0||game.bld.getBuildingExt("chronosphere").meta.val<=u.val)){continue}if(b==="ressourceRetrieval"&&u.val>=100){continue}if(u.stage!==s.stage){continue}let i=u.stages?u.stages[u.stage].prices:u.prices;if(s.variant==="s"){i=game.village.getEffectLeader("wise",dojo.clone(u.prices))}d=this.getPriceRatio(u,o);if(!this.singleBuildPossible(u,i,d,o)){continue}if(u.almostLimited&&!game.workshop.get("geodesy").researched&&game.village.leader){continue}let e=s.require?this.craftManager.getResource(s.require):false;if(!e||r<=e.value/e.maxValue){if(typeof s.stage!=="undefined"&&s.stage!==u.stage){continue}m[n]={};m[n].id=b;m[n].label=s.label;m[n].name=s.name;m[n].stage=s.stage;m[n].variant=s.variant;f[n]={};f[n].id=b;f[n].name=s.name;f[n].count=0;f[n].spot=n;f[n].prices=[];let e=game.getLimitedDR(game.getEffect(b+"CostReduction"),1);let a=1-e;for(l in i){let e=game.getLimitedDR(game.getEffect(i[l].name+"CostReduction"),1);let t=1-e;f[n].prices.push({val:i[l].val*a*t,name:i[l].name})}f[n].priceRatio=d;f[n].source=o;f[n].limit=isNaN(s.max)?-1:s.max;f[n].val=u.val;n++}}if(f.length===0){return}let p={};for(let e in Y){p[e]=Y[e].value}for(let e in p){p[e]=this.craftManager.getValueAvailable(e,true)}let h=0;while(f.length!==0){e:for(let n=0;n<f.length;n++){let l=f[n];u=a[l.id];let s=u.val;g=l.prices;d=l.priceRatio;o=l.source;for(let r=0;r<g.length;r++){let e,t,a,i=false;if(o&&o==="space"&&g[r].name==="oil"){e=true;a=g[r].val*(1-game.getLimitedDR(game.getEffect("oilReductionRatio"),.75))}else if(l.id==="cryochambers"&&g[r].name==="karma"){t=true;i=g[r].val*(1-game.getLimitedDR(.01*game.prestige.getBurnedParagonRatio(),1))}if(e){c=p["oil"]<a*Math.pow(1.05,h+s)}else if(t){c=p["karma"]<i*Math.pow(d,h+s)}else{let e=g[r].val*Math.pow(d,h+s);c=p[g[r].name]<e}if(c||u.noStackable&&h+s>=1||l.id==="ressourceRetrieval"&&h+s>=100||l.id==="cryochambers"&&game.bld.getBuildingExt("chronosphere").meta.val<=h+s){for(let t=0;t<r;t++){if(o&&o==="space"&&g[t].name==="oil"){let e=g[t].val*(1-game.getLimitedDR(game.getEffect("oilReductionRatio"),.75));p["oil"]+=e*Math.pow(1.05,h+s)}else if(l.id==="cryochambers"&&g[t].name==="karma"){let e=g[t].val*(1-game.getLimitedDR(.01*game.prestige.getBurnedParagonRatio(),1));p["karma"]+=e*Math.pow(d,h+s)}else{let e=g[t].val*Math.pow(d,h+s);p[g[t].name]+=g[t].name==="void"?Math.ceil(e):e}}if(l.limit!==-1){l.count=Math.max(0,Math.min(l.count,l.limit-l.val))}m[f[n].spot].count=f[n].count;f.splice(n,1);n--;continue e}if(e){p["oil"]-=a*Math.pow(1.05,h+s)}else if(t){p["karma"]-=i*Math.pow(d,h+s)}else{let e=g[r].val*Math.pow(d,h+s);p[g[r].name]-=g[r].name==="void"?Math.ceil(e):e;p[g[r].name]=p[g[r].name]?p[g[r].name]:0}}f[n].count++}h++}return m},construct:function(e,t,a){const i=e.metadata;let r=0;if(typeof i.limitBuild=="number"&&i.limitBuild-i.val<a){a=i.limitBuild-i.val}if(!e.enabled){t.controller.updateEnabled(e)}if(e.enabled&&t.controller.hasResources(e)||game.devMode){while(t.controller.hasResources(e)&&a>0){e.prices=t.controller.getPrices(e);t.controller.payPrice(e);t.controller.incrementValue(e);r++;a--}if(i.breakIronWill){game.ironWill=false;let e=game.science.getPolicy("liberty");e.calculateEffects(e,game)}if(i.unlockScheme&&i.val>=i.unlockScheme.threshold){game.ui.unlockScheme(i.unlockScheme.name)}if(i.unlocks){game.unlock(i.unlocks)}if(i.upgrades){if(i.updateEffects){i.updateEffects(i,game)}b(i)}}return r},getPriceRatio:function(e,t){let a=e.stages?e.priceRatio||e.stages[e.stage].priceRatio:e.priceRatio;let i=0;if(t&&t==="bonfire"){i=game.getEffect(e.name+"PriceRatio")+game.getEffect("priceRatio")+game.getEffect("mapPriceReduction");i=game.getLimitedDR(i,a-1)}return a+i},singleBuildPossible:function(r,l,s,n){let e=game.getLimitedDR(game.getEffect(r.name+"CostReduction"),1);let o=1-e;for(let i in l){let e=game.getLimitedDR(game.getEffect(l[i].name+"CostReduction"),1);let t=1-e;let a=l[i].val*o*t;if(n&&n==="space"&&l[i].name==="oil"){let e=a*(1-game.getLimitedDR(game.getEffect("oilReductionRatio"),.75));if(this.craftManager.getValueAvailable("oil",true)<e*Math.pow(1.05,r.val)){return false}}else if(r.name==="cryochambers"&&l[i].name==="karma"){let e=a*(1-game.getLimitedDR(.01*game.prestige.getBurnedParagonRatio(),1));if(this.craftManager.getValueAvailable("karma",true)<e*Math.pow(s,r.val)){return false}}else{if(this.craftManager.getValueAvailable(l[i].name,true)<a*Math.pow(s,r.val)){return false}}}return true}};let x=function(){this.craftManager=new t;this.manager=new e("Trade")};x.prototype={craftManager:undefined,manager:undefined,trade:function(e,t){if(!e||t<1){s(e+"-"+t+"贸易可能出点问题")}let a=this.getRace(e);let i=this.getTradeButton(a.name);let r=H.auto.cache.trait["merchant"]?"商人小猫与":"小猫与";if(!i.model.enabled){return i.controller.updateEnabled(i.model)}if(e!=="sharks"&&!H.auto.trade.items[e].enabled){s("贸易可能出点问题")}game.diplomacy.tradeMultiple(a,t);game.stats.getStat("totalClicks").val+=1;ie(r+" "+a.title,t,"trade");Q("act.trade",[t,r+D(a.title)],"ks-trade")},getProfitability:function(e){let a,s;let t=this.getRace(e);let i=this.getMaterials(e);let r=0;if(e==="leviathans"&&game.time.getCFU("ressourceRetrieval").val&&ee("unobtainium")>.7){return true}for(let e in i){if(e==="ivory"){continue}a=this.craftManager.getTickVal(this.craftManager.getResource(e));if(a<=0){return false}r+=i[e]/a}let n=this.getAverageTrade(t);let l=0;for(let t in n){let e=this.craftManager.getResource(t);a=this.craftManager.getTickVal(e);if(a==="ignore"){continue}if(a<=0){s=true}l+=e.maxValue>0?Math.min(n[t],Math.max(e.maxValue-e.value,0))/a:n[t]/a}let o=true;let c=Y["spice"].value+60*game.getResourcePerTick("spice",true)<0;if(e==="nagas"){if(!Y["concrate"].unlocked&&!game.ironWill){o=false}if(Y["ship"].value<30&&t.embassyLevel<10&&!game.ironWill){o=false}if(Y["concrate"].value<500&&t.embassyLevel>10&&Y["titanium"].value>1e3){a=true}s=c&&game.calendar.festivalDays}if(e==="griffins"){if(Y["ship"].value&&game.calendar.season!==2&&(Y["ship"].value>200||game.getEffect("productionRatio"))){o=false}s=c&&game.calendar.festivalDays}if(e==="zebras"){let e=H.auto.trade.items.griffins;let t=this.craftManager.getTickVal(Y["iron"]);let a=Y["titanium"];let i=Math.min(n["titanium"],Math.max(a.maxValue-a.value,0))/this.craftManager.getTickVal(a);let r=this.getAverageTrade(this.getRace("griffins"))["iron"]/t<n["iron"]/t+i;if(e.enabled&&e.autumn&&game.calendar.season===2){o=o&&r&&ee("titanium")<.95&&i>a.perTickCached}let l=game.religion.getSolarRevolutionRatio();if(game.bld.get("calciner").val>1&&l>3&&!game.religion.getRU("basilica").on){o=false}s=c&&game.calendar.festivalDays;s=s&&game.workshop.get("caravanserai").researched}return s||a===true||r<=l&&o},getAverageTrade:function(s){let e=game.getEffect("standingRatio")+game.diplomacy.calculateStandingFromPolicies(s.name,game);let n=1+s.energy*.02;let o=1+game.diplomacy.getTradeRatio()+game.diplomacy.calculateTradeBonusFromPolicies(s.name,game)+game.challenges.getChallenge("pacifism").getTradeBonusEffect(game);let t=s.standing<0?s.standing+e:0;let c=t<0?1+t:1;let u=s.standing>0?Math.min(s.standing+e/2,1):0;let g={};for(let l of s.sells){if(!this.isValidTrade(l,s)){continue}let e=0;let t=l.minLevel?l.chance*(1+game.getLimitedDR(.01*s.embassyLevel,.75)):l.chance;let a=l.seasons?1+l.seasons[game.calendar.getCurSeason().name]:1;let i=(c-u)*Math.min(t,1);let r=u*Math.min(t,1);e=(i+1.25*r)*l.value*n*a*o;g[l.name]=e}if(s.name==="zebras"){let e=Y["ship"].value;let t=game.getEffect("zebraRelationModifier")*game.bld.getBuildingExt("tradepost").meta.effects["tradeRatio"];let a=Math.min(.15+e*.0035,1);g["titanium"]=(1.5+e*.03)*(1+t)*a*c;if(game.religion.getSolarRevolutionRatio()<1&&e<40&&game.getEffect("titaniumPerTickAutoprod")<.002){g["titanium"]=0}}let a=s.embassyPrices?.35*(1+.01*s.embassyLevel):.35;let i=c*Math.min(a,1);g["spice"]=25*i+50*i*o/2;g["blueprint"]=.1*c;return g},isValidTrade:function(e,t){return!(e.minLevel&&t.embassyLevel<e.minLevel)&&(Y[e.name].unlocked||e.name==="titanium"||e.name==="uranium"||t.name==="leviathans")},getLowestTradeAmount:function(e,t,a){let i,r,l,s;let n=this.getMaterials(e);let o=this.getRace(e);for(s in n){if(s==="manpower"){i=this.craftManager.getValueAvailable(s,true)/n[s]}else{i=this.craftManager.getValueAvailable(s,!t,H.auto.trade.trigger)/n[s]}r=r===undefined||i<r?i:r}r=Math.floor(r);if(r===0){return 0}if(o===null||H.auto.trade.items[e].allowCapped){return r}let c=this.getAverageTrade(o);for(let r in o.sells){let e=o.sells[r];let t=this.craftManager.getResource(e.name);let a=0;if(!t.maxValue){continue}a=c[e.name];let i=Math.max((t.maxValue-t.value)/a,0);l=i<l?l:i}l=Math.ceil(l);if(l===0){return 0}r=l<r?Math.max(l-1,1):r;return Math.floor(r)},getMaterials:function(e){let t=game.challenges.isActive("postApocalypse")?game.bld.getPollutionLevel():1;let a={manpower:t*(50-game.getEffect("tradeCatpowerDiscount")),gold:t*(15-game.getEffect("tradeGoldDiscount"))};if(e===undefined){return a}let i=this.getRace(e).buys;for(const r in i){let e=i[r];a[e.name]=e.val}return a},getRace:function(e){if(e===undefined){return null}else{return game.diplomacy.get(e)}},getTradeButton:function(a){for(let t in this.manager.tab.racePanels){let e=this.manager.tab.racePanels[t];if(e.race.name===a){return e.tradeBtn}}},singleTradePossible:function(e){let t=this.getMaterials(e);for(let e in t){if(this.craftManager.getValueAvailable(e,true)<t[e]){return false}}return true}};let n=function(){};n.prototype={pushToCache:function(e){let t=H.auto.cache.cacheSum;let a=e["materials"];for(let e in a){if(!t[e]){t[e]=0}t[e]+=a[e]}},getResValue:function(e){let t=H.auto.cache;let a=t.dataTimer;let i=t.cacheSum;if(!i[e]){return 0}let r=a.ticksTotal;let l=game.timer.ticksTotal;let s=i[e]/(l-r);return s},checkForTimer:function(){let t=H.auto.cache;let e=t.dataTimer;let a=game.timer.ticksTotal;let i=e.ticksTotal;let r=game.calendar.trueYear();let l=game.telemetry.guid;if(a-i<0||e["trueYear"]+1<r||e["saveId"]!==l){t.dataTimer=null;t.dataTimer={};t.cacheSum=null;t.cacheSum={};let e=t.dataTimer;e["saveId"]=l;e["ticksTotal"]=a;e["trueYear"]=r;return 0}if(a-i>2e4){e.ticksTotal=a}}};let o=function(e){const t=document.styleSheets;t[0].insertRule(e,0)};if(o){let e="body[data-ks-style]:not(.scheme_sleek)";o("body {"+"font-family: inherit;"+"font-size: inherit;"+"}");o(e+" #game {"+"min-width: 1300px;"+"top: 32px;"+"}");o(e+" .column {"+"min-height: inherit;"+"max-width: inherit !important;"+"padding: 1%;"+"margin: 0;"+"overflow-y: auto;"+"}");o(e+" #leftColumn {"+"height: 92%;"+"width: 26%;"+"}");o(e+" #midColumn {"+"margin-top: 1% !important;"+"height: 90%;"+"width: 48%;"+"}");o(e+" #rightColumn {"+"overflow-y: auto;"+"height: 92%;"+"width: 19%;"+"font-size: 12px;"+"font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,Helvetica,Arial,PingFang SC,Hiragino Sans GB,Microsoft YaHei,sans-serif;"+"}");o("body #gamePageContainer #game #rightColumn {"+"overflow-y: auto;"+"}");o(e+" #gameLog {"+"overflow-y: hidden !important;"+"width: 100% !important;"+"padding-top: 5px !important;"+"}");o(e+" #resContainer .maxRes {"+"color: #676766;"+"}");o(e+" #game .btn {"+"border-radius: 0px;"+"font-family: monospace;"+"font-size: 12px !important;"+"margin: 0 5px 7px 0;"+"width: 290px;"+"}");o(e+" #game .map-viewport {"+"height: 340px;"+"max-width: 500px;"+"overflow: visible;"+"}");o(" #game .map-dashboard {"+"height: 120px;"+"width: 292px;"+"}");o("#ks-options ul {"+"list-style: none;"+"margin: 0 0 5px;"+"padding: 0;"+"}");o("#ks-options ul:after {"+"clear: both;"+'content: " ";'+"display: block;"+"height: 0;"+"}");o("#ks-options ul li {"+"display: block;"+"float: left;"+"width: 100%;"+"}");o("#ks-options #toggle-list-resources .stockWarn *,"+"#ks-options #toggle-reset-list-resources .stockWarn * {"+"color: "+H.stockwarncolor+";"+"}");o(".right-tab {"+"height: unset !important;"+"}")}let c=3;let V={version:c,toggles:{},items:{},resources:{},triggers:{},reset:{reset:false,times:0,paragonLastTime:0,paragonTotal:0,karmaLastTime:0,karmaTotal:0},policies:[]};let z=["build","space","craft","upgrade","trade","faith","time","timeCtrl","distribute","options","filter"];let R=function(){z.forEach(e=>{$("#items-list-"+e).find("input[id^='toggle-']").each(function(){let e=$(this);if($(this).attr("type")!=="radio"){V.items[e.attr("id")]=e.prop("checked")}})});V.items["toggle-leaderJob-farmer"]=true;V.items["toggle-leaderTrait-manager"]=true;L()};let L=function(){V.toggles={build:H.auto.build.enabled,space:H.auto.space.enabled,craft:H.auto.craft.enabled,upgrade:H.auto.upgrade.enabled,trade:H.auto.trade.enabled,faith:H.auto.faith.enabled,time:H.auto.time.enabled,timeCtrl:H.auto.timeCtrl.enabled,distribute:H.auto.distribute.enabled,options:H.auto.options.enabled,filter:H.auto.filter.enabled};V.resources=H.auto.resources;V.triggers={faith:H.auto.faith.trigger,time:H.auto.time.trigger,build:H.auto.build.trigger,space:H.auto.space.trigger,craft:H.auto.craft.trigger,trade:H.auto.trade.trigger};V.policies=H.policies;localStorage["cbc.kitten-scientists"]=JSON.stringify(V)};let J=function(){let e=JSON.parse(localStorage["cbc.kitten-scientists"]||"null");if(!e||e.version>c){R();return}if(e.version===1){e.version=2;e.reset={reset:false,times:0,paragonLastTime:0,paragonTotal:0,karmaLastTime:0,karmaTotal:0}}if(e.version===2){e.version=3;e.policies=[]}if(e.version===c){V=e;let t;if(e.toggles){for(const r in e.toggles){if(r!=="engine"&&H.auto[r]){H.auto[r].enabled=!!e.toggles[r];t=$("#toggle-"+r);t.prop("checked",H.auto[r].enabled)}}}for(const l in V.items){let a=V.items[l];t=$("#"+l);let e=t.data("option");let i=l.split("-");if(e===undefined){delete V.items[l];continue}if(i[0]==="set"){t[0].title=a;if(i[i.length-1]==="max"){t.text(j("ui.max",[a]))}else if(i[i.length-1]==="min"){t.text(j("ui.min",[a]))}}else{t.prop("checked",a)}if(i.length===2){e.enabled=a}else if(i[1]==="reset"&&i.length>=4){let e=i[2];let t=i[3];switch(i[0]){case"toggle":H.auto[e].items[t].checkForReset=a;break;case"set":H.auto[e].items[t].triggerForReset=a;break}}else{if(i[1]==="limited"){e.limited=a}else if(i[1]==="leaderJob"){e[i[1]]=i[2]}else if(i[1]==="leaderTrait"){e[i[1]]=i[2]}else{e[i[2]]=a}}}let a=$("#toggle-list-resources");let i=$("#toggle-reset-list-resources");for(const s in V.resources){let e=V.resources[s];if(e.enabled){if($("#resource-"+s).length===0){a.append(U(s))}if("stock"in e){F(s,e.stock)}if("consume"in e){M(s,e.consume)}}if(e.checkForReset){if($("#resource-reset-"+s).length===0){i.append(U(s,undefined,true))}if("stockForReset"in e){F(s,e.stockForReset?e.stockForReset:Infinity,true)}}}if(e.triggers){H.auto.faith.trigger=e.triggers.faith;H.auto.time.trigger=e.triggers.time;H.auto.build.trigger=e.triggers.build;H.auto.space.trigger=e.triggers.space;H.auto.craft.trigger=e.triggers.craft;H.auto.trade.trigger=e.triggers.trade;$("#trigger-faith")[0].title=H.auto.faith.trigger;$("#trigger-time")[0].title=H.auto.time.trigger;$("#trigger-build")[0].title=H.auto.build.trigger;$("#trigger-space")[0].title=H.auto.space.trigger;$("#trigger-craft")[0].title=H.auto.craft.trigger;$("#trigger-trade")[0].title=H.auto.trade.trigger}H.policies=e.policies}};let D=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};let w=function(e){return+(Math.round(+(e+"e+2"))+"e-2")};let T=function(t,e,a=false){let i=a?"#resource-reset-"+t:"#resource-"+t;$(i).removeClass("stockWarn");let r=game.resPool.resources.filter(e=>e.name===t)[0].maxValue;if(e>r&&!(r===0)||e===Infinity){$(i).addClass("stockWarn")}};let F=function(e,t,a=false){let i;let r=Number(t);if(isNaN(r)||r<0){s("ignoring non-numeric or invalid stock value "+t);return}if(!H.auto.resources[e]){H.auto.resources[e]={}}if(a){i="#resource-reset-"+e+" #stock-value-"+e;r=r<0?Infinity:r;H.auto.resources[e].checkForReset=true;H.auto.resources[e].stockForReset=r}else{i="#resource-"+e+" #stock-value-"+e;H.auto.resources[e].enabled=true;H.auto.resources[e].stock=r}$(i).text(j("resources.stock",[r===Infinity?"∞":game.getDisplayValueExt(r)]));T(e,r,a)};let M=function(e,t){let a=parseFloat(t);if(isNaN(a)||a<0||a>1){s("ignoring non-numeric or invalid consume rate "+t);return}if(!H.auto.resources[e]){H.auto.resources[e]={}}H.auto.resources[e].consume=a;$("#consume-rate-"+e).text(j("resources.consume",[a.toFixed(2)]))};let E=function(e,t=false){let a=H.auto.resources[e];if(t){a.checkForReset=false}else{a.enabled=false}if(!a.enabled&&!a.checkForReset){delete H.auto.resources[e]}};let U=function(a,i,e=false){let t;let r=Y[a];i=i||r.title||D(a);let l=H.auto.resources[a];if(e&&l&&l.stockForReset){t=l.stockForReset}else if(!e&&l&&l.stock){t=l.stock}else{t=0}let s=l&&l.consume!==undefined?l.consume:H.consume;let n=$("<div/>",{id:(e?"resource-reset-":"resource-")+a,css:{display:"inline-block",width:"100%"}});let o;if(r.type==="uncommon"){o="#FF7F50"}if(r.type==="rare"){o="#FFA500"}o=r.color||o;let c=$("<div/>",{id:"resource-label-"+a,text:i,css:{display:"inline-block",color:o,width:"95px"}});t=$("<div/>",{id:"stock-value-"+a,text:j("resources.stock",[t===Infinity?"∞":game.getDisplayValueExt(t)]),css:{cursor:"pointer",display:"inline-block",width:"80px"}});s=$("<div/>",{id:"consume-rate-"+a,text:j("resources.consume",[s.toFixed(2)]),css:{cursor:"pointer",display:"inline-block"}});let u=$("<div/>",{id:"resource-delete-"+a,text:j("resources.del"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});if(e){n.append(c,t,u)}else{n.append(c,t,s,u)}if(l!==undefined&&l.stock!==undefined){T(a,l.stock)}(function(e,t){e.on("click",function(){I.stop(false);let e=window.prompt(j("resources.stock.set",[i]));if(H.auto.engine.enabled){I.start(false)}if(e!==null){F(a,e,t);L()}})})(t,e);s.on("click",function(){I.stop(false);let e=window.prompt(j("resources.consume.set",[i]));if(H.auto.engine.enabled){I.start(false)}if(e!==null){M(a,e);L()}});(function(e,t){e.on("click",function(){if(window.confirm(j("resources.del.confirm",[i]))){n.remove();E(a,t);L()}})})(u,e);return n};let P=true;if(P){let e=true;if(e){let e,t,a,i;let r=new B;let l=H.auto.faith.items;for(e in l){i=l[e];a=r.getBuild(i.name||e,i.variant);if(a){l[e].label=a.label}}let s=new C;l=H.auto.time.items;for(e in l){i=l[e];a=s.getBuild(i.name||e,i.variant);if(a){l[e].label=a.label}}let n=new q;l=H.auto.build.items;for(e in l){i=l[e];a=n.getBuild(i.name||e);if(a){if("stage"in i){l[e].label=a.meta.stages[i.stage].label}else{l[e].label=a.meta.label}}}let o=new A;l=H.auto.space.items;for(t in l){a=o.getBuild(t);if(a){let e=a.title?a.title:a.label;l[t].label=e}}}let l=function(r){let l=[];let s=r?"#resource-reset-":"#resource-";let n=game.resPool.resources;let o=H.auto.resources;for(let t in n){let a=n[t];let i=a.name;let e=o[i];e=e&&e.enabled;if(!r&&(a.persists||e)){continue}if(i&&$(s+i).length===0){let e;if(a.type==="uncommon"){e="#FF7F50"}if(a.type==="rare"){e="#FFA500"}e=a.color||e;let t=$("<div/>",{id:"resource-add-"+i,text:D(a.title?a.title:i),css:{cursor:"pointer",color:e}});(function(e,t,a){t.on("click",function(){t.remove();if(!o[i]){o[i]={}}if(a){o[i].checkForReset=true;o[i].stockForReset=Infinity;$("#toggle-reset-list-resources").append(U(i,e.title,a))}else{o[i].enabled=true;o[i].stock=0;o[i].consume=H.consume;$("#toggle-list-resources").append(U(i,e.title,a))}L()})})(a,t,r);l.push(t)}}return l};let h=function(a=false){let i=$("<ul/>",{id:a?"toggle-reset-list-resources":"toggle-list-resources",css:{display:"none",paddingLeft:"20px"}});let e=$("<div/>",{id:"resources-add",text:j("resources.add"),css:{cursor:"pointer",display:"inline-block",textShadow:"3px 3px 4px gray",borderBottom:"1px solid rgba(185, 185, 185, 0.7)"}});let t=$("<div/>",{id:"resources-clear-unused",text:j("resources.clear.unused"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});t.on("click",function(){for(let e in H.auto.resources){if(!H.auto.resources[e].stock&&H.auto.resources[e].consume===H.consume||H.auto.resources[e].consume===undefined){$("#resource-"+e).remove()}}});let r=$("<ul/>",{id:"available-resources-list",css:{display:"none",paddingLeft:"20px"}});(function(e,t){e.on("click",function(){r.toggle();r.empty();if(r[0].style.display!=="none"){r.append(l(t))}})})(e,a);if(a){i.append(e,r)}else{i.append(e,t,r)}for(let t in H.auto.resources){let e=H.auto.resources[t];if(a&&e.checkForReset||!a&&e.enabled){i.append(U(t,undefined,a))}}return i};let b=function(e){let t=$("<ul/>",{id:"items-list-"+e,css:{display:"none",paddingLeft:"20px"}});let a=$("<div/>",{id:"toggle-all-items-"+e,text:j("ui.disable.all"),css:{cursor:"pointer",display:"inline-block",textShadow:"3px 3px 4px gray",marginRight:"8px"}});a.on("click",function(){let e=t.children().children(":checkbox");e.prop("checked",false);e.change();t.children().children(":checkbox").change()});t.append(a);let i=$("<div/>",{id:"toggle-all-items-"+e,text:j("ui.enable.all"),css:{cursor:"pointer",display:"inline-block",textShadow:"3px 3px 4px gray"}});i.on("click",function(){let e=t.children().children(":checkbox");e.prop("checked",true);e.change();t.children().children(":checkbox").change()});t.append(i);return t};let k=function(){let e="faith-addition";let i=b(e);let r=H.auto.faith.addition;for(let a in r){let t=y(a,r[a]);if(a==="bestUnicornBuilding"){t.children("label").prop("title",j("option.faith.best.unicorn.desc"));let e=t.children("input");e.unbind("change");e.on("change",e=>{let t=r.bestUnicornBuilding;if(e.target.checked&&!t.enabled){t.enabled=true;S("status.sub.enable",[j("option.faith.best.unicorn")]);S("option.faith.best.unicorn.desc")}else if(!e.target.checked&&t.enabled){t.enabled=false;S("status.sub.disable",[j("option.faith.best.unicorn")])}V.items[e.target.id]=t.enabled;L()})}if(r[a].subTrigger!==undefined){let e=$("<div/>",{id:"set-"+a+"-subTrigger",text:j("ui.trigger"),title:r[a].subTrigger,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",r[a]);(function(t,a){if(t==="adore"){a.on("click",function(){let e;I.stop(false);e=window.prompt(j("adore.trigger.set"),r[t].subTrigger);if(H.auto.engine.enabled){I.start(false)}if(e!==null){r[t].subTrigger=parseFloat(e);V.items[a[0].id]=r[t].subTrigger;L();a[0].title=r[t].subTrigger}})}else if(t==="autoPraise"){a.on("click",function(){let e;I.stop(false);e=window.prompt(j("parise.trigger.set",[j("option.praise")]),r[t].subTrigger);if(H.auto.engine.enabled){I.start(false)}if(e!==null){r[t].subTrigger=parseFloat(e);V.items[a[0].id]=r[t].subTrigger;L();a[0].title=r[t].subTrigger}})}})(a,e);t.append(e)}i.append(t)}return i};let s=function(a){let e,t,i,r;let l=D(j("ui."+a));let s=H.auto[a];let n=$("<li/>",{id:"ks-"+a});let o=$("<label/>",{for:"toggle-"+a,text:l});let c=$("<input/>",{id:"toggle-"+a,type:"checkbox"});if(s.enabled){c.prop("checked",true)}if(a!=="engine"){c.on("change",function(){if(c.is(":checked")&&!s.enabled){s.enabled=true;if(a==="filter"||a==="options"){S("status.sub.enable",[l])}else{S("status.auto.enable",[l])}L()}else if(!c.is(":checked")&&s.enabled){s.enabled=false;if(a==="filter"||a==="options"){S("status.sub.disable",[l])}else{S("status.auto.disable",[l])}L()}})}n.append(c,o);if(s.items){n.css("borderBottom","1px  solid rgba(185, 185, 185, 0.7)");i=$("<div/>",{css:{display:"inline-block",float:"right"}});r=$("<div/>",{id:"toggle-items-"+a,text:j("ui.items"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});n.append(r);e=b(a);if(a==="faith"){for(t in H.auto.unicorn.items){e.append(y(t,H.auto.unicorn.items[t]))}}for(t in s.items){switch(a){case"trade":e.append(v(t,s.items[t]));break;case"craft":e.append(w(t,s.items[t]));break;case"timeCtrl":e.append(T(t,s.items[t]));break;case"options":e.append(F(t,s.items[t]));break;case"upgrade":e.append(x(t,s.items[t]));break;case"distribute":e.append(M(t,s.items[t]));break;case"build":case"faith":case"space":e.append(R(t,s.items[t]));break;case"time":e.append(R(t,s.items[t]));break;default:e.append(y(t,s.items[t]));break}}r.on("click",function(){e.toggle()})}if(s.trigger!==undefined){let t=$("<div/>",{id:"trigger-"+a,text:j("ui.trigger"),title:s.trigger,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});t.on("click",function(){let e;I.stop(false);if(a==="faith"){e=window.prompt(j("ui.trigger.set",[l+"("+$I("resources.faith.title")+")"]),s.trigger.toString())}else if(a==="trade"){e=window.prompt(j("ui.trigger.set",[l+" 的触发值\n需同时满足 种族触发资源 和 "+$I("resources.gold.title")+" 的"]),s.trigger.toString())}else{e=window.prompt(j("ui.trigger.set",[l]),s.trigger.toString())}if(H.auto.engine.enabled){I.start(false)}if(e!==null){s.trigger=parseFloat(e);L();t[0].title=s.trigger}});n.append(t)}if(a==="craft"){const u=$("<div/>",{id:"toggle-resource-controls",text:j("ui.craft.resources"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});const g=h();r.on("click",function(){g.toggle(false)});u.on("click",function(){e.toggle(false);g.toggle()});n.append(u);n.append(g)}else if(a==="faith"){const d=$("<div/>",{id:"toggle-addition-controls",text:j("ui.faith.addtion"),title:"太阳教团的自动化项目",css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"2px 2px 5px gray"}});const m=k();r.on("click",function(){m.toggle(false)});d.on("click",function(){e.toggle(false);m.toggle()});n.append(d);for(const f in H.auto.unicorn.items){const p=e.children().children("#toggle-"+f);p.on("change",function(e){if(!$(e.target).is(":checked")){const t=$("#toggle-bestUnicornBuilding");t.prop("checked",false);t.trigger("change")}})}n.append(m)}if(s.items){n.append(i,e)}return n};let v=function(e,t){let a=D(j("$trade.race."+e));let i=y(e,t,a);i.css("borderBottom","1px solid rgba(185, 185, 185, 0.7)");let r=$("<label/>",{for:"toggle-limited-"+e,title:j("trade.limited",[a]),text:j("ui.limit")});let l=$("<input/>",{id:"toggle-limited-"+e,type:"checkbox"}).data("option",t);if(t.limited){l.prop("checked",true)}l.on("change",function(){if(l.is(":checked")&&t.limited===false){t.limited=true;S("trade.limited",[a])}else if(!l.is(":checked")&&t.limited){t.limited=false;let e=t.require?"需同时满足资源黄金和"+Y[t.require].title+"的触发条件才":"资源满足黄金的触发条件就会";S("trade.unlimited",[a,e])}V.items[l.attr("id")]=t.limited;L()});i.append(l,r);let s=$("<div/>",{id:"toggle-seasons-"+e,text:j("trade.seasons"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let n=$("<ul/>",{id:"seasons-list-"+e,css:{display:"none",paddingLeft:"20px"}});n.append(o(e,"spring",t));n.append(o(e,"summer",t));n.append(o(e,"autumn",t));n.append(o(e,"winter",t));s.on("click",function(){n.toggle()});i.append(s,n);return i};let o=function(e,t,a){let i=D(j("$trade.race."+e));let r=D(j("$calendar.season."+t));let l=$("<li/>");let s=$("<label/>",{for:"toggle-"+e+"-"+t,text:D(r)});let n=$("<input/>",{id:"toggle-"+e+"-"+t,type:"checkbox"}).data("option",a);if(a[t]){n.prop("checked",true)}n.on("change",function(){if(n.is(":checked")&&!a[t]){a[t]=true;S("trade.season.enable",[i,r])}else if(!n.is(":checked")&&a[t]){a[t]=false;S("trade.season.disable",[i,r])}V.items[n.attr("id")]=a[t];L()});l.append(n,s);return l};let c=function(e,t){let a=D(j("$calendar.season."+e));let i=$("<li/>");let r=$("<label/>",{for:"toggle-timeSkip-"+e,text:D(a)});let l=$("<input/>",{id:"toggle-timeSkip-"+e,type:"checkbox"}).data("option",t);if(t[e]){l.prop("checked",true)}l.on("change",function(){if(l.is(":checked")&&!t[e]){t[e]=true;S("time.skip.season.enable",[a])}else if(!l.is(":checked")&&t[e]){t[e]=false;S("time.skip.season.disable",[a])}V.items[l.attr("id")]=t[e];L()});i.append(l,r);return i};let y=function(e,t,a){let i=$("<li/>");let r=a||t.label||D(e);let l=t.require;l=l?game.resPool.get(t.require).title:j("ui.none");let s=j("ui.trigger.resource")+": "+l;if(t.require===undefined){s=null}let n=$("<label/>",{for:"toggle-"+e,text:r,title:s,css:{display:"inline-block",minWidth:"80px"}});let o=$("<input/>",{id:"toggle-"+e,type:"checkbox"}).data("option",t);if(t.enabled){o.prop("checked",true)}o.on("change",function(){if(o.is(":checked")&&!t.enabled){t.enabled=true;if(t.filter){S("filter.enable",[r])}else if(t.misc){S("status.sub.enable",[r])}else{S("status.auto.enable",[r]);if(e==="wood"){S("msg.catnip")}}}else if(!o.is(":checked")&&t.enabled){t.enabled=false;if(t.filter){S("filter.disable",[r])}else if(t.misc){S("status.sub.disable",[r])}else{S("status.auto.disable",[r])}}V.items[o.attr("id")]=t.enabled;if(e!=="saves"){L()}});i.append(o,n);return i};let n=function(e){let a=[];for(let t in H.policies){let e=H.policies[t];if(e==="authocracy"){e="autocracy"}a.push($("<div/>",{id:"policy-"+e,text:j("$policy."+e+".label"),css:{cursor:"pointer",textShadow:"3px 3px 4px gray"}}))}return a};let x=function(a,i){let r=j("ui.upgrade."+a);let l=y(a,i,r);if(a==="policies"){let e=$("<ul/>",{id:"items-list-policies",css:{display:"none",paddingLeft:"20px"}});let t=$("<div/>",{id:"toggle-upgrade-policies-load",text:j("ui.upgrade.policies.load"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let a=$("<div/>",{id:"toggle-upgrade-policies-show",text:j("ui.upgrade.policies.show"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});t.on("click",function(){const t=[];for(const a in game.science.policies){let e=game.science.policies[a];if(e.researched){t.push(e.name)}}H.policies=t;L();e.empty();e.append(n())});a.on("click",function(){e.toggle();e.empty();e.append(n())});l.append(a,t,e)}if(i.subTrigger!==undefined&&a==="missions"){let t=$("<div/>",{id:"set-"+a+"-subTrigger",text:j("ui.trigger"),title:i.subTrigger,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",i);t.on("click",function(){let e;I.stop(false);if(a==="missions"){e=window.prompt(j("ui.trigger.missions.set"),i.subTrigger.toString())}else{e=window.prompt(j("ui.trigger.set"),i.subTrigger.toString())}if(H.auto.engine.enabled){I.start(false)}if(e!==null){i.subTrigger=parseFloat(e);V.items[t.attr("id")]=i.subTrigger;L();t[0].title=i.subTrigger}});l.append(t)}if(a==="upgrades"||a==="techs"){let e=$("<label/>",{for:"toggle-limited-"+a,text:j("ui.upgradesLimit")});let t=$("<input/>",{id:"toggle-limited-"+a,type:"checkbox"}).data("option",i);if(i.limited){t.prop("checked",true)}t.on("change",function(){if(t.is(":checked")&&!i.limited){i.limited=true;S("upgrade.limited",[r])}else if(!t.is(":checked")&&i.limited){i.limited=false;S("upgrade.unlimited",[r])}V.items[t.attr("id")]=i.limited;L()});l.append(t,e)}return l};let R=function(e,t,a){let i=$("<li/>");let r=a||t.label||D(e);let l=t.require;l=l?game.resPool.get(t.require).title:j("ui.none");let s=l;let n=$("<label/>",{for:"toggle-"+e,text:r,title:j("ui.trigger.resource")+": "+s,css:{display:"inline-block",minWidth:"80px"}});let o=$("<input/>",{id:"toggle-"+e,type:"checkbox"}).data("option",t);if(t.enabled){o.prop("checked",true)}o.on("change",function(){if(o.is(":checked")&&!t.enabled){t.enabled=true;if(t.filter){S("filter.enable",[r])}else if(t.misc){S("status.sub.enable",[r])}else{S("status.auto.enable",[r]);if(e==="field"){S("msg.catnip")}}}else if(!o.is(":checked")&&t.enabled){t.enabled=false;if(t.filter){S("filter.disable",[r])}else if(t.misc){S("status.sub.disable",[r])}else{S("status.auto.disable",[r])}}V.items[o.attr("id")]=t.enabled;L()});let c=$("<div/>",{id:"set-"+e+"-max",text:j("ui.max",[t.max]),title:t.max,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",t);c.on("click",function(){let e;I.stop(false);e=window.prompt(j("ui.max.set",[t.label]),t.max.toString());if(H.auto.engine.enabled){I.start(false)}if(e!==null){t.max=parseInt(e);V.items[c.attr("id")]=t.max;L();c[0].title=t.max;c[0].innerText=j("ui.max",[t.max])}});i.append(o,n,c);return i};let w=function(e,t){let a=D(j("$resources."+e+".title"));if(e==="ship"){a=D(j("$workshop.crafts."+e+".label"))}let i=y(e,t,a);if(e==="parchment"){return i}let r=$("<label/>",{for:"toggle-limited-"+e,title:j("craft.limitedTitle"),text:j("ui.craftLimit")});let l=$("<input/>",{id:"toggle-limited-"+e,type:"checkbox"}).data("option",t);if(t.limited){l.prop("checked",true)}l.on("change",function(){if(l.is(":checked")&&!t.limited){t.limited=true;S("craft.limited",[a]);ae("craftLimited")}else if(!l.is(":checked")&&t.limited){t.limited=false;let e=t.require?Y[t.require].title+"满足触发资源的触发条件才会制作，":"无，当资源满足制作条件就会制作";S("craft.unlimited",[a,e])}V.items[l.attr("id")]=t.limited;L()});i.append(l,r);return i};let u=function(e,t){let a=game.calendar.cycles[e];let i=$("<li/>");let r=$("<label/>",{for:"toggle-timeSkip-"+e,text:a.title});let l=$("<input/>",{id:"toggle-timeSkip-"+e,type:"checkbox"}).data("option",t);if(t[e]){l.prop("checked",true)}l.on("change",function(){if(l.is(":checked")&&!t[e]){t[e]=true;S("time.skip.cycle.enable",[a.title])}else if(!l.is(":checked")&&t[e]){t[e]=false;S("time.skip.cycle.disable",[a.title])}V.items[l.attr("id")]=t[e];L()});i.append(l,r);return i};let d=function(e,t,a){let i=$("<li/>");let r=a.label;let l=$("<label/>",{for:"toggle-reset-"+t+"-"+e,text:r,css:{display:"inline-block",minWidth:"80px"}});let s=$("<input/>",{id:"toggle-reset-"+t+"-"+e,type:"checkbox"}).data("option",a);if(a.checkForReset){s.prop("checked",true)}s.on("change",function(){if(s.is(":checked")&&!a.checkForReset){a.checkForReset=true;S("status.reset.check.enable",[r])}else if(!s.is(":checked")&&a.checkForReset){a.checkForReset=false;S("status.reset.check.disable",[r])}V.items[s.attr("id")]=a.checkForReset;L()});let n=$("<div/>",{id:"set-reset-"+t+"-"+e+"-min",text:j("ui.min",[a.triggerForReset]),title:a.triggerForReset,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",a);n.on("click",function(){let e;e=window.prompt(j("reset.check.trigger.set",[a.label]),a.triggerForReset.toString());if(e!==null){a.triggerForReset=parseInt(e);V.items[n.attr("id")]=a.triggerForReset;L();n[0].title=a.triggerForReset;n[0].innerText=j("ui.min",[a.triggerForReset])}});i.append(s,l,n);return i};let T=function(l,s){let n;let g=y(l,s);if(l==="timeSkip"){n=$("<div/>",{id:"set-timeSkip-subTrigger",text:j("ui.trigger"),title:s.subTrigger,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",s);n.on("click",function(){let e;I.stop(false);e=window.prompt(j("time.skip.trigger.set",[]),s.subTrigger);if(H.auto.engine.enabled){I.start(false)}if(e!==null){s.subTrigger=parseFloat(e);V.items[n.attr("id")]=s.subTrigger;L();n[0].title=s.subTrigger}});let t=$("<div/>",{id:"set-timeSkip-maximum",text:j("ui.maximum"),title:s.max,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",s);t.on("click",function(){let e;I.stop(false);e=window.prompt(j("ui.max.set",["每次燃烧时间水晶"]),s.maximum.toString());if(H.auto.engine.enabled){I.start(false)}if(e!==null){s.maximum=parseFloat(e);V.items[t.attr("id")]=s.maximum;L();t[0].title=s.maximum}});let e=$("<div/>",{id:"toggle-cycle-"+l,text:j("ui.cycles"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let a=$("<ul/>",{id:"cycles-list-"+l,css:{display:"none",paddingLeft:"20px"}});for(let e in game.calendar.cycles){a.append(u(e,s))}let i=$("<div/>",{id:"toggle-seasons-"+l,text:j("trade.seasons"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let r=$("<ul/>",{id:"seasons-list-"+l,css:{display:"none",paddingLeft:"20px"}});r.append(c("spring",s));r.append(c("summer",s));r.append(c("autumn",s));r.append(c("winter",s));e.on("click",function(){a.toggle();r.toggle(false)});i.on("click",function(){a.toggle(false);r.toggle()});g.append(e,i,t,n,a,r)}else if(l==="reset"){let e;let t=b("reset-build");let a=b("reset-space");let i=h(true);let r=b("reset-religion");let l=b("reset-time");for(e in H.auto.build.items){t.append(d(e,"build",H.auto.build.items[e]))}for(e in H.auto.space.items){a.append(d(e,"space",H.auto.space.items[e]))}for(e in H.auto.unicorn.items){r.append(d(e,"unicorn",H.auto.unicorn.items[e]))}for(e in H.auto.faith.items){r.append(d(e,"faith",H.auto.faith.items[e]))}for(e in H.auto.time.items){l.append(d(e,"time",H.auto.time.items[e]))}let s=$("<div/>",{id:"toggle-reset-build",text:j("ui.build"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let n=$("<div/>",{id:"toggle-reset-space",text:j("ui.space"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let o=$("<div/>",{id:"toggle-reset-resources",text:j("ui.craft.resources"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let c=$("<div/>",{id:"toggle-reset-religion",text:j("ui.faith"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let u=$("<div/>",{id:"toggle-reset-time",text:j("ui.time"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});s.on("click",function(){t.toggle();a.toggle(false);i.toggle(false);r.toggle(false);l.toggle(false)});n.on("click",function(){t.toggle(false);a.toggle();i.toggle(false);r.toggle(false);l.toggle(false)});o.on("click",function(){t.toggle(false);a.toggle(false);i.toggle();r.toggle(false);l.toggle(false)});c.on("click",function(){t.toggle(false);a.toggle(false);i.toggle(false);r.toggle();l.toggle(false)});u.on("click",function(){t.toggle(false);a.toggle(false);i.toggle(false);r.toggle(false);l.toggle()});g.append(s,n,o,c,u,t,a,i,r,l)}else{n=$("<div/>",{id:"set-"+l+"-subTrigger",text:j("ui.trigger"),title:s.subTrigger,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",s);n.on("click",function(){let e;e=window.prompt(j("ui.trigger.set",[s.label]),s.subTrigger);if(e!==null){s.subTrigger=parseFloat(e);V.items[n.attr("id")]=s.subTrigger;L();n[0].title=s.subTrigger}});g.append(n)}return g};let F=function(a,i){let r;let l=y(a,i);if(a==="style"){r=l.children("input");r.unbind("change");r.on("change",function(e){i.enabled=r.prop("checked");V.items[r.attr("id")]=i.enabled;if(e.isTrusted){L()}let t=document.getElementById("toggleCenter").style;if(i.enabled){document.body.setAttribute("data-ks-style","");if(!game.ui.isCenter){t.display="none"}}else{document.body.removeAttribute("data-ks-style");t.display=""}})}if(a==="useWorkers"){r=l.children("input");r.on("click",function(){let e=confirm(j("ui.trigger.useWorkers.alert"));if(e&&!i.enabled){I.stop();i.enabled=true;V.items[r.attr("id")]=i.enabled;if(H.auto.engine.enabled){I.start()}}else if(e&&i.enabled){I.stop();i.enabled=false;V.items[r.attr("id")]=i.enabled;if(H.auto.engine.enabled){I.start()}}})}if(a==="saves"){r=l.children("input");r.on("click",function(){I.stop(false);let e=window.confirm("点击确认会导出珂学家的配置.txt文件");if(e){let e=$("#download-link");let t=JSON.stringify(window.localStorage["cbc.kitten-scientists"]);let a=game.compressLZData(t,false);let i=new Blob([a],{type:"text/plain"});e.attr("href",window.URL.createObjectURL(i));let r="小猫珂学家配置"+(game.stats.getStat("totalResets").val+1)+"周目";e.attr("download",r+".txt");e.get(0).dispatchEvent(new MouseEvent("click"))}if(H.auto.engine.enabled){I.start(false)}});let e=$("<div/>",{id:"loadKS",text:"导入配置",css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",i);e.on("click",function(){I.stop(false);let t=window.prompt("窗口内填入后你需要导入的珂学家配置，确认后会导入配置","");if(H.auto.engine.enabled){I.start(false)}if(t&&t.length>=10){let e;if(t.charAt(0)!=="{"){e=JSON.parse(LZString.decompressFromBase64(t))}window.localStorage["cbc.kitten-scientists"]=e;J()}});let t=$("<div/>",{id:"ressetKS",text:"恢复默认配置",css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",i);t.on("click",function(){if(confirm("确定要初始化珂学家配置吗，点击确认后初始化珂学家配置(最好刷新下页面)")){I.stop();let e=sessionStorage.getItem("options");delete localStorage["cbc.kitten-scientists"];if(e){$("#ks-options").remove();H.policies=[];H["auto"]=JSON.parse(e).auto;E=$("<div/>",{id:"ks-options",css:{marginBottom:"10px"}});P=$("<ul/>");P.append(s("engine"));if(H.auto.engine.enabled){I.start()}z.forEach(e=>{P.append(s(e))});p.prepend(E.append(P));ne();J()}else{game.save();window.location.reload()}}});l.append(e);l.append(t)}if(a==="donate"){r=l.children("input");r.unbind("change");r.on("change",function(e){i.enabled=r.prop("checked");V.items[r.attr("id")]=i.enabled;if(e.isTrusted){L()}let t=document.getElementById("ks-donate").style;if(i.enabled){t.display="block"}else{t.display="none"}t=null})}if(a==="wiki"){r=l.children("input");r.on("click",function(){let e=window.open();e.location="https://petercheney.gitee.io/baike/?file=004-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B7%A5%E5%85%B7/02-%E5%B0%8F%E7%8C%AB%E7%A7%91%E5%AD%A6%E5%AE%B6";X(["如果还有问题可以在猫国群询问，有BUG或意见可以联系Cheney。默认配置即推荐配置：文艺复兴玄学下默认配置能2小时冲出轨道。","ks-default",H.activitycolor])})}if(i.subTrigger!==undefined){let t=$("<div/>",{id:"set-"+a+"-subTrigger",text:j("ui.trigger"),title:i.subTrigger,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",i);t.on("click",function(){let e;I.stop(false);if(a==="crypto"){e=window.prompt(j("ui.trigger.crypto.set",[i.label]),i.subTrigger)}else if(a==="shipOverride"){e=window.prompt(j("ui.trigger.shipOverride.set",[i.label]),i.subTrigger)}else{e=window.prompt(j("ui.trigger.set",[i.label]),i.subTrigger)}if(H.auto.engine.enabled){I.start(false)}if(e!==null){if(a==="crypto"){i.subTrigger=e}else{i.subTrigger=parseFloat(e)}V.items[t.attr("id")]=i.subTrigger;L();t[0].title=i.subTrigger}});l.append(t)}return l};let M=function(e,a){if(e==="leader"){return g(e,a)}let t=D(j("$village.job."+e));let i=y(e,a,t);i.css("borderBottom","1px solid rgba(185, 185, 185, 0.7)");let r=$("<label/>",{for:"toggle-limited-"+e,text:j("ui.limit")});let l=$("<input/>",{id:"toggle-limited-"+e,type:"checkbox"}).data("option",a);if(a.limited){l.prop("checked",true)}l.on("change",function(){if(l.is(":checked")&&!a.limited){a.limited=true;S("distribute.limited",[t])}else if(!l.is(":checked")&&a.limited){a.limited=false;S("distribute.unlimited",[t])}V.items[l.attr("id")]=a.limited;L()});i.append(l,r);let s=$("<div/>",{id:"set-"+e+"-max",text:j("ui.max",[a.max]),title:a.max,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",a);(function(t){s.on("click",function(){let e;I.stop(false);e=window.prompt(j("ui.max.set",[t])+" （按max比例分配）",a.max.toString());if(H.auto.engine.enabled){I.start(false)}if(e!==null){a.max=Math.max(0,parseInt(e));V.items[s.attr("id")]=a.max;L();s[0].title=a.max;s[0].innerText=j("ui.max",[a.max])}})})(t);i.append(s);return i};let g=function(e,t){let a;let i=D(j("distribute.makeLeader"));let r=y(e,t,i);r.css("borderBottom","1px solid rgba(185, 185, 185, 0.7)");let l=$("<ul/>",{id:"items-list-traits",css:{display:"none",paddingLeft:"20px"}});let s=$("<div/>",{id:"toggle-leaderTrait"+e,text:j("$village.trait.filter.all"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});for(a in window["com"]["nuclearunicorn"].game.village.Kitten().traits){l.append(f(a,t))}s.on("click",function(){n.toggle(false);l.toggle()});let n=$("<ul/>",{id:"items-list-jobs",css:{display:"none",paddingLeft:"20px"}});let o=$("<div/>",{id:"toggle-leaderJob"+e,text:j("$village.panel.job"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});for(a in game.village.jobs){n.append(m(a,t))}o.on("click",function(){l.toggle(false);n.toggle()});r.append(s,o,l,n);return r};let m=function(e,t){let a=game.village.jobs;let i=a[e];let r=$("<li/>");let l=$("<label/>",{for:"toggle-leaderJob-"+i.name,text:i.title,css:{cursor:"pointer",textShadow:"3px 3px 4px gray"}});let s=$("<input/>",{id:"toggle-leaderJob-"+i.name,name:"leaderJob",value:i.name,type:"radio"}).data("option",t);if(s.prop("value")===t.leaderJob){s.prop("checked",true)}s.on("change",function(){S("distribute.leaderJob",[i.title]);t.leaderJob=$("input[name='leaderJob']:checked").val();a.forEach(e=>{delete V.items["toggle-leaderTrait-"+e.name]});V.items["toggle-leaderJob-"+t.leaderJob]=true;L()});r.append(s,l);return r};let f=function(e,t){let a=window["com"]["nuclearunicorn"].game.village.Kitten().traits;const i=a[e];const r=$("<li/>");const l=$("<label/>",{for:"toggle-leaderTrait-"+i.name,text:i.title,css:{cursor:"pointer",textShadow:"3px 3px 4px gray"}});const s=$("<input/>",{id:"toggle-leaderTrait-"+i.name,name:"leaderTrait",value:i.name,type:"radio"}).data("option",t);if(s.prop("value")===t.leaderTrait){s.prop("checked",true)}s.on("change",function(){S("distribute.leaderTrait",[i.title]);t.leaderTrait=$(this).val();a.forEach(e=>{delete V.items["toggle-leaderTrait-"+e.name]});V.items["toggle-leaderTrait-"+t.leaderTrait]=true;L()});r.append(s,l);return r};let p=$("#rightColumn");let E=$("<div/>",{id:"ks-options",css:{marginBottom:"10px"}});let P=$("<ul/>");P.append(s("engine"));z.forEach(e=>{P.append(s(e))});let t=function(){const e="1HDV6VEnXH9m8PJuT4eQD7v8jRnucbneaq";let t=$("<li/>",{id:"ks-donate"}).append($("<a/>",{href:"bitcoin:"+e+"?amount=0.00048&label=Kittens Donation",target:"_blank",text:e})).prepend($('<img alt="bit" src="https://s1.ax1x.com/2022/04/30/OSmUAK.png" height="15px" />',{css:{height:"15px",width:"15px",padding:"3px 4px 0 4px",verticalAlign:"bottom"}}));t.css("padding","5px");P.append(t)};t();p.prepend(E.append(P));let a=$("<a/>",{css:{display:"inline-block",textShadow:"3px 3px 4px gray",fontStyle:"italic",transform:"scale(0.85)"},text:O,target:"_blank",href:"https://petercheney.gitee.io/scientists/updateLog.html?v="+(new Date).getDate()});$("#ks-engine").append(a)}let te={other:{},resGain:{},resConsume:{},research:{}};let ae=(e,t,a)=>{if(t){te.other["auto."+e]=null}else{if(!te.other["auto."+e]){Z(j("summary.auto."+e),a);ie("auto."+e)}}};let k=a=>{for(let t in a){let e=a[t];ie(e.name,e.val,"resConsume")}};let W=function(){te={lastyear:game.calendar.year,lastday:game.calendar.day,craft:{},trade:{},build:{},other:{}}};let ie=function(e,t,a){if(t===undefined){t=1}if(a===undefined){a="other"}if(te[a]===undefined){te[a]={}}if(te[a][e]===undefined){te[a][e]=parseFloat(t)}else{te[a][e]+=parseFloat(t)}};let K=function(){if(game.console.messages.length>900){game.clearLog()}let e="=".repeat(24);let t,a,i;let r=te.resGain;for(a in r){let e=r[a];if(!e){continue}i=game.msg("小喵共获得了 "+game.getDisplayValueExt(e)+" "+$I("resources."+a+".title"),null,null,true);$(i.span).css("color","#ff589c")}if(i){game.msg(e,"notice");i=null}let l=te.resConsume;let s=game.resPool.resources;for(let t=s.length-1;t>0;t--){if(!l){break}a=s[t].name;let e=l[a];if(!e){continue}i=game.msg("小喵共消耗了 "+game.getDisplayValueExt(e)+" "+$I("resources."+a+".title"),null,null,true);$(i.span).css("color","#DC143C")}if(i){game.msg(e,"notice")}let n=te.other;for(const g in n){let e=n[g];if(e){e=typeof e==="number"?game.getDisplayValueExt(e):e;d("summary."+g,[e])}}let o=te.research;for(a in o){t=o[a];t=t?"科学家":"";d("summary.tech",[t+"小猫研究了 "+D(a)])}for(a in te.upgrade){t=te.upgrade[a];t=t?"科学家":"";d("summary.upgrade",[t+"小猫发明了 "+D(a)])}let c=["build","faith","craft","craftLeader","trade"];c.forEach(t=>{let a=te[t];for(let e in a){d("summary."+t,[game.getDisplayValueExt(a[e]),D(e)])}});if(te.lastyear&&te.lastday){let e=game.calendar.year-te.lastyear;let t=game.calendar.day-te.lastday;if(t<0){e-=1;t+=400}let a="";if(e>0){a+=e+" ";a+=e===1?j("summary.year"):j("summary.years")}if(t>=0){if(e>0){a+=j("summary.separator")}a+=w(t)+" ";a+=t===1?j("summary.day"):j("summary.days")}d("summary.head",[a])}let u=H.auto.filter;if(!u.enabled||!u.items["craftFilter"].enabled||!u.items["buildFilter"].enabled||game.console.filters["faith"].enabled||game.console.filters["astronomicalEvent"].enabled){i=game.msg("喵喵提示：游戏(珂学家)日志消耗性能比较多");$(i.span).css("color","#ff589c")}W()};W();let G=$("<div/>",{id:"activity-box",css:{display:"inline-block",verticalAlign:"top"}});let _=$("<a/>",{id:"showActivityHref",text:j("summary.show"),href:"#",css:{verticalAlign:"top"}});_.on("click",K);G.append(_);$("#clearLog").append(G);const u=$("<div/>",{id:"important-msg-box",class:"dialog help",css:{display:"none",width:"auto",height:"auto"}});let N=$("<a/>",{text:j("ui.close"),href:"#",css:{position:"absolute",top:"10px",right:"15px"}});N.on("click",function(){u.toggle()});let re=$("<h1/>",{id:"mb-title",text:"test text"});let le=$("<h1/>",{id:"mb-content",text:"test text"});u.append(N,re,le);$("#gamePageContainer").append(u);let se=(e,t)=>{re.html(e);le.html(t);u.toggle()};let I=new v;let g;let ne=()=>{g=$("#toggle-engine");g.on("change",function(){let e=H.auto.engine;if(g.is(":checked")){e.enabled=true;I.start();oe();setTimeout(()=>{if(e.enabled){game.msg("点击小猫总结可以查询干了什么","notice")}},2e3)}else{e.enabled=false;I.stop()}})};ne();let m=H.auto.cache.dataTimer;m["trueYear"]=game.calendar.trueYear();m["ticksTotal"]=game.timer.ticksTotal;m["saveId"]=game.telemetry.guid;m=null;sessionStorage.setItem("options",JSON.stringify(H));J();$("#toggle-style").trigger("change");$("#toggle-donate").trigger("change");if(console&&console.log){console.log(f+" loaded")}game._publish("kitten_scientists/ready",f);let oe=()=>{let e=H.auto.resources;let i;for(let a in e){let t=e[a];if(t.enabled&&t.stock){if(a==="furs"&&t.stock===350){continue}i=true;let e=game.msg($I("resources."+a+".title")+"库存："+game.getDisplayValueExt(t.stock),null,null,true);$(e.span).css("color","#ff589c")}}if(i){Z("小喵的库存：");l("可爱的猫猫珂学家提示挂机尽量别设置库存")}};if(V.reset&&V.reset.reset){V.reset.karmaTotal+=Y["karma"].value-Number(V.reset.karmaLastTime);V.reset.paraonTotal+=Y["paragon"].value-Number(V.reset.paragonLastTime);V.reset.reset=false;se(j("summary.time.reset.title",[V.reset.times]),j("summary.time.reset.content",[V.reset.karmaTotal,V.reset.paragonTotal]));g.prop("checked",true);g.trigger("change");S("reset.after")}else{V.reset={reset:false,times:0,paragonLastTime:0,paragonTotal:0,karmaLastTime:0,karmaTotal:0}}L();const ce=function(){if(!H.auto.engine.enabled&&H.auto.options.items.autoScientists.enabled){let e=H.countdown;if(e===0){g.click();clearInterval(ue);S("reset.after")}else if(e>10){if(e%60===0){S("auto.tip")}if(e%10===0){Q("auto.countdown",[e])}H.countdown-=1}else if(e<=10){S("reset.countdown."+e);H.countdown-=1}}else{clearInterval(ue)}};let ue=setInterval(ce,1e3)};let loadTest=function(){if(typeof gamePage==="undefined"||typeof i18nLang==="undefined"){setTimeout(function(){loadTest()},2e3)}else{let t=game.workshop.upgrades;for(let e in game.workshop.upgrades){game.workshop.metaCache[t[e].name]=t[e]}game.workshop.metaCache["undefined"]=null;delete game.workshop.metaCache["undefined"];run();loadTest=run=null}};loadTest();