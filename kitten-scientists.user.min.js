window.run=function(){var e="15.28",b="小猫珂学家版本"+e;const i="zh"===localStorage["com.nuclearunicorn.kittengame.language"]?"zh":"en",r={en:{"option.observe":"Observe Astro Events","option.festival":"Hold Festivals","option.praise":"Auto Praise","option.autofeed":"Feed Leviathans","option.hunt":"Hunt","option.crypto":"Trade Blackcoin","option.embassies":"Build Embassies (Beta)","option.style":"View Full Width","option.steamworks":"Turn on Steamworks","filter.build":"Building","filter.craft":"Crafting","filter.upgrade":"Upgrading","filter.research":"Researching","filter.trade":"Trading","filter.hunt":"Hunting","filter.praise":"Praising","filter.faithBld":"Order of the Sun","filter.festival":"Festivals","filter.star":"Astronomical Events","filter.misc":"Miscellaneous","dispose.necrocorn":"Kittens disposed of inefficient necrocorns","blackcoin.buy":"Kittens sold your Relics and bought {0} Blackcoins","blackcoin.sell":"Kittens sold your Blackcoins and bought {0} Relics","act.feed":"Kittens fed the Elders. The elders are pleased","act.observe":"Kitten Scientists have observed a star","act.hunt":"Sent {1} on {0} hunts","act.build":"Kittens have built a new {0}","act.builds":"Kittens have built a new {0} {1} times.","act.craft":"Kittens have crafted {0} {1}","act.trade":"Kittens have traded {0}x with {1}","upgrade.space.mission":"Kittens conducted a mission to {0}","upgrade.space":"Kittens conducted a {0}","upgrade.race":"Kittens met the {0}","upgrade.building.pasture":"Upgraded pastures to solar farms!","upgrade.building.aqueduct":"Upgraded aqueducts to hydro plants!","upgrade.building.library":"Upgraded libraries to data centers!","upgrade.building.amphitheatre":"Upgraded amphitheatres to broadcast towers!","upgrade.upgrade":"Kittens have bought the upgrade {0}","upgrade.limited":"Optimize {0}","upgrade.unlimited":"All {0}","upgrade.tech":"Kittens have bought the tech {0}","upgrade.policy":"Kittens have passed {0}","festival.hold":"Kittens begin holding a festival","festival.extend":"Kittens extend the festival","build.embassy":"Built {0} embassy for {1}","build.embassies":"Built {0} embassies for {1}","act.praise":"Praised the sun! Accumulated {0} faith to {1} worship","act.sun.discover":"Kittens have discovered {0}","act.sun.discovers":"Kittens have discovered {0} {1} times.","ui.items":"items","ui.disable.all":"disable all","ui.enable.all":"enable all","ui.craft.resources":"resources","ui.trigger":"trigger","ui.trigger.set":"Enter a new trigger value for {0}. Should be in the range of 0 to 1.","ui.limit":"Limited","ui.trigger.missions.set":"Enter a new trigger value for missions. Should be in the range of 0 to 13. Corresponds to each planet sort","ui.trigger.crypto.set":"Enter a new trigger value for {0}. Corresponds to the amount of Relics needed before the exchange is made.","ui.engine":"Enable Scientists","ui.build":"Bonfire","ui.space":"Space","ui.craft":"Crafting","ui.upgrade":"Unlocking","ui.trade":"Trading","ui.faith":"Religion","ui.time":"Time","ui.options":"Options","ui.filter":"Filters","ui.distribute":"Kitten Resources","ui.max":"Max: {0}","ui.upgrade.upgrades":"Upgrades","ui.upgrade.techs":"Techs","ui.upgrade.races":"Races","ui.upgrade.missions":"Missions","ui.upgrade.buildings":"Buildings","ui.upgrade.policies":"Policies","ui.upgrade.policies.load":"Load","ui.upgrade.policies.show":"Show","ui.faith.addtion":"addition","option.faith.best.unicorn":"Build Best Unicorn Building First","option.faith.best.unicorn.desc":"Include auto Sacrifice Unicorns if tears are not enough to build the best unicorn building","option.faith.transcend":"Auto Transcend","act.transcend":"Spend {0} epiphany, Transcend to T-level: {1}","summary.transcend":"Transcend {0} times","filter.transcend":"Transcend","option.faith.adore":"Auto Adore the Galaxy","act.adore":"Adore the galaxy! Accumulated {0} worship to {1} epiphany","summary.adore":"Accumulated {0} epiphany by adore the galaxy","filter.adore":"Adoring","adore.trigger.set":"Enter a new trigger value for AutoAdore. Should be in the range of 0 to 1.\nKS will AutoAdore if the Solar Revolution Bonus brought by praising the sun once after adore can reach the trigger of maximum.\n\nNote: The solar revolution bonus will diminish after reaching 75% of the maximum.","resources.add":"add resources","resources.clear.unused":"clear unused","resources.stock":"Stock: {0}","resources.consume":"Consume: {0}","resources.del":"del","resources.stock.set":"Stock for {0}","resources.consume.set":"Consume rate for {0}","resources.del.confirm":"Delete resource controls for {0}?","status.ks.enable":"Enabling the kitten scientists!","status.ks.disable":"Disabling the kitten scientists!","status.sub.enable":"Enabled {0}","status.auto.enable":"Enable Auto {0}","status.sub.disable":"Disabled {0}","status.auto.disable":"Disable Auto {0}","trade.limited":"Trading with {0}: limited to only occur when profitable based off relative production time","trade.unlimited":"Trading with {0}: unlimited","trade.seasons":"seasons","trade.season.enable":"Enabled trading with {0} in the {1}","trade.season.disable":"Disabled trading with {0} in the {1}","filter.enable":"Enable {0} Filter","filter.disable":"Disabled {0} Filter","craft.limited":"Crafting {0}: limited to be proportional to cost ratio","craft.unlimited":"Crafting {0}: unlimited","distribute.limited":"Distribute to {0}: stop when reach max","distribute.unlimited":"Distribute to {0}: unlimited","distribute.leaderJob":"Leader Job: {0} ","distribute.leaderTrait":"Choose {0} Leader","distribute.makeLeader":"Make Leader","act.distribute":"Distribute a kitten to {0}","act.distributeLeader":"Make a {0} kitten leader","ui.max.set":"Maximum for {0}","summary.distribute":"Help {0} kittens to find job","filter.distribute":"Distribute","option.promote":"Promote Leader","act.promote":"Kittens' leader has been promoted to rank {0}","filter.promote":"Promote leader","summary.promote":"Promoted leader {0} times","ui.timeCtrl":"Time Control","option.accelerate":"Tempus Fugit","act.accelerate":"Accelerate time!","filter.accelerate":"Tempus Fugit","summary.accelerate":"Accelerate time {0} times","option.time.skip":"Time Skip","act.time.skip":"Kittens combust Time crystal, {0} years skipped!","ui.cycles":"cycles","ui.maximum":"Maximum","time.skip.cycle.enable":"Enable time skip in cycle {0} and allow skip over this cycle","time.skip.cycle.disable":"Disable time skip in cycle {0} and disallow skip over this cycle","time.skip.season.enable":"Enable time skip in the {0}","time.skip.season.disable":"Disable time skip in the {0}","time.skip.trigger.set":"Enter a new trigger value for Time Skip (Combust time crystal). Should be a positive integer.","summary.time.skip":"Skip {0} years","filter.time.skip":"Time Skip","option.time.reset":"Reset Timeline (Danger!)","status.reset.check.enable":"Enable check {0} before Reset Timeline","status.reset.check.disable":"Disable check {0} before Reset Timeline","ui.min":"Min: {0}","reset.check.trigger.set":"Enter a new trigger value for {0}.\n-1 meaning must build this building until exceeding resource limit.","reset.check":"Trigger for {0} : {1}, you have {2}","reset.checked":"All conditions are met, the timeline will restart in next few seconds!","reset.tip":'You can cancel this reset by disable "Kitten Scientists" or "Time Control" or "Reset Timeline"',"reset.countdown.10":"10 - Harvesting catnip","reset.countdown.9":"&nbsp;9 - Sacrificing Unicorns","reset.countdown.8":"&nbsp;8 - Releasing lizards","reset.countdown.7":"&nbsp;7 - Disassembling rail-guns","reset.countdown.6":"&nbsp;6 - Starting time engines","reset.countdown.5":"&nbsp;5 - Melting blackcoins","reset.countdown.4":"&nbsp;4 - Turning off satellite","reset.countdown.3":"&nbsp;3 - Opening temporal rifts","reset.countdown.2":"&nbsp;2 - Boosting the chronoforge","reset.countdown.1":"&nbsp;1 - Time engine start","reset.countdown.0":"&nbsp;0 - Temporal rifts opened!","reset.last.message":"See you next poinciana recurrence","reset.after":"Nice to meet you, the cute Kittens Scientists will serve you","reset.cancel.message":"Timeline Reset canceled.","reset.cancel.activity":"Meoston, We Have a Problem.","summary.time.reset.title":"Summary of the last {0} timelines","summary.time.reset.content":"Gain {0} Karma.<br>Gain {1} Paragon.","ui.close":"close","option.fix.cry":"Fix Cryochamber","act.fix.cry":"Kittens fix {0} Cryochambers","summary.fix.cry":"Fix {0} Cryochambers","summary.festival":"Held {0} festivals","summary.stars":"Observed {0} stars","summary.praise":"Accumulated {0} worship by praising the sun","summary.hunt":"Sent adorable kitten hunters on {0} hunts","summary.embassy":"Built {0} embassies","summary.feed":"Fed the elders {0} necrocorns","summary.tech":"Researched: {0}","summary.upgrade":"Upgraded: {0}","summary.building":"Built: +{0} {1}","summary.sun":"Discovered: +{0} {1}","summary.craft":"Crafted: +{0} {1}","summary.trade":"Traded: {0}x {1}","summary.year":"year","summary.years":"years","summary.separator":" and ","summary.day":"day","summary.days":"days","summary.head":"Summary of the last {0}","summary.show":"Show activity"},zh:{"option.observe":"观测天文现象","option.festival":"举办节日","option.praise":"赞美太阳","option.autofeed":"献祭死灵兽","option.hunt":"派出猎人","option.crypto":"黑币交易","option.embassies":"建造大使馆","option.style":"占满屏幕","option.useWorkers":"启用后台满速珂学家","filter.build":"建筑","filter.craft":"工艺制作","filter.space":"太空相关","filter.upgrade":"工坊升级","filter.research":"科学研究","filter.policy":"政策","filter.upgBld":"营火建筑升级","filter.trade":"贸易","filter.embassy":"大使馆","filter.hunt":"狩猎","filter.praise":"赞美太阳","filter.adore":"赞美群星","filter.transcend":"次元超越","filter.sacrifice":"献祭","filter.faithBld":"太阳教团","filter.accelerate":"光阴似箭","filter.time.skip":"时间跳转","filter.festival":"举办节日","filter.star":"天文现象","filter.distribute":"猫猫分配","filter.leader":"领袖相关","filter.misc":"喵喵喵","dispose.necrocorn":"小猫帮你处理掉了影响效率的多余死灵兽","act.feed":"小猫向利维坦献上祭品。古神很高兴","blackcoin.buy":"小猫花掉 {1} 遗物，加仓了 {0} 黑币","blackcoin.sell":"小猫抛售 {1} 黑币，套现了 {0} 遗物","act.observe":"小猫观测了天文现象{0}","act.hunt":"{0} 波{1}去打猎","act.hunt.unicorn":"小猫急着派出猎人帮独角兽配种，呜呼十连爪ฅ ฅ","act.hunt.trade":"小猫贸易后决定去打猎","act.hunt.mint":"毛皮或羊皮纸处于低储量","act.build":"小猫建造了一个 {0}","act.builds":"小猫建造了 {1} 个新的 {0}","act.craft":" {0} {1}","act.trade":" {1} 交易 {0} 次","upgrade.space.mission":"小猫执行了 {0} 的任务","upgrade.space":"小猫执行了 {0}","upgrade.race":"小猫探险遇到了新的文明：{0}","upgrade.upgrade":"{1}发明了 {0}","upgrade.limited":"优化 {0}","upgrade.unlimited":"全部 {0}","upgrade.tech":"{1}研究了 {0}","upgrade.policy":"小猫通过了 {0} 法案","festival.hold":"呜呼，小猫的节日开始了","festival.extend":"小猫加了一年钟","build.embassy":"在 {1} 设立了 {0} 个大使馆","build.embassies":"在 {1} 设立了 {0} 个大使馆","act.praise":"赞美太阳! 转化 {0} 信仰为 {1} 虔诚","parise.trigger.set":"输入新的赞美太阳的触发值，取值范围为 0 到 1的纯小数\n 当为0.98时且点出太阳革命，若虔诚太少小猫每天赞美太阳","summary.praise.msg":"虔诚的小猫每天都会赞美太阳，直到太阳革命加成大于 {0} % (说你了虔诚太低了!)","act.sun.discover":"小猫在宗教祷告了 {0} ","act.sun.discovers":"小猫在宗教祷告了 {0} {1} 次","act.sun.discovers.leader":"哲学家小猫在宗教祷告了 {0} {1} 次","ui.items":"项目","ui.disable.all":"全部禁用","ui.enable.all":"全部启用","ui.craft.resources":"资源","ui.trigger":"触发条件","ui.trigger.set":"输入新的 {0} 触发条件，取值范围为 0 到 1 的小数。\n\n 触发条件：当前触发资源数量 / 触发资源的上限数量\n鼠标移动到该项目名字上能看到触发资源","ui.trigger.resource":"触发资源为","ui.none":"无","ui.limit":"限制","ui.craftLimit":"AI平衡","ui.upgradesLimit":"优选","ui.trigger.filterGame.set":"设置游戏日志数量上限","ui.trigger.missions.set":"输入一个新的 探索星球 触发值,取值范围为 0 到 13 的整数。\n分别对应13颗星球。\n\n默认优先碧池探索，会暂时跳过沙丘","ui.trigger.crypto.set":"输入一个新的 {0} 触发值，\n支持3个参数：-符号隔开数字参数\n第一个数字：当遗物数量大于触发值才会进行黑币交易\n第二个数字：买入的最高价（超过这价格就不会买了）\n第三个数字：卖出最低的价格。（低于这价格就不会卖出）\n默认10000-881-1060","ui.engine":"启用小猫珂学家","ui.build":"营火","ui.space":"太空","ui.craft":"工艺","ui.upgrade":"升级","ui.trade":"贸易","ui.faith":"宗教","ui.time":"时间","ui.options":"小喵选项","ui.filter":"日志过滤","ui.distribute":"喵喵管理","ui.max":"Max: {0}","msg.catnip":"如果寒冬猫薄荷产量低于0，小猫珂学家会停止消耗猫薄荷","ui.upgrade.upgrades":"工坊升级","ui.upgrade.techs":"科学科技","ui.upgrade.races":"探险者出发!","ui.upgrade.missions":"探索星球","ui.upgrade.buildings":"升级建筑","ui.upgrade.policies":"政策","ui.upgrade.policies.load":"读取","ui.upgrade.policies.show":"列表","ui.faith.addtion":"宗教附加","option.faith.best.unicorn":"自动最佳独角兽建筑","option.faith.best.unicorn.desc":"自动献祭独角兽，并会以独角兽或象牙来决定建造独角兽牧场~象牙塔...太阳尖顶<br>当象牙不足时会切换成象牙模式具体可以点击小猫总结看到(概览还未更新象牙模式)",unicornSacrifice:"小猫让 {0} 个独角兽群返回了天上的维度，收集了 {1} 滴独角兽的眼泪","option.faith.transcend":"自动最佳次元超越","summary.transcend.catnip":"喵喵喵，你也不想次元超越再赞美群星后让小喵饿死吧？（猫薄荷产量将是：{0}）","act.transcend":"消耗 {0} 顿悟，达到次元超越 {1}","summary.transcend":"次元超越了 {0} 次","option.faith.adore":"赞美群星","act.adore":"赞美群星! 转化 {0} 虔诚为 {1} 顿悟","act.adore.last":"下次小猫赞美群星，会等到虔诚大于 {0} ","summary.adore":"赞美群星了 {0} 次，共积累了 {1} 顿悟","summary.adore.catnip":"喵喵喵，你也不想赞美群星后让小喵饿死吧？（猫薄荷产量将是：{0}）","summary.adore.solar":"聪明的小猫已经会算期望了，当太阳革命加成到达：{0}% 后才会赞美群星","summary.adore.last":"下次赞美群星会等到虔诚大于{0} ","adore.trigger.set":"赞美群星再赞美太阳后的太阳革命加成 ≥ 触发条件 * 1000%，\n触发条件取值范围为 0 到 1 的小数（0.001为自动模式）\n\n同时满足以下条件珂学家将自动赞美群星。\n1. 当前信仰 / 信仰上限 ≥ 0.98(赞美太阳触发条件设置0.98配合使用)\n2.有月球前哨\n3.赞美群星后的猫薄荷产量＞0。\n推荐启用该功能多放几个农民，喵喵保护协会不允许饿死喵喵喵\n优先次元超越 => 赞美群星 => 赞美太阳","resources.add":"添加资源","resources.clear.unused":"清除未使用","resources.stock":"库存: {0}","resources.consume":"消耗率: {0}","resources.del":"删除","resources.stock.set":"设置 {0} 的库存","resources.consume.set":"设置 {0} 的消耗率","resources.del.confirm":"确定要取消 {0} 的库存控制?","status.ks.enable":"神说，要有猫猫珂学家!","status.ks.disable":"太敬业了，该歇了","status.sub.enable":"启用 {0}","status.auto.enable":"启用自动化 {0}","status.sub.disable":"禁用 {0}","status.auto.disable":"禁用自动化 {0}","time.game":"猫珂学家等待游戏处理{0} 毫秒","time.ks":"可爱小喵珂学家一共为你服务了 {0} 次，珂学家处理共耗时 {1} 毫秒，平均耗时 {2} 毫秒","trade.limited":"贸易获得数量大于产量时才与 {0} 贸易，次数自动限制","trade.limitedTitle":"根据产量和贸易获得数量","trade.unlimited":"{1}与 {0} 的 贸易","trade.seasons":"季节","trade.season.enable":"启用在 {1} 与 {0} 的贸易","trade.season.disable":"停止在 {1} 与 {0} 的贸易","trade.catnip":"ฅ'ω'ฅ，你也不想让小喵饿死吧？与鲨鱼贸易喽","filter.enable":"过滤 {0}","filter.disable":"取消过滤 {0}","craft.force":"为了研究{1}，喵喵偷偷拿了资源合成了{0}，她才不会心痛了","craft.forceSteel":"小猫为了工坊升级{0}，偷偷多使用了一些材料合成了钢","craft.limited":"平衡{0}（理解为小猫AI控制触发条件、消耗率，挂机效率会比较高）","craft.limitedTitle":"根据原材料和目标材料的数量","craft.unlimited":"触发资源：{1}{0}","craft.winterCatnip":"呐呐呐，你也不想让寒冬时小喵饿死吧？喵粮上交","distribute.limited":"分配 {0} 不会超过Max","distribute.leaderJob":"领袖工作为 {0} ","distribute.leaderTrait":"领袖的特质为 {0} ","distribute.unlimited":"分配 {0} 允许超过MAX","distribute.makeLeader":"分配领袖","act.distribute":"抓住一只空闲猫猫分配为 {0}","act.distribute.catnip":"担心你的猫猫没有猫薄荷吸并强制分配到农民","act.distributeLeader":"分配一只 {0} 猫猫领袖","ui.max.set":"设置 {0} 的最大值","summary.distribute":"帮助 {0} 只偷吃猫薄荷的猫猫找到工作","set.leader":"{0}，喵喵喵！","option.promote":"提拔领袖小猫","act.promote":"花费了 {1} 黄金，小猫领袖被提拔到 {0} 级","summary.promote":"提拔领袖 {0} 次","ui.trigger.useWorkers.alert":"比如天文事件没观测、烧水晶慢，珂学家后台大概10才运行1次\n勾选将会在后台满速运行，注意会导致使用内存增多。\n电脑不好、内存< 8G的建议禁用\n推荐过滤全部日志会减少性能的消耗。\n\n需满足浏览器支持且游戏选项的web worker启用。\n确认后会自动重新勾选启用珂学家","ui.timeCtrl":"时间操纵","option.accelerate":"光阴似箭","act.accelerate":"固有时制御，二倍速!","act.accelerate.acl":"抓稳了，猫猫要开始加速了!","act.accelerate.slow":"不行了，要减速了","summary.accelerate":"小猫加速时间 {0} 次","option.time.skip":"时间跳转","act.time.skip":"燃烧时间水晶, 跳过接下来的 {0} 年!","ui.cycles":"周期","ui.maximum":"单次数量","time.skip.cycle.enable":"启用在 {0} 跳转时间并允许跳过该周期","time.skip.cycle.disable":"停止在 {0} 跳转时间并禁止跳过该周期","time.skip.season.enable":"启用在 {0} 跳转时间","time.skip.season.disable":"停止在 {0} 跳转时间","time.skip.trigger.set":"拥有时间水晶数量大于该触发值才会燃烧时间水晶，取值范围为正整数。\n注意会计算时间水晶库存\n周期默认全勾就行，珂学家会自动判断是否停在红月\n每2秒烧水晶次数固定为 0.04x时计炉(无千禧年0.02)，故单次数量进一法就行\n如果资源回复后资源一直是满的，建议过滤大部分日志\n\n故长挂推荐：触发条件500，单次数量1，周期全勾","summary.time.skip":"跳过 {0} 年","option.time.reset":"重启时间线 (弃用)","status.reset.check.enable":"在重启时间线前检查 {0}","status.reset.check.disable":"在重启时间线前不检查 {0}","ui.min":"Min: {0}","reset.check.trigger.set":"为 {0} 设置新的触发值.\n-1 表示必须将此建筑建造至超过资源上限为止","reset.check":"{0} 的触发值: {1}, 现在共有 {2}","reset.checked":"所有条件都已满足，时间线将在几秒后重启!","reset.tip":'你可以通过取消 "启用小猫珂学家" 或 "时间操控" 或 "重启时间线" 以取消此次重启',"reset.countdown.10":"10 - 正在收获猫薄荷","reset.countdown.9":"&nbsp;9 - 正在献祭独角兽","reset.countdown.8":"&nbsp;8 - 正在放生蜥蜴","reset.countdown.7":"&nbsp;7 - 正在拆解电磁炮","reset.countdown.6":"&nbsp;6 - 正在启动时间引擎","reset.countdown.5":"&nbsp;5 - 正在融化黑币","reset.countdown.4":"&nbsp;4 - 正在关闭卫星","reset.countdown.3":"&nbsp;3 - 正在打开时空裂隙","reset.countdown.2":"&nbsp;2 - 正在启动时间锻造","reset.countdown.1":"&nbsp;1 - 时间引擎已启动!","reset.countdown.0":"&nbsp;0 - 时空裂缝已打开!","reset.last.message":"我们下个庞加莱回归再见","reset.after":"初次见面，可爱的猫猫珂学家为您服务","reset.cancel.message":"重启时间线计划取消.","reset.cancel.activity":"喵斯顿，我们有麻烦了.","summary.time.reset.title":"过去 {0} 个时间线的总结","summary.time.reset.content":"获得 {0} 业.<br>获得 {1} 领导力.","ui.close":"关闭","auto.countdown":"{0} 秒后将会自动启用珂学家","auto.tip":'你可以通过取消 "首次自启珂学家" 以取消此次自动开启',"option.fix.cry":"修复冷冻仓","act.fix.cry":"小猫修复了 {0} 个冷冻仓","summary.fix.cry":"修复了 {0} 个冷冻仓","summary.auto.academy":"小猫当科学快满了才会继续建造研究院","summary.auto.biolab":"小猫为了节省合金发展，轨道测地学前不建造，太空制造前生物实验室优先级降低","summary.auto.bls":"小猫存眼泪提炼悲伤(当然是在幸福度边上)","summary.auto.broadcastTower":"小猫为了节省钛用来发展，太空制造解锁后建造更多的广播塔","summary.auto.caravanserai":"储存黄金为了商队驿站。~打败斑马的第一步","summary.auto.changeLeader":"如需对应项目-自动切换对应领袖特质<br>比如工艺项目切换到工匠合成更多材料、升级切换到科学家减少科学价格等等<br>但需同时勾选 提拔领袖小猫 和喵喵管理以及里面的 分配领袖","summary.auto.craftLimited":"每次运行都会合成工艺(即无视触发条件)，数量AI自动。挂机发展速度会远大于触发条件的。","summary.auto.crossbow":"铁当然是要来用来改良弩，喵用喵说好","summary.auto.harbor":"港口需要的金属板太多，小猫会少造亿点点(一定是斑马的阴谋","summary.auto.hunter":"未发明弩和导航学，小猫当猎人欲望降低","summary.auto.ironFactory":"如果钢的合成数量偏少，推荐关闭煅烧炉的自动化","summary.auto.ironwood":"喵喵喵把铁收起来，希望住上向往的铁木小屋","summary.auto.kittens":"计划生育! 猫粮产量不够了","summary.auto.ksHelp":"为了游戏可玩性，并没有给萌新开放过多智能项目，随着猫猫的发展珂学家默认下会越来越智能喵","summary.auto.lag":"喵喵砖家提示你，燃烧时间水晶：最好不要设置工程师、在挑战页面挂机可以减少卡顿","summary.auto.leader":"喵喵自觉顶替领袖，做特质相关项目。（领袖特质的具体效果可以参考右下角：百科-游戏标签-村庄-猫口普查）","summary.auto.leaderPriest":"已经是成熟的小猫了，该学会好好念经了，领袖职业改为牧师","summary.auto.lower":"未研究轨道测地学，小猫为了发展更快，故降低牧场、水渠、图书馆、研究院、粮仓、港口、油井、仓库的优先度","summary.auto.lumberMill":"喵喵觉得木头已经发展好了，减少木材厂的建造","summary.auto.magnetos":"也许没有石油了导致磁电机自动关机，小猫还是选择打开了它","summary.auto.marker":"没有黑金字塔小猫拒绝了神印的建造","summary.auto.mansion":"小猫为了节省钛和钢用来发展，宅邸优先度降低（2倍多资源）","summary.auto.oxidation":"别急，你先别急，小猫为了氧化反应把钢全存起来了","summary.auto.parchment":"还未研究地质学，毛皮用不了那么多，喵喵喵把毛皮存起来了","summary.auto.pasture":"喵喵喵嫌弃了牧场，木材还是用来发展的好（真的是最后1个了","summary.auto.religion":"大教堂前继续限制神殿和交易所(如果有问题的话","summary.auto.reinforcedSaw":"用铁给木材厂升级换成加强锯，更加锋利的捏","summary.auto.scholar":"科学产量可能有点不够，学者猫咪数量上限增至24~","summary.auto.steamworks":"小猫曰：蒸汽工房要与磁电机成双成对","summary.auto.templars":"没有足够的黄金和铁产量拿什么祷告圣殿骑士呢","summary.auto.temple":"祷告太阳革命后才会建造神殿，真的不是偷懒喵","summary.auto.tradepost":"祷告太阳革命前，交易所开摆","summary.auto.workshop":"工坊只是解锁升级的 猫玩具罢了，现在小猫只愿意造1个工坊哦","summary.auto.sattelite":"小猫足够虔诚，于是会先造卫星回回血","summary.auto.scienceBld":"天文台、研究院、生物实验室科学上限快满了才会建造。","summary.auto.spaceTrigger":"小猫发展飞快，把星图留给探索碧池星","summary.auto.steelSaw":"小喵存着钢给木材厂换精钢锯，更加锋利了喵","summary.auto.smelter":"神学前，冶炼专精的小猫会根据木材和矿物产量来控制熔炉上限","summary.auto.tear":"小喵都做了什么?! 独角兽的眼泪加小猫幸福度的捏","summary.auto.unicorn":"最佳独角兽建筑：{0}","summary.auto.upgPasture":"当勾选太阳能发电站了，并有足够钛的产量、且缺电、且猫薄荷产量足够高时，小猫会贴心的帮你卖出全部牧场后，升级太阳能发电站!","summary.auto.upgAqueduct":"当勾选水电站了，有太阳能发电站、且缺电、且猫薄荷产量足够高时，小猫会贴心的帮你卖出全部水渠后，升级水电站!","summary.auto.upgLibrary":"当勾选数据中心了，概要数量大于 150X图书馆数量 时，小猫会贴心的帮你卖出全部图书馆后，升级数据中心!","summary.auto.upgAmphitheatre":"当有贸易船或者钛产量足够高时，小猫会贴心的帮你卖出全部剧场后，升级广播塔!","summary.upgrade.building.pasture":"卖出牧场 并升级为 太阳能发电站 !","summary.upgrade.building.aqueduct":"卖出水渠 并升级为 水电站 !","summary.upgrade.building.library":"卖出图书馆 并升级为 数据中心!","summary.upgrade.building.amphitheatre":"卖出剧场 并升级为 广播塔!","summary.resource":"小猫自动调整资源: {0} 的消耗率","summary.moon":"小猫停在红月周期散热 {0} 次","summary.time.skip.moon":"由于燃烧时间水晶支出大于收入，小猫决定攒难得素，停留在红月 {0} 次!","summary.blackcoin.buy":"小猫出售遗物并买入 {0} 次黑币","summary.blackcoin.sell":"小猫出售黑币并买入了 {0} 次遗物","summary.accelerator":"电量寄了，大概只有加速器能关闭了（不会影响库存","summary.catnip":"呐，你的猫猫没有猫薄荷吸并强制分配 {0} 个农民","summary.calciner":"小猫因为你工坊升级了钢铁工厂，故关闭了煅烧炉自动化（其效果铁和煤转化钢没有100%~具体右下角参考百科）（她真的好温柔，😭）","summary.mint":"秋梨膏别开铸币厂了（其转化效率与喵力上限有关，打猎会获得更多的毛皮，具体右下角参考百科 游戏标签-其它建筑-铸币厂，）","summary.pumpjack":"小猫担心冬季电不够并关闭了 {0} 次油井自动化","summary.biolab":"小猫担心冬季电不够并关闭了 {0} 个生物实验室(关了后科学上限和科学加成还会加成)","summary.biolab.test":" {0} 个生物实验室(非常没用的工坊升级)","summary.temporalAccelerator":"小猫担心卡顿打开了时空加速器的自动化","summary.reactor":"小猫向反应堆投入了铀开始发光呐","summary.factory":"小猫为了空间的发展，把工厂全部启用呐","summary.steamworks":"小猫向蒸汽工房加了煤开始排蒸汽呐","summary.breweryOn":"已举办文化节，喵星人重新打开了酿酒厂~嗝","summary.breweryOff":"节日没呐，小猫拒奢守俭，暂时关闭了酿酒厂","summary.brewery":"小猫根据节日调整了 {0} 次酿酒厂","summary.chronocontrolOn":"小猫开启了时间操纵延长时间悖论的持续天数","summary.chronocontrolOff":"小猫关闭了时间操纵节省电力","summary.chronocontrol":"小猫根据时间悖论调整了 {0} 次时间操纵","summary.festival":"举办了 {0} 次节日","summary.stars":"观测了 {0} 次天文事件","summary.praise":"赞美太阳了 {0} 次，共积累了 {1} 虔诚","summary.hunt":"派出了 {0} 批可爱的小猫","summary.hunt.manager":"管理者领袖派出了 {0} 批可爱的小猫","summary.embassy":"设立了 {0} 个大使馆","summary.feed":"向利维坦献祭 {0} 只死灵兽","summary.tech":"{0}","summary.upgrade":"{0}","summary.build":"建造了 {0} 个 {1}","summary.faith":"{1} {0} 次","summary.craft":"制作了{0} 个 {1}","summary.craftLeader":"工匠制作了 {0} 个 {1}","summary.craftManuscript":"小猫偷偷使用了 {0} 次材料合成手稿，为了科学","summary.craftCompedium":"小猫偷偷使用了 {0} 次材料合成概要，为了科学","summary.craftBlueprint":"小猫偷偷使用了 {0} 次材料合成蓝图，为了科学","summary.trade":"{1} 贸易了 {0} 次","summary.year":"年","summary.years":"年","summary.separator":" ","summary.day":"天","summary.days":"天","summary.head":"猫国过去 {0} 的总结","summary.show":"小猫总结"}},H=(r[i]||(console.error(i+" not found"),r[i]=r.en),function(e,a){if("$"===e[0])return $I(e.slice(1));let t=r[i][e];if(void 0===t){if(!(t=r.en[e]))return console.error('key "'+e+'" not found'),"$"+e;console.error('Key "'+e+'" not found in '+i)}if(a)for(let e=0;e<a.length;e++)t=t.replace("{"+e+"}",a[e]);return t}),_={debug:!1,interval:2e3,msgcolor:"#aa50fe",summarycolor:"#009933",activitycolor:"#E65C00",stockwarncolor:"#DD1E00",copyTrait:!1,countdown:120,renderTime:0,consume:.6,auto:{engine:{enabled:!1},unicorn:{items:{unicornPasture:{require:!1,enabled:!0,variant:"zp",label:H("$buildings.unicornPasture.label"),checkForReset:!0,triggerForReset:-1},unicornTomb:{require:!1,enabled:!1,variant:"z",label:H("$religion.zu.unicornTomb.label"),checkForReset:!0,triggerForReset:-1},ivoryTower:{require:!1,enabled:!1,variant:"z",label:H("$religion.zu.ivoryTower.label"),checkForReset:!0,triggerForReset:-1},ivoryCitadel:{require:!1,enabled:!1,variant:"z",label:H("$religion.zu.ivoryCitadel.label"),checkForReset:!0,triggerForReset:-1},skyPalace:{require:!1,enabled:!1,variant:"z",label:H("$religion.zu.skyPalace.label"),checkForReset:!0,triggerForReset:-1},unicornUtopia:{require:"gold",enabled:!1,variant:"z",label:H("$religion.zu.unicornUtopia.label"),checkForReset:!0,triggerForReset:-1},sunspire:{require:"gold",enabled:!1,variant:"z",label:H("$religion.zu.sunspire.label"),checkForReset:!0,triggerForReset:-1}}},faith:{enabled:!1,trigger:0,transcendCatnip:0,adoreCatnip:0,addition:{bestUnicornBuilding:{enabled:!0,misc:!0,label:H("option.faith.best.unicorn"),confirm:0},autoPraise:{enabled:!0,misc:!0,label:H("option.praise"),subTrigger:.98,msg:0,time:0,expect:0},adore:{enabled:!0,misc:!0,label:H("option.faith.adore"),subTrigger:.001},transcend:{enabled:!0,misc:!0,label:H("option.faith.transcend")}},items:{marker:{require:"unobtainium",enabled:!1,max:-1,variant:"z",checkForReset:!0,triggerForReset:-1},unicornGraveyard:{require:!1,enabled:!1,max:-1,variant:"z",checkForReset:!0,triggerForReset:-1},unicornNecropolis:{require:!1,enabled:!1,max:-1,variant:"z",checkForReset:!0,triggerForReset:-1},blackPyramid:{require:"unobtainium",enabled:!0,max:-1,variant:"z",checkForReset:!0,triggerForReset:-1},solarchant:{require:"faith",enabled:!0,max:-1,variant:"s",checkForReset:!0,triggerForReset:-1},scholasticism:{require:"faith",enabled:!0,max:3,variant:"s",checkForReset:!0,triggerForReset:-1},goldenSpire:{require:"faith",enabled:!0,max:-1,variant:"s",checkForReset:!0,triggerForReset:-1},sunAltar:{require:"faith",enabled:!0,max:-1,variant:"s",checkForReset:!0,triggerForReset:-1},stainedGlass:{require:"faith",enabled:!0,max:1,variant:"s",checkForReset:!0,triggerForReset:-1},solarRevolution:{require:"faith",enabled:!0,max:1,variant:"s",checkForReset:!0,triggerForReset:-1},basilica:{require:"faith",enabled:!0,max:5,variant:"s",checkForReset:!0,triggerForReset:-1},templars:{require:"faith",enabled:!0,max:6,variant:"s",checkForReset:!0,triggerForReset:-1},apocripha:{require:"faith",enabled:!0,max:1,variant:"s",checkForReset:!0,triggerForReset:-1},transcendence:{require:"faith",enabled:!0,max:1,variant:"s",checkForReset:!0,triggerForReset:-1},blackObelisk:{require:!1,enabled:!1,max:-1,variant:"c",checkForReset:!0,triggerForReset:-1},blackNexus:{require:!1,enabled:!1,max:-1,variant:"c",checkForReset:!0,triggerForReset:-1},blackCore:{require:!1,enabled:!1,max:-1,variant:"c",checkForReset:!0,triggerForReset:-1},singularity:{require:!1,enabled:!1,max:-1,variant:"c",checkForReset:!0,triggerForReset:-1},blackLibrary:{require:!1,enabled:!1,max:-1,variant:"c",checkForReset:!0,triggerForReset:-1},blackRadiance:{require:!1,enabled:!1,max:-1,variant:"c",checkForReset:!0,triggerForReset:-1},blazar:{require:!1,enabled:!1,max:-1,variant:"c",checkForReset:!0,triggerForReset:-1},darkNova:{require:!1,enabled:!1,max:-1,variant:"c",checkForReset:!0,triggerForReset:-1},holyGenocide:{require:!1,enabled:!1,max:-1,variant:"c",checkForReset:!0,triggerForReset:-1}}},build:{enabled:!1,trigger:0,items:{field:{require:"catnip",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},workshop:{require:"minerals",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},factory:{require:"titanium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},hut:{require:"wood",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},logHouse:{require:"minerals",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},mansion:{require:"titanium",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},steamworks:{require:!1,enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},magneto:{require:!1,enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},reactor:{require:"titanium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},smelter:{require:"minerals",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},calciner:{require:"titanium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},mine:{require:"wood",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},lumberMill:{require:"minerals",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},oilWell:{require:"coal",enabled:!0,max:200,checkForReset:!0,triggerForReset:-1},quarry:{require:!1,enabled:!0,max:300,checkForReset:!0,triggerForReset:-1},observatory:{require:"iron",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},academy:{require:"wood",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},biolab:{require:"science",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},library:{require:"wood",enabled:!0,max:-1,stage:0,checkForReset:!0,triggerForReset:-1},dataCenter:{require:!1,enabled:!0,max:150,stage:1,name:"library",checkForReset:!0,triggerForReset:-1},pasture:{require:"catnip",enabled:!0,max:150,stage:0,checkForReset:!0,triggerForReset:-1},solarFarm:{require:"titanium",enabled:!0,max:-1,stage:1,name:"pasture",checkForReset:!0,triggerForReset:-1},aqueduct:{require:"minerals",enabled:!0,max:250,stage:0,checkForReset:!0,triggerForReset:-1},hydroPlant:{require:"titanium",enabled:!0,max:-1,stage:1,name:"aqueduct",checkForReset:!0,triggerForReset:-1},amphitheatre:{require:"minerals",enabled:!0,max:60,stage:0,checkForReset:!0,triggerForReset:-1},broadcastTower:{require:"titanium",enabled:!0,max:-1,stage:1,name:"amphitheatre",checkForReset:!0,triggerForReset:-1},chapel:{require:"minerals",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},temple:{require:"gold",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},mint:{require:"gold",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},tradepost:{require:"gold",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},ziggurat:{require:!1,enabled:!0,max:110,checkForReset:!0,triggerForReset:-1},chronosphere:{require:"unobtainium",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},aiCore:{require:!1,enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},brewery:{require:!1,enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},barn:{require:"wood",enabled:!0,max:15,checkForReset:!0,triggerForReset:-1},harbor:{require:!1,enabled:!0,max:200,checkForReset:!0,triggerForReset:-1},warehouse:{require:!1,enabled:!0,max:200,checkForReset:!0,triggerForReset:-1},accelerator:{require:"titanium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},zebraOutpost:{require:"bloodstone",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},zebraWorkshop:{require:"bloodstone",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},zebraForge:{require:"bloodstone",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1}}},space:{enabled:!1,trigger:0,items:{spaceElevator:{require:"unobtainium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},sattelite:{require:"titanium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},spaceStation:{require:"oil",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},moonOutpost:{require:"uranium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},moonBase:{require:"unobtainium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},planetCracker:{require:"science",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},hydrofracturer:{require:"science",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},spiceRefinery:{require:"science",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},researchVessel:{require:"titanium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},orbitalArray:{require:"science",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},sunlifter:{require:"science",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},containmentChamber:{require:"science",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},heatsink:{require:"thorium",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},sunforge:{require:!1,enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},cryostation:{require:"eludium",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},spaceBeacon:{require:"antimatter",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},terraformingStation:{require:"antimatter",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},hydroponics:{require:"kerosene",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},hrHarvester:{require:"antimatter",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},entangler:{require:"antimatter",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},tectonic:{require:"antimatter",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},moltenCore:{require:"uranium",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1}}},time:{enabled:!1,trigger:0,items:{temporalBattery:{require:!1,enabled:!1,max:0,variant:"chrono",checkForReset:!0,triggerForReset:-1},blastFurnace:{require:!1,enabled:!1,max:-1,variant:"chrono",checkForReset:!0,triggerForReset:-1},timeBoiler:{require:!1,enabled:!1,max:-1,variant:"chrono",checkForReset:!0,triggerForReset:-1},temporalAccelerator:{require:!1,enabled:!1,max:1,variant:"chrono",checkForReset:!0,triggerForReset:-1},temporalImpedance:{require:!1,enabled:!1,max:-1,variant:"chrono",checkForReset:!0,triggerForReset:-1},ressourceRetrieval:{require:!1,enabled:!1,max:-1,variant:"chrono",checkForReset:!0,triggerForReset:-1},temporalPress:{require:!1,enabled:!1,max:0,variant:"chrono",checkForReset:!0,triggerForReset:-1},cryochambers:{require:!1,enabled:!1,max:-1,variant:"void",checkForReset:!0,triggerForReset:-1},voidHoover:{require:"antimatter",enabled:!1,max:-1,variant:"void",checkForReset:!0,triggerForReset:-1},voidRift:{require:!1,enabled:!1,max:-1,variant:"void",checkForReset:!0,triggerForReset:-1},chronocontrol:{require:"temporalFlux",enabled:!1,max:-1,variant:"void",checkForReset:!0,triggerForReset:-1},voidResonator:{require:!1,enabled:!1,max:-1,variant:"void",checkForReset:!0,triggerForReset:-1}}},timeCtrl:{enabled:!1,items:{accelerateTime:{enabled:!0,subTrigger:1,misc:!0,label:H("option.accelerate")},timeSkip:{enabled:!0,subTrigger:500,misc:!0,label:H("option.time.skip"),maximum:1,0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,spring:!0,summer:!1,autumn:!1,winter:!1,wait:!1,adore:!1,craft:!1,moonMsg:-1}}},craft:{enabled:!1,trigger:.95,items:{wood:{require:"catnip",max:0,limited:!0,limRat:.5,enabled:!0},beam:{require:"wood",max:0,limited:!0,limRat:.5,enabled:!0},slab:{require:"minerals",max:0,limited:!0,limRat:.5,enabled:!0},steel:{require:"coal",max:0,limited:!0,limRat:.5,enabled:!0},plate:{require:"iron",max:0,limited:!0,limRat:.5,enabled:!0},alloy:{require:"titanium",max:0,limited:!0,limRat:.5,enabled:!0},concrate:{require:!1,max:0,limited:!0,limRat:.5,enabled:!0},gear:{require:!1,max:0,limited:!0,limRat:.5,enabled:!0},scaffold:{require:!1,max:0,limited:!0,limRat:.5,enabled:!0},ship:{require:!1,max:0,limited:!0,limRat:.5,enabled:!0},tanker:{require:!1,max:0,limited:!0,limRat:.5,enabled:!1},parchment:{require:!1,max:0,limited:!1,limRat:.5,enabled:!0},manuscript:{require:"culture",max:0,limited:!0,limRat:.5,enabled:!0},compedium:{require:"science",max:0,limited:!0,limRat:.5,enabled:!0},blueprint:{require:"science",max:0,limited:!0,limRat:.5,enabled:!0},kerosene:{require:"oil",max:0,limited:!0,limRat:.5,enabled:!0},megalith:{require:!1,max:0,limited:!0,limRat:.5,enabled:!0},eludium:{require:"unobtainium",max:0,limited:!0,limRat:.5,enabled:!0},thorium:{require:"uranium",max:0,limited:!1,limRat:.5,enabled:!0}},autoConsume:{}},trade:{cache:!1,enabled:!1,trigger:.98,items:{dragons:{enabled:!1,require:"titanium",allowCapped:!1,limited:!0,summer:!1,autumn:!0,winter:!0,spring:!0},zebras:{enabled:!0,require:!1,allowCapped:!1,limited:!0,summer:!0,autumn:!0,winter:!0,spring:!0},lizards:{enabled:!1,require:"minerals",allowCapped:!1,limited:!0,summer:!0,autumn:!1,winter:!1,spring:!1},sharks:{enabled:!1,require:"iron",allowCapped:!1,limited:!0,summer:!1,autumn:!1,winter:!0,spring:!1},griffins:{enabled:!0,require:"wood",allowCapped:!1,limited:!0,summer:!1,autumn:!0,winter:!1,spring:!1},nagas:{enabled:!0,require:!1,allowCapped:!1,limited:!0,summer:!1,autumn:!1,winter:!1,spring:!0},spiders:{enabled:!0,require:!1,allowCapped:!1,limited:!0,summer:!0,autumn:!0,winter:!0,spring:!0},leviathans:{enabled:!0,require:"unobtainium",allowCapped:!0,limited:!0,summer:!0,autumn:!0,winter:!0,spring:!0}}},upgrade:{enabled:!1,items:{techs:{enabled:!0,limited:!0},upgrades:{enabled:!0,limited:!0,cache:!1},policies:{enabled:!1},races:{enabled:!0},missions:{enabled:!0,subTrigger:4},buildings:{enabled:!0}}},options:{catnipMsg:0,enabled:!0,items:{style:{enabled:!0,misc:!0,label:H("option.style")},hunt:{enabled:!0,subTrigger:.97,require:"manpower",misc:!0,label:H("option.hunt")},buildEmbassies:{enabled:!0,subTrigger:.94,require:"culture",misc:!0,label:H("option.embassies")},festival:{enabled:!0,misc:!0,label:H("option.festival")},promote:{enabled:!0,misc:!0,label:H("option.promote")},autofeed:{enabled:!0,misc:!0,label:H("option.autofeed")},observe:{enabled:!0,misc:!0,label:H("option.observe")},filterGame:{enabled:!0,subTrigger:300,misc:!0,label:"游戏日志过滤"},crypto:{enabled:!1,subTrigger:1e4,misc:!0,label:H("option.crypto")},fixCry:{enabled:!1,misc:!0,label:H("option.fix.cry")},saves:{enabled:!1,misc:!0,label:"导出配置文件"},donate:{enabled:!1,misc:!0,label:"显示捐赠原作者图标"},useWorkers:{enabled:!1,misc:!0,label:H("option.useWorkers")},wiki:{enabled:!1,misc:!0,label:"珂学家使用说明书（百科链接🐱）"},autoScientists:{enabled:!1,misc:!0,label:"首次自启珂学家"}}},distribute:{religion:!1,enabled:!1,items:{woodcutter:{enabled:!0,max:29,limited:!0},farmer:{enabled:!0,max:1,limited:!0},scholar:{enabled:!0,max:9,limited:!0},hunter:{enabled:!0,max:24,limited:!0},miner:{enabled:!0,max:24,limited:!0},priest:{enabled:!0,max:3,limited:!1},geologist:{enabled:!0,max:40,limited:!0},leader:{enabled:!0,leaderJob:"farmer",leaderTrait:"manager"}}},filter:{enabled:!1,console:{},items:{buildFilter:{enabled:!1,label:H("filter.build")},researchFilter:{enabled:!1,label:H("filter.research")},upgradeFilter:{enabled:!1,label:H("filter.upgrade")},craftFilter:{enabled:!1,label:H("filter.craft")},spaceFilter:{enabled:!1,label:H("filter.space")},policyFilter:{enabled:!1,label:H("filter.policy")},upgBldFilter:{enabled:!1,label:H("filter.upgBld")},tradeFilter:{enabled:!1,label:H("filter.trade")},embassyFilter:{enabled:!1,label:H("filter.embassy")},huntFilter:{enabled:!1,label:H("filter.hunt")},unicornSacrificeFilter:{enabled:!1,label:H("filter.sacrifice")},faithBuildFilter:{enabled:!1,label:H("filter.faithBld")},faithFilter:{enabled:!1,label:H("filter.praise")},adoreFilter:{enabled:!1,label:H("filter.adore")},transcendFilter:{enabled:!1,label:H("filter.transcend")},accelerateFilter:{enabled:!1,label:H("filter.accelerate")},tcShatterFilter:{enabled:!1,label:H("filter.time.skip")},festivalFilter:{enabled:!1,label:H("filter.festival")},astronomicalEventFilter:{enabled:!1,label:H("filter.star")},distributeFilter:{enabled:!1,label:H("filter.distribute")},leaderFilter:{enabled:!1,label:H("filter.leader")},miscFilter:{enabled:!1,label:H("filter.misc")}}},resources:{furs:{enabled:!0,stock:350,checkForReset:!1,stockForReset:1/0},coal:{enabled:!0,stock:0,consume:1},timeCrystal:{enabled:!1,stock:0,checkForReset:!0,stockForReset:5e5}},policies:[],cache:{dataTimer:{},cacheSum:{},resources:{},trait:{},upgrade:void 0,science:"",resUpg:{}}}};let Y=game.resPool.resourceMap;function l(){let e=Array.prototype.slice.call(arguments);e.push("ks-default"),e.push(_.msgcolor),I(e)}function j(e,a,t){X(H(e,a),t)}const I=function(e){var a=e[1],t=_.auto.filter;if(t.enabled&&a){t=t.items[a];if(t&&t.enabled)return}a=e.pop(),e[1]=e[1]||"ks-default",t=game.msg.apply(game,e);$(t.span).css("color",a),_.debug&&console&&console.log(e)},X=function(){let e=Array.prototype.slice.call(arguments);var a=1<e.length?e.pop():"miscFilter";e.push(a),e.push(_.activitycolor),I(e)},v=function(){const e=Array.prototype.slice.call(arguments);e.push("ks-summary"),e.push(_.summarycolor),I(e)},o=function(){const e=Array.prototype.slice.call(arguments);e.unshift("Warning!"),console&&console.log(e)},B=function(e,a,t){l(H(e,a),t)},k=function(e,a,t){v(H(e,a),t)},W=a=>{let e=_.auto.cache,t=(e.upgrade||(e.upgrade={}),e.upgrade);for(var i in a){t[i]||(t[i]=[]);let e=t[i];for(var r in a[i]){r=a[i][r];-1===e.indexOf(r)&&e.push(r)}}};let Z=e=>{e=Y[e];return e.value/e.maxValue};function f(){this.upgradeManager=new x,this.buildManager=new d,this.spaceManager=new p,this.craftManager=new t,this.bulkManager=new n,this.tradeManager=new y,this.religionManager=new u,this.timeManager=new m,this.villageManager=new a("Village"),this.cacheManager=new R}f.prototype={upgradeManager:void 0,buildManager:void 0,spaceManager:void 0,craftManager:void 0,bulkManager:void 0,tradeManager:void 0,religionManager:void 0,timeManager:void 0,villageManager:void 0,cacheManager:void 0,now:void 0,loop:void 0,huntID:void 0,renderID:void 0,worker:void 0,toolText:void 0,leaderTimer:void 0,time:void 0,start:function(e=!0){var a;_.interval=100*Math.ceil(100/game.getTicksPerSecondUI()),game.isWebWorkerSupported()&&game.useWorkers&&_.auto.options.items.useWorkers.enabled?this.worker||(a=new Blob(["onmessage = function(e) { setInterval(function(){postMessage('miaowu')}, '"+_.interval+"' ); }"]),a=window.URL.createObjectURL(a),this.worker=new Worker(a),this.worker.addEventListener("message",this.iterate.bind(this)),this.worker.postMessage("miaowu"),e&&l("后台珂学家上钟了~ ＞▽＜")):this.loop||(this.loop=setInterval(this.iterate.bind(this),_.interval),e&&B("status.ks.enable"))},stop:function(e=!0){game.isWebWorkerSupported()&&this.worker&&(e&&l("后台珂学家爪巴了"),this.worker.terminate(),this.worker=void 0),this.loop&&(clearTimeout(this.huntID),clearTimeout(this.renderID),clearInterval(this.loop),this.loop=void 0,e&&B("status.ks.disable"))},iterate:async function(){if(game.mobileSaveOnPause&&!game.loadingSave&&!game.isPaused){let e=0;this.time=performance.now();var a=_.auto,t=a.options;t.enabled&&t.items.observe.enabled&&this.observeStars(),t.enabled&&t.items.festival.enabled&&this.holdFestival(),a.timeCtrl.enabled&&(e+=~~this.timeCtrl()),t.enabled&&t.items.autofeed.enabled&&this.autofeed(),a.trade.enabled&&this.trade(),a.upgrade.enabled&&(e+=~~this.upgrade()),a.build.enabled&&(e+=~~this.build()),a.space.enabled&&(e+=~~this.space()),a.faith.enabled&&(e+=~~this.worship()),(0<e||a.cache.upgrade)&&this.gameUpgrade(),a.craft.enabled&&this.craft(),t.enabled&&t.items.hunt.enabled&&this.delay(),a.time.enabled&&(e+=~~this.chrono()),t.enabled&&t.items.crypto.enabled&&this.crypto(),_.copyTrait&&this.setTrait(),t.enabled&&t.items.promote.enabled&&this.promote(),t.enabled&&(e+=~~this.miscOptions()),a.distribute.enabled&&(e+=~~this.distribute()),0<e&&this.delay("render"),this.calculateTime()}},delay:function(e){if(e){let a=dojo.byId("tooltip").textContent;a=a.slice(0,Math.ceil(.4*a.length)),(_.renderTime+6e5<Date.now()||this.toolText!==a)&&(ee("changeLeader",!0,"noFilter"),this.renderID=setTimeout(()=>{var e=game.ui.activeTabId;"Village"!==e&&"Nummon"!==e&&(_.renderTime=Date.now(),this.toolText=a,game.ui.render())},Math.min(197,197-Date.now()+game.timer.timestampStart))),game.updateResources()}else this.huntID=setTimeout(()=>{this.hunt()},.5*_.interval)},reset:async function(){},timeCtrl:function(){const r=_.auto.timeCtrl.items;let l=0;var e;r.accelerateTime.enabled&&game.science.get("calendar").researched&&((e=Y.temporalFlux).value>=Math.max(e.maxValue*r.accelerateTime.subTrigger,1)&&!game.time.isAccelerated&&(game.time.isAccelerated=!0,j("act.accelerate",[],"accelerateFilter"),ae("accelerate",1)),_.interval!==100*Math.ceil(100/game.getTicksPerSecondUI())&&(V.stop(!1),_.auto.engine.enabled&&(2e3===_.interval?j("act.accelerate.acl"):j("act.accelerate.slow"),V.start(!1))));e:if(r.timeSkip.enabled&&game.workshop.get("chronoforge").researched){var o=Y.timeCrystal.value;let i=r.timeSkip.maximum;var n=game.getEffect("heatMax"),s=game.time.heat;if(!i)return 0;var c=game.challenges.getChallenge("1000Years").researched?5:10,g=(s-15*game.getEffect("heatPerTick")<.5*n&&(i=Math.ceil(Math.max(50/c*game.getEffect("heatPerTick")/game.getTicksPerSecondUI(),i))),r.timeSkip.subTrigger),g=Math.max(g,this.craftManager.getStock("timeCrystal"),i),u=game.calendar.cycle,m=game.calendar.year,d=game.calendar.day;if(!(o<g||d<0||!r.timeSkip[u]||n<=s)){g=game.prestige.getPerk("numerology").researched;if(5===u&&r.timeSkip[u]&&g&&game.nummon){var d=game.nummon.getTradeTC(),p=game.calendar.cycleEffectsFestival({unobtainium:1}).unobtainium,h=game.calendar.cycleEffectsBasics({unobtainiumPerTickSpace:1},"moonOutpost").unobtainiumPerTickSpace,b=(56.5+12*game.getEffect("festivalRatio"))/50,f=game.calendar.cycleYear;if(d*b/(p*h)<1||game.getEffect("heatPerTick")<.02){f!==r.timeSkip.moonMsg&&(r.timeSkip.moonMsg=f,j("summary.time.skip.moon",[1]),ae("time.skip.moon",1));break e}}let e=game.timeTab.cfPanel.children[0].children[0];if(!e.model.enabled)return e.controller.updateEnabled(e.model);d=game.calendar.season,b=r.timeSkip.wait,p=game.getEffect("shatterTCGain")*(1+game.getEffect("rrRatio"))<=1&&!1!==b&&5===u;if(!r.timeSkip[game.calendar.seasons[d].name]||p){if(1===b&&5===u){r.timeSkip.wait=game.calendar.year;break e}if(!1===b||b===m||1===b)break e;b!==m&&(r.timeSkip.wait=!1)}var h=4*i*c,f=game.time.heat>game.getEffect("heatMax")-Math.min(h,20*game.time.getCFU("blastFurnace").on+20),v=(r.timeSkip[5]&&g&&!1===r.timeSkip.wait&&f&&(r.timeSkip.wait=1,j("summary.moon",[1]),ae("moon",1)),game.calendar.yearsPerCycle),d=v-game.calendar.cycleYear,k=game.calendar.cyclesPerEra;let a=Math.min(Math.floor((n-s)/c),i),t=0;if(a<d)t=a;else{t+=d,a-=d;let e=1;for(;a>v&&r.timeSkip[(u+e)%k];)t+=v,a-=v,e+=1;r.timeSkip[(u+e)%k]&&0<a&&(t+=a)}if(0<t){if(t=Math.min(t,Math.max(2500,25*game.getEffect("temporalPressCap"))),game.time.getCFU("ressourceRetrieval").val){r.timeSkip.adore=!0,_.auto.options.items.hunt.time=!0;let e=r.timeSkip;if(!e.craft){const x=["catnip","coal","iron","oil","uranium","science"];let a="";x.forEach(e=>{_.auto.craft.autoConsume[e]=!0,a=a+Y[e].title+"，"}),e.craft=!0,X(H("summary.resource",[a]))}}p=game.calendar.year,b=game.time.testShatter;if(1<t&&t<50&&(game.time.testShatter=2,ee("lag",!1,"noFilter")),this.setTrait(),e.controller.doShatterAmt(e.model,t),game.time.testShatter=b,!(t=game.calendar.year-p))return;ae("timeCrystal",o-Y.timeCrystal.value,"resConsume"),l=-100,j("act.time.skip",[t],"tcShatterFilter"),ae("time.skip",t)}}}return l},promote:function(){let e=game.village,a=e.leader;if(game.science.get("civil").researched&&a){e.jobs[5].unlocked&&(a.exp+=.1+5*game.getEffect("skillXP"));var t=_.auto.distribute.items.leader,i=this.leaderTimer;if(t.enabled&&a.trait===t.leaderTrait&&i&&this.leaderTimer++,!(!a.rank&&Y.gold.value<8e3&&i<31&&i)){var i=a.rank,r=this.craftManager.getValueAvailable("gold",!0);if(e.sim.goldToPromote(i,i+1,r)[0]&&1===e.sim.promote(a,i+1)){let e=game.villageTab.censusPanel.census;j("act.promote",[i+1,25+25*i],"leaderFilter"),e.renderGovernment(e.container),e.update(),t.enabled&&a.trait===t.leaderTrait&&(this.leaderTimer=1),ae("gold",25+25*i,"resConsume"),ae("promote",1)}}}},distribute:function(){var a=_.auto.distribute.items,r=a.leader;let l=0,o=game.village;if(r.enabled&&game.science.get("civil").researched&&!game.challenges.isActive("anarchy")&&!_.copyTrait){let t=r.leaderTrait,i=r.leaderJob;r=o.leader;if("farmer"===i&&"manager"===t&&game.getEffect("priceRatio")&&o.getJob("priest").unlocked&&(i="priest",r&&"priest"!==r.job&&ee("leaderPriest")),null===r&&o.sim.kittens.length)return game.villageTab.censusPanel.census.makeLeader(o.sim.kittens[0]);let e=!1;((e=_.auto.upgrade.items.policies.enabled?void 0!==_.policies&&_.policies.some(e=>"theocracy"===e):e)||game.science.getPolicy("theocracy").researched)&&(i="priest");var n=o.getJob(i);if(null==r||r.job!==i||r.trait.name!==t){let a=o.sim.kittens.filter(e=>e.trait.name===t);if(0!==a.length&&n.unlocked&&n.value<o.getJobLimit(i)){let e=a.sort(function(e,a){return a.rank-e.rank==0?a.exp-e.exp:a.rank-e.rank})[0];o.unassignJob(e),e.job=i,o.getJob(i).value++,game.villageTab.censusPanel.census.makeLeader(e),l+=1,j("act.distributeLeader",[H("$village.trait."+t)],"distributeFilter"),ae("distribute",1)}}}r=o.getFreeKittens(),n=o.jobs[4];let e=_.auto.distribute;if(!r){var t=o.getJob("woodcutter").value;if(_.auto.distribute.items.miner.enabled&&n.unlocked&&!n.value&&1<t&&o.sim.kittens.length&&o.sim.removeJob("woodcutter"),!(e.religion&&2<t))return l;o.sim.removeJob("woodcutter")}var n=Y.kittens,t=Y.catnip,i=o.happiness,s=n.value,c=game.science.get("agriculture").researched,g=this.craftManager.getPotentialCatnip(!1),g=g<=.85*i&&s<4||Y.catnip.value+2e3*(g-1.7)<0||0===o.jobs[1].value&&a.farmer.enabled,i=t.value-1800*i*s<0||n.maxValue-s==1||1<r;if(e.religion||g&&c&&i&&t.value<=t.maxValue)return e.religion=!1,o.assignJob(o.getJob("farmer"),1),j("act.distribute.catnip",[],"distributeFilter"),j("act.distribute",[H("$village.job.farmer")],"distributeFilter"),ae("catnip",1),l;let u="",m=1/0;var d=game.religion.getSolarRevolutionRatio();let p=_.auto.faith.addition.autoPraise.expect;var h=game.workshop.get("spaceManufacturing").researched||game.challenges.isActive("blackSky")||1e5<Y.starchart.value&&game.calendar.year<10;p=p&&5<p&&d<.3*p&&o.jobs[5].unlocked;for(let e=o.jobs.length-1;0<=e;e--){var b=o.jobs[e];if(b.unlocked){var f=b.name;if("engineer"!==f){var v=a[f];if(v.enabled){var k=o.getJobLimit(f),b=b.value;if(!(k<=b)){let a=Math.max(0,v.max),e=v.limited;if("hunter"===f?(k=game.getEffect("manpowerJobRatio"))<.5?a=10<o.maxKittens?2:0:k<=.75&&!game.science.get("navigation").researched||p?(a=Math.round(.42*a),!p&&!z.other["auto.hunter"]&&b>=a-1&&(v=game.msg($I("village.job.hunter.flavor"),null,null,!0),$(v.span).css("color","#ff589c"),ee("hunter"))):ee("hunter",!0):game.challenges.isActive("atheism")&&(e=!1),"geologist"===f&&(!(k=game.workshop.get("geodesy").researched)&&Y.iron.perTickCached<50&&(a=Math.round(.5*a)),game.science.get("mechanization").unlocked||k||(a=1),1e5<Y.starchart.value&&!game.diplomacyTab.visible&&(a=1)),"scholar"===f&&e){let e;!game.getEffect("shatterTCGain")&&h&&(e=!0),.3<Z("science")&&b?a=0:e&&b<(a=Math.max(a,24))&&ee("scholar")}"miner"!==f||game.science.get("writing").researched||(a=Math.round(.3*a)),"priest"===f&&1e4<Y.starchart.value&&d<3&&(a=Math.max(a,20)),(!e||b<a)&&(v=b/a)<m&&(m=v,u=f)}}}}}return u&&(o.assignJob(o.getJob(u),1),l=1,j("act.distribute",[H("$village.job."+u)],"distributeFilter"),ae("distribute",1)),l?(game.villageTab.updateTab(),o.updateResourceProduction(),1):void 0},autofeed:function(){var e=game.diplomacy.get("leviathans"),a=Y.necrocorn;e.unlocked&&0<a.value&&e.energy!==game.diplomacy.getMarkerCap()&&(1<=a.value?(game.diplomacy.feedElders(),j("act.feed",[],"unicornSacrificeFilter"),ae("feed",1)):.25*(1+game.getEffect("corruptionBoostRatio"))<1&&(ae("feed",a.value),game.diplomacy.feedElders(),j("dispose.necrocorn")))},crypto:function(){var a=game.calendar.cryptoPrice,t=Y.relic.value,i=Y.blackcoin.value;if(!(!game.science.get("blackchain").researched&&0<!i||!game.diplomacy.get("leviathans").unlocked)){var r=null==_.auto.options.items.crypto.subTrigger?"1e6-860-1060":_.auto.options.items.crypto.subTrigger.toString().split("-");let e=parseFloat(r[0]);var l=parseFloat(r[1]),o=parseFloat(r[2]);if(3!==r.length||!e||!l||!o)return e=e||1e4,_.auto.options.items.crypto.subTrigger=e+"-881-1060",q();a<l&&t>e?(game.diplomacy.buyBcoin(),r=Y.blackcoin.value,l=game.getDisplayValueExt(r-i),j("blackcoin.buy",[l,game.getDisplayValueExt(t)],"tradeFilter"),ae("blackcoin.buy",1)):o<a&&0<Y.blackcoin.value&&(game.diplomacy.sellBcoin(),r=Y.relic.value,l=game.getDisplayValueExt(r-t),j("blackcoin.sell",[l,game.getDisplayValueExt(i)],"tradeFilter"),ae("blackcoin.sell",1))}},worship:function(){var i=_.auto.faith.items;const L=this.buildManager,r=this.craftManager;let D=this.religionManager;const t=_.auto.faith.addition;let l=game.religion,o=0,e,n;var s=game.prestige.getPerk("voidOrder").researched,c=game.time.getCFU("ressourceRetrieval").val;if(t.bestUnicornBuilding.enabled){var g=this.getBestUnicornBuilding(),u=game.bld.get("ziggurat").on,m=Y.tears.value,d=Y.unicorns.value;let e=l.getZU("blackPyramid");var p=l.getZU("sunspire").on;if(g){var h=!m&&1e3<=d&&u&&!game.ironWill;let t;var b=e.getEffectiveValue(game),f=i.blackPyramid.enabled&&e.unlocked,f=1<p&&Y.sorrow.value<5&&!b&&5e3<Y.unobtainium.maxValue&&f;if(f&&(ee("bls"),1e4<=Y.tears.value&&(Y.tears.value-=1e4,Y.sorrow.value+=1,X("小喵把眼泪炼成悲伤"))),"unicornPasture"!==g.name||h||f){let a;if(h)a=1,ee("tear");else for(t=dojo.clone(g.prices),n=0;n<t.length;n++){let e=t[n];e.val*=Math.pow(1.15,g.on),"tears"===e.name&&(e.val+=r.getStock("tears")+.01,a=e.val),"gold"===e.name&&(e.val*=1-game.getEffect("goldCostReduction"))}if(b&&i.marker.enabled&&(b=l.getZU("marker").on,m<(v=5e3*Math.pow(1.15,b))&&p>Math.min(9+b,19)&&(a=Math.min(v,a))),(a=f?1e4:a)>m){p=Math.floor((d-r.getStock("unicorns"))/2500),b=Math.ceil((a-m)/u);if(b<=p){var v=game.religionTab.sacrificeBtn;if(!v||!v.model)return game.religionTab.render();m=v.model.prices[0].val*b;m<d&&(p=u*b,k=v.controller.controllerOpts,game.resPool.addResEvent(v.model.prices[0].name,-m),game.resPool.addResEvent(k.gainedResource,p),game.stats.getStat("unicornsSacrificed").val+=m,ae("unicorns",m,"resConsume"),ae("tears",p,"resGain"),p=game.getDisplayValueExt(p),m=game.getDisplayValueExt(m),game.msg($I(k.logTextID,[m,p]),"notice",k.logfilterID),X(H("unicornSacrifice",[game.getDisplayValueExt(b),p]),"unicornSacrificeFilter"))}}!h&&!f&&game.resPool.hasRes(t)&&u&&(D.build(g.name,"z",1),o=1)}else d>=2*Math.pow(g.priceRatio+game.getEffect("priceRatio"),g.val)&&L.built(g.name,void 0,1)}}else(!Y.alicorn.unlock||t.bestUnicornBuilding.confirm<2)&&($("#toggle-bestUnicornBuilding").click(),t.bestUnicornBuilding.confirm+=1),_.auto.unicorn.items.unicornPasture.enabled&&this.build({unicornPasture:{require:!1,enabled:!0}}),e=JSON.parse(JSON.stringify(_.auto.unicorn.items)),delete(e=Object.assign(e,_.auto.faith.items)).unicornPasture;o+=this._worship(e||i);var v=r.getResource("faith"),m=Z("faith"),k=l.getRU("transcendence"),b=k.on,p=l.transcendenceTier;let x=b?p:0;var y=l.faith;let R=l.faithRatio;h=l.getSolarRevolutionRatio(),f=game.getEffect("solarRevolutionLimit"),u=10+f,t.adore.subTrigger,d=y/1e6*(x+1)*(x+1)*1.01,i=R+d,i=.01+v.value*(1+.1*game.getUnlimitedDR(i,.1)),i=game.getLimitedDR(game.getUnlimitedDR(i,1e3)/100,u);let w=!1;var a=t.autoPraise.enabled,F=t.adore.enabled,O=_.auto.timeCtrl.items.timeSkip.adore,T=O&&a&&F;let M=t.autoPraise.subTrigger;var E=game.space.getBuilding("moonOutpost").val;let S=E&&1e5<=y;var P=l.getRU("apocripha").on,B=x||!R&&2e5<y;S=S&&P&&B&&F;let C=M<.98;B=z.adore[0];if(E&&S&&C&&M&&(t.autoPraise.subTrigger=.98),Math.min(.999,Math.max(.98,M))<=m||T){if(t.transcend.enabled&&b){let t;b=l._getTranscendTotalPrice(x+1)-l._getTranscendTotalPrice(x);let e=this.catnipForReligion(b);for(e=0<=e||e<0&&0<Y.catnip.value+2e3*e,t=10<x?1:x<11&&E&&1e5<y&&P&&e?4:0;t;){R=l.faithRatio,x=l.transcendenceTier;var q=Math.pow((x+2)/(x+1),2),A=l._getTranscendTotalPrice(x+1)-l._getTranscendTotalPrice(x),V=A;let a=l.getTU("blackObelisk").val;q=q*((5*(x+1)*a+1e3)/(5*x*a+1e3)),V=(1-q+Math.sqrt(80*(q*q-1)*V+(q-1)*(q-1)))*q/(40*(1+q)*(1+q)*(q-1))+V+V/(q*q-1),q=R>V&&y>Math.min(1e6*(x-3),0)+1e6,V=2.02*y*x+3.03*y>1e6*A&&R>A;if(q||V){l.faithRatio-=A,l.tcratio+=A,l.transcendenceTier+=1;let e=game.challenges.getChallenge("atheism");e.calculateEffects(e,game),(a=l.getTU("blackObelisk")).calculateEffects(a,game),game.msg($I("religion.transcend.msg.success",[l.transcendenceTier])),(x=l.transcendenceTier)<8&&(w=!0);for(let a=0;a<l.transcendenceUpgrades.length;a++){let e=l.transcendenceUpgrades[a];!e.unlocked&&x>=e.tier&&"mausoleum"!==e.name&&(e.unlocked=!0,o=1)}t--,j("act.transcend",[game.getDisplayValueExt(A),x],"transcendFilter"),ae("transcend",1)}else t=0}}b=game.resPool.isStorageLimited(k.prices);let e=_.auto.faith.items.transcendence;!e.enabled&&y>k.faith&&F&&b&&(e.enabled=!0,I(["小猫贴心得无视超越按钮禁用","ks-default",_.activitycolor]));E=!l.faithRatio||x;let a=this.catnipForReligion();a=0<a||a<0&&0<Y.catnip.value+2e3*a,a=9<p||a;P=game.prestige.getParagonProductionRatio()<2?1+Math.min(2/game.prestige.getParagonProductionRatio(),.3):1,k=.5*Math.log(l.faithRatio)+3.45,F=E<11||c?1.3+Math.min(.6,.06*x)+Math.log1p(f):1.32,b=game.getLimitedDR(P*F*Math.pow(Math.E,.65*k),100*u),p=t.adore.subTrigger;.001===p&&S&&100*h<b&&x&&((E=i<=Math.max(1,Math.min(.01*b-.5,.9*u)))&&(S=!1),f=!c||!s,(b=Math.floor(100*b)/100)!==z.other["adore.solar"]&&f&&E&&(X(H("summary.adore.solar",[b])),z.other["adore.solar"]=b)),((S=S&&.001!==p?10*p<i:S)&&a||w)&&(T&&(_.auto.timeCtrl.items.timeSkip.adore=!1),w=!0,l._resetFaithInternal(1.01),j("act.adore",[game.getDisplayValueExt(y),game.getDisplayValueExt(d)],"adoreFilter"),z.adore[1]+=d,z.adore[0]+=1)}P=.65*(.525*Math.log(l.faithRatio)+3.45);let U=s||B?1:.3;U=U*game.prestige.getPerk("vitruvianFeline").researched?1:.5,U=6<l.getRU("solarchant").on?5:U;F=2e5<Y.starchart.value?90:80,k=game.getLimitedDR(.3*Math.pow(Math.E,P)*U,F*u),t.autoPraise.expect=.01*k,c=l.getRU("solarRevolution").on,f=l.getRU("stainedGlass").on||Y.gold.value<250||v.perTickCached<2||game.getEffect("culturePerTickBase")<.9,E=l.getRU("basilica").on||Y.gold.value<750||v.perTickCached<6||game.getEffect("culturePerTickBase")<2.7,C=!C&&M<=1,c&&C&&h<.01*k&&f&&E&&(M=0),b=1+.1*game.getUnlimitedDR(R,.1),p=v.value>(1e3-y)/b&&y<1e3||v.value>(150-y)/b&&y<150&&!s;if(p&=!h&&!s,a&&m>=M&&.001<v.value&&(m<.98||!s||c)||w||p){C&&!w&&m<.98&&!O&&(Date.now()>t.autoPraise.time+4e5||!z.other["praise.msg"])&&(t.autoPraise.time=Date.now(),i=game.getDisplayValueExt(k),X(H("summary.praise.msg",[i])),z.other["praise.msg"]=i);T=l.getApocryphaBonus(),d=v.value,B=d*(1+T);z.praise[1]+=B,z.praise[0]+=1,ae("faith",d,"resConsume"),j("act.praise",[game.getDisplayValueExt(v.value),game.getDisplayValueExt(B)],"faithFilter"),l.praise();let e=Y.faith;e.value=Math.max(Math.min(Y.faith.maxValue,e.value+2*Y.faith.perTickCached),0)}return o},_worship:function(e){var a=_.auto.faith.items;let t=JSON.parse(JSON.stringify(e||_.auto.faith.items)),i=this.religionManager,r=this.bulkManager,l=game.religion;var e=l.getRU("solarRevolution"),o=(l.faith>e.faith||game.prestige.getPerk("voidOrder").researched)&&750<Y.faith.maxValue&&500<Y.gold.maxValue,n=!e.on&&o&&l.getRU("solarchant").on&&l.transcendenceTier?1.1:_.auto.faith.trigger;this.setTrait("wise"),game.getLimitedDR(.09+.01*(1+game.prestige.getBurnedParagonRatio()),1);if(!e.on&&o&&a.solarRevolution.enabled&&l.faith>e.faith&&i.build("solarRevolution","s",1),!l.getRU("solarchant").on&&100<Y.faith.value&&150<l.faith&&i.build("solarchant","s",1),!game.religion.getRU("sunAltar").on&&l.getRU("basilica").on&&(t.goldenSpire.enabled=!1),!l.getRU("basilica").on&&t.basilica.enabled&&(5e4<game.religion.faith&&(t.sunAltar.enabled=!1,t.goldenSpire.enabled=!1),!game.religion.getRU("stainedGlass").on&&65e3<Y.science.maxValue&&(t.scholasticism.enabled=!1)),game.ironWill||game.workshop.get("orbitalGeodesy").researched||(t.templars.enabled=!1,!l.getRU("templars").on&&75e3<game.religion.faith&&ee("templars")),l.getSolarRevolutionRatio()>9.98+.9*game.getEffect("solarRevolutionLimit")&&game.workshop.get("spaceManufacturing").researched&&z.adore[0]){let e=["scholasticism","goldenSpire","stainedGlass","basilica","templars"];e.forEach(e=>{t[e].max=-1})}var s,o=l.getZU("marker");!l.getZU("blackPyramid").getEffectiveValue(game)&&game.resPool.hasRes(o.prices)&&o.unlocked&&(ee("marker"),t.marker.enabled=!1);let c={};for(s in t){let e=t[s];var g=i.getBuild(s,e.variant),u=g.on&&g.noStackable||l.faith<g.faith;"s"===e.variant&&u&&(e.enabled=!1),"z"!==e.variant||game.bld.getBuildingExt("ziggurat").meta.on||(e.enabled=!1),"c"!==e.variant||game.science.get("cryptotheology").researched||(e.enabled=!1),c[s]=g}var m,d,p=r.bulk(t,c,n);let h=0;for(d in p)0<p[d].count&&(m=l.getRU("solarRevolution").on?p[d].count:1,i.build(p[d].id,p[d].variant,m),h+=1);return h},chrono:function(){if(!game.timeTab.visible||!game.workshop.get("chronoforge").researched)return 0;let e=0;var a=JSON.parse(JSON.stringify(_.auto.time.items));const t=this.timeManager,i=this.bulkManager;var r=_.auto.time.trigger;let l=a.cryochambers;var o=l.max,n=game.bld.get("chronosphere").on+game.getEffect("cryochamberSupport");l.max=-1===o?n:Math.min(n,o);let s=a.ressourceRetrieval;var c,n=s.max;s.max=-1===n?100:Math.min(100,n);const g={};for(c in a){let e=a[c];"chrono"!==e.variant||game.workshop.get("chronoforge").researched||(e.enabled=!1),"void"!==e.variant||game.science.get("voidSpace").researched||(e.enabled=!1),g[c]=t.getBuild(c,e.variant)}var u,m=i.bulk(a,g,r);for(u in m){var d=m[u];0<d.count&&(t.build(d.id,d.variant,d.count),e=1)}return e},upgrade:function(){let i,r,l;const o=_.auto.upgrade.items,a=this.upgradeManager,n=this.craftManager,s=this.bulkManager,c=this.buildManager;var g=game.workshop.get("geodesy").researched,u=game.workshop.get("orbitalGeodesy").researched,t=game.religion.getSolarRevolutionRatio();let m=0;var d=game.bld.getBuildingExt("pasture").meta,p=game.bld.getBuildingExt("aqueduct").meta;if(this.setTrait("scientist"),o.techs.enabled&&game.libraryTab.visible){var U=game.science.techs,e=(o.techs.limited=!0,game.science.get("nanotechnology").researched);e:for(var h of U)if(!h.researched&&h.unlocked){if(o.techs.limited){var b=h.name,f=Y.titanium.value,v=Y.relic.value;switch(b){case"biology":if(f<5e3)continue;break;case"biochemistry":if(f<7e3)continue;break;case"ai":if(f<1e4)continue;break;case"particlePhysics":if(!e&&f<1e3)continue;break;case"oilProcessing":if(!e&&f<1e4)continue;break;case"drama":if(n.getTickVal(Y.parchment,!0)<2)continue;break;case"cryptotheology":if(v<105&&Y.antimatter.value<4e3)continue;break;case"blackchain":if(v<1e6)continue;break;case"antimatter":if(game.workshop.get("chronoforge").researched)break;continue}}var k,b=dojo.clone(h.prices);for(k of game.village.getEffectLeader("scientist",b)){var L=k.name;if(a.getValue(L)<k.val)continue e}m=1,a.build(h,"science")}}if(o.upgrades.enabled&&game.workshopTab.visible){game.workshopTab.domNode||(m=2);var D=game.workshop.upgrades;o.upgrades.limited=!0;let e=[];o.upgrades.limited&&(A=Y.starchart,e=["biofuel","gmo","invisibleBlackHand"],game.getEffect("shatterTCGain")<.05&&e.push("steelPlants"),d.on&&0!==d.stage||(e=e.concat(["photovoltaic","thinFilm","qdot"])),p.on&&0!==p.stage||e.push("hydroPlantTurbines"),(q=game.getEffect("priceRatio"))&&(e.push("register"),q<-.08&&e.push("neuralNetworks")),$=["factoryAutomation","advancedAutomation","pneumaticPress"],C=game.challenges.isActive("pacifism"),game.bld.get("steamworks").on<1+5*q&&!C?(e=e.concat(["printingPress","offsetPress","photolithography"],$),game.bld.get("steamworks").on||e.push("combustionEngine")):game.opts.enableRedshift||(e=e.concat($)),C&&(e=e.concat(["bolas","huntingArmor","steelArmor","alloyArmor","nanosuits"])),(q=game.bld.getBuildingExt("magneto").meta).val&&q.on===q.val&&e.push("carbonSequestration"),game.village.getJob("engineer").value<5&&(e=e.concat(["spaceEngineers","aiEngineers","chronoEngineers","amFission","factoryRobotics","factoryOptimization"])),!t&&750<=Y.faith.maxValue&&1e3<game.religion.faith&&e.push("caravanserai"),game.resPool.energyProd-game.resPool.energyCons<=50&&(e=e.concat(["carbonSequestration","pumpjack"])),game.globalEffectsCached.titaniumPerTickAutoprod<.006&&Y.ship.value<40&&1<t&&(e=e.concat(["titaniumAxe","silos","combustionEngine","astrolabe"])),(8<t||u)&&!game.space.meta[0].meta[3].val&&A.value<1600&&6<t&&(e.push("geodesy"),.8<Z("coal")&&!u&&e.push("fuelInjectors")),t<7&&!g&&400<A.value&&e.push("titaniumSaw"),g||(e=e.concat(["seti","refrigeration"])),Y.oil.value<75e3&&!g&&(e=e.concat(["offsetPress","photolithography"]),.8<Z("coal")&&Z("oil")<.95&&!u&&e.push("fuelInjectors")),game.bld.getBuildingExt("factory").meta.val<3&&e.push("factoryLogistics"),game.workshop.get("mWReactor").researched||(e=e.concat(["eludiumReflectors","amBases","coldFusion","amReactors","cryocomputing"])),0===game.bld.getBuildingExt("library").meta.stage&&(e=e.concat(["starlink","uplink","cryocomputing"])),game.bld.getBuildingExt("accelerator").meta.val<5&&(e=e.concat(["darkEnergy","stasisChambers","voidEnergy","tachyonAccelerators","lhc"])),game.bld.getBuildingExt("aiCore").meta.val<5&&(e=e.concat(["machineLearning","aiBases"])),(!game.bld.getBuildingExt("reactor").meta.val||Y.ship.value<169)&&(e=e.concat(["reactorVessel","enrichedUranium"])),game.space.getBuilding("sattelite").val<6&&(e=e.concat(["solarSatellites","satelliteRadio"])),A.perTickCached?game.challenges.isActive("blackSky")&&A.perTickCached<1&&(e=e.concat(["geodesy"])):e=e.concat(["hubbleTelescope"]),Y.thorium.value<6e4&&e.push("thoriumReactors"),(19e4<Y.science.maxValue&&A.value<2075||Y.titanium.value<5+10*t)&&(e=e.concat(["astrolabe","unobtainiumReflectors","lhc","titaniumMirrors"])),game.challenges.isActive("anarchy")&&(e=e.concat(["logistics","augumentation","internet","neuralNetworks","register"])),game.ironWill?e=e.concat(["logistics","augumentation","internet","neuralNetworks","mineralHoes","ironHoes","miningDrill","mineralAxes","ironAxes","steelAxe","titaniumAxe","alloyAxe","ironwood","concreteHuts","unobtainiumHuts","eludiumHuts","geodesy","register","unobtainiumDrill","assistance","astrophysicists","register"]):game.workshop.get("concreteHuts").researched||(e=e.concat(["concreteWarehouses","concreteBarns"])));e:for(var x of D)if(!x.researched&&x.unlocked){var y=x.name;if(-1===e.indexOf(y)){r=dojo.clone(x.prices);for(l of r=game.village.getEffectLeader("scientist",r))if(a.getValue(l.name,y)<l.val)continue e;m+=1,a.build(x,"workshop")}}}if(o.policies.enabled&&game.libraryTab.visible){var R=game.science.policies;let e=i=0;var O=R.length;const V=[];var I=game.science.get("astronomy").researched?1:3;for(i in _.policies){var w,z=_.policies[i];for(w in R){var F=R[((w=parseInt(w))+e)%O];if(F.name===z){if(e=w+e+1,!F.researched){if(F.blocked)break;F.unlocked&&(void 0===F.requiredLeaderJob||null!=game.village.leader&&game.village.leader.job===F.requiredLeaderJob)&&V.push(F)}break}}}e:for(i of V){for(var T of i.prices)if(n.getValueAvailable(T.name,!0)<T.val*I)continue e;a.build(i,"policy")}}let M=game.spaceTab;if(o.missions.enabled&&M.visible){let a=o.missions.subTrigger;var J=game.space.meta[0].meta.length;let t=game.workshop.get("spaceManufacturing").researched,e=(4===a&&Y.alicorn.value&&t&&1e5<Y.starchart.value&&(a=12),0);var E=!u&&!game.ironWill&&!g,S=M.GCPanel,P=(S||M.render(),game.space.meta[0].meta);e:for(i=0;i<J;i++){var B=P[i];if(B.val&&7!==i&&e++,!(!B.unlocked||B.val||i>=a)){if(E)break;let e=S.children[i];if(!e||!e.model.metadata){M.render();break}if((P[3].val||2!==i||3===a||game.challenges.isActive("blackSky"))&&!e.model.metadata.val&&!e.model.metadata.on){for(l of r=e.model.prices)if(n.getValueAvailable(l.name,!0)<l.val)continue e;e.model.enabled?(e.controller.build(e.model,1),t=2,G(r),7===i||12===i?X(H("upgrade.space.mission",[P[i].label]),"spaceFilter"):X(H("upgrade.space",[P[i].label]),"spaceFilter")):e.controller.updateEnabled(e.model)}}}(M.planetPanels.length!==e&&!E||1<t)&&M.render()}if(o.races.enabled&&game.diplomacy.hasUnlockedRaces()){let a=game.diplomacy.get("leviathans").unlocked?8:7;game.diplomacyTab.racePanels.length<a&&($=function(e){game.diplomacy.get(e).unlocked||1e3<=n.getValueAvailable("manpower",!0)&&(Y.manpower.value-=1e3,a="render",j("upgrade.race",[game.diplomacy.unlockRandomRace().title],"tradeFilter"),ae("manpower",1e3,"resConsume"))},(game.challenges.isActive("pacifism")||!game.village.sim.kittens.length||15<Y.gold.value)&&($("lizards"),$("sharks"),$("griffins")),1500<=Y.culture.value&&$("nagas"),1<=Y.ship.value&&$("zebras"),100<=Y.ship.value&&125e3<Y.science.maxValue&&$("spiders"),game.science.get("nuclearFission").researched&&$("dragons"),game.diplomacyTab.racePanels.length&&"render"!==a||game.diplomacyTab.render())}if(o.buildings.enabled){var C=1===game.calendar.season?game.resPool.energyProd:game.resPool.energyWinterProd,q=C&&C-10<game.resPool.energyCons,A=0===d.stage?d.val:0,t=0===p.stage?p.val:0,u=(e,a)=>{var t=a.stages[1].prices;if(s.singleBuildPossible(a,t,1))return c.sellBuild(e),game.resPool.payPrices(t),a.stage=1,a.on=1,a.val=1,a.upgrades&&(a.updateEffects&&a.updateEffects(a,game),W(a.upgrades)),game.bld.getBuildingExt(e)._metaCache=null,game.bld.getBuildingExt(e)._metaCacheStage=1,c.manager.render(),j("summary.upgrade.building."+e,[],"upgBldFilter"),ae("upgrade.building."+e),ee("upg"+e.charAt(0).toUpperCase()+e.slice(1),!0),2};if(0===d.stage&&d.stages[1].stageUnlocked){var g=1===game.bld.getBuildingExt("amphitheatre").meta.stage,$=q&&g&&25<game.getResourcePerTick("titanium",!0);if(45<n.getPotentialCatnip(!0,0,t)&&$&&_.auto.build.items.solarFarm.enabled)return u("pasture",d);ee("upgPasture","","upgBldFilter")}if(0===p.stage&&p.stages[1].stageUnlocked){if(90<n.getPotentialCatnip(!0,A,0)&&q&&1===d.stage&&_.auto.build.items.hydroPlant.enabled)return u("aqueduct",p);ee("upgAqueduct","","upgBldFilter")}g=game.bld.getBuildingExt("library").meta,t=.1*g.totalEffectsCached.scienceMax/(1+game.prestige.getParagonProductionRatio());if(0===g.stage&&g.stages[1].stageUnlocked){$=1+.01*game.bld.get("biolab").val,A=Math.max(1+game.prestige.getParagonProductionRatio(),2)/2,$=3*Y.compedium.value>t/$&&1e6<game.bld.getEffect("scienceMax");if(($|=n.getTickVal(Y.concrate)>600*A)&&_.auto.build.items.dataCenter.enabled){if(C>=game.resPool.energyCons+150&&!game.challenges.isActive("energy"))return u("library",g)}else ee("upgLibrary","","upgBldFilter")}q=game.bld.getBuildingExt("amphitheatre").meta;if(0===q.stage&&q.stages[1].stageUnlocked){if(2<game.getResourcePerTick("titanium",!0)||200<Y.ship.value)return u("amphitheatre",q);ee("upgAmphitheatre","","upgBldFilter")}}return m},build:function(a){const p=this.buildManager,h=this.craftManager,e=this.bulkManager;var t=_.auto.build.trigger;let i=0;var b=game.challenges.isActive("blackSky"),f=(game.prestige.getPerk("vitruvianFeline").researched,game.challenges.isActive("atheism")),v=game.workshop.get("geodesy").researched,k=game.workshop.get("orbitalGeodesy").researched;let x=game.workshop.get("spaceManufacturing").researched;var y=game.religion.getRU("solarRevolution"),R=game.religion.getSolarRevolutionRatio();let w=game.science;var F=w.get("theology").researched;let T={},M;if("object"!=typeof a){var E=game.prestige.getParagonProductionRatio();M={};let l=JSON.parse(JSON.stringify(_.auto.build.items));var S=Y.science;let o=S.value/S.maxValue;var P=(e,a,t)=>{let i=l[e];var r=i.max;e&&(o<t?(i.max=-1===r?a:Math.min(a,r),game.bld.getBuildingExt(e).meta.val>=a&&!x&&ee("scienceBld")):i.max=-1===r?game.bld.getBuildingExt(e).meta.val+2:r)},P=(R<50&&(P("observatory",1e5<Y.starchart.value?200:300,.95),P("academy",Math.max(22*(E+1),100),.98),P("biolab",200,.99)),h.getPotentialCatnip(!1)),B=w.get("machinery").researched,C=w.get("astronomy"),q=game.stats.getStat("totalResets").val&&!C.researched,q=(o<.98&&q&&(!B||C.unlocked)&&Y.minerals.value&&(l.academy.max=6*(E+1),ee("academy")),x&&l.barn.max<16&&(l.barn.max=-1),l.pasture);let e=l.smelter,a=(F?(ee("smelter",!0),ee("pasture",!0)):(B=game.bld.getBuildingExt("smelter").meta,e.max=1,Math.ceil(2*Y.wood.perTickCached)>B.val&&Math.ceil(Y.minerals.perTickCached)>B.val&&(e.max=B.val+1,ee("smelter")),(C=game.bld.getBuildingExt("pasture").meta).unlocked&&10<C.val&&ee("pasture"),P||(l.pasture.max=20),B=game.bld.getBuildingExt("hut").meta.val-2,l.library.max=0<B?Math.floor(11*B):l.library.max),!w.get("writing").researched&&Y.minerals.value?(l.workshop.max=1,ee("workshop")):ee("workshop",!0),game.workshopTab.visible||game.challenges.isActive("winterIsComing")||!w.get("animal").researched||(e.max=0,-1===q.max&&(l.pasture.enabled=!1,ee("pasture"))),l.reactor);C=game.space.getBuilding("sattelite").on,P=((!x&&125e3<Y.titanium.maxValue||!C)&&(a.max=25+10*b),Y.uranium.value<100&&(a.max=0),Y.oil.maxValue<55e3&&(l.quarry.max=40/(1+E)),game.getEffect("priceRatio")),B=game.bld.getBuildingExt("ziggurat").meta,q=Math.pow(B.priceRatio+P,B.val);10<B.val&&Y.blueprint.value<3*q&&!Y.alicorn.unlocked&&(l.ziggurat.max=0),b&&3e5<Y.science.maxValue&&!k&&(l.observatory.max=0);let t=l.steamworks,i=(game.challenges.isActive("pacifism")||game.bld.get("magneto").val?ee("steamworks",!0):game.bld.get("steamworks").unlocked&&t.enabled&&19<Y.gear.value&&(ee("steamworks"),t.enabled=!1),l.brewery),r=((!w.get("metalurgy").researched||Y.spice.value<2e3)&&(i.max=5),game.calendar.festivalDays||(i.max=0),l.temple),n=l.tradepost;game.religion.faith>y.faith||game.prestige.getPerk("voidOrder").researched;B=Y.gold.value/Y.gold.maxValue,q=(!b&&Y.titanium.value<25&&(r.max=Math.max(30,10*(1+R))),game.workshop.get("caravanserai")),q=(q.unlocked&&!q.researched&&1e4<Y.ivory.value&&130<Y.gold.value&&(r.enabled=!1,n.max=21,ee("caravanserai")),game.religion.getRU("stainedGlass").on&&game.religion.getRU("basilica").on&&game.religion.getRU("sunAltar").on);_.auto.faith.addition.autoPraise.expect;!q&&2e4<game.religion.faith&&780<Y.gold.maxValue&&R&&(r.max=25-Math.min(13,8*R),n.max=40-Math.min(22,12*R),ee("religion")),v||R||(n.max=30),y.on||f||!F?F&&(ee("temple",!0),ee("tradepost",!0)):(_.auto.faith.items.solarRevolution.enabled&&750<Y.faith.maxValue&&560<Y.gold.maxValue&&w.get("philosophy").researched&&(ee("temple"),r.max=Math.floor(7.5/(1+game.prestige.getParagonStorageRatio())),560<Y.gold.value&&(r.max=game.bld.getBuildingExt("temple").meta.val+1)),game.religion.transcendenceTier&&(n.max=12,525<Y.gold.value&&(n.max=Math.min(18,game.bld.getBuildingExt("tradepost").meta.val+1))),ee("tradepost")),!F&&w.get("philosophy").researched&&B<.96&&!f&&(q=game.village.happiness<4&&1===game.bld.get("temple").val&&game.prestige.getPerk("renaissance").researched,r.max=q?1:Math.floor(7.5/(1+game.prestige.getParagonStorageRatio())),n.max=12,ee("tradepost"));let s=l.calciner;y=s.max,B=(k?x&&C||(s.max=-1===y?Math.min(47+47*game.getEffect("productionRatio"),95-30*b):Math.min(50,y)):15e4<S.maxValue&&35e3<Y.oil.maxValue?s.max=-1===y?25:Math.min(25,y):(F=(1+7*E)*Math.max(1,Math.log(R)),s.max=-1===y?F:Math.min(F,y)),game.getResourcePerTick("oil",!0));B<.5&&(s.max=0,B<.1&&(l.magneto.max=0));let c=l.solarFarm;f=1===game.calendar.season?game.resPool.energyProd:game.resPool.energyWinterProd;!x&&125e3<Y.titanium.maxValue&&f>game.resPool.energyCons&&(c.enabled=!1);let g=l.mansion,u=l.broadcastTower;w.get("archeology").researched;q=Y.ship.value,C=k||600<q,S=(w.get("electronics").researched&&!x?(ee("broadcastTower"),u.max=8,g.max=80):ee("broadcastTower",!0),Y.titanium);let m=l.biolab;if(v||k?(C&&!g.max&&1===Z("titanium")&&(g.max=45),x?(ee("biolab",!0),ee("mansion",!0),ee("scienceBld",!0)):(m.max=10*R,Z("titanium")<.96&&!v&&(m.max=10,F=u.max,u.max=-1===F?30:Math.max(30,F),g.max=Math.max(135-game.village.maxKittens,Math.floor(17*(E+1)))))):(!b&&1<S.value&&g.max&&(g.max=12),25<Y.alloy.value&&w.get("biology").researched&&(m.max=2,ee("biolab"))),1e5<Y.starchart.value&&!x&&!game.calendar.festivalDays&&!game.ironWill&&(l.observatory.max=50,l.amphitheatre.max=17,l.academy.max=60,l.logHouse.max=game.bld.getBuildingExt("logHouse").meta.val+1,l.hut.max=game.bld.getBuildingExt("hut").meta.val+1,e.max=60,l.ziggurat.max=1),!game.challenges.isActive("pacifism")){let e=l.mint;y=Y.manpower.maxValue,B=game.bld.getBuildingExt("mint").meta.val;y<=2e4?e.enabled=!1:B?k||v&&game.workshop.get("miningDrill").researched||(e.enabled=!1):e.max=2}P&&Y.unobtainium.value<8794&&game.calendar.futureSeasonTemporalParadox<0&&(l.chronosphere.enabled=!1);var A,f=game.bld.getBuildingExt("calciner").meta;b&&_.auto.build.items.calciner.enabled&&f.unlocked&&!f.val&&p.built("calciner",void 0,1);let d=["library","academy","pasture","barn","harbor","oilWell","warehouse","broadcastTower","accelerator","mansion","quarry","aqueduct","chapel","lumberMill","factory","biolab"];for(A in l){var $=l[A];$.enabled&&$.max&&(-1===d.indexOf(A)?M[A]=$:T[A]=$)}}const r={};a=M||a;var l,o=game.village.leader;for(l in a){let e=a[l];var n=p.getBuild(e.name||l).meta;n.almostLimited&&!v&&o&&(e.enabled=!1),n.stage!==e.stage&&(e.enabled=!1),r[l]=n}var s=e.bulk(a,r,t,"bonfire");if(s)for(let e=0;e<s.length;e++){var c=s[e].count,g=s[e].id;0<(c=p.count(g,c))&&(p.built(s[e].name||g,s[e].stage,c),i+=1)}return"{}"!==JSON.stringify(T)&&(i+=this.build(T)),i},space:function(){if(game.spaceTab.visible){const h=JSON.parse(JSON.stringify(_.auto.space.items)),b=this.spaceManager;this.craftManager;const f=this.bulkManager;let e=_.auto.space.trigger;var t,i=game.challenges.isActive("blackSky"),r=game.religion.getSolarRevolutionRatio(),l=Y.starchart.value,o=(this.setTrait("chemist"),game.prestige.getPerk("vitruvianFeline").researched),n=(i?(h.researchVessel.enabled=!1,h.spaceStation.enabled&&$("#toggle-spaceStation").click()):!e&&2<r&&!game.space.meta[0].meta[3].val&&l<2e3&&(e=9,ee("spaceTrigger")),i||5<r),s=game.space.getBuilding("sattelite").val;if(!e){var c=game.space.getBuilding("spaceStation").val,g=3e3*Math.pow(1.12,c),u=2300*Math.pow(1.12,s);u<l&&r<2&&(h.sattelite.max=s+1),(l<u&&r<2||!game.workshop.get("orbitalGeodesy").researched)&&(h.sattelite.max=0),g<l&&(h.spaceStation.max=c+1),l<g&&(h.spaceStation.max=0),Z("unobtainium")<.9?h.moonBase.max=0:h.moonBase.max=game.space.getBuilding("moonBase").val+1,game.getEffect("lunarOutpostRatio")?r||(h.spaceElevator.max=22):(h.spaceElevator.max=11,!o&&Z("unobtainium")<.5&&(h.spaceElevator.max=0));let e=h.containmentChamber,a=h.heatsink;var u=Y.antimatter,c=game.space.getBuilding("heatsink").val,l=game.space.getBuilding("containmentChamber").val,g=(a.max=c+1,e.max=l+1,50*(1+.01*c)),o=game.resPool.energyProd<game.resPool.energyCons+g;(u.value+50*game.getEffect("antimatterProduction")<u.maxValue||o)&&(e.enabled=!1,a.enabled=!1);let t=h.orbitalArray,i=game.nummon;i&&(l=game.space.getBuilding("orbitalArray").val,i.getBestUnobtainiumBuilding()===$I("space.planet.piscine.orbitalArray.label")?!game.getEffect("shatterTCGain")||39<l?t.max=l+1:t.max=40:t.max<0&&(t.max=0))}game.ironWill&&(h.spaceStation.max=0),s<3+2*(9.7<r)&&n&&(b.build("sattelite",1),ee("sattelite")),n&&(!i&&game.space.getBuilding("researchVessel").val<1&&h.sattelite.enabled&&b.build("researchVessel",1),game.space.getBuilding("researchVessel").val<4&&(h.spaceStation.max=0));const v={};for(t in h)v[t]=b.getBuild(t);var m,d=f.bulk(h,v,e,"space");let a=0;for(m in d){var p=d[m];0<p.count&&(b.build(p.id,p.count),a=1)}return a}},craft:function(){var e=_.auto.craft.items;const a=this.craftManager;var t=_.auto.craft.trigger,i=!game.science.get("construction").researched||!game.bld.getBuildingExt("workshop").meta.on;let r,l,o;this.setTrait("metallurgist"),this.setTrait("engineer");for(const s of["ship","beam","wood","slab","alloy","gear","concrate","steel","plate","scaffold","tanker","parchment","manuscript","compedium","blueprint","kerosene","megalith","eludium","thorium"])o=(l=e[s]).require?a.getResource(l.require):"noRequire",r=0,!l.enabled||i&&"wood"!==s||a.getCraft(s).unlocked&&("noRequire"===o||o.value/o.maxValue>=t&&o.value<=2*o.maxValue?r=a.getLowestCraftAmount(s,l.limited,l.limRat,o.name):l.limited&&(r=a.getLowestCraftAmount(s,l.limited,l.limRat,!1)),1<=r&&a.craft(s,r));let n=_.auto.upgrade.items.upgrades;n.cache&&game.workshop.get(n.cache).researched&&(n.cache=!1)},holdFestival:function(){if(game.science.get("drama").researched&&!(400<=game.calendar.festivalDays)&&(game.prestige.getPerk("carnivals").researched||!(0<game.calendar.festivalDays))&&(!(game.village.getKittens()<5)||Y.zebras.value)){let e=this.craftManager;var a=1500<4e3*e.getTickVal(Y.manpower,!0),t=5e3<4e3*e.getTickVal(Y.culture,!0),i=5e3<4e3*e.getTickVal(Y.parchment,!0);if(a&&t&&(5e3<=Y.parchment.value||i)){if(game.science.getPolicy("carnivale").researched)if(!Y.furs.value||!Y.ivory.value||!Y.spice.value)return;let e=game.villageTab;a=e.festivalBtn;if(!a||!a.model)return e.render();t=a.model.prices;game.resPool.hasRes(t)?(game.resPool.payPrices(t),game.village.holdFestival(1),_.auto.trade.festival=void 0,ae("festival",1),G(t),400<game.calendar.festivalDays?j("festival.extend",[],"festivalFilter"):j("festival.hold",[],"festivalFilter")):_.auto.trade.festival=!0}}},observeStars:function(){let a=game.calendar;if(null!=a.observeBtn&&!game.workshop.get("seti").researched){var t=Y.science.value,i=Y.starchart.value;game.calendar.observeRemainingTime<270&&600<game.ticks&&X("珂学家可能进入了后台，运行速度缓慢(最好别最小化挂机)"),a.observeHandler();let e="";t=Y.science.value-t,i=(t&&(e+="，获得了 "+game.getDisplayValueExt(t)+" 科学"),Y.starchart.value-i);i&&(e+="，获得了 "+i+" 个星图"),j("act.observe",[e],"astronomicalEventFilter"),ae("science",t,"resGain"),ae("starchart",i,"resGain"),ae("stars",1)}game.ironWill&&(Y.catnip.value+=10)},hunt:function(){let t=this.craftManager.getResource("manpower");if(!(t.value<100||game.challenges.isActive("pacifism")||3<Z("manpower")&&game.getEffect("hunterRatio")<3)){var i=Y.unicorns.value,r=game.achievements.get("unicornConspiracy").unlocked||i,r=!game.bld.getBuildingExt("unicornPasture").meta.val&&r&&1e3<t.value&&i<3&&.06<game.getEffect("craftRatio");let e=_.auto.options.items.hunt;var i=e.subTrigger,l=e.subTrigger<=t.value/t.maxValue,o=!l&&_.auto.trade.cache,n=this.craftManager.getAverageHunt();t.value+=Math.max(2*t.perTickCached*(.9<i),0);let a=Math.floor(t.value/100);var i=game.science.get("writing").researched,s=!Y.furs.value||Y.parchment.value<25?Math.max(30,Math.floor(.5*a)):0,i=i&&a>s&&0<s&&1!==Z("culture");if((l||i||r||o||e.time)&&(i&&(a=s,j("act.hunt.mint","","huntFilter")),r&&(a=10,X(H("act.hunt.unicorn"))),o&&!e.time&&(a=Math.min(a,Math.max(Math.floor(t.perTickCached/50),1)),_.auto.trade.cache=!1,j("act.hunt.trade","","huntFilter")),e.time&&(e.time=!1),!(a<=0))){var c,g,l=game.ironWill?Y.zebras.title:$I("effectsMgr.statics.maxKittens.title");game.resPool.addResEvent("manpower",100*-a),ae("manpower",100*a,"resConsume");let e={};for(c in n)e[c]=Y[c].value;this.setTrait("manager"),game.village.gainHuntRes(a),this.setTrait(),1e3<=a&&(game.challenges.getChallenge("pacifism").unlocked=!0),_.auto.cache.trait.manager?(j("act.hunt",["管理者派出"+a,l],"huntFilter"),ae("hunt.manager",a)):(ae("hunt",a),j("act.hunt",[a,l],"huntFilter"));const u={};for(g in n){this.craftManager.getResource(g);u[g]=n[g]*a,ae(g,Y[g].value-e[g],"resGain")}this.cacheManager.pushToCache({materials:u})}}},trade:function(){let s={};var e,a=_.auto.options.items.promote.enabled&&_.auto.distribute.enabled?2:0;for(e in Y){var t=Y[e];game.resPool.addRes(t,Math.max(a*t.perTickCached+game.getEffect(e+"PerTickCon"),0),!1),s[e]=t.value}let c;const g=this.craftManager,u=this.tradeManager,m=this.cacheManager;g.getResource("gold");let d=[],p=_.auto.trade;var h=p.trigger;if(u.singleTradePossible(void 0)){let a=game.calendar;var b=a.getCurSeason().name,f=Z("gold"),v=Z("titanium"),k=h<=f;let i,e=(this.setTrait("merchant"),0);var x=game.religion.getSolarRevolutionRatio(),y=game.challenges.anyChallengeActive()&&2<a.year,R=game.prestige.getPerk("renaissance").researched,z=x||y||!R,J=!game.ironWill&&game.workshop.get("spaceManufacturing").researched&&2<x;let r,l,o,n;var w=p.items;for(o in w)if(r=w[o],(l=u.getRace(o)).unlocked&&(game.diplomacyTab.racePanels[e]||game.diplomacyTab.render(),e++,r.enabled)){var F,T,M=r[b];if(M)if(u.getTradeButton(l.name)){n=!!r.require&&g.getResource(r.require);let e=u.getProfitability(o);"nagas"===o&&J||"zebras"===o&&!e&&2===a.season&&.5<v||("sharks"===o&&l.embassyLevel<10&&(e=!1),"dragons"===o&&2<x&&!e&&v<1||(Y.faith.value,M=game.religion.getRU("transcendence").on||!_.auto.faith.items.transcendence.enabled,F=game.religion.getRU("apocripha").on||!_.auto.faith.items.apocripha.enabled,T=game.workshop.get("miningDrill").researched,M=M&&F||2<game.religion.transcendenceTier||!game.space.getBuilding("moonOutpost").val||!T,r.limited&&e&&z&&M?(d.push(o),i=!0):(!n||h<=n.value/n.maxValue)&&k&&d.push(o)))}}y=Y.catnip.value+100*game.getResourcePerTick("catnip",!0),R=u.getLowestTradeAmount("sharks");if(y<0&&R&&game.deadKittens<1e3&&(S=game.diplomacy.get("sharks"),S=u.getAverageTrade(S).catnip,u.trade("sharks",Math.max(Math.ceil(y/-S),R)),j("trade.catnip")),0!==d.length){i=i&&!k?.4:1;let t=Math.floor(u.getLowestTradeAmount(void 0,!0,!1)*i);if(!(p.festival&&!a.festivalDays&&2500<Y.parchment.value||t<1)){const D=[];for(c=0;c<d.length;c++){o=d[c],r=_.auto.trade.items[o];var E=(!(n=!!r.require&&g.getResource(r.require))||h<=n.value/n.maxValue)&&h<=f,E=Math.floor(u.getLowestTradeAmount(o,r.limited,E)*i);E<1?(d.splice(c,1),c--):D[c]=E}y=d.length;if(d.length){var S=game.getEffect("shatterTCGain"),W=Y.steel.value>Y.plate.value&&!S&&2!==a.season,G=.4<Z("uranium")&&1<y&&!S,K=Y.plate.value>10*Y.steel.value&&.5<v;const O={};for(;0<d.length&&1<=t;)if(t<d.length){var P=Math.floor(Math.random()*d.length);O[d[P]]||(O[d[P]]=0),O[d[P]]+=1,--t,d.splice(P,1),D.splice(P,1)}else{let e=Math.floor(t/d.length),a=0;for(c=0;c<d.length;c++)D[c]<e&&(e=D[c],a=c);"spiders"===(o=d[a])&&W&&(e=Math.floor(.4*e)),"dragons"===o&&G&&(e=Math.floor(.2*e)),"zebras"===o&&K&&(e=Math.floor(.3*e)),O[o]||(O[o]=0),O[o]+=e,t-=e,d.splice(a,1),D.splice(a,1)}if(0!==O.length){var B,C,N=_.auto.cache.cacheSum.manpower;const I={};for(o in O){l=u.getRace(o);let e=O[o];e=k||!N?1:.6*e;var q,A=u.getMaterials(o);for(q in A)I[q]||(I[q]=0),I[q]-=A[q]*e;var $,V=u.getAverageTrade(l);for($ in V){var U=g.getResource($);I[$]||(I[$]=0),I[$]+=0<U.maxValue?Math.min(V[$]*e,Math.max(U.maxValue-U.value,0)):V[$]*e}}for(B in m.pushToCache({materials:I}),.98<=f&&(p.cache=!0),O)0<O[B]&&u.trade(B,O[B]);for(C in Y){var L=Y[C].value-s[C];0<L&&ae(C,L,"resGain"),L<0&&ae(C,-L,"resConsume")}}}}}}},miscOptions:function(){const l=this.craftManager,i=this.buildManager;var t=_.auto.options.items;let o=0,a=_.auto.cache,e=a.dataTimer;var r=game.timer.ticksTotal,n=e.ticksTotal,s=game.calendar.trueYear(),c=game.telemetry.guid;if(r-n<0||e.trueYear>s||e.saveId!==c){a.dataTimer=null,a.dataTimer={},a.cacheSum=null,a.cacheSum={},_.auto.filter.console=null,_.auto.filter.console={},P(),re(),a.resUpg=null,a.resUpg={},this.leaderTimer=0,_.auto.upgrade.items.upgrades.cache=null;let e=a.dataTimer;e.saveId=c,e.ticksTotal=r,e.trueYear=s}2e4<r-n&&(e.ticksTotal=r);c=_.auto.filter;if(t.filterGame.enabled&&c.enabled){var g=c.items;let a=c.console;var u,m=game.console.filters;for(u in m){var d=g[u+"Filter"];let e=m[u];!e.unlocked||d&&!d.enabled||a[u]||(e.enabled=!1,a[u]=!0,o=1)}o&&game.ui.renderFilters()}if(t.buildEmbassies.enabled&&game.diplomacy.races[0].embassyPrices){var s=l.getResource("culture"),n=s.value/s.maxValue,p=(t.buildEmbassies.subTrigger,.98<=n),h=Math.sqrt(game.religion.getSolarRevolutionRatio()+1),r=s.value>15e3*h;if(t.buildEmbassies.subTrigger<=n&&n<2||r){let a,t,e,i;var b=game.diplomacyTab.racePanels;let r=l.getValueAvailable("culture",!0);const M={},E=[];var f,c=b.length-(game.diplomacy.get("leviathans").unlocked?1:0),v=_.auto.trade.items;for(a=c-1;-1<a;a--)b[a].embassyButton?(t=b[a].race.name,e=game.diplomacy.get(t),(p||v[t].enabled)&&(f=1-game.getEffect("embassyCostReduction"),M[t]={val:0,basePrice:e.embassyPrices[0].val*f,currentEm:e.embassyLevel,priceSum:0,race:e},E.push(t))):game.diplomacyTab.render();if(0!==E.length){for(;0<E.length;)for(a=0;a<E.length;a++){t=E[a];let e=(i=M[t]).currentEm+i.val;var k=i.basePrice*Math.pow(1.15,e+game.getEffect("embassyFakeBought"));e=p||e<14+h&&game.science.get("astronomy").researched,k<=r&&e?(r-=k,i.priceSum+=k,i.val+=1,p&&(E.splice(a,1),a--)):(E.splice(a,1),a--)}for(t in M)0!==(i=M[t]).val&&(r=l.getValueAvailable("culture",!0),i.priceSum>r||(Y.culture.value-=i.priceSum,ae("culture",i.priceSum,"resConsume"),i.race.embassyLevel+=i.val,ae("embassy",i.val),o+=1,1===i.val?X(H("build.embassy",[i.val,i.race.title]),"embassyFilter"):X(H("build.embassies",[i.val,i.race.title]),"embassyFilter")))}}}if(t.fixCry.enabled&&0<game.time.getVSU("usedCryochambers").val){let e=0;const S=game.timeTab.vsPanel.children[0].children[0];for(;S.controller.buyItem(S.model,{},function(){});)e+=1;0<e&&(j("act.fix.cry",[e],"ks-fixCry"),ae("fix.cry",e))}let x;s=(e,a,t)=>{X(H("summary."+e,[a])),ae(e,a),t&&(x=i.getBuildButton(e))&&x.controller.onAll(x.model)};let y=game.bld.getBuildingExt("mint").meta;y.on!==y.val&&2e4<Y.manpower.maxValue&&(y.on=y.val),y.on&&Y.manpower.maxValue<2e4&&!game.challenges.isActive("pacifism")&&2<y.on&&!game.opts.enableRedshift&&(y.on=0,s("mint"));n=game.bld.getBuildingExt("factory").meta,n.val&&n.on!==n.val&&game.workshop.get("spaceManufacturing").researched&&s("factory",void 0,!0),r=game.bld.getBuildingExt("magneto").meta,c=game.getResourcePerTick("oil",!0)>.05*r.val,t=5e6<game.bld.cathPollution&&50<game.bld.cathPollutionPerTick,r.val&&!r.on&&c&&t&&!n.isAutomationEnabled&&s("magneto",void 0,!0),c=game.bld.getBuildingExt("steamworks").meta,c.val&&c.on!==c.val&&9<r.on&&s("steamworks",void 0,!0),t=game.bld.getBuildingExt("reactor").meta,n=game.getResourcePerTick("uranium",!0);t.val&&t.on!==t.val&&0<n&&s("reactor",void 0,!0);let R=game.time.getCFU("temporalAccelerator");R.on&&!game.time.testShatter&&(R.isAutomationEnabled=!0,game.time.testShatter=1,s("temporalAccelerator"));c=game.resPool.energyProd;let w=game.bld.getBuildingExt("biolab").meta;r=w.on&&game.workshop.get("biofuel").researched;let F=l.getPotentialCatnip();if(F=_.auto.distribute.religion||F<0&&0<Y.catnip.value+400*F,r&&F&&(X(H("summary.biolab.test")+"(猫薄荷产量过低)"),w.on=0),c&&c<game.resPool.energyCons){if(r&&w.on)return t="冬季产出电:"+game.getDisplayValueExt(c)+"，消耗电:"+game.getDisplayValueExt(game.resPool.energyCons)+"，小猫担心电不够并关闭了",n=w.on,j("summary.biolab.test",[t+n]),w.on=0,ae("biolab.test",t+n),1;let e=game.bld.getBuildingExt("oilWell").meta;if(e.isAutomationEnabled&&game.workshop.get("pumpjack").researched)return e.isAutomationEnabled=!1,game.upgrade({buildings:["oilWell"]}),game.resPool.update(),s("pumpjack",1),1;let a=game.bld.getBuildingExt("accelerator").meta;a.on&&(a.on=0,s("accelerator",1))}r=Y.spice.value;const T=[{name:"brewery",metadata:game.bld.get("brewery"),Button:i.getBuildButton("brewery"),conditionOn:game.calendar.festivalDays&&r,conditionOff:game.bld.get("brewery").on}];if(!game.opts.enableRedshift){T.push({name:"chronocontrol",metadata:game.time.getVSU("chronocontrol"),Button:this.timeManager.getBuildButton("chronocontrol"),conditionOn:game.calendar.futureSeasonTemporalParadox<1&&98<game.calendar.day,conditionOff:game.time.getVSU("chronocontrol").on&&0<game.calendar.day});let e=game.bld.getBuildingExt("calciner").meta;!game.time.getCFU("ressourceRetrieval").on&&e.isAutomationEnabled&&(e.isAutomationEnabled=!1,game.upgrade({buildings:["calciner"]}),s("calciner"))}for(let a=0;a<T.length;a++){let e=T[a];0<e.metadata.val&&(e.conditionOn?e.metadata.val-e.metadata.on&&(e.Button.controller.onAll(e.Button.model),X(H("summary."+e.name+"On")),ae(e.name)):e.conditionOff&&(e.Button.controller.offAll(e.Button.model),X(H("summary."+e.name+"Off")),ae(e.name)))}return o},gameUpgrade:function(){var e=performance.now(),a=_.auto;let t=a.upgrade.items.upgrades,i=a.cache,r=i.upgrade;if(r){for(var l in game.upgrade(r),r)delete r[l];i.upgrade=null}else game.updateCaches();t.update&&(game.updateCaches(),t.update=null);a=performance.now()-e;this.time+=a},calculateTime:function(){var e=this.time,e=performance.now()-e;z.ksTime+=e,z.totalTicks++},setTrait:function(t){let e=game.village.leader;var i=_.auto,r=i.distribute;if((!i.options.items.promote.enabled||!r.enabled||!r.items.leader.enabled)&&e)return ee("changeLeader","","noFilter");if(t){if(game.science.get("civil").researched&&e&&!game.challenges.isActive("anarchy")){let a=_.auto.cache;i=game.village.traits.some(e=>e.title===$I("village.trait."+t));if(!a.trait[t]&&i){a.trait[t]=!0;let e=$I("village.bonus.desc."+t);var r=["当"+e.slice(0,2)+"项目时"+$I("village.trait."+t)+"猫猫自觉顶替当前领袖，其效果为"+e];1e4<game.ticks?ee("leader",!0):ee("leader","","leaderFilter"),j("set.leader",[r],"leaderFilter")}_.copyTrait||(r=e.trait.name,_.copyTrait=r,a.trait[r]=!0),i||(a.trait[t]=!1),!i&&_.copyTrait!==t||(e.trait.name=t)}}else _.copyTrait&&e&&$I("village.trait."+_.copyTrait)===e.trait.title&&(e.trait.name=_.copyTrait,_.copyTrait=void 0)},catnipForReligion:function(e){e=e||0;let a=1,t=game.religion.getRU("transcendence").on?game.religion.transcendenceTier:0;e&&(t+=1);var i,r=game.religion.faithRatio+game.religion.faith/1e6*(t+1)*(t+1)*1.01-e,r=.01+Y.faith.value*(1+.1*game.getUnlimitedDR(r,.1)),r=game.getLimitedDR(game.getUnlimitedDR(r,1e3)/100,10+game.getEffect("solarRevolutionLimit"));return t<10&&(a=game.village.getResConsumption().catnip*(1+game.getEffect("catnipDemandRatio")),0<game.village.sim.kittens.length&&1<game.village.happiness&&(a+=a*Math.max(game.village.happiness*(1+game.getEffect("hapinnessConsumptionRatio"))-1,0)*(1+game.getEffect("catnipDemandWorkerRatioGlobal"))),i=1+game.religion.getSolarRevolutionRatio()*(1+game.bld.pollutionEffects.solarRevolutionPollution),a=(Y.catnip.perTickCached-a)*(1+r)/i+a+game.globalEffectsCached.catnipPerTickCon),a<0&&Y.catnip.value+1e3*a<0&&(_.auto.faith,_.auto.distribute.religion||(_.auto.distribute.religion=!0),e&&(j("summary.transcend.catnip",[game.getDisplayValueExt(5*a)]),z.other["transcend.catnip"]=5*a),e||(j("summary.adore.catnip",[game.getDisplayValueExt(5*a)]),z.other["adore.catnip"]=5*a)),a},getBestUnicornBuilding:function(){var s=game.bld.getBuildingExt("unicornPasture").meta;if(s.unlocked){let l=1/0,o="";var c=1-game.getEffect("goldCostReduction"),t=game.bld.getBuildingExt("ziggurat").meta.on,g=Math.max(t,1),u=game.getEffect("unicornsRatioReligion")+1,i=500*(.9+.1*u),m=game.prestige.getPerk("unicornmancy").researched?1.1:1,d=game.getEffect("riftChance")*m/2e4*i;let e="unicorns";var p=Y.unicorns,i=p.perTickCached,r=game.calendar.cycleEffectsFestival({unicorns:1}).unicorns,h=p.perTickCached*game.getTicksPerSecondUI()/r;if(!h)return s;let a=h/Math.max(1,s.val);var b=2*Math.pow(s.priceRatio+game.getEffect("priceRatio"),s.val),f=(a=b/a,1.5*game.prestige.getParagonProductionRatio()+1.5),v=Y.tears.value+2500*p.value/g>Math.max(1e6,f*Y.ivory.value)||Y.ivory.perTickCached*f*r<i&&2e4<Y.manpower.maxValue;let n="tears";(v&=Y.alicorn.unlocked)&&(n="ivory",e="ivory"),(a=v?3e3*a:a)<l&&(l=a,o=s);e:for(let e=0;e<6;e++){var k=game.religion.meta[0].meta[e];if(k.unlocked){let t,i=0,r=u;if(k.effects.unicornsRatioReligion&&(!v||k.effects.alicornChance)){var x=Math.pow(1.15,k.on);for(let e=0;e<k.prices.length;e++){var y=k.prices[e],R=y.name,y=y.val;if(R===n&&(i+=y*x*2500/g,r+=k.effects.unicornsRatioReligion),"gold"===R&&y*c*x>Y.gold.maxValue)continue e;"tears"===R&&(t=y*x*2500/g)}let e=game.getEffect("riftChance");var w=k.effects,F=(w.riftChance&&(e+=w.riftChance),50*r+450),F=e*m/2e4*F;F-=d;let a=h*r/u;a=a-h+F,a=i/a,v&&w.tcRefineRatio&&(a*=.5-w.tcRefineRatio),a<l&&(l=a,o=k),v&&p.value>t+b&&(o=s)}}}return t&&(f=o.label||"独角兽牧场",f+="("+H("$resources."+e+".title")+"性价比)",z.other["auto.unicorn"]!==f&&(z.other["auto.unicorn"]=f,j("summary.auto.unicorn",[f],"unicornSacrificeFilter"))),o}}};let a=function(e){this.setTab(e)},u=(a.prototype={tab:void 0,render:function(){this.tab&&game.ui.activeTabId!==this.tab.tabId&&!this.tab._inherited&&setTimeout(()=>{this.tab.render()},200+Math.max(-Date.now()+game.timer.timestampStart,-200))},setTab:function(e){for(const a in game.tabs)if(game.tabs[a].tabId===e){this.tab=game.tabs[a];break}this.tab?this.render():o("unable to find tab "+e)}},function(){this.manager=new a("Religion"),this.bulkManager=new n}),m=(u.prototype={manager:void 0,bulkManager:void 0,build:function(e,a,t){var i=this.getBuild(e,a);let r=this.getBuildButton(e,a);if(!r||!r.model.metadata)return game.religionTab.render();if((r.model.enabled||(r.model.prices=r.controller.getPrices(r.model),r.controller.updateEnabled(r.model),r.model.enabled))&&0!==(t=this.bulkManager.construct(r.model,r,t))){G(r.model.prices),game.stats.getStat("totalClicks").val+=1;e=i.label;if("s"===a){if(_.auto.cache.trait.wise)return ae("哲学家小猫祷告了 "+e,t,"faith"),j("act.sun.discovers.leader",[e,t],"faithBuildFilter");1===t?j("act.sun.discover",[e],"faithBuildFilter"):j("act.sun.discovers",[e,t],"faithBuildFilter"),ae("小猫祷告了 "+e,t,"faith")}else ae(e,t,"build"),1===t?j("act.build",[e],"buildFilter"):j("act.builds",[e,t],"buildFilter")}},getBuild:function(e,a){switch(a){case"z":return game.religion.getZU(e);case"s":return game.religion.getRU(e);case"c":return game.religion.getTU(e)}},getBuildButton:function(e,a){let t,i,r;switch(a){case"z":t=this.manager.tab.zgUpgradeButtons;break;case"s":t=this.manager.tab.rUpgradeButtons;break;case"c":t=this.manager.tab.children[0].children[0].children}var l=this.getBuild(e,a);for(i=0;i<t.length;i++)if(t[i]&&-1!==(r=t[i].model.name).indexOf(l.label))return t[i]}},function(){this.manager=new a("Time"),this.crafts=new t,this.bulkManager=new n}),x=(m.prototype={manager:void 0,crafts:void 0,bulkManager:void 0,build:function(e,a,t){var i=this.getBuild(e,a);let r=this.getBuildButton(e,a);if(!r||!r.model.metadata)return game.timeTab.render();if(!r.model.enabled)return r.controller.updateEnabled(r.model);e=i.label;0!==(t=this.bulkManager.construct(r.model,r,t))&&(G(r.model.prices),ae(e,t,"build"),1===t?j("act.build",[e],"buildFilter"):j("act.builds",[e,t],"buildFilter"))},getBuild:function(e,a){return"chrono"===a?game.time.getCFU(e):game.time.getVSU(e)},getBuildButton:function(e,a){let t;t=("chrono"===a?this.manager.tab.children[2]:this.manager.tab.children[3]).children[0].children;var i,r=this.getBuild(e,a);for(i in t){let e=t[i].model.name;if(-1!==e.indexOf(r.label))return t[i]}}},function(){this.workManager=new a("Workshop"),this.sciManager=new a("Science"),this.crafts=new t}),d=(x.prototype={manager:void 0,crafts:void 0,build:function(e,i){let r;const l=this.getBuildButton(e,i);if(l&&l.model.metadata){if(l.model.enabled||(l.model.prices=l.controller.getPrices(l.model),l.controller.updateEnabled(l.model),l.model.enabled)){if("policy"===i){let e=l.model.metadata;if(game.village.leader&&e.requiredLeaderJob&&game.village.leader.job!==e.requiredLeaderJob)return o=game.village.getJob(e.requiredLeaderJob).title,void game.msg($I("msg.policy.wrongLeaderJobForResearch",[e.label,o]),"important");if("transkittenism"===e.name&&15<=game.bld.getBuildingExt("aiCore").meta.effects.aiLevel)return void game.msg($I("msg.policy.aiNotMerges"),"alert","ai");if(!1===e.blocked)for(r=0;r<e.blocks.length;r++)if(game.science.getPolicy(e.blocks[r]).researched)return void(e.blocked=!0)}let a=_.auto.upgrade.items.upgrades,t=(l.model.prices=l.controller.getPrices(l.model),l.controller.payPrice(l.model,{},function(){}),G(l.model.prices),l.model.metadata);if(t.researched=!0,t.handler&&t.handler(game,t),t.unlocks&&game.unlock(t.unlocks),t.blocks)for(r in t.blocks){let e=game.science.getPolicy(t.blocks[r]);e.blocked=!0}t.onResearch&&t.onResearch(game),t.upgrades&&("workshop"!==i||a.update||(a.update=!0),W(t.upgrades)),game.stats.getStat("totalClicks").val+=1;var o=e.label,n=(s=_.auto.cache.trait.scientist)?"科学家小猫":"小猫",s=s?1:0;if("workshop"===i){if(ae(o,s,"upgrade"),j("upgrade.upgrade",[o,n],"upgradeFilter"),e.name===a.cache){a.cache=!1;let e=_.auto.cache.resUpg;for(var c in _.auto.cache.resUpg)delete e[c]}}else"science"===i?(ae(o,s,"research"),j("upgrade.tech",[o,n],"researchFilter")):"policy"===i&&j("upgrade.policy",[o],"policyFilter")}}else("workshop"===i?game.workshopTab:game.libraryTab).render()},getValue:function(e,a){var t=_.auto.resources[e];let i=t&&t.enabled?t.stock:0;t=_.auto.upgrade.items.upgrades.cache;return _.auto.craft.oxidation&&"oxidation"!==a&&("science"===e&&5e3<Y.steel.value&&(i+=1e5),"steel"===e&&(i+=5e3)),"titanium"===e&&"rotaryKiln"!==a&&("rotaryKiln"!==a&&!game.workshop.metaCache.rotaryKiln.researched&&game.workshop.get("orbitalGeodesy").researched&&(i+=5e3),"orbitalGeodesy"===t&&t!==a&&(i+=1e3)),"iron"===e&&"ironwood"!==a&&z.other["auto.ironwood"]&&(i+=3e3),"alloy"===e&&t&&t!==a&&(i+=_.auto.cache.resUpg[e]),"oil"===e&&"orbitalGeodesy"!==a&&20<game.bld.get("calciner").val&&!game.workshop.metaCache.orbitalGeodesy.researched&&(i+=35e3),Math.max(Y[e].value-i,0)},getBuildButton:function(e,a){let t;"workshop"===a?t=this.workManager.tab.buttons:"science"===a?t=this.sciManager.tab.buttons:"policy"===a&&(t=this.sciManager.tab.policyPanel.children);for(var i of t)if(i.model.name===e.label)return i}},function(){this.manager=new a("Bonfire"),this.crafts=new t,this.bulkManager=new n}),p=(d.prototype={manager:void 0,crafts:void 0,bulkManager:void 0,built:function(e,a,t){var i=this.getBuild(e);let r=this.getBuildButton(e,a);if(i.meta.unlocked){if(!(r&&r.model.metadata||(game.bldTab.activeGroup="all",r&&r.model.metadata)))return game.bldTab.render();if(!r.model.enabled)return r.controller.updateEnabled(r.model);e=i.meta.label||i.meta.stages[a].label;0!==(t=this.bulkManager.construct(r.model,r,t))&&(G(r.model.prices),ae(e,t,"build"),game.stats.getStat("totalClicks").val+=1,1===t?j("act.build",[e],"buildFilter"):j("act.builds",[e,t],"buildFilter"))}},count:function(t,i){if(i){let e;var r=game.challenges.isActive("atheism"),l=game.religion.getRU("solarRevolution"),o=game.workshop.get("geodesy").researched,n=game.workshop.get("orbitalGeodesy").researched,s=game.workshop.get("spaceManufacturing").researched;let a=game.prestige.getPerk("vitruvianFeline").researched;var c,g=Y.minerals.value>.94*Y.minerals.maxValue,u=Y.wood.value>.94*Y.wood.maxValue,m=Y.titanium.value>=.9*Y.titanium.maxValue,d=game.science.metaCache,p=this.crafts.getPotentialCatnip(!1),h=game.bld.getBuildingExt("amphitheatre").meta;game.space.getProgram("moonMission");switch(t){case"field":if(!(game.bld.getBuildingExt(t).meta.val>35+85*a))return i;game.libraryTab.visible||(e=!0);break;case"chapel":if("chapel"===t){if(game.bld.getBuildingExt(t).meta.val<18)break;game.calendar.festivalDays||(i=0),n||(i=Math.floor(.3*i),e=!0)}break;case"aqueduct":if(p<2||game.challenges.isActive("winterIsComing"))break;s||(i=Math.floor(.4*i));case"library":if("library"===t&&!d.writing.unlocked)break;case"academy":case"pasture":case"barn":if("barn"===t&&Y.minerals.maxValue<1600)break;if(g&&u)break;case"warehouse":if("warehouse"===t)if(Y.minerals.maxValue<5e4){if(game.workshop.get("deepMining").researched||game.bld.getBuildingExt(t).meta.val<20)break}else a&&!s&&(i=Math.floor(.3*i));case"lumberMill":if("lumberMill"===t)if(game.bld.getBuildingExt(t).meta.val<55-10*a-10*!o){if(!game.getEffect("lumberMillRatio")&&3.1<game.bld.getEffect("woodRatio")&&1200<Y.iron.maxValue&&(i=0),Y.gold.value||game.getEffect("ironPerTickAutoprod")<.3)break}else!s&&Z("iron")<.5&&(e=!0,ee("lumberMill"));case"oilWell":if("oilWell"===t){var b=game.bld.getBuildingExt(t).meta.val;if(b<8||Y.oil.maxValue<2e4)break;if(55e3<Y.oil.maxValue&&3e4<Y.oil.value&&b<199&&(i=Math.floor(.5*i)),20<game.bld.getBuildingExt("calciner").meta.val&&!n)break}case"quarry":a&&(!n&&game.bld.get(t).val?(e=!0,ee("lower")):n&&ee("lower",!0));break;case"harbor":"harbor"===t&&(b=game.bld.getBuildingExt(t).meta.val,c=game.bld.getBuildingExt("reactor").meta.val,b<8?(ee("harbor"),e=!0):!(c<20&&7.5<game.religion.getSolarRevolutionRatio())&&(n||game.workshop.get("geodesy").researched)?s&&ee("harbor",!0):e=!0,60+c<b&&Z("iron")<.9&&(i=Math.floor(.5*i)));break;case"logHouse":!h.stage&&h.val<5&&game.village.happiness<3&&18<game.village.maxKittens&&(e=!0);break;case"biolab":s||(i=1);break;case"factory":s?game.space.getBuilding("sattelite").val||!game.bld.get(t).val||r||(_.auto.space.items.sattelite.enabled=!0,i=0):(c=game.bld.getBuildingExt(t).meta.val,Y.titanium.maxValue<13e4&&c&&Y.titanium.perTickCached<70&&!m&&(i=0),2<c&&!m&&(i=Math.floor(.4*i),e=!0));break;case"accelerator":if(!a)break;game.workshop.get("energyRifts").researched||(i=0),!s&&13e4<Y.titanium.maxValue&&(i=0);break;case"mansion":a=a||!a&&game.workshop.get("geodesy").researched&&game.village.sim.kittens.length<116,!s&&1<game.stats.getStat("totalResets").val&&!m&&a&&(ee("mansion"),e=!0),Y.starchart.perTickCached<4&&"mansion"===t&&!m&&a&&(e=!0)}return e?i=Math.floor(.5*i):l.on||r||(i=Math.ceil(.5*i)),"hut"!==t&&"logHouse"!==t||!i||(((l=Y.catnip).perTickCached<1.7*game.village.happiness&&(!game.science.get("agriculture").researched||2===Y.kittens.maxValue)||p<0&&l.value+1e3*p<0)&&!o?(i=0,ee("kittens")):ee("kittens",!0)),i}},getBuild:function(e){return game.bld.getBuildingExt(e)},getBuildButton:function(e,a){var t=this.manager.tab.children,e=this.getBuild(e),i=(void 0===a?e.meta:e.meta.stages[a]).label;for(const r in t){let e=t[r].model.name;if(-1!==e.indexOf(i))return t[r]}},getSumPrices:function(e,a){var t=(e.priceRatio||e.stages[e.stage].priceRatio)+game.getEffect("priceRatio");return(a.val-a.val*Math.pow(t,e.val-1))/(1-t)},sellBuild:function(e){let t=this.getBuild(e).meta;var i=t.stages[t.stage].prices;for(let a=0;a<i.length;a++){var r,l=i[a];let e=Y[l.name];e.isRefundable()&&!l.isTemporary&&t.val&&(r=this.getSumPrices(t,l),game.resPool.addResEvent(l.name,.5*r))}t.on=0,t.val=0}},function(){this.manager=new a("Space"),this.crafts=new t,this.bulkManager=new n}),t=(p.prototype={manager:void 0,crafts:void 0,bulkManager:void 0,build:function(e,a){var t=this.getBuild(e);let i=this.getBuildButton(e);if(t.unlocked&&_.auto.space.items[e].enabled){if(!i||!i.model.metadata)return game.spaceTab.render();if(!i.model.enabled)return i.controller.updateEnabled(i.model);e=t.label;0!==(a=this.bulkManager.construct(i.model,i,a))&&(G(i.model.prices),ae(e,a,"build"),game.stats.getStat("totalClicks").val+=1,1===a?j("act.build",[e],"spaceFilter"):j("act.builds",[e,a],"spaceFilter"))}},getBuild:function(e){return game.space.getBuilding(e)},getBuildButton:function(e){var a=this.manager.tab.planetPanels;for(const i in a)for(var t in a[i].children)if(a[i].children[t].id===e)return a[i].children[t]}},function(){this.cacheManager=new R}),n=(t.prototype={craft:function(t,i){if(i=Math.floor(i),t&&!(i<1)&&this.canCraft(t,i)){var r=this.getCraft(t),l=game.getResCraftRatio(r.name)+1,o=_.auto.cache.trait.engineer&&game.village.leader;let e=o?"工匠小猫制作了 ":"小猫制作了 ",a=(i=Math.ceil(i))*l;var n=dojo.clone(game.workshop.getCraftPrice(r));for(let a=n.length-1;0<=a;a--){let e=n[a];e.val*=i,ae(e.name,e.val,"resConsume")}o&&(l=game.village.getEffectLeader("engineer",0),o&&"metallurgist"===Y[t].tag&&_.auto.cache.trait.metallurgist&&(a+=i*l,e="冶金学家小猫制作了 "),"chemist"===Y[t].tag&&_.auto.cache.trait.chemist&&(a+=.5*i*l,e="化学家小猫制作了 ")),game.resPool.payPrices(n),game.resPool.addResEvent(r.name,a),r.upgrades&&W(r.upgrades),game.stats.getStat("totalCrafts").val++,game.stats.getStatCurrent("totalCrafts").val++,game.stats.getStat("totalClicks").val+=1;l=Y[t].title;i=a,o?ae(l,i,"craftLeader"):ae(l,i,"craft"),j("act.craft",[e+game.getDisplayValueExt(i),l],"craftFilter")}},canCraft:function(e,a){e=this.getCraft(e);let t=!1;if(e.unlocked){t=!0;var i,r=game.workshop.getCraftPrice(e);for(i in r){var l=r[i];Y[l.name].value<l.val*a&&(t=!1)}}return t},getCraft:function(e){return game.workshop.getCraft(e)},getLowestCraftAmount:function(a,e,t,i){let r=Number.MAX_VALUE,n=game.workshop;var l=n.get("geodesy").researched,o=this.getMaterials(a);if(!o)return 0;if(Y[a].value===1/0)return 0;let s=this.getValueAvailable(a,!0),c,g,u;var m=game.bld.getBuildingExt("temple").meta,L=Math.pow(m.priceRatio+game.getEffect("priceRatio"),m.val),D=game.prestige.getPerk("renaissance").researched,d=this.getCraft(a);let p=_.auto.craft,h=game.getResCraftRatio(d.name)+1,b=p.trigger;d=Y.ship.value;if("ship"===a&&e){g=d<85||1e5<Y.science.maxValue;var f=game.religion.getSolarRevolutionRatio();let e=200;.2<f&&(e+=43,!game.spaceTab.visible&&l&&(e+=257));l=l?Math.max(e):45/Math.max(.25,Math.log1p(f)),f=!n.get("oxidation").researched&&!p.oxidation||!f;g=g&&d<l&&f}let v=Number.MAX_VALUE/h+Number.MAX_VALUE/Math.pow(2,53)/h,k=game.science;var x=k.meta[0],l=k.get("navigation").researched;let y,R=_.auto.cache;var w=e=>{var a=R.science||"科学";g=!0,"油气处理"!==a&&(_.auto.filter.items.miscFilter.enabled||(a=game.msg(H("craft.force",[Y[e].title,a]),null,null,!0),$(a.span).css("color","#ff589c")),ae("craft"+Q(e),1))};"beam"!==a&&"slab"!==a||(c=Object.keys(o)[0],Z(c)<2&&(p.autoConsume[c]=0,500<Y.scaffold.value&&.9<b&&e&&(p.autoConsume[c]=1,b=.9),!Y[a].value&&Y.slab.value&&(g=!0))),"megalith"===a&&e&&Y[a].unlocked&&15<game.diplomacy.get("nagas").embassyLevel&&!game.calendar.season&&!s&&(r=1,g=!0);let F=_.auto.options.items.hunt;var f="fullIron"===F.time&&F.enabled,O=("plate"===a&&e&&p.items.steel.enabled&&(P=game.getResourcePerTick("coal",!0),M=this.getResource("coal").maxValue*b,U=game.bld.getBuildingExt("reactor").meta,U=Math.pow(game.getEffect("priceRatio")+U.priceRatio,U.val),U=Y.titanium.value>3500*U&&300<Y.uranium.value&&s<5e3*U,0<P&&Y.iron.value!==Y.iron.maxValue&&150<s&&!U&&.8<this.getValueAvailable("plate")/this.getValueAvailable("steel")&&(P=(M-this.getValue("coal"))/P*Math.max(game.getResourcePerTick("iron",!0),0),r=.008*(this.getValueAvailable("iron")-Math.max(M-P,0))),U&&(g=!0),Y.faith.maxValue<750&&30<Y.gold.value&&Y[a].value<23&&3<h&&(g=!0),!d&&3<h&&25<=Y.starchart.value&&s<150&&(r=Math.ceil(Math.min(Y.iron.value/100,(150-s)/h)),g=!0),f&&(g=!0)),this.getValueAvailable("science",!0)),T=Y.science.value/Y.science.maxValue,M=Y.culture.value/Y.culture.maxValue;if("manuscript"===a&&e){var E=R.resources.manuscript;for(y=E?17:19,c=16;c<y;c++){var S=x.meta[c];let e=E||S.prices[1].val;if(!S.researched||0<E){var I=16===c&&game.village.happiness<4&&1===m.val&&D||750<Y.faith.maxValue||Y.gold.value<50,z=(e=I?e:10*L,game.science.getPolicy("tradition").researched?20:25),J=(r=Math.ceil((e-s)/h),this.getValueAvailable("parchment",!0));J>r*z&&1<=r&&Y.culture.value>16*z*r&&(R.science=0<E?R.science:S.label,R.science=I?R.science:"神殿",w("manuscript"),R.resources.manuscript=0);break}}.9<M&&(Y.manpower.perTickCached<14||!l)&&(g=!0)}var P=Y.gold.maxValue<500||game.religion.getRU("solarRevolution").on||game.religion.faith<2e3;if("compedium"===a&&e&&l&&P){var B=R.resources.compedium;for(y=B?19:27,c=18;c<y&&(!game.prestige.getPerk("numerology").researched||game.calendar.festivalDays||!game.science.get("drama").unlocked);c++){var C,W,q=x.meta[c];if((!q.researched||0<B)&&"metaphysics"!==q.name&&"drama"!==q.name){q.prices[1].name!==a&&!B||(C=B||q.prices[1].val,r=Math.ceil((C-s)/h),C=this.getValueAvailable("manuscript",!0),W=O>1e4*r||1<=T,C>50*r&&1<=r&&W?(R.science=0<B?R.science:q.label,w("compedium"),R.resources.manuscript=0,R.resources.compedium=0):1<=r&&(R.resources.manuscript=50*r,R.science=0<B?R.science:q.label));break}}!x.meta[32].researched&&.98<M&&s<100&&.98<T&&(g=!0)}if("blueprint"===a&&e&&k.get("electricity").researched)for(c=30;c<44;c++){var A=x.meta[c];if(!A.researched){var G,V=A.name;let e=["quantumCryptography","blackchain","ecology","ai"];if(!(-1<e.indexOf(V))){A.prices[1].name===a&&(r=Math.ceil((A.prices[1].val-s)/h),V=this.getValueAvailable("compedium",!0),G=O>25e3*r||1<=T,V>25*r&&1<=r&&G?(R.science=A.label,w("blueprint"),R.resources.manuscript=0,R.resources.compedium=0):1<=r&&(R.resources.compedium=25*r,R.science=A.label));break}}}var K=this.getLimRat(a,e,t);for(c in"parchment"===a&&(e=h<2.1,!Y[a].value&&1.5<h&&(g=!0,r=2),l||(300<s&&(e=!0),500<s&&(r=0,ee("parchment")))),o){u=0;var N=o[c],j=!e||g||0<Y[c].maxValue&&i;u=j?this.getValueAvailable(c,g)/N:K*((this.getValueAvailable(c,!0)+N/h*s)/N)-s/h,v=Math.min(u,v,r)}if("steel"===a&&e){var U=game.bld.getBuildingExt("calciner").meta,d=(this.getValueAvailable("steel"),.3*Math.min(1,Y.coal.perTickCached/Y.iron.perTickCached)),P=(Y.plate.value<1.25*d*Y.steel.value&&!p.oxidation&&p.items.plate.enabled&&(v=0),(a,t)=>{let i;if((!a||(t=(i=n.get(a)).prices,i.unlocked))&&(!a||!i.researched)){let e;for(var r in t)"steel"===t[r].name&&(e=t[r].val);var l=Math.ceil((e-s)/h),o=Y.iron.value>100*l&&Y.coal.value>100*l;0<l&&o&&(v=l,g=!0,a&&X(H("craft.forceSteel",[i.label])))}}),M=(P("steelSaw"),P("steelAxe"),P("steelArmor"),this.getUnResearched("oxidation")),t=U.on;if(t){U.isAutomationEnabled?game.time.getCFU("ressourceRetrieval").on<5&&ee("ironFactory"):(l=.0015*(1+.1*game.bld.get("reactor").on)*(game.getEffect("calcinerRatio")+1)*game.bld.getAutoProductionRatio()*(game.getEffect("ironPolicyRatio")+1)*game.calendar.cycleEffectsFestival({iron:1}).iron*t,v=Math.max(0,v)+l,d=.01*Math.min(Y.coal.value,Y.iron.value),v>d&&(v=d)),P("oxidation");let e=_.auto.upgrade.items.upgrades;var U=Y.titanium.value,d=(M&&(d=(100*(l=Math.ceil((5e3-s)/h))-Y.coal.value)/Y.coal.perTickCached,l=(100*l-Y.iron.value)/Y.iron.perTickCached,d<4500&&l<4500&&(p.oxidation=!0,ee("oxidation"))),Y.alloy.value),l=(this.getUnResearched("orbitalGeodesy")&&17e3<Y.oil.value&&35e3<Y.oil.maxValue&&Y.uranium.value<1e3&&(l=Math.ceil((1e3-d)/h),U=Y.titanium.value>10*l||300<Y.alloy.value&&20<t||(10*l-U)/Y.titanium.perTickCached<600,0<l&&U&&!e.cache&&(_.auto.cache.resUpg.alloy=1e3,e.cache="orbitalGeodesy")),this.getUnResearched("fluidizedReactors")),U=(l&&!e.cache&&(l=10*(U=Math.ceil((200-d)/h))<(l=Y.titanium.value)||100<Y.alloy.value||(10*U-l)/Y.titanium.perTickCached<600,0<U&&6<t&&l&&(_.auto.cache.resUpg.alloy=200,e.cache="fluidizedReactors")),_.auto.cache.resUpg.alloy);U&&P("",[{name:"steel",val:75*Math.ceil((U-d)/h)}])}else game.challenges.isActive("blackSky")&&P("",[{name:"steel",val:1100}]);M||(p.oxidation=null,ee("oxidation",!0)),F.time&&.98<Z("iron")&&(F.time="fullIron")}if("alloy"===a&&e&&(t=(e,a)=>{e=n.get(e);!e.researched&&e.unlocked&&1<(a=Math.ceil((a-Y.alloy.value)/h))&&Y.steel.value>75*a&&Y.titanium.value>10*a&&!p.oxidation&&(v=a,g=!0,X(H("craft.forceSteel",[e.label])))},35e3<Y.oil.value&&t("orbitalGeodesy",1e3),t("fluidizedReactors",200),t("alloyAxe",25),t("alloySaw",75)),(v="eludium"===a&&e&&!i&&f&&game.time.getCFU("ressourceRetrieval").on>8-2*D?Math.max(v,1):v)<1)return 0;l=Y[a].maxValue,U=Y[a].value;return 0<l&&v*h>l-U&&(v=(l-U)/h),!e||g||i&&"noRequire"!==i||(v*=Math.max(Math.min(Math.log(h-1),1),.2)),v},getMaterials:function(e){let a={};e=this.getCraft(e);if(e){var t=game.workshop.getCraftPrice(e);for(const r in t){var i=t[r];a[i.name]=i.val}return a}},getTickVal:function(a,e){let t=game.getResourcePerTick(a.name,!0);var i;if("timeCrystal"===a.name&&(s=game.getEffect("alicornChance"),c=game.getResourcePerTick("alicorn"),i=.04*(1+game.getEffect("tcRefineRatio")),s*=1+game.getLimitedDR(game.getEffect("alicornPerTickRatio"),1.2),s=.2*Math.min(s,1)*(1+game.timeAccelerationRatio()),t+=(s+c)*i),a.craftable){let e=Number.MAX_VALUE;var r,l=this.getMaterials(a.name);for(r in l){var o=(1+game.getResCraftRatio(a.name))/l[r],n=this.getTickVal(this.getResource(r));e=Math.min(n*o,e)}t+=e===Number.MAX_VALUE?0:e}var s="spice"===a.name||"blueprint"===a.name;if(t<=0&&s)return"ignore";if(!e){var c=z.other["time.skip"];let e=1;"unobtainium"===a.name&&c&&(e=.4),t+=this.cacheManager.getResValue(a.name)*e}return t},getAverageHunt:function(){let e={};var a=game.getEffect("hunterRatio")+game.village.getEffectLeader("manager",0);return e.furs=40+32.5*a,e.ivory=50*Math.min(.225+.01*a,.5)+40*a*Math.min(.225+.01*a,.5),e.unicorns=.05,10<=this.getValue("zebras")&&(e.bloodstone=0===this.getValue("bloodstone")?.05:5e-4),game.ironWill&&game.workshop.get("goldOre").researched&&(e.gold=.625+.625*a),e},getResource:function(e){var a=Y[e];return a||(o("unable to find resource "+e),null)},getValue:function(e){return this.getResource(e).value},getStock:function(a){var e=_.auto.resources[a];let i=e&&e.enabled?e.stock:0;if(!game.workshop.get("spaceManufacturing").researched){let e=game.workshop;var t=e.get("orbitalGeodesy").researched,r=_.auto.cache.resUpg[a];switch(a){case"iron":var l,o=game.bld.get("lumberMill").val>19-40*game.getEffect("priceRatio"),n=Y.gold.value<50&&o;(2<game.bld.getBuildingExt("temple").meta.on||749<Y.faith.maxValue||n||18<Y.plate.value)&&(n=(e,a,t)=>{e&&Y.iron.value<1e4&&(i+=a,ee(t))},s=this.getUnResearched("reinforcedSaw")&&200<Y[a].value&&1e3<Y[a].maxValue,o=this.getUnResearched("crossbow")&&o&&1500<Y[a].maxValue,l=this.getUnResearched("ironwood")&&800<Y[a].value&&3e3<Y[a].maxValue&&3e4<Y.science.maxValue&&!game.ironWill,n(s,1e3,"reinforcedSaw"),n(o,1500,"crossbow"),n(l,3e3,"ironwood"),e.get("orbitalGeodesy").researched&&(ee("ironwood",!0),ee("crossbow",!0),ee("ironwood",!0)));break;case"alloy":r&&(i+=r);break;case"steel":this.getUnResearched("steelAxe")&&3e3<Y.coal.value&&(30<game.bld.get("lumberMill").val||10<Y[a].value)&&(i+=75);var s=this.getUnResearched("steelSaw")&&250<Y[a].value&&!Y.titanium.perTickCached,o=(s&&(i+=750,ee("steelSaw")),_.auto.craft.oxidation&&this.getUnResearched("oxidation")&&(i+=5e3),game.challenges.isActive("blackSky")&&!Y.titanium.perTickCached&&Y.steel.value<1100&&6e3<Y.oil.value&&(i+=1100),_.auto.cache.resUpg.steel);o&&(i+=o),r&&(i+=75*r/(1+game.getEffect("craftRatio")));break;case"titanium":this.getUnResearched("rotaryKiln")&&t&&(i+=5e3),this.getUnResearched("spaceManufacturing")&&24<game.bld.get("reactor").val&&125e3<Y.titanium.maxValue&&(i+=13e5);break;case"gear":this.getUnResearched("rotaryKiln")&&t&&5e3<Y.titanium.value&&(i+=5e3),this.getUnResearched("fuelInjectors")&&Z("coal")<.8&&2e4<Y.oil.value&&(i+=250);break;case"beam":this.getUnResearched("deepMining")&&1200<Y.iron.value&&(i+=5e3);break;case"blueprint":.1<game.getEffect("productionRatio")&&!game.science.get("nanotechnology").researched&&(i+=150)}}return i||0},getValueAvailable:function(a,e,t){let i=this.getValue(a),r=this.getStock(a),l;l=t||0===t?t:void 0===t?1:_.auto.craft.trigger,"catnip"===a&&(n=this.getPotentialCatnip(!1),o=0!==game.calendar.season||this.getResource(a).maxValue*l<i||game.getResourcePerTick("catnip",!0)<0,n<0&&o&&(r-=1500*n,_.auto.options.catnipMsg+6e5<Date.now()&&(game.stats.getStat("totalResets").val<5&&X(H("msg.catnip")),X(H("craft.winterCatnip")),_.auto.options.catnipMsg=Date.now()))),i=Math.max(i-r,0);var o=t&&!e?i:this.getResource(a).maxValue;if(!e&&0<o){var n=_.auto.resources[a];let e=(n&&n.enabled&&void 0!==n.consume?n:_).consume;(_.auto.craft.autoConsume[a]&&!t||"coal"===a)&&(e=1),i-=Math.min(o,i)*(1-e),"unobtainium"===a&&i+r<1e3&&this.getResource(a).value===o&&1e3<=this.getResource(a).value&&(i=this.getResource(a).value)}return i},getUnResearched:function(e){e=game.workshop.metaCache[e];return e.unlocked&&!e.researched},getLimRat:function(e,a,t){if(!a)return t;var i=game.science.get("navigation"),r=Y[e],l=Y.ship.value;let o=game.space;var n=o.getProgram("piscineMission"),s=game.prestige.getPerk("renaissance").researched;let c=game.bld;var g=c.getBuildingExt("reactor").meta,u=game.getEffect("priceRatio"),m=c.get("steamworks"),d=c.get("magneto"),p=c.getBuildingExt("temple").meta,h=Math.pow(p.priceRatio+u,p.val),b=game.religion.getSolarRevolutionRatio();let f;switch(e){case"wood":t=.09+r.perTickCached<Y.catnip.perTickCached/game.workshop.getCraft("wood").prices[0].val&&this.getPotentialCatnip()?1:.5;var v=c.getBuildingExt("field").meta,v=Math.pow(v.priceRatio+u,v.val);t=Y.catnip.maxValue>10*v&&1<b&&!game.ironWill?0:t;break;case"beam":v=i.unlocked||Y.gold.maxValue<500||1e3<Y.iron.value&&!Y.coal.value;t=Y.scaffold.value<500+500*b+4500*!b?t:.02,t=v?t:.005;break;case"slab":v=Y.faith.maxValue<750&&r.value<51&&35<Y.gold.value;t=Y.scaffold.value||v||g.val&&r.value<2500?t:.005,t=Y.scaffold.value<500?t:.1,t=2500<Y.scaffold.value&&2500<r.value?.02:t;break;case"ship":var v=5*g.val+225,k=Y.titanium.maxValue,x=(y=!n.on&&o.getBuilding("sattelite").val<9&&r.value)&&6<b&&k<125e3&&!n.val,y=y&&6<b&&12e4<k;t=.75*v<l&&2<b&&Y.starchart.value<1e5?.3:t,t=x||.9<Z("titanium")?.05:t,t=y&&(!game.workshop.get("satnav").researched||123e3<k)?0:t,t=l>Math.max(400,k)?0:t;break;case"plate":v=3500<Y.titanium.value&&250<Y.uranium.value&&!g.val,x=p.on&&p.on<15-3*s&&b&&r.value<15*h;t=game.getEffect("calcinerRatio")||x?t:.3,t=r.value<150&&i.researched&&10<Y.starchart.value&&50<Y.scaffold.value||v?.9:t,t=_.auto.craft.oxidation&&!game.workshop.get("oxidation").researched?0:t;break;case"alloy":game.globalEffectsCached.titaniumPerTickAutoprod;y=c.getBuildingExt("calciner").meta.val;f=Math.pow(d.priceRatio+u,d.val),t=m.on<d.on||y<2?t:.76,t=r.value>Math.max(1250,10*f)&&_.auto.build.items.magneto.enabled?.01:t,t=Y.titanium.value<17&&!y||y<2&&game.challenges.isActive("blackSky")?0:t;break;case"steel":t=_.auto.craft.oxidation?1:t;break;case"eludium":t=5<game.time.getCFU("ressourceRetrieval").on?.1:.6,t=r.value<125&&-1.06<game.getEffect("hutPriceRatio")?1:t;break;case"megalith":k=c.getBuildingExt("ziggurat").meta,x=(f=Math.pow(k.priceRatio+u,k.val),Math.pow(g.priceRatio+u,g.val));t=game.workshop.get("spaceManufacturing").researched?t:.15,t=r.value>Math.max(100,50*f)?.005:t,t=Y.plate.value<Math.max(5e3,50*x)?.1:t,!(50<r.value||k.on||Y.unicorns.value<1e3)||game.workshop.get("orbitalGeodesy").researched||(t=.001);break;case"concrate":v=o.getBuilding("moonOutpost").val,v=150*Math.pow(1.12,v),y=(f=Math.pow(g.priceRatio+u,g.val),c.getBuildingExt("library").meta),x=Math.pow(y.priceRatio+u,y.val)*y.stage;t=g.val?t:.25,t=r.value>Math.max(v,50*f,10*x)?.01:t,t=!r.unlocked&&10<game.diplomacy.get("nagas").embassyLevel&&!game.calendar.season&&500<Y.titanium.value?1:t;break;case"gear":{f=Math.pow(m.priceRatio+u,m.val);k=game.workshop.get("logistics");let e=game.workshop.get("fuelInjectors");e=!e.researched&&e.unlocked;y=2e4<Y.oil.value&&Z("coal")<.5&&r.value<250&&e;t=30<r.value&&!k.unlocked&&k.researched?.3:t,t=y?.7:t,t=r.value>Math.max(500,20*f)?.005:t,t=m.val||game.science.get("chemistry").researched?t:0;break}case"kerosene":t=.25,t=!n.val&&1400<Y.starchart.value&&r.value<250&&3<b?.8:t,t=!n.on&&250<r.value?0:t,t=o.getProgram("moonMission").val?t:0;break;case"manuscript":t=game.prestige.getPerk("numerology").researched&&!game.calendar.festivalDays&&game.science.get("drama").unlocked?.25:t;v=c.getBuildingExt("chapel").meta,v=Math.pow(v.priceRatio+u,v.val),x=c.getBuildingExt("brewery").meta;Y.culture.maxValue>Math.pow(x.priceRatio+u,x.val)&&.5<Z("culture")&&(t=Y.parchment.value>Math.max(1e6,250*v)&&g.val?1:t);break;case"compedium":t=game.science.get("architecture").unlocked?t:0,t=Y.manuscript.value>Math.max(1e4,100*h)?.9:t,10*r.value>Math.max(2e4,this.getCompendiaMax())&&1===Z("science")&&(t=0);break;case"blueprint":t=game.science.get("industrialization").unlocked?t:0,10*Y.compedium.value>Math.max(2e4,this.getCompendiaMax())&&1===Z("science")&&(t=1);break;case"scaffold":k=c.get("observatory");f=Math.pow(k.priceRatio+u,k.val),t=r.value<100&&game.science.get("navigation").unlocked&&750<Y.iron.value?1:t,t=game.science.get("navigation").unlocked?t:0,t=r.value<50*f&&5e5<Y.minerals.maxValue?.75:t;break;case"tanker":t=.1}return t},getCompendiaMax:function(){let e=game.bld.getEffect("scienceMax");var a,t=game.getEffect("scienceMaxCompendia");return game.ironWill&&(e*=10),game.prestige.getPerk("codexLeviathanianus").researched&&(a=1+(a=game.religion.getTU("blackLibrary")).val*(a.effects.compendiaTTBoostRatio+game.getEffect("blackLibraryBonus")),e*=1+.05*a*game.religion.transcendenceTier),e+t},getPotentialCatnip:function(e,a,t){let i=game.getEffect("catnipPerTickBase");e?(i=(i*=.1)*(1+game.getLimitedDR(game.getEffect("coldHarshness"),1)),game.science.getPolicy("communism").researched&&(i=0)):(e=game.calendar.year<4?0:.15,i*=game.calendar.seasons[3].modifiers.catnip-e);var e=game.village.getResProduction().catnip?game.village.getResProduction().catnip*(1+game.getEffect("catnipJobRatio")):0;let r=i+e;void 0===t?r*=1+game.getEffect("catnipRatio"):(o=(e=game.space.getBuilding("hydroponics")).effects.catnipRatio,r*=1+game.bld.getBuildingExt("aqueduct").meta.stages[0].effects.catnipRatio*t+o*e.val);t=game.challenges.isActive("winterIsComing")?0:game.prestige.getParagonProductionRatio();r=(r=(r*=1+t)*(1+game.religion.getSolarRevolutionRatio()*(1+game.bld.pollutionEffects.solarRevolutionPollution)))*(1+game.getEffect("blsProductionBonus")*Y.sorrow.value),r=game.calendar.cycleEffectsFestival({catnip:r}).catnip,r*=1+game.bld.pollutionEffects.catnipPollutionRatio;let l=game.village.getResConsumption().catnip;var o=game.bld.getBuildingExt("unicornPasture").meta.val;return l*=void 0===a?1+game.getEffect("catnipDemandRatio"):1+game.getLimitedDR(-.005*a+-.0015*o,1),0<game.village.sim.kittens.length&&1<game.village.happiness&&(e=Math.max(game.village.happiness*(1+game.getEffect("hapinnessConsumptionRatio"))-1,0),game.challenges.isActive("anarchy")?l*=1+e*(1+game.getEffect("catnipDemandWorkerRatioGlobal")):l*=1+e*(1+game.getEffect("catnipDemandWorkerRatioGlobal"))*(1-game.village.getFreeKittens()/game.village.sim.kittens.length)),r=(r+=l)+game.getResourcePerTickConvertion("catnip")}},function(){this.craftManager=new t}),y=(n.prototype={craftManager:void 0,bulk:function(e,a,t,c){let g,u,m,d,i,r;const p=[],h=[];let l=0;for(const R in e)if(r=e[R],u=a[R],r.enabled&&!(-1!==r.max&&r.max<=u.val)&&!1!==u.unlocked){var o=!!r.require&&this.craftManager.getResource(r.require);if(!o||t<=o.value/o.maxValue){let e=(u.stages?u.stages[u.stage]:u).prices;"s"===r.variant&&(e=game.village.getEffectLeader("wise",dojo.clone(u.prices))),d=this.getPriceRatio(u,c),p[l]={},p[l].id=R,p[l].label=r.label,p[l].name=r.name,p[l].stage=r.stage,p[l].variant=r.variant,h[l]={},h[l].id=R,h[l].name=r.name,h[l].count=0,h[l].spot=l,h[l].prices=[];var n=1-game.getLimitedDR(game.getEffect(R+"CostReduction"),1);for(i in e){var s=e[i],b=game.getLimitedDR(game.getEffect(s.name+"CostReduction"),1);h[l].prices.push({val:s.val*n*(1-b),name:s.name})}h[l].priceRatio=d,h[l].source=c,h[l].limit=isNaN(r.max)?-1:r.max,h[l].val=u.val,this.singleBuildPossible(u,h[l].prices,d,c)?l++:h.pop()}}if(0!==h.length){let n={};for(var f in Y)n[f]=this.craftManager.getValueAvailable(f,!0);let s=0;for(;0!==h.length;){e:for(let o=0;o<h.length;o++){let l=h[o];var v,k,x,y=(u=a[l.id]).val;m=l.prices,d=l.priceRatio,c=l.source;for(let r=0;r<m.length;r++){let e,a,t,i=!1;if(c&&"space"===c&&"oil"===m[r].name?(e=!0,t=m[r].val*(1-game.getLimitedDR(game.getEffect("oilReductionRatio"),.75))):"cryochambers"===l.id&&"karma"===m[r].name&&(a=!0,i=m[r].val*(1-game.getLimitedDR(.01*game.prestige.getBurnedParagonRatio(),1))),(g=e?n.oil<t*Math.pow(1.05,s+y):a?n.karma<i*Math.pow(d,s+y):(x=m[r].val*Math.pow(d,s+y),n[m[r].name]<x))||u.noStackable&&1<=s+y||"ressourceRetrieval"===l.id&&100<=s+y||"cryochambers"===l.id&&game.bld.getBuildingExt("chronosphere").meta.val<=s+y){for(let e=0;e<r;e++)c&&"space"===c&&"oil"===m[e].name?(v=m[e].val*(1-game.getLimitedDR(game.getEffect("oilReductionRatio"),.75)),n.oil+=v*Math.pow(1.05,s+y)):"cryochambers"===l.id&&"karma"===m[e].name?(v=m[e].val*(1-game.getLimitedDR(.01*game.prestige.getBurnedParagonRatio(),1)),n.karma+=v*Math.pow(d,s+y)):(k=m[e].val*Math.pow(d,s+y),n[m[e].name]+="void"===m[e].name?Math.ceil(k):k);-1!==l.limit&&(l.count=Math.max(0,Math.min(l.count,l.limit-l.val))),p[h[o].spot].count=h[o].count,h.splice(o,1),o--;continue e}e?n.oil-=t*Math.pow(1.05,s+y):a?n.karma-=i*Math.pow(d,s+y):(x=m[r].val*Math.pow(d,s+y),n[m[r].name]-="void"===m[r].name?Math.ceil(x):x,n[m[r].name]=n[m[r].name]||0)}h[o].count++}s++}return p}},construct:function(e,a,t){const i=e.metadata;let r=0;if("number"==typeof i.limitBuild&&i.limitBuild-i.val<t&&(t=i.limitBuild-i.val),e.enabled||a.controller.updateEnabled(e),e.enabled&&a.controller.hasResources(e)||game.devMode){for(;a.controller.hasResources(e)&&0<t;)e.prices=a.controller.getPrices(e),a.controller.payPrice(e),a.controller.incrementValue(e),r++,t--;if(i.breakIronWill){game.ironWill=!1;let e=game.science.getPolicy("liberty");e.calculateEffects(e,game)}i.unlockScheme&&i.val>=i.unlockScheme.threshold&&game.ui.unlockScheme(i.unlockScheme.name),i.unlocks&&game.unlock(i.unlocks),i.upgrades&&(i.updateEffects&&i.updateEffects(i,game),W(i.upgrades))}return r},getPriceRatio:function(e,a){var t=e.stages?e.priceRatio||e.stages[e.stage].priceRatio:e.priceRatio;let i=0;return a&&"bonfire"===a&&(i=game.getEffect(e.name+"PriceRatio")+game.getEffect("priceRatio")+game.getEffect("mapPriceReduction"),i=game.getLimitedDR(i,t-1)),t+i},singleBuildPossible:function(e,a,t,i){var r,l=1-game.getLimitedDR(game.getEffect(e.name+"CostReduction"),1);for(r in a){var o=game.getLimitedDR(game.getEffect(a[r].name+"CostReduction"),1),o=a[r].val*l*(1-o);if(i&&"space"===i&&"oil"===a[r].name){var n=o*(1-game.getLimitedDR(game.getEffect("oilReductionRatio"),.75));if(this.craftManager.getValueAvailable("oil",!0)<n*Math.pow(1.05,e.val))return!1}else if("cryochambers"===e.name&&"karma"===a[r].name){n=o*(1-game.getLimitedDR(.01*game.prestige.getBurnedParagonRatio(),1));if(this.craftManager.getValueAvailable("karma",!0)<n*Math.pow(t,e.val))return!1}else if(this.craftManager.getValueAvailable(a[r].name,!0)<o*Math.pow(t,e.val))return!1}return!0}},function(){this.craftManager=new t,this.manager=new a("Trade")}),R=(y.prototype={craftManager:void 0,manager:void 0,trade:function(e,a){(!e||a<1)&&o(e+"-"+a+"贸易可能出点问题");var t=this.getRace(e);let i=this.getTradeButton(t.name);var r=_.auto.cache.trait.merchant?"商人小猫与":"小猫与";if(!i.model.enabled)return i.controller.updateEnabled(i.model);"sharks"===e||_.auto.trade.items[e].enabled||o("贸易可能出点问题"),game.diplomacy.tradeMultiple(t,a),game.stats.getStat("totalClicks").val+=1,ae(r+" "+t.title,a,"trade"),j("act.trade",[a,r+Q(t.title)],"tradeFilter")},getProfitability:function(e){let a,t;var i=this.getRace(e),r=this.getMaterials(e);let l=0;if("leviathans"===e&&game.time.getCFU("ressourceRetrieval").val&&.6<Z("unobtainium"))return!0;for(var o in r)if("ivory"!==o){if((a=this.craftManager.getTickVal(this.craftManager.getResource(o),!1))<=0)return!1;l+=r[o]/a}var n,s=this.getAverageTrade(i);let c=0;for(n in s){var g=this.craftManager.getResource(n);"ignore"!==(a=this.craftManager.getTickVal(g))&&(a<=0&&(t=!0),c+=0<g.maxValue?Math.min(s[n],Math.max(g.maxValue-g.value,0))/a:s[n]/a)}let u=!0;var m,d,p,h,b=game.calendar.season,f=Y.spice.value+60*game.getResourcePerTick("spice",!0)<0,v=game.religion.getSolarRevolutionRatio(),k=Z("titanium"),x=("nagas"===e&&(Y.concrate.unlocked||game.ironWill||(u=!1),Y.ship.value<30&&i.embassyLevel<10&&!game.ironWill&&(u=!1),x=1+game.prestige.getParagonProductionRatio(),Y.concrate.value<100*x&&10<i.embassyLevel&&Y.concrate.value&&(t=!0),Y.concrate.value>1e3*(1+v)&&k<.8&&(u=!1)),Y.titanium);return"griffins"===e&&(Y.ship.value&&2!==b&&(200<Y.ship.value||game.getEffect("productionRatio"))&&(u=!1),x.value&&x.value<500&&2===b&&1<v&&(u=!1),t=f&&game.calendar.festivalDays),"zebras"===e&&(m=game.bld.getBuildingExt("calciner").meta.val,d=_.auto.trade.items.griffins,h=this.craftManager.getTickVal(Y.iron),p=Math.min(Math.max(x.maxValue-x.value,0),s.titanium)/x.perTickCached,h=this.getAverageTrade(this.getRace("griffins")).iron/h<s.iron/h+p,d.enabled&&d.autumn&&2===b&&2<m&&(u=u&&h&&k<.95),1.5<v&&!game.religion.getRU("stainedGlass").on&&(u=!1),1<m&&3<v&&!game.religion.getRU("basilica").on&&(u=!1),t=(t||f&&game.calendar.festivalDays)&&game.workshop.get("caravanserai").researched),!("spiders"===e&&(2!==b&&(u=.4<k&&Z("coal")<.5),3===b&&(u=.9<k&&Z("coal")<.5&&.95<Z("gold")),t||(t=.1<k&&Z("coal")<1&&x.value>600*(1+v),u||t||(t=game.challenges.isActive("atheism")&&4<i.embassyLevel)),Y.scaffold.value<7e3))&&("dragons"===e&&(u=game.space.getProgram("centaurusSystemMission").on&&.5<k||Z("uranium")<.35&&.1<Z("iron"),t=t&&Y.uranium.unlocked),t||l<=c&&u)},getAverageTrade:function(e){var a,t,i,r,l=game.getEffect("standingRatio")+game.diplomacy.calculateStandingFromPolicies(e.name,game),o=1+.02*e.energy,n=1+game.diplomacy.getTradeRatio()+game.diplomacy.calculateTradeBonusFromPolicies(e.name,game)+game.challenges.getChallenge("pacifism").getTradeBonusEffect(game),s=e.standing<0?e.standing+l:0,c=s<0?1+s:1,g=0<e.standing?Math.min(e.standing+l/2,1):0;let u={};for(a of e.sells)this.isValidTrade(a,e)&&(r=0,t=a.minLevel?a.chance*(1+game.getLimitedDR(.01*e.embassyLevel,.75)):a.chance,i=a.seasons?1+a.seasons[game.calendar.getCurSeason().name]:1,r=((c-g)*Math.min(t,1)+1.25*(g*Math.min(t,1)))*a.value*o*i*n,u[a.name]=r);"zebras"===e.name&&(s=Y.ship.value,l=game.getEffect("zebraRelationModifier")*game.bld.getBuildingExt("tradepost").meta.effects.tradeRatio,m=Math.min(.15+.0035*s,1),u.titanium=(1.5+.03*s)*(1+l)*m*c,game.religion.getSolarRevolutionRatio()<1&&s<40&&game.getEffect("titaniumPerTickAutoprod")<.002&&(u.titanium=0));var l=e.embassyPrices?.35*(1+.01*e.embassyLevel):.35,m=c*Math.min(l,1);return u.spice=25*m+50*m*n/2,u.blueprint=.1*c,u},isValidTrade:function(e,a){return!(e.minLevel&&a.embassyLevel<e.minLevel)&&(Y[e.name].unlocked||"titanium"===e.name||"uranium"===e.name||"leviathans"===a.name)},getLowestTradeAmount:function(e,a,t){let i,r,l,o;var n=this.getMaterials(e),s=this.getRace(e);for(o in n)i="manpower"===o?this.craftManager.getValueAvailable(o,!0)/n[o]:this.craftManager.getValueAvailable(o,!a,_.auto.trade.trigger)/n[o],r=void 0===r||i<r?i:r;if(0===(r=Math.floor(r)))return 0;if(null===s||_.auto.trade.items[e].allowCapped)return r;var c,g=this.getAverageTrade(s);for(c in s.sells){var u=s.sells[c],m=this.craftManager.getResource(u.name),d=0;m.maxValue&&(d=g[u.name],u=Math.max((m.maxValue-m.value-Math.max(0,9*m.perTickCached))/d,0),l=u<l?l:u)}return 0===(l=Math.ceil(l))?0:(r=l<r?Math.max(l-1,1):r,Math.floor(r))},getMaterials:function(e){var a=game.challenges.isActive("postApocalypse")?game.bld.getPollutionLevel():1;let t={manpower:a*(50-game.getEffect("tradeCatpowerDiscount")),gold:a*(15-game.getEffect("tradeGoldDiscount"))};if(void 0===e)return t;var i=this.getRace(e).buys;for(const l in i){var r=i[l];t[r.name]=r.val}return t},getRace:function(e){return void 0===e?null:game.diplomacy.get(e)},getTradeButton:function(e){for(var a in this.manager.tab.racePanels){a=this.manager.tab.racePanels[a];if(a.race.name===e)return a.tradeBtn}},singleTradePossible:function(e){var a,t=this.getMaterials(e);for(a in t)if(this.craftManager.getValueAvailable(a,!0)<t[a])return!1;return!0}},function(){});R.prototype={pushToCache:function(e){let a=_.auto.cache.cacheSum;var t,i=e.materials;for(t in i)a[t]||(a[t]=0),a[t]+=i[t]},getResValue:function(e){var a=_.auto.cache,t=a.dataTimer,a=a.cacheSum;if(!a[e])return 0;var t=t.ticksTotal,i=game.timer.ticksTotal;return a[e]/(i-t)}};function s(e){const a=document.styleSheets;a[0].insertRule(e,0)}var h="body[data-ks-style]:not(.scheme_sleek)";s("body {font-family: inherit;font-size: inherit;}"),s(h+" #game {min-width: 1300px;top: 32px;}"),s(h+" .column {min-height: inherit;max-width: inherit !important;padding: 1%;margin: 0;overflow-y: auto;}"),s(h+" #leftColumn {height: 92%;width: 26%;}"),s(h+" #midColumn {height: 90%;width: 49%;}"),s(h+" #rightColumn {overflow-y: auto;height: 92%;width: 19%;top: 5px;font-size: 12px;font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,Helvetica,Arial,PingFang SC,Hiragino Sans GB,Microsoft YaHei,sans-serif;}"),s("body #gamePageContainer #game #rightColumn {overflow-y: auto;}"),s(h+" #gameLog {overflow-y: hidden !important;width: 100% !important;padding-top: 5px !important;}"),s(h+" #resContainer .maxRes {color: #676766;}"),s(h+" #game .btn {border-radius: 0px;font-family: monospace;font-size: 12px !important;margin: 0 5px 7px 0;width: 290px;}"),s(h+" #game .map-viewport {height: 340px;max-width: 500px;overflow: visible;}"),s(" #game .map-dashboard {height: 120px;width: 292px;}"),s("#ks-options ul {list-style: none;margin: 0 0 5px;padding: 0;}"),s('#ks-options ul:after {clear: both;content: " ";display: block;height: 0;}'),s("#ks-options ul li {display: block;float: left;width: 100%;}"),s("#ks-options #toggle-list-resources .stockWarn *,#ks-options #toggle-reset-list-resources .stockWarn * {color: "+_.stockwarncolor+";}"),s(".right-tab {height: unset !important;}");let C={version:3,toggles:{},items:{},resources:{},triggers:{},reset:{reset:!1,times:0,paragonLastTime:0,paragonTotal:0,karmaLastTime:0,karmaTotal:0},policies:[]},U=["build","space","craft","upgrade","trade","faith","time","timeCtrl","distribute","options","filter"],q=function(){C.toggles={build:_.auto.build.enabled,space:_.auto.space.enabled,craft:_.auto.craft.enabled,upgrade:_.auto.upgrade.enabled,trade:_.auto.trade.enabled,faith:_.auto.faith.enabled,time:_.auto.time.enabled,timeCtrl:_.auto.timeCtrl.enabled,distribute:_.auto.distribute.enabled,options:_.auto.options.enabled,filter:_.auto.filter.enabled},C.resources=_.auto.resources,C.triggers={faith:_.auto.faith.trigger,time:_.auto.time.trigger,build:_.auto.build.trigger,space:_.auto.space.trigger,craft:_.auto.craft.trigger,trade:_.auto.trade.trigger},C.policies=_.policies,localStorage["cbc.kitten-scientists"]=JSON.stringify(C)},L=function(){let i=JSON.parse(localStorage["cbc.kitten-scientists"]||"null");if(!i||3<i.version)return game.ironWill||(1<game.stats.getStat("totalResets").val&&game.msg("非钢铁意志模式，故勾上了喵喵建筑","alert"),["hut","logHouse","mansion"].forEach(e=>{_.auto.build.items[e].enabled||$("#toggle-"+e).click()})),U.forEach(e=>{$("#items-list-"+e).find("input[id^='toggle-']").each(function(){let e=$(this);"radio"!==$(this).attr("type")&&(C.items[e.attr("id")]=e.prop("checked"))})}),C.items["toggle-leaderJob-farmer"]=!0,C.items["toggle-leaderTrait-manager"]=!0,void q();if(1===i.version&&(i.version=2,i.reset={reset:!1,times:0,paragonLastTime:0,paragonTotal:0,karmaLastTime:0,karmaTotal:0}),2===i.version&&(i.version=3,i.policies=[]),3===i.version){let a;if((C=i).toggles)for(const c in i.toggles)"engine"!==c&&_.auto[c]&&(_.auto[c].enabled=!!i.toggles[c],(a=$("#toggle-"+c)).prop("checked",_.auto[c].enabled));for(const g in C.items){var r=C.items[g];let e=(a=$("#"+g)).data("option");var l=g.split("-");if(void 0===e)delete C.items[g];else if("set"===l[0]?(a[0].title=r,"max"===l[l.length-1]?a.text(H("ui.max",[r])):"min"===l[l.length-1]&&a.text(H("ui.min",[r]))):a.prop("checked",r),2===l.length)e.enabled=r;else if("reset"===l[1]&&4<=l.length){var o=l[2],n=l[3];switch(l[0]){case"toggle":_.auto[o].items[n].checkForReset=r;break;case"set":_.auto[o].items[n].triggerForReset=r}}else"limited"===l[1]?e.limited=r:"leaderJob"===l[1]&&r||"leaderTrait"===l[1]&&r?e[l[1]]=l[2]:e[l[2]]=r}let e=$("#toggle-list-resources"),t=$("#toggle-reset-list-resources");for(const u in C.resources){var s=C.resources[u];s.enabled&&(0===$("#resource-"+u).length&&e.append(A(u)),"stock"in s&&F(u,s.stock),"consume"in s&&T(u,s.consume)),s.checkForReset&&(0===$("#resource-reset-"+u).length&&t.append(A(u,void 0,!0)),"stockForReset"in s&&F(u,s.stockForReset||1/0,!0))}i.triggers&&(_.auto.faith.trigger=i.triggers.faith,_.auto.time.trigger=i.triggers.time,_.auto.build.trigger=i.triggers.build,_.auto.space.trigger=i.triggers.space,_.auto.craft.trigger=i.triggers.craft,_.auto.trade.trigger=i.triggers.trade,$("#trigger-faith")[0].title=_.auto.faith.trigger,$("#trigger-time")[0].title=_.auto.time.trigger,$("#trigger-build")[0].title=_.auto.build.trigger,$("#trigger-space")[0].title=_.auto.space.trigger,$("#trigger-craft")[0].title=_.auto.craft.trigger,$("#trigger-trade")[0].title=_.auto.trade.trigger),_.policies=i.policies}},Q=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},w=function(a,e,t=!1){var t=t?"#resource-reset-"+a:"#resource-"+a,i=($(t).removeClass("stockWarn"),game.resPool.resources.filter(e=>e.name===a)[0].maxValue);(i<e&&0!==i||e===1/0)&&$(t).addClass("stockWarn")},F=function(e,a,t=!1){let i,r=Number(a);isNaN(r)||r<0?o("ignoring non-numeric or invalid stock value "+a):(_.auto.resources[e]||(_.auto.resources[e]={}),t?(i="#resource-reset-"+e+" #stock-value-"+e,r=r<0?1/0:r,_.auto.resources[e].checkForReset=!0,_.auto.resources[e].stockForReset=r):(i="#resource-"+e+" #stock-value-"+e,_.auto.resources[e].enabled=!0,_.auto.resources[e].stock=r),$(i).text(H("resources.stock",[r===1/0?"∞":game.getDisplayValueExt(r)])),w(e,r,t))},T=function(e,a){let t=parseFloat(a);isNaN(t)||t<0||1<t?o("ignoring non-numeric or invalid consume rate "+a):(_.auto.resources[e]||(_.auto.resources[e]={}),_.auto.resources[e].consume=t,$("#consume-rate-"+e).text(H("resources.consume",[t.toFixed(2)])))},M=function(e,a=!1){let t=_.auto.resources[e];a?t.checkForReset=!1:t.enabled=!1,t.enabled||t.checkForReset||delete _.auto.resources[e]},A=function(a,t,e=!1){let i;var r=Y[a],l=(t=t||r.title||Q(a),_.auto.resources[a]);i=e&&l&&l.stockForReset?l.stockForReset:!e&&l&&l.stock?l.stock:0;let o=(l&&void 0!==l.consume?l:_).consume,n=$("<div/>",{id:(e?"resource-reset-":"resource-")+a,css:{display:"inline-block",width:"100%"}}),s;"uncommon"===r.type&&(s="#FF7F50"),"rare"===r.type&&(s="#FFA500"),s=r.color||s;var c,g,r=$("<div/>",{id:"resource-label-"+a,text:t,css:{display:"inline-block",color:s,width:"95px"}}),u=(i=$("<div/>",{id:"stock-value-"+a,text:H("resources.stock",[i===1/0?"∞":game.getDisplayValueExt(i)]),css:{cursor:"pointer",display:"inline-block",width:"80px"}}),o=$("<div/>",{id:"consume-rate-"+a,text:H("resources.consume",[o.toFixed(2)]),css:{cursor:"pointer",display:"inline-block"}}),$("<div/>",{id:"resource-delete-"+a,text:H("resources.del"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}));return e?n.append(r,i,u):n.append(r,i,o,u),void 0!==l&&void 0!==l.stock&&w(a,l.stock),r=i,c=e,r.on("click",function(){V.stop(!1);var e=window.prompt(H("resources.stock.set",[t]));_.auto.engine.enabled&&V.start(!1),null!==e&&(F(a,e,c),q())}),o.on("click",function(){V.stop(!1);var e=window.prompt(H("resources.consume.set",[t]));_.auto.engine.enabled&&V.start(!1),null!==e&&(T(a,e),q())}),g=e,u.on("click",function(){window.confirm(H("resources.del.confirm",[t]))&&(n.remove(),M(a,g),q())}),n};{var D;["workshopTab","libraryTab","villageTab"].forEach(e=>{game[e]&&game.ui.activeTabId!==game[e].tabId&&!game[e]._inherited&&game[e].render()});{let e,a,t,i,r=new u,l=_.auto.faith.items;for(e in l)i=l[e],(t=r.getBuild(i.name||e,i.variant))&&(l[e].label=t.label);let o=new m;for(e in l=_.auto.time.items)i=l[e],(t=o.getBuild(i.name||e,i.variant))&&(l[e].label=t.label);let n=new d;for(e in l=_.auto.build.items)i=l[e],(t=n.getBuild(i.name||e))&&("stage"in i?l[e].label=t.meta.stages[i.stage].label:l[e].label=t.meta.label);let s=new p;for(a in l=_.auto.space.items)(t=s.getBuild(a))&&(D=t.title||t.label,l[a].label=D)}let s=function(a){let t=[];var r,l=a?"#resource-reset-":"#resource-",o=game.resPool.resources;let n=_.auto.resources;for(r in o){var s=o[r];let i=s.name,e=n[i];if(e=e&&e.enabled,(a||!s.persists&&!e)&&(i&&0===$(l+i).length)){let e;"uncommon"===s.type&&(e="#FF7F50"),"rare"===s.type&&(e="#FFA500"),e=s.color||e;var c=$("<div/>",{id:"resource-add-"+i,text:Q(s.title||i),css:{cursor:"pointer",color:e}});!function(e,a,t){a.on("click",function(){a.remove(),n[i]||(n[i]={}),t?(n[i].checkForReset=!0,n[i].stockForReset=1/0,$("#toggle-reset-list-resources").append(A(i,e.title,t))):(n[i].enabled=!0,n[i].stock=0,n[i].consume=_.consume,$("#toggle-list-resources").append(A(i,e.title,t))),q()})}(s,c,a),t.push(c)}}return t},b=function(e=!1){let a=$("<ul/>",{id:e?"toggle-reset-list-resources":"toggle-list-resources",css:{display:"none",paddingLeft:"20px"}});var t,i,r=$("<div/>",{id:"resources-add",text:H("resources.add"),css:{cursor:"pointer",display:"inline-block",textShadow:"3px 3px 4px gray",borderBottom:"1px solid rgba(185, 185, 185, 0.7)"}});let l=$("<div/>",{id:"resources-clear-unused",text:H("resources.clear.unused"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}),o=(l.on("click",function(){for(var e in _.auto.resources)(_.auto.resources[e].stock||_.auto.resources[e].consume!==_.consume)&&void 0!==_.auto.resources[e].consume||$("#resource-"+e).remove()}),$("<ul/>",{id:"available-resources-list",css:{display:"none",paddingLeft:"20px"}}));for(i in t=e,r.on("click",function(){o.toggle(),o.empty(),"none"!==o[0].style.display&&o.append(s(t))}),e?a.append(r,o):a.append(r,l,o),_.auto.resources){var n=_.auto.resources[i];(e&&n.checkForReset||!e&&n.enabled)&&a.append(A(i,void 0,e))}return a},f=function(e){let a=$("<ul/>",{id:"items-list-"+e,css:{display:"none",paddingLeft:"20px"}});if("distribute"===e)return a;let t=$("<div/>",{id:"toggle-all-items-"+e,text:H("ui.disable.all"),css:{cursor:"pointer",display:"inline-block",textShadow:"3px 3px 4px gray",marginRight:"8px"}}),i=(t.on("click",function(){let e=a.children().children(":checkbox");e.prop("checked",!1),e.change(),a.children().children(":checkbox").change()}),a.append(t),$("<div/>",{id:"toggle-all-items-"+e,text:H("ui.enable.all"),css:{cursor:"pointer",display:"inline-block",textShadow:"3px 3px 4px gray"}}));return i.on("click",function(){let e=a.children().children(":checkbox");e.prop("checked",!0),e.change(),a.children().children(":checkbox").change()}),a.append(i),a},v=function(t){let e,a,i,r,l=Q(H("ui."+t)),o=_.auto[t],n=$("<li/>",{id:"ks-"+t});var s=$("<label/>",{for:"toggle-"+t,text:l});let c=$("<input/>",{id:"toggle-"+t,type:"checkbox"});if(o.enabled&&c.prop("checked",!0),"engine"!==t&&c.on("change",function(){c.is(":checked")&&!o.enabled?(o.enabled=!0,"filter"===t||"options"===t?B("status.sub.enable",[l]):B("status.auto.enable",[l]),q()):!c.is(":checked")&&o.enabled&&(o.enabled=!1,"filter"===t||"options"===t?B("status.sub.disable",[l]):B("status.auto.disable",[l]),q())}),n.append(c,s),o.items){if(n.css("borderBottom","1px  solid rgba(185, 185, 185, 0.7)"),i=$("<div/>",{css:{display:"inline-block",float:"right"}}),r=$("<div/>",{id:"toggle-items-"+t,text:H("ui.items"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}),n.append(r),e=f(t),"faith"===t)for(a in _.auto.unicorn.items)e.append(y(a,_.auto.unicorn.items[a]));for(a in o.items)switch(t){case"trade":e.append(function(e,a){let t=Q(H("$trade.race."+e)),i=y(e,a,t),r=(i.css("borderBottom","1px solid rgba(185, 185, 185, 0.7)"),$("<label/>",{for:"toggle-limited-"+e,title:H("trade.limited",[t]),text:H("ui.limit")})),l=$("<input/>",{id:"toggle-limited-"+e,type:"checkbox"}).data("option",a);if(a.limited)l.prop("checked",true);l.on("change",function(){if(l.is(":checked")&&a.limited===false){a.limited=true;B("trade.limited",[t])}else if(!l.is(":checked")&&a.limited){a.limited=false;let e=a.require?"需同时满足资源黄金和"+Y[a.require].title+"的触发条件才":"资源满足黄金的触发条件就会";B("trade.unlimited",[t,e])}C.items[l.attr("id")]=a.limited;q()}),i.append(l,r);let o=$("<div/>",{id:"toggle-seasons-"+e,text:H("trade.seasons"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}),n=$("<ul/>",{id:"seasons-list-"+e,css:{display:"none",paddingLeft:"20px"}});return n.append(k(e,"spring",a)),n.append(k(e,"summer",a)),n.append(k(e,"autumn",a)),n.append(k(e,"winter",a)),o.on("click",function(){n.toggle()}),i.append(o,n),i}(a,o.items[a]));break;case"craft":e.append(function(e,a){let t=Q(H("$resources."+e+".title"));if(e==="ship")t=Q(H("$workshop.crafts."+e+".label"));let i=y(e,a,t);if(e==="parchment")return i;let r=$("<label/>",{for:"toggle-limited-"+e,title:H("craft.limitedTitle"),text:H("ui.craftLimit")}),l=$("<input/>",{id:"toggle-limited-"+e,type:"checkbox"}).data("option",a);if(a.limited)l.prop("checked",true);return l.on("change",function(){if(l.is(":checked")&&!a.limited){a.limited=true;B("craft.limited",[t]);ee("craftLimited")}else if(!l.is(":checked")&&a.limited){a.limited=false;let e=a.require?Y[a.require].title+"满足触发资源的触发条件才会制作，":"无，当资源满足制作条件就会制作";B("craft.unlimited",[t,e])}C.items[l.attr("id")]=a.limited;q()}),i.append(l,r),i}(a,o.items[a]));break;case"timeCtrl":e.append(function(l,o){let n,u=y(l,o);if(l==="timeSkip"){n=$("<div/>",{id:"set-timeSkip-subTrigger",text:H("ui.trigger"),title:o.subTrigger,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",o);n.on("click",function(){let e;V.stop(false);e=window.prompt(H("time.skip.trigger.set",[]),o.subTrigger);if(_.auto.engine.enabled)V.start(false);if(e!==null){o.subTrigger=parseFloat(e);C.items[n.attr("id")]=o.subTrigger;q();n[0].title=o.subTrigger}});let a=$("<div/>",{id:"set-timeSkip-maximum",text:H("ui.maximum"),title:o.max,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",o);a.on("click",function(){let e;V.stop(false);e=window.prompt(H("ui.max.set",["每次燃烧时间水晶"]),o.maximum.toString());if(_.auto.engine.enabled)V.start(false);if(e!==null){o.maximum=parseFloat(e);C.items[a.attr("id")]=o.maximum;q();a[0].title=o.maximum}});let e=$("<div/>",{id:"toggle-cycle-"+l,text:H("ui.cycles"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let t=$("<ul/>",{id:"cycles-list-"+l,css:{display:"none",paddingLeft:"20px"}});for(let e in game.calendar.cycles)t.append(F(e,o));let i=$("<div/>",{id:"toggle-seasons-"+l,text:H("trade.seasons"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let r=$("<ul/>",{id:"seasons-list-"+l,css:{display:"none",paddingLeft:"20px"}});r.append(x("spring",o));r.append(x("summer",o));r.append(x("autumn",o));r.append(x("winter",o));e.on("click",function(){t.toggle();r.toggle(false)});i.on("click",function(){t.toggle(false);r.toggle()});u.append(e,i,a,n,t,r)}else if(l==="reset"){let e;let a=f("reset-build");let t=f("reset-space");let i=b(true);let r=f("reset-religion");let l=f("reset-time");for(e in _.auto.build.items)a.append(T(e,"build",_.auto.build.items[e]));for(e in _.auto.space.items)t.append(T(e,"space",_.auto.space.items[e]));for(e in _.auto.unicorn.items)r.append(T(e,"unicorn",_.auto.unicorn.items[e]));for(e in _.auto.faith.items)r.append(T(e,"faith",_.auto.faith.items[e]));for(e in _.auto.time.items)l.append(T(e,"time",_.auto.time.items[e]));let o=$("<div/>",{id:"toggle-reset-build",text:H("ui.build"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let n=$("<div/>",{id:"toggle-reset-space",text:H("ui.space"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let s=$("<div/>",{id:"toggle-reset-resources",text:H("ui.craft.resources"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let c=$("<div/>",{id:"toggle-reset-religion",text:H("ui.faith"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let g=$("<div/>",{id:"toggle-reset-time",text:H("ui.time"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});o.on("click",function(){a.toggle();t.toggle(false);i.toggle(false);r.toggle(false);l.toggle(false)});n.on("click",function(){a.toggle(false);t.toggle();i.toggle(false);r.toggle(false);l.toggle(false)});s.on("click",function(){a.toggle(false);t.toggle(false);i.toggle();r.toggle(false);l.toggle(false)});c.on("click",function(){a.toggle(false);t.toggle(false);i.toggle(false);r.toggle();l.toggle(false)});g.on("click",function(){a.toggle(false);t.toggle(false);i.toggle(false);r.toggle(false);l.toggle()});u.append(o,n,s,c,g,a,t,i,r,l)}else{n=$("<div/>",{id:"set-"+l+"-subTrigger",text:H("ui.trigger"),title:o.subTrigger,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",o);n.on("click",function(){let e;e=window.prompt(H("ui.trigger.set",[o.label]),o.subTrigger);if(e!==null){o.subTrigger=parseFloat(e);C.items[n.attr("id")]=o.subTrigger;q();n[0].title=o.subTrigger}});u.append(n)}return u}(a,o.items[a]));break;case"options":e.append(function(t,i){let r,l=y(t,i);if(t==="style"){r=l.children("input");r.unbind("change");r.on("change",function(e){i.enabled=r.prop("checked");C.items[r.attr("id")]=i.enabled;if(e.isTrusted)q();let a=document.getElementById("toggleCenter").style;if(i.enabled){document.body.setAttribute("data-ks-style","");game.ui.fullWidth=true;if(!game.ui.isCenter)a.display="none"}else{document.body.removeAttribute("data-ks-style");a.display="";game.ui.fullWidth=undefined}})}if(t==="useWorkers"){r=l.children("input");r.on("click",function(){let e=confirm(H("ui.trigger.useWorkers.alert"));if(e&&!i.enabled){V.stop();i.enabled=true;C.items[r.attr("id")]=i.enabled;if(_.auto.engine.enabled)V.start()}else if(e&&i.enabled){V.stop();i.enabled=false;C.items[r.attr("id")]=i.enabled;if(_.auto.engine.enabled)V.start()}})}if(t==="saves"){r=l.children("input");r.on("click",function(){V.stop(false);let e=window.confirm("点击确认会导出珂学家的配置.txt文件");if(e){let e=$("#download-link");let a=JSON.stringify(window.localStorage["cbc.kitten-scientists"]);let t=game.compressLZData(a,false);let i=new Blob([t],{type:"text/plain"});e.attr("href",window.URL.createObjectURL(i));let r="小猫珂学家配置"+(game.stats.getStat("totalResets").val+1)+"周目";e.attr("download",r+".txt");e.get(0).dispatchEvent(new MouseEvent("click"))}if(_.auto.engine.enabled)V.start(false)});let e=$("<div/>",{id:"loadKS",text:"导入配置",css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",i);e.on("click",function(){V.stop(false);let a=window.prompt("窗口内填入后你需要导入的珂学家配置，确认后会导入配置","");if(_.auto.engine.enabled)V.start(false);if(a&&a.length>=10){let e;if(a.charAt(0)!=="{")e=JSON.parse(LZString.decompressFromBase64(a));window.localStorage["cbc.kitten-scientists"]=e;L()}});let a=$("<div/>",{id:"ressetKS",text:"恢复默认配置",css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",i);a.on("click",function(){if(confirm("确定要初始化珂学家配置吗，点击确认后初始化珂学家配置(最好刷新下页面)\n为了照顾钢铁模式，默认配置小屋、木屋、宅邸默认不勾，请有需要的自行勾上")){V.stop();let e=sessionStorage.getItem("options");delete localStorage["cbc.kitten-scientists"];if(e){$("#ks-options").remove();_.policies=[];_["auto"]=JSON.parse(e).auto;S=$("<div/>",{id:"ks-options",css:{marginBottom:"10px"}});P=$("<ul/>");P.append(v("engine"));if(_.auto.engine.enabled)V.start();U.forEach(e=>{P.append(v(e))});E.prepend(S.append(P));te();L();X("为了照顾钢铁模式，小屋、木屋、宅邸默认不勾，请有需要的自行勾上")}else{game.save();window.location.reload()}}});l.append(e);l.append(a)}if(t==="donate"){r=l.children("input");r.unbind("change");r.on("change",function(e){i.enabled=r.prop("checked");C.items[r.attr("id")]=i.enabled;if(e.isTrusted)q();let a=document.getElementById("ks-donate").style;if(i.enabled)a.display="block";else a.display="none";a=null})}if(t==="wiki"){r=l.children("input");r.on("click",function(){let e=window.open();e.location="https://petercheney.gitee.io/baike/?file=004-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B7%A5%E5%85%B7/02-%E5%B0%8F%E7%8C%AB%E7%A7%91%E5%AD%A6%E5%AE%B6";I(["如果还有问题可以在猫国群询问，有BUG或意见可以联系Cheney。默认配置即推荐配置：文艺复兴玄学下默认配置能2小时冲出轨道。","ks-default",_.activitycolor])})}if(i.subTrigger!==undefined){let a=$("<div/>",{id:"set-"+t+"-subTrigger",text:H("ui.trigger"),title:i.subTrigger,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",i);a.on("click",function(){let e;V.stop(false);if(t==="crypto")e=window.prompt(H("ui.trigger.crypto.set",[i.label]),i.subTrigger);else if(t==="filterGame")e=window.prompt(H("ui.trigger.filterGame.set"),i.subTrigger);else e=window.prompt(H("ui.trigger.set",[i.label]),i.subTrigger);if(_.auto.engine.enabled)V.start(false);if(e!==null){if(t==="crypto")i.subTrigger=e;else if(t==="filterGame"){i.subTrigger=parseFloat(e);ie()}else i.subTrigger=parseFloat(e);C.items[a.attr("id")]=i.subTrigger;q();a[0].title=i.subTrigger}});l.append(a)}return l}(a,o.items[a]));break;case"upgrade":e.append(function(t,i){let r=H("ui.upgrade."+t),l=y(t,i,r);if(t==="policies"){let e=$("<ul/>",{id:"items-list-policies",css:{display:"none",paddingLeft:"20px"}});let a=$("<div/>",{id:"toggle-upgrade-policies-load",text:H("ui.upgrade.policies.load"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let t=$("<div/>",{id:"toggle-upgrade-policies-show",text:H("ui.upgrade.policies.show"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});a.on("click",function(){const a=[];for(const t in game.science.policies){let e=game.science.policies[t];if(e.researched)a.push(e.name)}_.policies=a;q();e.empty();e.append(R())});t.on("click",function(){e.toggle();e.empty();e.append(R())});l.append(t,a,e)}if(i.subTrigger!==undefined&&t==="missions"){let a=$("<div/>",{id:"set-"+t+"-subTrigger",text:H("ui.trigger"),title:i.subTrigger,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",i);a.on("click",function(){let e;V.stop(false);if(t==="missions")e=window.prompt(H("ui.trigger.missions.set"),i.subTrigger.toString());else e=window.prompt(H("ui.trigger.set"),i.subTrigger.toString());if(_.auto.engine.enabled)V.start(false);if(e!==null){i.subTrigger=parseFloat(e);C.items[a.attr("id")]=i.subTrigger;q();a[0].title=i.subTrigger}});l.append(a)}if(t==="upgrades"||t==="techs"){let e=$("<label/>",{for:"toggle-limited-"+t,text:H("ui.upgradesLimit")});let a=$("<input/>",{id:"toggle-limited-"+t,type:"checkbox"}).data("option",i);if(i.limited)a.prop("checked",true);a.on("change",function(){if(a.is(":checked")&&!i.limited){i.limited=true;B("upgrade.limited",[r])}else if(!a.is(":checked")&&i.limited){i.limited=false;B("upgrade.unlimited",[r])}C.items[a.attr("id")]=i.limited;q()});l.append(a,e)}return l}(a,o.items[a]));break;case"distribute":e.append(function(e,a){if(e==="leader")return M(e,a);let t=Q(H("$village.job."+e)),i=y(e,a,t),r=(i.css("borderBottom","1px solid rgba(185, 185, 185, 0.7)"),$("<label/>",{for:"toggle-limited-"+e,text:H("ui.limit")})),l=$("<input/>",{id:"toggle-limited-"+e,type:"checkbox"}).data("option",a);if(a.limited)l.prop("checked",true);l.on("change",function(){if(l.is(":checked")&&!a.limited){a.limited=true;B("distribute.limited",[t])}else if(!l.is(":checked")&&a.limited){a.limited=false;B("distribute.unlimited",[t])}C.items[l.attr("id")]=a.limited;q()}),i.append(l,r);let o=$("<div/>",{id:"set-"+e+"-max",text:H("ui.max",[a.max]),title:a.max,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",a);var n=t;return o.on("click",function(){let e;V.stop(false);e=window.prompt(H("ui.max.set",[n])+" （按max比例分配）",a.max.toString());if(_.auto.engine.enabled)V.start(false);if(e!==null){a.max=Math.max(0,parseInt(e));C.items[o.attr("id")]=a.max;q();o[0].title=a.max;o[0].innerText=H("ui.max",[a.max])}}),i.append(o),i}(a,o.items[a]));break;case"build":case"faith":case"space":case"time":e.append(w(a,o.items[a]));break;default:e.append(y(a,o.items[a]))}r.on("click",function(){e.toggle()})}if(void 0!==o.trigger){let a=$("<div/>",{id:"trigger-"+t,text:H("ui.trigger"),title:o.trigger,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});a.on("click",function(){let e;V.stop(!1),e="faith"===t?window.prompt(H("ui.trigger.set",[l+"("+$I("resources.faith.title")+")"]),o.trigger.toString()):"trade"===t?window.prompt(H("ui.trigger.set",[l+" 的触发值\n需同时满足 种族触发资源 和 "+$I("resources.gold.title")+" 的"]),o.trigger.toString()):window.prompt(H("ui.trigger.set",[l]),o.trigger.toString()),_.auto.engine.enabled&&V.start(!1),null!==e&&(o.trigger=parseFloat(e),q(),a[0].title=o.trigger)}),n.append(a)}if("craft"===t){const g=$("<div/>",{id:"toggle-resource-controls",text:H("ui.craft.resources"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}),u=b();r.on("click",function(){u.toggle(!1)}),g.on("click",function(){e.toggle(!1),u.toggle()}),n.append(g),n.append(u)}else if("faith"===t){const m=$("<div/>",{id:"toggle-addition-controls",text:H("ui.faith.addtion"),title:"太阳教团的自动化项目",css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"2px 2px 5px gray"}}),d=function(){var e,t;let i=f("faith-addition"),r=_.auto.faith.addition;for(e in r){let a=y(e,r[e]);if("bestUnicornBuilding"===e){a.children("label").prop("title",H("option.faith.best.unicorn.desc"));let e=a.children("input");e.unbind("change"),e.on("change",e=>{let a=r.bestUnicornBuilding;e.target.checked&&!a.enabled?(a.enabled=!0,B("status.sub.enable",[H("option.faith.best.unicorn")]),B("option.faith.best.unicorn.desc")):!e.target.checked&&a.enabled&&(a.enabled=!1,B("status.sub.disable",[H("option.faith.best.unicorn")])),C.items[e.target.id]=a.enabled,q()})}void 0!==r[e].subTrigger&&(t=$("<div/>",{id:"set-"+e+"-subTrigger",text:H("ui.trigger"),title:r[e].subTrigger,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",r[e]),function(a,t){"adore"===a?t.on("click",function(){var e;V.stop(!1),e=window.prompt(H("adore.trigger.set"),r[a].subTrigger),_.auto.engine.enabled&&V.start(!1),null!==e&&(r[a].subTrigger=parseFloat(e),C.items[t[0].id]=r[a].subTrigger,q(),t[0].title=r[a].subTrigger)}):"autoPraise"===a&&t.on("click",function(){var e;V.stop(!1),e=window.prompt(H("parise.trigger.set",[H("option.praise")]),r[a].subTrigger),_.auto.engine.enabled&&V.start(!1),null!==e&&(r[a].subTrigger=parseFloat(e),C.items[t[0].id]=r[a].subTrigger,q(),t[0].title=r[a].subTrigger)})}(e,t),a.append(t)),i.append(a)}return i}();r.on("click",function(){d.toggle(!1)}),m.on("click",function(){e.toggle(!1),d.toggle()}),n.append(m);for(const p in _.auto.unicorn.items){const h=e.children().children("#toggle-"+p);h.on("change",function(e){if(!$(e.target).is(":checked")){const a=$("#toggle-bestUnicornBuilding");a.prop("checked",!1),a.trigger("change")}})}n.append(d)}return o.items&&n.append(i,e),n},k=function(e,a,t){let i=Q(H("$trade.race."+e)),r=Q(H("$calendar.season."+a)),l=$("<li/>");var o=$("<label/>",{for:"toggle-"+e+"-"+a,text:Q(r)});let n=$("<input/>",{id:"toggle-"+e+"-"+a,type:"checkbox"}).data("option",t);return t[a]&&n.prop("checked",!0),n.on("change",function(){n.is(":checked")&&!t[a]?(t[a]=!0,B("trade.season.enable",[i,r])):!n.is(":checked")&&t[a]&&(t[a]=!1,B("trade.season.disable",[i,r])),C.items[n.attr("id")]=t[a],q()}),l.append(n,o),l},x=function(e,a){let t=Q(H("$calendar.season."+e)),i=$("<li/>");var r=$("<label/>",{for:"toggle-timeSkip-"+e,text:Q(t)});let l=$("<input/>",{id:"toggle-timeSkip-"+e,type:"checkbox"}).data("option",a);return a[e]&&l.prop("checked",!0),l.on("change",function(){l.is(":checked")&&!a[e]?(a[e]=!0,B("time.skip.season.enable",[t])):!l.is(":checked")&&a[e]&&(a[e]=!1,B("time.skip.season.disable",[t])),C.items[l.attr("id")]=a[e],q()}),i.append(l,r),i},y=function(e,a,t){let i=$("<li/>"),r=t||a.label||Q(e);t=a.require?game.resPool.get(a.require).title:H("ui.none");let l=H("ui.trigger.resource")+": "+t;void 0===a.require&&(l=null);t=$("<label/>",{for:"toggle-"+e,text:r,title:l,css:{display:"inline-block",minWidth:"80px"}});let o=$("<input/>",{id:"toggle-"+e,type:"checkbox"}).data("option",a);return a.enabled&&o.prop("checked",!0),o.on("change",function(){o.is(":checked")&&!a.enabled?(a.enabled=!0,-1<e.indexOf("Filter")?B("filter.enable",[r]):a.misc?B("status.sub.enable",[r]):(B("status.auto.enable",[r]),"wood"===e&&B("msg.catnip"))):!o.is(":checked")&&a.enabled&&(a.enabled=!1,-1<e.indexOf("Filter")?B("filter.disable",[r]):a.misc?B("status.sub.disable",[r]):B("status.auto.disable",[r])),C.items[o.attr("id")]=a.enabled,"saves"!==e&&q()}),i.append(o,t),i},R=function(e){let a=[];for(var t in _.policies){let e=_.policies[t];"authocracy"===e&&(e="autocracy"),a.push($("<div/>",{id:"policy-"+e,text:H("$policy."+e+".label"),css:{cursor:"pointer",textShadow:"3px 3px 4px gray"}}))}return a},w=function(e,a,t){let i=$("<li/>"),r=t||a.label||Q(e);t=a.require?game.resPool.get(a.require).title:H("ui.none"),t=$("<label/>",{for:"toggle-"+e,text:r,title:H("ui.trigger.resource")+": "+t,css:{display:"inline-block",minWidth:"80px"}});let l=$("<input/>",{id:"toggle-"+e,type:"checkbox"}).data("option",a),o=(a.enabled&&l.prop("checked",!0),l.on("change",function(){l.is(":checked")&&!a.enabled?(a.enabled=!0,-1<e.indexOf("Filter")?B("filter.enable",[r]):a.misc?B("status.sub.enable",[r]):(B("status.auto.enable",[r]),"field"===e&&B("msg.catnip"))):!l.is(":checked")&&a.enabled&&(a.enabled=!1,-1<e.indexOf("Filter")?B("filter.disable",[r]):a.misc?B("status.sub.disable",[r]):B("status.auto.disable",[r])),C.items[l.attr("id")]=a.enabled,q()}),$("<div/>",{id:"set-"+e+"-max",text:H("ui.max",[a.max]),title:a.max,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",a));return o.on("click",function(){var e;V.stop(!1),e=window.prompt(H("ui.max.set",[a.label])+"\n -1为没有上限",a.max.toString()),_.auto.engine.enabled&&V.start(!1),null!==e&&(a.max=parseInt(e),C.items[o.attr("id")]=a.max,q(),o[0].title=a.max,o[0].innerText=H("ui.max",[a.max]))}),i.append(l,t,o),i},F=function(e,a){let t=game.calendar.cycles[e],i=$("<li/>");var r=$("<label/>",{for:"toggle-timeSkip-"+e,text:t.title});let l=$("<input/>",{id:"toggle-timeSkip-"+e,type:"checkbox"}).data("option",a);return a[e]&&l.prop("checked",!0),l.on("change",function(){l.is(":checked")&&!a[e]?(a[e]=!0,B("time.skip.cycle.enable",[t.title])):!l.is(":checked")&&a[e]&&(a[e]=!1,B("time.skip.cycle.disable",[t.title])),C.items[l.attr("id")]=a[e],q()}),i.append(l,r),i},T=function(e,a,t){let i=$("<li/>"),r=t.label;var l=$("<label/>",{for:"toggle-reset-"+a+"-"+e,text:r,css:{display:"inline-block",minWidth:"80px"}});let o=$("<input/>",{id:"toggle-reset-"+a+"-"+e,type:"checkbox"}).data("option",t),n=(t.checkForReset&&o.prop("checked",!0),o.on("change",function(){o.is(":checked")&&!t.checkForReset?(t.checkForReset=!0,B("status.reset.check.enable",[r])):!o.is(":checked")&&t.checkForReset&&(t.checkForReset=!1,B("status.reset.check.disable",[r])),C.items[o.attr("id")]=t.checkForReset,q()}),$("<div/>",{id:"set-reset-"+a+"-"+e+"-min",text:H("ui.min",[t.triggerForReset]),title:t.triggerForReset,css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}}).data("option",t));return n.on("click",function(){var e=window.prompt(H("reset.check.trigger.set",[t.label]),t.triggerForReset.toString());null!==e&&(t.triggerForReset=parseInt(e),C.items[n.attr("id")]=t.triggerForReset,q(),n[0].title=t.triggerForReset,n[0].innerText=H("ui.min",[t.triggerForReset]))}),i.append(o,l,n),i},M=function(e,a){let t;var i=Q(H("distribute.makeLeader"));let r=y(e,a,i),l=(r.css("borderBottom","1px solid rgba(185, 185, 185, 0.7)"),$("<ul/>",{id:"items-list-traits",css:{display:"none",paddingLeft:"20px"}})),o=$("<div/>",{id:"toggle-leaderTrait"+e,text:H("$village.trait.filter.all"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});for(t in window.com.nuclearunicorn.game.village.Kitten().traits)l.append(g(t,a));o.on("click",function(){n.toggle(!1),l.toggle()});let n=$("<ul/>",{id:"items-list-jobs",css:{display:"none",paddingLeft:"20px"}}),s=$("<div/>",{id:"toggle-leaderJob"+e,text:H("$village.panel.job"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});for(t in game.village.jobs)n.append(c(t,a));return s.on("click",function(){l.toggle(!1),n.toggle()}),r.append(o,s,l,n),r},c=function(e,a){let t=game.village.jobs,i=t[e],r=$("<li/>");e=$("<label/>",{for:"toggle-leaderJob-"+i.name,text:i.title,css:{cursor:"pointer",textShadow:"3px 3px 4px gray"}});let l=$("<input/>",{id:"toggle-leaderJob-"+i.name,name:"leaderJob",value:i.name,type:"radio"}).data("option",a);return l.prop("value")===a.leaderJob&&l.prop("checked",!0),l.on("change",function(){B("distribute.leaderJob",[i.title]),a.leaderJob=$("input[name='leaderJob']:checked").val(),t.forEach(e=>{delete C.items["toggle-leaderJob-"+e.name]}),C.items["toggle-leaderJob-"+a.leaderJob]=!0,q()}),r.append(l,e),r},g=function(e,a){let t=window.com.nuclearunicorn.game.village.Kitten().traits;const i=t[e],r=$("<li/>");e=$("<label/>",{for:"toggle-leaderTrait-"+i.name,text:i.title,css:{cursor:"pointer",textShadow:"3px 3px 4px gray"}});const l=$("<input/>",{id:"toggle-leaderTrait-"+i.name,name:"leaderTrait",value:i.name,type:"radio"}).data("option",a);return l.prop("value")===a.leaderTrait&&l.prop("checked",!0),l.on("change",function(){B("distribute.leaderTrait",[i.title]),a.leaderTrait=$(this).val(),t.forEach(e=>{delete C.items["toggle-leaderTrait-"+e.name]}),C.items["toggle-leaderTrait-"+a.leaderTrait]=!0,q()}),r.append(l,e),r},E=$("#rightColumn"),S=$("<div/>",{id:"ks-options",css:{marginBottom:"10px"}}),P=$("<ul/>");P.append(v("engine")),U.forEach(e=>{P.append(v(e))});{h="1HDV6VEnXH9m8PJuT4eQD7v8jRnucbneaq";let e=$("<li/>",{id:"ks-donate"}).append($("<a/>",{href:"bitcoin:"+h+"?amount=0.00048&label=Kittens Donation",target:"_blank",text:h})).prepend($('<img alt="bit" src="https://s1.ax1x.com/2022/04/30/OSmUAK.png" height="15px" />',{css:{height:"15px",width:"15px",padding:"3px 4px 0 4px",verticalAlign:"bottom"}}));e.css("padding","5px"),P.append(e)}E.prepend(S.append(P));h=$("<a/>",{css:{display:"inline-block",textShadow:"1px 1px 1px gray",transformOrigin:"bottom",fontStyle:"italic",transform:"scale(0.8)",paddingLeft:"3px"},text:e,target:"_blank",href:"https://petercheney.gitee.io/scientists/updateLog.html?v="+(new Date).getDate()});$("#ks-engine").append(h)}e=_.auto.build.items;_.auto.build.items=Object.assign({amphitheatre:e.amphitheatre,reactor:e.reactor,magneto:e.magneto,steamworks:e.steamworks},e);let ee=(e,a,t)=>{a?z.other["auto."+e]=null:z.other["auto."+e]||(t=t||"miscFilter",X(H("summary.auto."+e),t),ae("auto."+e))},G=e=>{for(var a in e){a=e[a];ae(a.name,a.val,"resConsume")}},z,P=function(){let e=game.calendar;z={lastyear:e.year,lastTrueYear:e.trueYear(),lastday:e.day,lastSeason:e.season,ksTime:0,totalTicks:0,praise:[0,0],adore:[0,0],craft:{},trade:{},build:{},other:{},resGain:{},resConsume:{},research:{}}},ae=(P(),function(e,a,t){void 0===a&&(a=1),void 0===t&&(t="other"),void 0===z[t]&&(z[t]={}),void 0===z[t][e]?z[t][e]=parseFloat(a):z[t][e]+=parseFloat(a)});let E=e=>{var a=z[e],t=a[0],a=game.getDisplayValueExt(a[1]);t&&k("summary."+e,[game.getDisplayValueExt(t),a])},S=$("<div/>",{id:"activity-box",css:{display:"inline-block",verticalAlign:"top"}}),O=$("<a/>",{id:"showActivityHref",text:H("summary.show"),href:"#",css:{verticalAlign:"top"}});O.on("click",function(){game.console.messages.length>game.console.maxMessages-250&&game.clearLog(),re();var e="=".repeat(24);let a,t,i;var r=z.resGain;for(t in r){var l=r[t];l&&(i=game.msg("小喵共获得了 "+game.getDisplayValueExt(l)+" "+$I("resources."+t+".title"),null,null,!0),$(i.span).css("color","#ff589c"))}i&&(game.msg(e,"notice"),i=null);var o=z.resConsume,n=game.resPool.resources;for(let e=n.length-1;0<e&&o;e--){var s=o[t=n[e].name];s&&(i=game.msg("小喵共消耗了 "+game.getDisplayValueExt(s)+" "+$I("resources."+t+".title"),null,null,!0),$(i.span).css("color","#DC143C"))}i&&game.msg(e,"notice");var c=z.other;for(const f in c){let e=c[f];e&&(e="number"==typeof e?game.getDisplayValueExt(e):e,k("summary."+f,[e]))}E("praise"),E("adore");var g=z.research;for(t in g)a=(a=g[t])?"科学家":"",k("summary.tech",[a+"小猫研究了 "+Q(t)]);for(t in z.upgrade)a=(a=z.upgrade[t])?"科学家":"",k("summary.upgrade",[a+"小猫发明了 "+Q(t)]);["faith","build","craft","craftLeader","trade"].forEach(e=>{var a,t=z[e];for(a in t)k("summary."+e,[game.getDisplayValueExt(t[a]),Q(a)])});var u=z.lastyear,m=z.lastday;if(u+m){let e=game.calendar;var u=e.year-u,m=e.day-m,d=e.trueYear()-z.lastTrueYear,p=e.season-z.lastSeason,h=e.daysPerSeason,b=e.seasonsPerYear;let a="";400<=(m=m+400*u+p*h)&&(a=(a+=u+" ")+(1==u?H("summary.year"):H("summary.years"))),0<=m&&(0<u&&(a+=H("summary.separator")),a=(a+=(p=m%400,+(Math.round(+(p+"e+2"))+"e-2")+" "))+(1==m?H("summary.day"):H("summary.days"))),k("summary.head",[a]),0<d&&(u=game.toDisplaySeconds(d*b*h*e.ticksPerDay/game.ticksPerSecond),v("总共 "+u+" 的小喵种田时间"))}p=_.auto.filter,p.enabled&&p.items.craftFilter.enabled&&p.items.buildFilter.enabled&&!game.console.filters.faith.enabled&&!game.console.filters.astronomicalEvent.enabled||(v(e),game.msg("喵喵提示：游戏(珂学家)日志消耗性能会比较多","alert")),m=z.ksTime;if(m){d=z.totalTicks;let i=Math.pow(10,2+game.opts.forceHighPrecision);v(H("time.ks",[d,(e=>{var a=Math.round(e*i)/i;let t=Math.round(e%1e3*i)/i;return t=1e3<e?game.toDisplaySeconds(Math.floor(a/1e3))+t:t})(m),Math.round(m*i/d)/i]))}P()}),S.append(O),$("#clearLog").append(S);const c=$("<div/>",{id:"important-msg-box",class:"dialog help",css:{display:"none",width:"auto",height:"auto"}});let J=$("<a/>",{text:H("ui.close"),href:"#",css:{position:"absolute",top:"10px",right:"15px"}}),K=(J.on("click",function(){c.toggle()}),$("<h1/>",{id:"mb-title",text:"test text"})),N=$("<h1/>",{id:"mb-content",text:"test text"});c.append(J,K,N),$("#gamePageContainer").append(c);let V=new f,g,te=()=>{(g=$("#toggle-engine")).on("change",function(){let e=_.auto.engine;g.is(":checked")?(e.enabled=!0,V.start(),re(),setTimeout(()=>{e.enabled&&l("如需查看小喵做过什么，可以点击小猫总结(清空日志旁边)")},2e3),-.03<game.getEffect("priceRatio")&&game.religion.transcendenceTier<4&&ee("ksHelp",!1,"noFilter")):(e.enabled=!1,V.stop())})},ie=(te(),_.auto.cache.dataTimer.trueYear=game.calendar.trueYear(),_.auto.cache.dataTimer.ticksTotal=game.timer.ticksTotal,_.auto.cache.dataTimer.saveId=game.telemetry.guid,sessionStorage.setItem("options",JSON.stringify(_)),L(),()=>{game.console.maxMessages=Math.min(Math.max(300,_.auto.options.items.filterGame.subTrigger),2e3)}),re=(ie(),$("#toggle-style").trigger("change"),$("#toggle-donate").trigger("change"),console&&console.log&&console.log(b+" loaded"),game._publish("kitten_scientists/ready",b),()=>{var e,a=_.auto.resources;let t;for(e in a){var i=a[e];i.enabled&&i.stock&&("furs"===e&&350===i.stock||(t=!0,i=game.msg($I("resources."+e+".title")+"库存："+game.getDisplayValueExt(i.stock),null,null,!0),$(i.span).css("color","#ff589c")))}t&&(X("小喵的库存："),l("可爱的猫猫珂学家提示挂机尽量别设置库存"))});C.reset&&C.reset.reset?(C.reset.karmaTotal+=Y.karma.value-Number(C.reset.karmaLastTime),C.reset.paraonTotal+=Y.paragon.value-Number(C.reset.paragonLastTime),C.reset.reset=!1,h=H("summary.time.reset.title",[C.reset.times]),e=H("summary.time.reset.content",[C.reset.karmaTotal,C.reset.paragonTotal]),K.html(h),N.html(e),c.toggle(),g.prop("checked",!0),g.trigger("change"),B("reset.after")):C.reset={reset:!1,times:0,paragonLastTime:0,paragonTotal:0,karmaLastTime:0,karmaTotal:0},q();let le=setInterval(function(){var e;!_.auto.engine.enabled&&_.auto.options.items.autoScientists.enabled?0===(e=_.countdown)?(g.click(),clearInterval(le),B("reset.after")):10<e?(e%60==0&&B("auto.tip"),e%10==0&&j("auto.countdown",[e]),--_.countdown):e<=10&&(B("reset.countdown."+e),--_.countdown):clearInterval(le)},1e3)},window.loadTest=function(){if("undefined"==typeof gamePage||"undefined"==typeof i18nLang)setTimeout(function(){window.loadTest()},1e3);else{var e,a=game.workshop.upgrades;for(e in a){var t=a[e];game.workshop.metaCache[t.name]=t}game.workshop.metaCache[void 0]=null,delete game.workshop.metaCache[void 0],window.run(),window.loadTest=window.run=null}},setTimeout(function(){window.loadTest()},1e3);