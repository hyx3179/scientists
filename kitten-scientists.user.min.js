window.run=function(){const m="V15.209";var d="小猫珂学家版本"+m;const A={zh:{"option.observe":"观测天文现象","option.festival":"举办节日","option.praise":"赞美太阳","option.autofeed":"献祭死灵兽","option.hunt":"派出猎人","option.crypto":"黑币交易","option.embassies":"建造大使馆","option.style":"占满屏幕","option.useWorkers":"启用后台满速珂学家","filter.build":"建筑","filter.craft":"工艺制作","filter.space":"太空相关","filter.upgrade":"工坊升级","filter.research":"科学研究","filter.policy":"政策","filter.upgBld":"营火建筑升级","filter.trade":"贸易","filter.embassy":"大使馆","filter.hunt":"狩猎","filter.praise":"赞美太阳","filter.adore":"赞美群星","filter.transcend":"次元超越","filter.sacrifice":"献祭","filter.faithBld":"太阳教团","filter.accelerate":"光阴似箭","filter.time.skip":"时间跳转","filter.festival":"举办节日","filter.star":"天文现象","filter.distribute":"猫猫分配","filter.leader":"领袖相关","filter.misc":"喵喵喵","dispose.necrocorn":"小猫帮你处理掉了影响效率的多余死灵兽","act.feed":"小猫向利维坦献上祭品。古神很高兴","blackcoin.buy":"小猫花掉 {1} 遗物，加仓了 {0} 黑币","blackcoin.sell":"小猫抛售 {1} 黑币，套现了 {0} 遗物","act.observe":"小猫观测了天文现象{0}","act.hunt":"{0} 波{1}去打猎","act.hunt.unicorn":"小猫急着派出猎人帮独角兽配种，呜呼十连爪ฅ ฅ","act.hunt.trade":"小猫贸易后决定去打猎","act.hunt.mint":"毛皮或羊皮纸处于低储量","act.build":"小猫建造了一个 {0}","act.builds":"小猫建造了 {1} 个新的 {0}","act.craft":" {0} {1}","act.trade":" {1} 交易 {0} 次","upgrade.space.mission":"小猫执行了 {0} 的任务","upgrade.space":"小猫执行了 {0}","upgrade.race":"小猫探险遇到了新的文明：{0}","upgrade.upgrade":"{1}发明了 {0}","upgrade.limited":"优化 {0}","upgrade.unlimited":"全部 {0}","upgrade.tech":"{1}研究了 {0}","upgrade.policy":"小猫通过了 {0} 法案","festival.hold":"呜呼，小猫开趴了","festival.extend":"小猫加了一年钟","build.embassy":"在 {1} 设立了 {0} 个大使馆","build.embassies":"在 {1} 设立了 {0} 个大使馆","act.praise":"赞美太阳! 消耗了 {0} 信仰转化成 {1} 的虔诚","autoPraise.trigger.set":"输入新的赞美太阳的触发值，取值范围为 0 到 1的纯小数\n 当为0.98时且点出太阳革命，若虔诚太少小猫每天赞美太阳","summary.praise.msg":"虔诚的小猫每天都会赞美太阳，直到太阳革命加成大于 {0} %<br>说你了虔诚太低了! (虔诚滚猫咪越滚越虔诚","act.sun.discover":"小猫在宗教祷告了 {0} ","act.sun.discovers":"小猫在宗教祷告了 {0} {1} 次","act.sun.discovers.leader":"哲学家小猫在宗教祷告了 {0} {1} 次","tcRefine.trigger.set":"输入触发精炼水晶功能的时间水晶最低数量，其最低值\n暂时只支持黑之连结大于35才会触发","ui.items":"项目","ui.disable.all":"全部禁用","ui.enable.all":"全部启用","ui.craft.resources":"资源","ui.trigger":"触发条件","ui.trigger.set":"输入资源的 {0} 触发条件，取值范围为 0 到 1 的小数。\n\n 触发条件的意思：当前项目的触发资源的数量 / 资源的上限数量 \n鼠标移动到该项目名字上能看到触发资源","ui.trigger.resource":"触发资源为","ui.none":"无","ui.limit":"限制","ui.tradeLimit":"AI计算","ui.distributeLimit":"限量","ui.craftLimit":"AI平衡","ui.upgradesLimit":"优选","ui.trigger.filterGame.set":"设置游戏日志数量上限","ui.trigger.missions.set":"输入一个新的 探索星球 触发值,取值范围为 0 到 13 的整数。\n分别对应13颗星球。\n\n默认优先碧池探索，会暂时跳过沙丘","ui.trigger.crypto.set":"输入一个新的 {0} 触发值，\n支持3个参数：-符号隔开数字参数\n第一个数字：当遗物数量大于触发值才会进行黑币交易\n第二个数字：买入的最高价（超过这价格就不会买了）\n第三个数字：卖出最低的价格。（低于这价格就不会卖出）\n默认1e7-881-1060","ui.engine":"启用小猫珂学家","ui.build":"营火","ui.space":"太空","ui.craft":"工艺","ui.upgrade":"升级","ui.trade":"贸易","ui.faith":"宗教","ui.time":"时间","ui.options":"小喵杂项","ui.filter":"日志过滤","ui.distribute":"喵喵管理","ui.max":"Max: {0}","msg.catnip":"如果寒冬猫薄荷产量低于0，连续寒冷的天气，小猫会饿死<br>小猫珂学家会留下过寒冬的猫薄荷","ui.upgrade.upgrades":"工坊升级","ui.upgrade.techs":"科学科技","ui.upgrade.races":"探险者出发!","ui.upgrade.missions":"探索星球","ui.upgrade.buildings":"升级建筑","ui.upgrade.policies":"政策","ui.upgrade.policies.load":"读取","ui.upgrade.policies.show":"列表","ui.faith.addition":"宗教附加","option.faith.best.unicorn":"自动最佳独角兽建筑","option.faith.best.unicorn.desc":"自动献祭独角兽，并会以独角兽或象牙来决定建造独角兽牧场~象牙塔...太阳尖顶<br>当象牙不足时会切换成象牙模式具体可以点击小猫总结看到(概览无象牙模式)",unicornSacrifice:"小猫让 {0} 个独角兽群返回了天上的维度，收集了 {1} 滴独角兽的眼泪","option.faith.transcend":"自动最佳次元超越","summary.transcend.catnip":"喵喵喵，你也不想次元超越再赞美群星后让小喵饿死吧？（猫薄荷产量将是：{0}）","act.transcend":"消耗 {0} 顿悟，达到次元超越 {1}","summary.transcend":"次元超越了 {0} 次","option.faith.adore":"赞美群星","act.adore":"赞美群星! 消耗了 {0} 虔诚转化成 {1} 顿悟","act.adore.last":"下次小猫赞美群星，会等到虔诚大于 {0} ","summary.adore":"赞美群星了 {0} 次，共积累了 {1} 顿悟","summary.adore.catnip":"喵喵喵，你也不想赞美群星后让小喵饿死吧？（猫薄荷产量将是：{0}）","summary.adore.solar":"聪明的小猫已经会算期望了，当太阳革命加成到达：{0}% 后才会赞美群星","summary.adore.last":"下次赞美群星会等到虔诚大于{0} ","adore.trigger.set":"赞美群星再赞美太阳后的太阳革命加成 ≥ 触发条件 * 1000%，\n触发条件取值范围为 0 到 1 的小数（0.001为自动模式）\n\n同时满足以下条件珂学家将自动赞美群星。\n1. 当前信仰 / 信仰上限 ≥ 0.98(赞美太阳触发条件设置0.98配合使用)\n2.有月球前哨\n3.赞美群星后的猫薄荷产量＞0。\n推荐启用该功能多放几个农民，喵喵保护协会不允许饿死喵喵喵\n优先次元超越 => 赞美群星 => 赞美太阳","option.faith.alicorn":"献祭天角兽(还未新建文件夹)","option.faith.tcRefine":"精炼水晶","resources.add":"添加资源","resources.clear.unused":"清除未使用","resources.stock":"库存: {0}","resources.consume":"消耗率: {0}","resources.del":"删除","resources.stock.set":"设置 {0} 的库存","resources.consume.set":"设置 {0} 的消耗率","resources.del.confirm":"确定要取消 {0} 的库存控制?","status.ks.enable":"神说，要有猫猫珂学家!","status.ks.disable":"太敬业了，该歇了","status.sub.enable":"启用 {0}","status.auto.enable":"启用自动化 {0}","status.sub.disable":"禁用 {0}","status.auto.disable":"禁用自动化 {0}","time.game":"猫珂学家等待游戏处理{0} 毫秒","time.ks":"可爱小喵珂学家一共为你服务了 {0} 次，珂学家处理共耗时 {1} 毫秒，平均耗时 {2} 毫秒","trade.limited":"贸易获得数量大于产量时才与 {0} 贸易，次数自动限制","trade.limitedTitle":"根据产量和贸易获得数量","trade.unlimited":"{1}与 {0} 的 贸易","trade.seasons":"季节","trade.season.enable":"启用在 {1} 与 {0} 的贸易","trade.season.disable":"停止在 {1} 与 {0} 的贸易","trade.catnip":"ฅ'ω'ฅ，你也不想让小喵饿死吧？与鲨鱼贸易喽","filter.enable":"过滤 {0}","filter.disable":"取消过滤 {0}","craft.force":"为了研究{1}，喵喵偷偷拿了资源合成了{0}，呐呐呐，她才不会心痛了~♪","craft.CacheSteel":"小猫急急急，存材料点工坊升级{0}，真的就用了亿点点材料~为了发展果咩捏","craft.forceSteel":"小猫为了工坊升级{0}，偷偷用了亿点点材料合成了钢<br>喵喵了?! 喵喵已经逃跑了 ! ε=ε=ε=ε=ε=ε=╭(;> ω <)ﾉ","craft.limited":"平衡{0}（理解为小猫AI控制触发条件、消耗率，挂机效率会比较高）","craft.limitedTitle":"根据原材料和目标材料的数量","craft.unlimited":"触发资源：{1}{0}","distribute.limited":"分配 {0} 的数量不会超过Max","distribute.leaderJob":"领袖工作为 {0} ","distribute.leaderTrait":"领袖的特质为 {0} ","distribute.unlimited":"总Max数量分配完后， {0} 的数量允许超过MAX","distribute.makeLeader":"分配领袖","act.distribute":"抓住一只空闲猫猫分配为 {0}","act.distribute.catnip":"担心你的猫猫没有猫薄荷吸并强制分配到农民<br>农民自动分配无视Max~","act.distributeLeader":"分配一只 {0} 猫猫领袖","ui.max.set":"设置 {0} 的最大值","summary.distribute":"帮助 {0} 只偷吃猫薄荷的猫猫找到工作","set.leader":"{0}，喵喵喵！","option.promote":"提拔领袖小猫","act.promote":"花费了 {1} 黄金，小猫领袖被提拔到 {0} 级","summary.promote":"提拔领袖 {0} 次","ui.trigger.useWorkers.alert":"比如玩别的游戏或者在干别的事情，浏览器可能会慢10倍的速度运行\n勾选后将会防止浏览器休眠珂学家，注意会导致使用内存增多，性能消耗增加。\n电脑不好、内存< 8G的建议禁用\n推荐过滤全部日志会减少性能的消耗。\n\n需满足浏览器支持且游戏选项的web worker启用。\n确认后会自动重新勾选启用珂学家\n 最小化浏览器必定会进入后台(游戏和珂学家速度都会被浏览器减慢10倍)","ui.timeCtrl":"时间管理","option.accelerate":"光阴似箭","act.accelerate":"固有时制御，二倍速!","act.accelerate.acl":"抓稳了，猫猫要开始加速了!","act.accelerate.slow":"不行了，猫猫要减速了","act.accelerate.fine":"没关系，{0}已经很厉害了 ❤","act.accelerate.za":"一遇到加速这种事情好急啊，呐~是因为点累了吧 ❤","summary.accelerate":"小猫加速时间 {0} 次","option.time.skip":"时间跳转","act.time.skip":"燃烧时间水晶, 跳过接下来的 {0} 年!","ui.cycles":"周期","ui.maximum":"单次数量","time.skip.cycle.enable":"启用在 {0} 跳转时间并允许跳过该周期","time.skip.cycle.disable":"停止在 {0} 跳转时间并禁止跳过该周期","time.skip.season.enable":"启用在 {0} 跳转时间","time.skip.season.disable":"停止在 {0} 跳转时间","time.skip.trigger.set":"拥有时间水晶数量大于该触发值才会燃烧时间水晶，取值范围为正整数。\n注意会计算时间水晶库存\n周期默认全勾就行，珂学家会自动判断是否停在红月\n每2秒烧水晶次数固定为 0.04x时计炉(无千禧年0.02)，故单次数量进一法就行\n如果资源回复后资源一直是满的，建议过滤大部分日志\n\n故长挂推荐：触发条件200，单次数量1，周期全勾","summary.time.skip":"燃烧时间水晶，跳过 {0} 年","option.time.reset":"重启时间线 (弃用)","status.reset.check.enable":"在重启时间线前检查 {0}","status.reset.check.disable":"在重启时间线前不检查 {0}","ui.min":"Min: {0}","reset.check.trigger.set":"为 {0} 设置新的触发值.\n-1 表示必须将此建筑建造至超过资源上限为止","reset.check":"{0} 的触发值: {1}, 现在共有 {2}","reset.checked":"所有条件都已满足，时间线将在几秒后重启!","reset.tip":'你可以通过取消 "启用小猫珂学家" 或 "时间操控" 或 "重启时间线" 以取消此次重启',"reset.countdown.10":"10 - 正在收获猫薄荷","reset.countdown.9":"&nbsp;9 - 正在献祭独角兽","reset.countdown.8":"&nbsp;8 - 正在放生蜥蜴","reset.countdown.7":"&nbsp;7 - 正在拆解电磁炮","reset.countdown.6":"&nbsp;6 - 正在启动时间引擎","reset.countdown.5":"&nbsp;5 - 正在融化黑币","reset.countdown.4":"&nbsp;4 - 正在关闭卫星","reset.countdown.3":"&nbsp;3 - 正在打开时空裂隙","reset.countdown.2":"&nbsp;2 - 正在启动时间锻造","reset.countdown.1":"&nbsp;1 - 时间引擎已启动!","reset.countdown.0":"&nbsp;0 - 时空裂缝已打开!","reset.last.message":"我们下个庞加莱回归再见","reset.after":"初次见面，可爱的猫猫珂学家为您服务","reset.cancel.message":"重启时间线计划取消.","reset.cancel.activity":"喵斯顿，我们有麻烦了.","summary.time.reset.title":"过去 {0} 个时间线的总结","summary.time.reset.content":"获得 {0} 业.<br>获得 {1} 领导力.","ui.close":"关闭","auto.countdown":"{0} 秒后将会自动启用珂学家","auto.tip":'你可以通过取消 "首次自动启用珂学家" 以取消此次自动开启',"option.fix.cry":"修复冷冻仓","act.fix.cry":"小猫修复了 {0} 个冷冻仓","summary.fix.cry":"修复了 {0} 个冷冻仓","summary.auto.150Faith":"你的信仰空了，看看你的宗教，有新东西","summary.auto.1000Faith":"你的信仰空了，无所谓，太阳革命会出手","summary.auto.academy":"吾等猫类看不上研究院♪呐","summary.auto.anyChallengeActive":"挑战模式中请自己点政策<br>挑战模式中请自己点政策<br>挑战模式中请自己点政策","summary.auto.apocripha":"超越喵喵极限，新约外传才有用捏","summary.auto.aqueduct":"心中无水渠，发展自然神，除非它给的猫薄荷实在太多了","summary.auto.aqueductCatnip":"水渠，饿饿，饭饭","summary.auto.bestUnicorn":"推荐勾选自动最佳独角兽，AI计算建筑，独角兽天角兽都会获得更快","summary.auto.biolab":"小猫为了节省合金发展，轨道测地学前不建造，太空制造前生物实验室优先级降低","summary.auto.blackCore":"活祭之猫的黑之核心不是特别适合呐","summary.auto.bls":"小猫存眼泪准备搅拌这悲伤的液体","summary.auto.biology":"喵星人不需要愚蠢的生物学 ฅ(๑˙o˙๑)ฅ ","summary.auto.broadcastTower":"小猫知道你缺钛，等钛上限时才会建造更多的广播塔","summary.auto.caravanserai":"储存黄金为了商队驿站。~打败斑马的第一步","summary.auto.changeLeader":"同时勾选提拔领袖小猫、喵喵管理、分配领袖，小喵服务时自会动切换对应领袖特质，发展会快很多的喵<br>科学和工坊升级换到科学家领袖，比如神学的科学价格变为19K等等","summary.auto.craftCatnip":"呐呐呐，你也不想让寒冬时小喵饿死吧？喵粮上交","summary.auto.craftLimited":"每次运行都会合成工艺(即无视触发条件)，数量AI自动。挂机发展速度会远大于触发条件的。","summary.auto.crossbow":"铁当然是要来用来改良弩，喵用喵说好","summary.auto.concreteHuts":"再多问斑马要亿点点钛，就能住上混凝土小屋了","summary.auto.defaultPriest":"默认无限制牧师，如需要限制请更改max","summary.auto.drama":"喵力产量低，羊皮纸库存低，聪明的小猫就不勾栏听曲啦","summary.auto.factory":"有了更多钛的后，小猫下次一定造工厂","summary.auto.fuelInjectors":"给蒸汽工房换上你燃料喷射器捏","summary.auto.furs":"我知道你很急，但是先别急，<br>更高的制作工艺加成后，同样的毛皮会制作更多的羊皮纸","summary.auto.geologist":"黄金和煤有点缺，就多了亿点点搬砖的地质学家","summary.auto.harbor":"港口需要的金属板太多，小猫会少造亿点点(一定是斑马的阴谋","summary.auto.hunter":"未发明弩和导航学，小猫当猎人欲望降低","summary.auto.hunterLess":"想致富，先砍树，打猎什么的放一放","summary.auto.ironFactory":"如果钢的合成数量偏少，推荐关闭煅烧炉的自动化","summary.auto.ironwood":"喵喵喵把铁收起来，希望住上向往的铁木小屋 (ฅ´ω`ฅ)","summary.auto.keepGold":"猫猫只是想当个守财奴，神殿、铸币厂，现在还不可以哦","summary.auto.kittens":"计划生育! 猫粮产量不够了 ovo","summary.auto.ksHelp":"为了游戏可玩性，没有给萌新开放过多智能项目，<br>你点珂学家这些按钮没用捏，因为我只是一只猫，自己多点点游戏捏<br>随着猫猫的发展珂学家初始设置好默认配置下会越来越智能快速效率喵","summary.auto.ksHelp2":"如有你特意想点的项目可以在 工艺 => 资源 => 库存,比如重置前要点猫口建筑设置木材 100K,就会永远留100K的木材让你手点","summary.auto.ksHelp3":"不更改任何设置下，默认配置纯自动大概290年左右 130猫口 + 新约外传(手动咸鱼平均600年❤)","summary.auto.ksHelp4":"小猫杂项里 => 恢复初始配置，只需外面大项目就可以用到毕业，想发展慢一点的话就自己改下设置","summary.auto.ksHelp5":"珂学家的日志过滤需勾选过滤，注意游戏的为不勾选才是过滤日志","summary.auto.lag":"喵喵砖家提示你，燃烧时间水晶：只要不挂在前台请务必打开后台珂学家<br>最好不要设置工程师、在挑战页面挂机可以减少卡顿","summary.auto.leader":"喵喵自觉顶替领袖，做特质相关项目。（领袖特质的具体效果可以参考右下角：百科-游戏标签-村庄-猫口普查）","summary.auto.leaderGold":"猫猫领袖贪污点黄金自用，氪金就能变强","summary.auto.leaderPriest":"已经是成熟的小猫了，该学会好好念经了，领袖职业改为牧师","summary.auto.logHouse":"为了喵喵的幸福，需要更多剧场来上演[所有的狗去天堂]的节目  ฅ( ̳• ◡ • ̳)ฅ","summary.auto.logHouseMineral":"存点矿物点木屋","summary.auto.lower":"未研究轨道测地学，小猫是懂发展的，故降低牧场、水渠、图书馆、研究院、粮仓、港口、油井、仓库的优先度","summary.auto.lumberMill":"喵喵觉得木头已经发展好了，减少木材厂的建造","summary.auto.marker":"没有黑金字塔小猫拒绝了神印的建造","summary.auto.mansion":"小猫为了节省钛和钢用来发展，宅邸优先度降低（2倍多资源）<br>湿软的纸箱才是猫猫的最爱","summary.auto.miao":"喵~<br>喵喵~<br>喵喵喵~<br>喵喵喵喵~<br>哎嘿，保留10个版本","summary.auto.miningDrill":"来点钢，地质学家会出手","summary.auto.moonBase":"难得素~男德素存到80%，小猫才会有力气造月球基地","summary.auto.nanotechnology":"存点蓝图，喵喵可能要进化成纳米机器猫了","summary.auto.oilTick":"小猫是懂石油的，控制石油平衡暂时不造煅烧炉了","summary.auto.offCalciner":"猫猫只会担心能源，关掉了煅烧炉","summary.auto.one1000years":"聪明的小猫自动勾上了长挂所需要的选项","summary.auto.oxidation":"别急，你先别急，小猫为了氧化反应把钢全存起来了","summary.auto.parchment":"还未感悟到地质学，小猫咪用不了那么多毛皮，毛皮存起来惹","summary.auto.pasture":"喵喵喵嫌弃了牧场，木材还是用来发展的好（真的是最后1个了 Ծ ̮ Ծ","summary.auto.physics":"艺术猫咪觉得物理学救不了猫咪","summary.auto.railgun":"喵喵想用电磁炮了，就多了亿点点猎人","summary.auto.religion":"大教堂前继续限制神殿和交易所","summary.auto.reinforcedSaw":"用铁给木材厂升级换成加强锯，更加锋利的捏","summary.auto.rotaryKiln":"猫猫看上了<s>回转炉</s>? 减肥旋转滚轮!","summary.auto.sattelite":"小猫足够虔诚，于是会先造卫星回回血，呼呼外层空间条约","summary.auto.scholar":"科学产量可能有点不够，学者猫咪数量上限增加~","summary.auto.scienceBld":"天文台、研究院、生物实验室科学上限快满了才会建造","summary.auto.ship":"征服海对面那稀树草原斑马的第二步，小目标:先制作 {0} 个贸易船<br>⊂(‘ω’⊂ ),斑马拿铁辅料钛<br>喵偷偷告诉你个秘密，贸易船越多跟斑马贸易获得钛几率越大","summary.auto.shipLess":"你说的对，但是这就是贸易船，25星图 150金属板 100脚手架的制作价格，甚至可以增加港口库存上限，然后只要243船就可以贸易斑马100%获得钛，还能增加贸易获得钛数量，缺钛啊啊啊啊啊啊","summary.auto.shipGeodesy":"小猫嗅到了黄金的味道喵 ^ ω ^，来点船船抄斑马的家<br>要不要让喵喵告诉你~贸易船越多跟斑马贸易获得钛数量越多哦<br>多点船让斑马把猫猫的钛灌满❤","summary.auto.smelter":"冶炼专精的小猫会根据木材和矿物产量来控制熔炉上限","summary.auto.spaceManufacturing":"猫猫进军太空，中间忘了，后面忘了，大概要偷用亿点点的钛","summary.auto.spaceStation":"黑暗天空会缺电，小猫贴心替你点了关闭空间站(记得删除时间水晶库存)","summary.auto.spaceStationStar":"小猫咪再等等亿点点时间就会造空间站了，小猫是懂星图的","summary.auto.spaceTrigger":"为了星图，星图得留给探索碧池星","summary.auto.spaceZero":"猫猫小助手提示: 太空触发条件为0时，会变聪明哦","summary.auto.steamworks":"小猫曰：蒸汽工房要与磁电机成双成对","summary.auto.steelAxe":"存着钢换个喵喵自用的精钢斧","summary.auto.steelSaw":"小喵存着钢给木材厂换精钢锯，更加锋利了喵","summary.auto.templars":"没有足够的黄金和铁产量拿什么祷告圣殿骑士呢","summary.auto.temple":"祷告太阳革命后才会建造神殿，真的不是偷懒喵","summary.auto.titaniumGeodesy":"小猫打败斑马的最后一步，存着钛和星图点测地学，猫猫要进化啦。","summary.auto.tradepost":"祷告太阳革命前，交易所的建设开摆 ≧ω≦","summary.auto.tear":"小喵都做了什么?! 独角兽的眼泪加小猫幸福度的捏","summary.auto.unicorn":"最佳独角兽建筑：{0}","summary.auto.upgPasture":"当勾选太阳能发电站了，并钛爆仓、且缺电、且猫薄荷产量足够高时，小猫会贴心的帮你卖出全部牧场后，升级太阳能发电站!","summary.auto.upgAqueduct":"当勾选水电站了，有太阳能发电站、且缺电、且猫薄荷产量足够高时，小猫会贴心的帮你卖出全部水渠后，升级水电站!","summary.auto.upgLibrary":"当勾选数据中心了，概要数量大于 150X图书馆数量 时，小猫会贴心的帮你卖出全部图书馆后，升级数据中心!","summary.auto.upgAmphitheatre":"当有贸易船或者钛产量足够高时，小猫会贴心的帮你卖出全部剧场后，升级广播塔!","summary.auto.workshop":"工坊只是解锁升级的 猫玩具罢了，现在小猫只愿意造1个工坊哦","summary.auto.debug":"{0}","summary.upgrade.building.pasture":"卖出牧场 并升级为 太阳能发电站 !","summary.upgrade.building.aqueduct":"卖出水渠 并升级为 水电站 !","summary.upgrade.building.library":"卖出图书馆 并升级为 数据中心!","summary.upgrade.building.amphitheatre":"卖出剧场 并升级为 广播塔!","summary.resource":"小猫自动调整资源: {0} 的消耗率","summary.moon":"小猫停在红月周期散热 {0} 次","summary.time.skip.moon":"由于燃烧时间水晶支出大于收入，停留在红月周期 {0} 次! (可以获得更多的难得素)","summary.blackcoin.buy":"小猫出售遗物并买入 {0} 次黑币","summary.blackcoin.sell":"小猫出售黑币并买入了 {0} 次遗物","summary.accelerator":"电量寄了，大概只有加速器能关闭了（不会影响库存","summary.breweryOn":"已举办文化节，喵星人重新打开了酿酒厂~嗝","summary.breweryOff":"节日或者香料没呐，小猫拒奢守俭，暂时关闭了酿酒厂","summary.brewery":"小猫根据节日调整了 {0} 次酿酒厂","summary.biolab":"小猫担心冬季电不够并关闭了 {0} 个生物实验室(关了后科学上限和科学加成还会加成)","summary.biolab.test":" {0} 个生物实验室(非常没用的工坊升级)","summary.calciner":"小猫因为你工坊升级了钢铁工厂，故关闭了煅烧炉自动化（其效果铁和煤转化钢没有100%~具体右下角参考百科）（她真的好温柔，😭）","summary.chronocontrolOn":"小猫开启了时间操纵延长时间悖论的持续天数","summary.chronocontrolOff":"小猫关闭了时间操纵节省电力","summary.chronocontrol":"小猫根据时间悖论调整了 {0} 次时间操纵","summary.catnip":"呐，你的猫猫没有猫薄荷吸并强制分配 {0} 个农民","summary.factory":"小猫为了空间的发展，把工厂全部启用呐","summary.magneto":"也许没有石油了导致磁电机自动关机，小猫还是选择打开了它","summary.mint":"秋梨膏别开铸币厂了（其转化效率与喵力上限有关，打猎会获得更多的毛皮，具体右下角参考百科 游戏标签-其它建筑-铸币厂）","summary.moonBase":"小猫我先急，趁你不注意关闭了月球基地","summary.pumpjack":"小猫担心冬季电不够并关闭了 {0} 次油井自动化","summary.reactor":"小猫向反应堆投入了铀开始发光呐，资源产量变多了","summary.steamworks":"小猫向蒸汽工房加了煤开始排蒸汽呐，资源产量变多了","summary.temporalAccelerator":"小猫担心卡顿打开了时空加速器的自动化","summary.festival":"举办了 {0} 次节日喵","summary.stars":"观测了 {0} 次天文事件","summary.praise":"赞美太阳了 {0} 次，共积累了 {1} 虔诚","summary.hunt":"派出了 {0} 批可爱的小猫","summary.hunt.manager":"管理者领袖派出了 {0} 批可爱的小猫","summary.embassy":"设立了 {0} 个大使馆","summary.feed":"向利维坦献祭 {0} 只死灵兽","summary.tech":"{0}","summary.upgrade":"{0}","summary.build":"建造了 {0} 个 {1}","summary.faith":"{1} {0} 次","summary.craft":"制作了{0} 个 {1}","summary.craftLeader":"工匠制作了 {0} 个 {1}","summary.craftManuscript":"小猫偷偷使用了 {0} 次材料合成手稿，为了科学","summary.craftCompedium":"小猫偷偷使用了 {0} 次材料合成概要，为了科学","summary.craftBlueprint":"小猫偷偷使用了 {0} 次材料合成蓝图，为了科学","summary.trade":"{1} 贸易了 {0} 次","summary.year":"年","summary.years":"年","summary.separator":" ","summary.day":"天","summary.days":"天","summary.head":"你醒啦，看看你的猫国过去 {0} 的总结","summary.show":"小猫总结"}},ee=function(e,a){if("$"===e[0])return $I(e.slice(1));let t=A.zh[e];if(void 0===t&&game.msg(e,"notice"),a)for(let e=0;e<a.length;e++)t=t.replace("{"+e+"}",a[e]);return t},ae={debug:!1,interval:2e3,msgColor:"#aa50fe",summaryColor:"#009933",activityColor:"#E65C00",stockWarnColor:"#DD1E00",copyTrait:!1,countdown:120,renderTime:0,consume:.6,auto:{engine:{enabled:!1},unicorn:{items:{unicornPasture:{require:!1,enabled:!0,variant:"zp",label:ee("$buildings.unicornPasture.label"),checkForReset:!0,triggerForReset:-1},unicornTomb:{require:!1,enabled:!0,variant:"z",label:ee("$religion.zu.unicornTomb.label"),checkForReset:!0,triggerForReset:-1},ivoryTower:{require:!1,enabled:!0,variant:"z",label:ee("$religion.zu.ivoryTower.label"),checkForReset:!0,triggerForReset:-1},ivoryCitadel:{require:!1,enabled:!0,variant:"z",label:ee("$religion.zu.ivoryCitadel.label"),checkForReset:!0,triggerForReset:-1},skyPalace:{require:!1,enabled:!0,variant:"z",label:ee("$religion.zu.skyPalace.label"),checkForReset:!0,triggerForReset:-1},unicornUtopia:{require:"gold",enabled:!0,variant:"z",label:ee("$religion.zu.unicornUtopia.label"),checkForReset:!0,triggerForReset:-1},sunspire:{require:"gold",enabled:!0,variant:"z",label:ee("$religion.zu.sunspire.label"),checkForReset:!0,triggerForReset:-1}}},faith:{enabled:!1,trigger:0,transcendCatnip:0,adoreCatnip:0,addition:{bestUnicornBuilding:{enabled:!0,misc:!0,label:ee("option.faith.best.unicorn"),confirm:0},autoPraise:{enabled:!0,misc:!0,label:ee("option.praise"),subTrigger:.98,msg:0,time:0,expect:0},adore:{enabled:!0,misc:!0,label:ee("option.faith.adore"),subTrigger:.001},transcend:{enabled:!0,misc:!0,label:ee("option.faith.transcend")},alicorn:{enabled:!1,misc:!0,label:ee("option.faith.alicorn")},tcRefine:{enabled:!1,misc:!0,label:ee("option.faith.tcRefine"),subTrigger:1e5}},items:{marker:{require:"unobtainium",enabled:!1,max:75,variant:"z",checkForReset:!0,triggerForReset:-1},unicornGraveyard:{require:!1,enabled:!1,max:-1,variant:"z",checkForReset:!0,triggerForReset:-1},unicornNecropolis:{require:!1,enabled:!1,max:-1,variant:"z",checkForReset:!0,triggerForReset:-1},blackPyramid:{require:"unobtainium",enabled:!0,max:-1,variant:"z",checkForReset:!0,triggerForReset:-1},solarchant:{require:"faith",enabled:!0,max:-1,variant:"s",checkForReset:!0,triggerForReset:-1},scholasticism:{require:"faith",enabled:!0,max:3,variant:"s",checkForReset:!0,triggerForReset:-1},goldenSpire:{require:"faith",enabled:!0,max:-1,variant:"s",checkForReset:!0,triggerForReset:-1},sunAltar:{require:"faith",enabled:!0,max:-1,variant:"s",checkForReset:!0,triggerForReset:-1},stainedGlass:{require:"faith",enabled:!0,max:1,variant:"s",checkForReset:!0,triggerForReset:-1},solarRevolution:{require:"faith",enabled:!0,max:1,variant:"s",checkForReset:!0,triggerForReset:-1},basilica:{require:"faith",enabled:!0,max:5,variant:"s",checkForReset:!0,triggerForReset:-1},templars:{require:"faith",enabled:!0,max:6,variant:"s",checkForReset:!0,triggerForReset:-1},apocripha:{require:"faith",enabled:!0,max:1,variant:"s",checkForReset:!0,triggerForReset:-1},transcendence:{require:"faith",enabled:!0,max:1,variant:"s",checkForReset:!0,triggerForReset:-1},blackObelisk:{require:!1,enabled:!0,max:70,variant:"c",checkForReset:!0,triggerForReset:-1},blackNexus:{require:!1,enabled:!0,max:54,variant:"c",checkForReset:!0,triggerForReset:-1},blackCore:{require:!1,enabled:!0,max:-1,variant:"c",checkForReset:!0,triggerForReset:-1},singularity:{require:!1,enabled:!1,max:-1,variant:"c",checkForReset:!0,triggerForReset:-1},blackLibrary:{require:!1,enabled:!1,max:0,variant:"c",checkForReset:!0,triggerForReset:-1},blackRadiance:{require:!1,enabled:!1,max:8,variant:"c",checkForReset:!0,triggerForReset:-1},blazar:{require:!1,enabled:!1,max:40,variant:"c",checkForReset:!0,triggerForReset:-1},darkNova:{require:!1,enabled:!1,max:-1,variant:"c",checkForReset:!0,triggerForReset:-1},holyGenocide:{require:!1,enabled:!1,max:-1,variant:"c",checkForReset:!0,triggerForReset:-1}}},build:{enabled:!1,trigger:0,items:{field:{require:"catnip",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},workshop:{require:"minerals",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},hut:{require:"wood",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},logHouse:{require:"minerals",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},mansion:{require:"titanium",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},steamworks:{require:!1,enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},magneto:{require:!1,enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},reactor:{require:"titanium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},smelter:{require:"minerals",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},calciner:{require:"titanium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},mine:{require:"wood",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},lumberMill:{require:"minerals",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},oilWell:{require:"coal",enabled:!0,max:200,checkForReset:!0,triggerForReset:-1},factory:{require:"titanium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},observatory:{require:"iron",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},biolab:{require:"science",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},library:{require:"wood",enabled:!0,max:-1,stage:0,checkForReset:!0,triggerForReset:-1},dataCenter:{require:!1,enabled:!0,max:150,stage:1,name:"library",checkForReset:!0,triggerForReset:-1},academy:{require:"wood",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},pasture:{require:"catnip",enabled:!0,max:150,stage:0,checkForReset:!0,triggerForReset:-1},solarFarm:{require:"titanium",enabled:!0,max:-1,stage:1,name:"pasture",checkForReset:!0,triggerForReset:-1},aqueduct:{require:"minerals",enabled:!0,max:250,stage:0,checkForReset:!0,triggerForReset:-1},hydroPlant:{require:"titanium",enabled:!0,max:-1,stage:1,name:"aqueduct",checkForReset:!0,triggerForReset:-1},amphitheatre:{require:"minerals",enabled:!0,max:60,stage:0,checkForReset:!0,triggerForReset:-1},broadcastTower:{require:"titanium",enabled:!0,max:-1,stage:1,name:"amphitheatre",checkForReset:!0,triggerForReset:-1},quarry:{require:!1,enabled:!0,max:300,checkForReset:!0,triggerForReset:-1},chapel:{require:"minerals",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},temple:{require:"gold",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},mint:{require:"gold",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},tradepost:{require:"gold",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},ziggurat:{require:!1,enabled:!0,max:110,checkForReset:!0,triggerForReset:-1},chronosphere:{require:"unobtainium",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},aiCore:{require:!1,enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},brewery:{require:!1,enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},barn:{require:"wood",enabled:!0,max:15,checkForReset:!0,triggerForReset:-1},harbor:{require:!1,enabled:!0,max:200,checkForReset:!0,triggerForReset:-1},warehouse:{require:!1,enabled:!0,max:200,checkForReset:!0,triggerForReset:-1},accelerator:{require:"titanium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},zebraOutpost:{require:"bloodstone",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},zebraWorkshop:{require:"bloodstone",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},zebraForge:{require:"bloodstone",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1}}},space:{enabled:!1,trigger:0,items:{spaceElevator:{require:"unobtainium",enabled:!0,max:110,checkForReset:!0,triggerForReset:-1},sattelite:{require:"titanium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},spaceStation:{require:"oil",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},moonOutpost:{require:"uranium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},moonBase:{require:"unobtainium",enabled:!0,max:140,checkForReset:!0,triggerForReset:-1},planetCracker:{require:"science",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},hydrofracturer:{require:"science",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},spiceRefinery:{require:"science",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},researchVessel:{require:"titanium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},orbitalArray:{require:"science",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},sunlifter:{require:"science",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},containmentChamber:{require:"science",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},heatsink:{require:!1,enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},sunforge:{require:!1,enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},cryostation:{require:"eludium",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},spaceBeacon:{require:"antimatter",enabled:!0,max:51,checkForReset:!0,triggerForReset:-1},terraformingStation:{require:"antimatter",enabled:!1,max:0,checkForReset:!0,triggerForReset:-1},hydroponics:{require:"kerosene",enabled:!1,max:0,checkForReset:!0,triggerForReset:-1},hrHarvester:{require:"antimatter",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},entangler:{require:"antimatter",enabled:!0,max:-1,checkForReset:!0,triggerForReset:-1},tectonic:{require:"antimatter",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1},moltenCore:{require:"uranium",enabled:!1,max:-1,checkForReset:!0,triggerForReset:-1}}},time:{enabled:!1,trigger:0,items:{temporalBattery:{require:!1,enabled:!1,max:0,variant:"chrono",checkForReset:!0,triggerForReset:-1},blastFurnace:{require:!1,enabled:!0,max:-1,variant:"chrono",checkForReset:!0,triggerForReset:-1},timeBoiler:{require:!1,enabled:!1,max:0,variant:"chrono",checkForReset:!0,triggerForReset:-1},temporalAccelerator:{require:!1,enabled:!1,max:1,variant:"chrono",checkForReset:!0,triggerForReset:-1},temporalImpedance:{require:!1,enabled:!1,max:0,variant:"chrono",checkForReset:!0,triggerForReset:-1},ressourceRetrieval:{require:!1,enabled:!0,max:-1,variant:"chrono",checkForReset:!0,triggerForReset:-1},temporalPress:{require:!1,enabled:!1,max:0,variant:"chrono",checkForReset:!0,triggerForReset:-1},cryochambers:{require:!1,enabled:!1,max:-1,variant:"void",checkForReset:!0,triggerForReset:-1},voidHoover:{require:"antimatter",enabled:!1,max:-1,variant:"void",checkForReset:!0,triggerForReset:-1},voidRift:{require:!1,enabled:!1,max:-1,variant:"void",checkForReset:!0,triggerForReset:-1},chronocontrol:{require:"temporalFlux",enabled:!1,max:-1,variant:"void",checkForReset:!0,triggerForReset:-1},voidResonator:{require:!1,enabled:!1,max:-1,variant:"void",checkForReset:!0,triggerForReset:-1}}},timeCtrl:{enabled:!1,items:{accelerateTime:{enabled:!0,subTrigger:1,misc:!0,label:ee("option.accelerate")},timeSkip:{enabled:!0,subTrigger:200,misc:!0,label:ee("option.time.skip"),maximum:1,0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,spring:!0,summer:!1,autumn:!1,winter:!1,wait:!1,adore:!1,craft:!1,moonMsg:-1}}},craft:{enabled:!1,trigger:.95,shipTime:0,items:{wood:{require:"catnip",max:0,limited:!0,limRat:.5,enabled:!0},beam:{require:"wood",max:0,limited:!0,limRat:.5,enabled:!0},slab:{require:"minerals",max:0,limited:!0,limRat:.5,enabled:!0},steel:{require:"coal",max:0,limited:!0,limRat:.5,enabled:!0},plate:{require:"iron",max:0,limited:!0,limRat:.5,enabled:!0},alloy:{require:"titanium",max:0,limited:!0,limRat:.5,enabled:!0},concrate:{require:!1,max:0,limited:!0,limRat:.5,enabled:!0},gear:{require:!1,max:0,limited:!0,limRat:.5,enabled:!0},scaffold:{require:!1,max:0,limited:!0,limRat:.5,enabled:!0},ship:{require:!1,max:0,limited:!0,limRat:.5,enabled:!0},tanker:{require:!1,max:0,limited:!0,limRat:.5,enabled:!1},parchment:{require:!1,max:0,limited:!1,limRat:.5,enabled:!0},manuscript:{require:"culture",max:0,limited:!0,limRat:.5,enabled:!0},compedium:{require:"science",max:0,limited:!0,limRat:.5,enabled:!0},blueprint:{require:"science",max:0,limited:!0,limRat:.5,enabled:!0},kerosene:{require:"oil",max:0,limited:!0,limRat:.5,enabled:!0},megalith:{require:!1,max:0,limited:!0,limRat:.5,enabled:!0},eludium:{require:"unobtainium",max:0,limited:!0,limRat:.5,enabled:!0},thorium:{require:"uranium",max:0,limited:!0,limRat:.5,enabled:!0}},autoConsume:{}},trade:{cache:!1,enabled:!1,trigger:.98,items:{dragons:{enabled:!0,require:"titanium",allowCapped:!1,limited:!0,summer:!1,autumn:!0,winter:!0,spring:!0},zebras:{enabled:!0,require:!1,allowCapped:!1,limited:!0,summer:!0,autumn:!0,winter:!0,spring:!0},lizards:{enabled:!1,require:"minerals",allowCapped:!1,limited:!0,summer:!0,autumn:!1,winter:!1,spring:!1},sharks:{enabled:!0,require:"iron",allowCapped:!1,limited:!0,summer:!1,autumn:!1,winter:!0,spring:!1},griffins:{enabled:!0,require:"wood",allowCapped:!1,limited:!0,summer:!1,autumn:!0,winter:!1,spring:!1},nagas:{enabled:!0,require:!1,allowCapped:!1,limited:!0,summer:!1,autumn:!1,winter:!1,spring:!0},spiders:{enabled:!0,require:!1,allowCapped:!1,limited:!0,summer:!0,autumn:!0,winter:!0,spring:!0},leviathans:{enabled:!0,require:"unobtainium",allowCapped:!0,limited:!0,summer:!0,autumn:!0,winter:!0,spring:!0}}},upgrade:{enabled:!1,items:{techs:{enabled:!0,limited:!0},upgrades:{enabled:!0,limited:!0,cache:!1},policies:{enabled:!1,auto:!1},races:{enabled:!0},missions:{enabled:!0,subTrigger:4},buildings:{enabled:!0}}},options:{catnipMsg:0,enabled:!0,items:{style:{enabled:!0,misc:!0,label:ee("option.style")},hunt:{enabled:!0,subTrigger:.95,require:"manpower",misc:!0,label:ee("option.hunt")},buildEmbassies:{enabled:!0,subTrigger:.95,require:"culture",misc:!0,label:ee("option.embassies")},festival:{enabled:!0,misc:!0,label:ee("option.festival")},promote:{enabled:!0,misc:!0,label:ee("option.promote")},autofeed:{enabled:!0,misc:!0,label:ee("option.autofeed")},observe:{enabled:!0,misc:!0,label:ee("option.observe")},filterGame:{enabled:!0,subTrigger:200,misc:!0,label:"游戏日志过滤"},crypto:{enabled:!1,subTrigger:1e6,misc:!0,label:ee("option.crypto")},fixCry:{enabled:!1,misc:!0,label:ee("option.fix.cry")},saves:{enabled:!1,misc:!0,label:"导出配置文件"},donate:{enabled:!1,misc:!0,label:"显示捐赠原作者图标"},useWorkers:{enabled:!1,misc:!0,label:ee("option.useWorkers")},wiki:{enabled:!1,misc:!0,label:"(ฅ´ω`ฅ)使用说明书（百科链接）"},autoScientists:{enabled:!1,misc:!0,label:"首次自动启用珂学家"}}},distribute:{religion:!1,enabled:!1,items:{woodcutter:{enabled:!0,max:28,limited:!0},farmer:{enabled:!0,max:1,limited:!0},scholar:{enabled:!0,max:9,limited:!0},hunter:{enabled:!0,max:24,limited:!0},miner:{enabled:!0,max:26,limited:!0},priest:{enabled:!0,max:3,limited:!1},geologist:{enabled:!0,max:40,limited:!0},leader:{enabled:!0,leaderJob:"woodcutter",leaderTrait:"manager"}}},filter:{enabled:!1,console:{},items:{buildFilter:{enabled:!0,label:ee("filter.build")},researchFilter:{enabled:!1,label:ee("filter.research")},upgradeFilter:{enabled:!1,label:ee("filter.upgrade")},craftFilter:{enabled:!0,label:ee("filter.craft")},spaceFilter:{enabled:!0,label:ee("filter.space")},policyFilter:{enabled:!0,label:ee("filter.policy")},upgBldFilter:{enabled:!0,label:ee("filter.upgBld")},tradeFilter:{enabled:!0,label:ee("filter.trade")},embassyFilter:{enabled:!0,label:ee("filter.embassy")},huntFilter:{enabled:!0,label:ee("filter.hunt")},unicornSacrificeFilter:{enabled:!0,label:ee("filter.sacrifice")},faithBuildFilter:{enabled:!0,label:ee("filter.faithBld")},faithFilter:{enabled:!0,label:ee("filter.praise")},adoreFilter:{enabled:!1,label:ee("filter.adore")},transcendFilter:{enabled:!0,label:ee("filter.transcend")},accelerateFilter:{enabled:!0,label:ee("filter.accelerate")},tcShatterFilter:{enabled:!0,label:ee("filter.time.skip")},festivalFilter:{enabled:!0,label:ee("filter.festival")},astronomicalEventFilter:{enabled:!0,label:ee("filter.star")},distributeFilter:{enabled:!0,label:ee("filter.distribute")},leaderFilter:{enabled:!0,label:ee("filter.leader")},miscFilter:{enabled:!1,label:ee("filter.misc")}}},resources:{furs:{enabled:!0,stock:350,checkForReset:!1,stockForReset:1/0},timeCrystal:{enabled:!0,stock:0,checkForReset:!0,stockForReset:5e5}},policies:[],cache:{dataTimer:{},cacheSum:{},resources:{},trait:{},upgrade:void 0,science:"",resUpg:{},stocks:void 0}}};let te=game.resPool.resourceMap;function ie(){var e=Array.prototype.slice.call(arguments),a=1<e.length?e.pop():"miscFilter";e.push(a),e.push(ae.activityColor),G(e)}function Q(e,a,t){ie(ee(e,a),t)}const G=function(e){var a=e[1],t=ae.auto.filter;if(t.enabled&&a){t=t.items[a];if(t&&t.enabled)return}a=e.pop(),e[1]=e[1]||"ks-default",t=game.msg.apply(game,e);$(t.span).css("color",a),ae.debug&&console&&console.log(e)},F=function(){var e=Array.prototype.slice.call(arguments);e.push("ks-default"),e.push(ae.msgColor),G(e)},y=function(){var e=Array.prototype.slice.call(arguments);e.push("ks-summary"),e.push(ae.summaryColor),G(e)},l=function(){var e=Array.prototype.slice.call(arguments);e.unshift("Warning!"),console&&console.log(e)},C=function(e,a,t){F(ee(e,a),t)},x=function(e,a,t){y(ee(e,a),t)},re=e=>{var a,t=ae.auto.cache,i=(t.upgrade||(t.upgrade={}),t.upgrade);for(a in e){var r,l=e[a],o=(i[a]||(i[a]=[]),i[a]);for(r in l){var n=l[r];-1===o.indexOf(n)&&o.push(n)}}};let le=e=>{e=te[e];return e.value/e.maxValue},oe=game.religion,ne=game.workshop;function p(){this.upgradeManager=new h,this.buildManager=new u,this.spaceManager=new L,this.craftManager=new a,this.bulkManager=new t,this.tradeManager=new f,this.religionManager=new o,this.timeManager=new g,this.villageManager=new e("Village"),this.cacheManager=new b}p.prototype={upgradeManager:void 0,buildManager:void 0,spaceManager:void 0,craftManager:void 0,bulkManager:void 0,tradeManager:void 0,religionManager:void 0,timeManager:void 0,villageManager:void 0,cacheManager:void 0,now:void 0,loop:void 0,huntID:void 0,renderID:void 0,worker:void 0,changeLeader:!1,toolText:void 0,leaderTimer:void 0,leader:0,accelerateTime:0,isAccelerated:!1,timeTick:0,time:void 0,start:function(e=!0){var a;ae.interval=100*Math.ceil(100/game.getTicksPerSecondUI()),game.isWebWorkerSupported()&&game.useWorkers&&ae.auto.options.items.useWorkers.enabled?this.worker||(a=new Blob(["onmessage = function(e) { setInterval(function() {postMessage('miaowu')}, '"+ae.interval+"' ); }"]),a=window.URL.createObjectURL(a),this.worker=new Worker(a),this.worker.addEventListener("message",this.iterate.bind(this)),this.worker.postMessage("miaowu"),e&&F("后台珂学家上钟了~ ＞▽＜")):this.loop||(this.loop=setInterval(this.iterate.bind(this),ae.interval),e&&C("status.ks.enable"))},stop:function(e=!0){game.isWebWorkerSupported()&&this.worker&&(e&&F("后台珂学家爪巴了"),this.worker.terminate(),this.worker=void 0),this.loop&&(clearTimeout(this.huntID),clearTimeout(this.renderID),clearInterval(this.loop),this.loop=void 0,e)&&C("status.ks.disable")},iterate:async function(){if(!game.mobileSaveOnPause||game.loadingSave||game.isPaused)return this.timeTick=0;let e=0;this.time=performance.now();var a=ae.auto,t=a.options,i=t.enabled,t=t.items;i&&t.observe.enabled&&this.observeStars(),i&&this.holdFestival(),a.timeCtrl.enabled&&(e+=~~this.timeCtrl()),i&&t.autofeed.enabled&&this.autofeed(),i&&t.promote.enabled&&this.promote(),a.trade.enabled&&this.trade(),a.upgrade.enabled&&(e+=~~this.upgrade()),a.build.enabled&&(e+=~~this.build()),a.space.enabled&&(e+=~~this.space()),a.faith.enabled&&(e+=~~this.worship()),(0<e||a.cache.upgrade)&&this.gameUpgrade(),a.craft.enabled&&this.craft(),i&&t.hunt.enabled&&this.delay(),a.time.enabled&&(e+=~~this.chrono()),i&&t.crypto.enabled&&this.crypto(),ae.copyTrait&&this.setTrait(),i&&(e+=~~this.miscOptions()),a.distribute.enabled&&(e+=~~this.distribute()),0<e&&this.delay("render"),this.calculateTime()},delay:function(e){if(e){let e=dojo.byId("tooltip").textContent;e=e.slice(0,Math.ceil(.4*e.length)),(ae.renderTime+6e5<Date.now()||this.toolText!==e)&&(this.renderID=setTimeout(()=>{"Nummon"!==game.ui.activeTabId&&(ae.renderTime=Date.now(),this.toolText=e,game.ui.render())},Math.min(197,197-Date.now()+game.timer.timestampStart))),game.updateResources()}else this.huntID=setTimeout(()=>{this.hunt()},.5*ae.interval)},reset:async function(){},timeCtrl:function(){var i=ae.auto.timeCtrl.items;let r=0;if(i.accelerateTime.enabled&&game.science.get("calendar").researched){var a=te.temporalFlux;if(a.value>=Math.max(a.maxValue*i.accelerateTime.subTrigger,5)&&!game.time.isAccelerated&&(game.time.isAccelerated=!0,this.accelerateTime=performance.now(),this.isAccelerated=!0,Q("act.accelerate",[],"accelerateFilter"),me("accelerate",1)),ae.interval!==100*Math.ceil(100/game.getTicksPerSecondUI())&&(q.stop(!1),ae.auto.engine.enabled)){if(2e3===ae.interval)Q("act.accelerate.acl"),this.accelerateTime=performance.now();else{var a=this.isAccelerated,t=this.accelerateTime;if(t){var t=(performance.now()-t)/1e3;let e=game.toDisplaySeconds(t);(a&&e&&t<60||3<t&&t<180)&&(e=e.substring(0,e.length-1),this.isAccelerated=!1,t=game.msg(ee("act.accelerate.fine",[e]),null,null,!0),$(t.span).css("color","#ff589c")),this.accelerateTime=0}Q("act.accelerate.slow"),a||(t=game.msg(ee("act.accelerate.za")),$(t.span).css("color","#ff589c"))}q.start(!1)}}e:if(i.timeSkip.enabled&&game.workshop.get("chronoforge").researched){var l=te.timeCrystal.value,o=i.timeSkip.maximum,n=game.getEffect("heatMax"),s=game.time.heat;if(!o)return 0;var c=game.calendar,g=c.cycle,u=c.yearsPerCycle,m=c.cyclesPerEra,d=c.cycleYear,p=c.year,h=c.day,f=c.season,b=game.challenges.getChallenge("1000Years").researched?5:10,v=game.getEffect("shatterTCGain"),k=1<v*(1+game.getEffect("rrRatio"))?0:5,y=game.getEffect("heatPerTick");let e=10*y/b;if(s<50*y&&1<=e&&(e+=1),!(.5<y&&g===k&&game.getEffect("voidResonance")&&700<c.trueYear()&&15+2*b/5<100*v&&(game.bld.getBuildingExt("aiCore").meta.effects.aiLevel<15||game.getEffect("aiCoreProductivness"))&&(e=5,k||(e=(.6<le("unobtainium")?25:50)-d),.1*n<s&&!f&&10<h||n-1e3*y<s))){o=Math.ceil(Math.max(e,o)),k=i.timeSkip.subTrigger,k=Math.max(k,this.craftManager.getStock("timeCrystal"),o);if(!(l<k||h<0||!i.timeSkip[g]||n<=s)){k=game.prestige.getPerk("numerology").researched;if(5===g&&i.timeSkip[g]&&k){h=game.nummon;if(game.nummon){var h=h.getTradeTC(),x=c.cycleEffectsFestival({unobtainium:1}).unobtainium,R=c.cycleEffectsBasics({unobtainiumPerTickSpace:1},"moonOutpost").unobtainiumPerTickSpace;if(h*((56.5+12*game.getEffect("festivalRatio"))/50)/(x*R)<1||y<.02){p!==i.timeSkip.moonMsg&&(i.timeSkip.moonMsg=p,Q("summary.time.skip.moon",[1]),me("time.skip.moon",1));break e}}}h=game.timeTab.cfPanel.children[0].children[0];if(!h.model.enabled)return h.controller.updateEnabled(h.model);x=i.timeSkip.wait,R=v*(1+game.getEffect("rrRatio"))<=1&&!1!==x&&5===g;if(!i.timeSkip[c.seasons[f].name]||R){if(1===x&&5===g){i.timeSkip.wait=p;break e}if(!1===x||x===p||1===x)break e;x!==p&&(i.timeSkip.wait=!1)}y=4*o*b,v=game.time.heat>game.getEffect("heatMax")-Math.min(y,20*game.time.getCFU("blastFurnace").on+20),f=(i.timeSkip[5]&&k&&!1===i.timeSkip.wait&&v&&(i.timeSkip.wait=1,5===g)&&(Q("summary.moon",[1]),me("moon",1)),u-d);let a=Math.min(Math.floor((n-s)/b),o),t=0;if(a<f)t=a;else{t+=f,a-=f;let e=1;for(;a>u&&i.timeSkip[(g+e)%m];)t+=u,a-=u,e+=1;i.timeSkip[(g+e)%m]&&0<a&&(t+=a)}if(0<t){if(t=Math.min(t,Math.max(2500,25*game.getEffect("temporalPressCap"))),game.time.getCFU("ressourceRetrieval").val){i.timeSkip.adore=!0,ae.auto.options.items.hunt.time=!0;R=i.timeSkip;if(!R.craft){let a="";["catnip","coal","iron","oil","uranium","science"].forEach(e=>{ae.auto.craft.autoConsume[e]=!0,a=a+te[e].title+"，"}),R.craft=!0,ie(ee("summary.resource",[a]))}}x=p,y=game.time.testShatter;if(1<t&&t<51&&(game.time.testShatter=2,ce("lag",!1,"noFilter")),this.setTrait(),h.controller.doShatterAmt(h.model,t),game.time.testShatter=y,!(t=c.year-x))return;me("timeCrystal",l-te.timeCrystal.value,"resConsume"),r=-100,Q("act.time.skip",[t],"tcShatterFilter"),me("time.skip",t)}}}}return r},promote:function(){this.changeLeader=!0;var e=game.village,a=e.leader,t=ae.auto.distribute,i=t.items.leader;if(a){var r,l=600<this.leaderTimer,o=i.enabled;if(o&&a.trait.name===i.leaderTrait||l?(l||(a.exp+=.15+10*game.getEffect("skillXP")),i=a.rank||0,l=this.craftManager.getStock("gold"),r=te.gold.value-l,i>=this.leader&&e.sim.expToPromote(i,i+1,a.exp)[0]&&(e.sim.goldToPromote(i,i+1,r)[0]?1===e.sim.promote(a,i+1)&&(r=game.villageTab.censusPanel.census,Q("act.promote",[i+1,25+25*i],"leaderFilter"),r.renderGovernment(r.container),game.villageTab.censusPanel.census.update(),this.leader=a.rank,this.leaderTimer=0,this.toolText=0,me("gold",25+25*i,"resConsume"),me("promote",1)):!l&&0<i&&(100<te.faith.maxValue||i<3)&&(ae.auto.cache.stocks.gold=25*i+25,ce("leaderGold")))):this.leaderTimer++,!t.enabled||!o)return ce("changeLeader")}},distribute:function(){var a=ae.auto.distribute.items,i=a.leader;let r=0;var l=game.village,o=l.sim.kittens,n=o.length,s=game.challenges.isActive("anarchy"),c=oe.transcendenceTier,g=game.getEffect("priceRatio");let u=l.getFreeKittens();var e=te.kittens,m=te.catnip,t=m.value,d=l.happiness,p=e.value,e=Math.min(this.craftManager.getPotentialCatnip(!1),m.perTickCached),h=le("catnip"),h=(500+3e3*(h<.2)+500*(h<.5))*(e-.85*Math.max(d*!s-1,.25)),d=e<=.85*d&&p<4||t+h<0||0===l.jobs[1].value&&a.farmer.enabled,h=ae.auto.distribute,d=h.religion||d&&t<=m.maxValue;if(i.enabled&&game.science.get("civil").researched&&!s&&!ae.copyTrait){let a=i.leaderTrait,t=i.leaderJob;m=l.leader;if(("woodcutter"===t||"farmer"===t)&&"manager"===a&&(6<c||g<-.06)&&l.getJob("priest").unlocked&&(t="priest",m)&&"priest"!==m.job&&ce("leaderPriest"),null===m&&n)return game.villageTab.censusPanel.census.makeLeader(o[0]);let e=!1;((e=ae.auto.upgrade.items.policies.enabled?void 0!==ae.policies&&ae.policies.some(e=>"theocracy"===e):e)||game.science.getPolicy("theocracy").researched)&&(t="priest");i=l.getJob(t);if(null==m||m.job!==t||m.trait.name!==a){var f=o.filter(e=>e.trait.name===a);if(0!==f.length&&i.unlocked&&i.value<l.getJobLimit(t)){i=f.sort(function(e,a){return a.rank-e.rank==0?a.exp-e.exp:a.rank-e.rank})[0];let e;"farmer"===i.job&&"farmer"!==m.job&&(e=m.job),l.unassignJob(i),i.job=t,e&&(game.village.sim.removeJob(e,1),u=l.getFreeKittens()),l.getJob(t).value++,game.villageTab.censusPanel.census.makeLeader(i),r+=1,this.toolText=0,Q("act.distributeLeader",[ee("$village.trait."+a)],"distributeFilter"),me("distribute",1)}}}var b=l.getJob("woodcutter").value;if(!u){if(a.miner.enabled&&1<b&&n){f=l.jobs[4];if(f.unlocked&&!f.value)for(let e=n-1;0<e;e--){var v=o[e];if(!v.isLeader&&"woodcutter"===v.job){l.unassignJob(v),u=l.getFreeKittens();break}}}if(d&&e<0&&game.science.get("agriculture").researched){m=game.getResourcePerTick("catnip",!0);if(t+25*e<0&&92<game.calendar.day||t+(1e3-10*game.calendar.day)*m<0||h.religion)for(let e=n-1;0<e;e--){var k=o[e];if(!k.isLeader&&"farmer"!==k.job){l.unassignJob(k),u=l.getFreeKittens();break}}}if(!u)return r}if(d&&game.science.get("agriculture").researched)return h.religion=!1,l.assignJob(l.getJob("farmer"),1),Q("act.distribute.catnip",[],"distributeFilter"),Q("act.distribute",[ee("$village.job.farmer")],"distributeFilter"),game.villageTab.updateTab(),l.updateResourceProduction(),me("catnip",1),1;let y="",x=1/0;var R=oe.getSolarRevolutionRatio(),w=game.challenges.isActive("blackSky")&&game.getEffect("calcinerRatio")||te.unobtainium.value&&5<c,M=game.challenges.isActive("atheism");for(let e=l.jobs.length-1;0<=e;e--){var E=l.jobs[e];if(E.unlocked){var T=E.name;if("engineer"!==T){var F=a[T];if(F.enabled){var C=l.getJobLimit(T);let t=E.value;if(!(t>=C)){let a=Math.max(0,F.max),e=F.limited;if("hunter"===T&&(C=(E=game.getEffect("manpowerJobRatio"))<=.75&&!game.science.get("navigation").researched,24===a&&game.workshop.get("railgun").researched&&(a=M?100:30,23<t)&&t<30&&ce("railgun"),E<.5?(a=10<l.maxKittens?2:0,ce("hunterLess")):C?(a=Math.round(.42*a),!ue.other["auto.hunter"]&&t>=a-1&&(F=game.msg($I("village.job.hunter.flavor"),null,null,!0),$(F.span).css("color","#ff589c"),ce("hunter"))):ce("hunter",!0),(E=te.manpower).maxValue/E.perTickCached<20)&&(a=0),!M||"hunter"===T&&"farmer"===T||(e=!1),"woodcutter"===T&&(game.getEffect("rankLeaderBonusConversion")&&(C=l.leader)&&"woodcutter"===C.job&&(1<C.rank&&1e3<C.exp||2<C.rank)&&(a=Math.min(20,a)),(F=te.wood).maxValue/F.perTickCached<60&&(a=0),ne.get("spaceManufacturing").researched||game.getEffect("calcinerRatio")&&s)&&(a*=.5),"geologist"===T&&(E=game.workshop.get("geodesy").researched,9<c&&(a=Math.min(a,Math.max(30,44-c))),E||(te.iron.perTickCached<20?(a=Math.round(a*(.25-g)+c),.97<le("coal")&&(a=0)):a=Math.min(20,a)),game.science.get("drama").unlocked&&.8<le("coal")&&(a=1),c<9&&E&&(a=Math.max(50-c,a),40<=t)&&t<50&&(ce("geologist")||($("#set-geologist-max")[0].innerText=ee("ui.max",[Math.ceil(a)]))),1<(a=1e5<te.starchart.value&&!game.diplomacyTab.visible?1:a)&&.85<le("gold")&&(a=1),b||(a=0)),"scholar"===T){let e=.28;game.getEffect("shatterTCGain")||(!te.starchart.value&&!w&&te.science.value>3e3+1e4*(4<t)&&2<t&&(a=0),(game.workshop.get("rotaryKiln").researched||(!c&&te.science.maxValue<95e3&&3<t&&(a*=.5),t<6&&(ne.get("cadSystems").researched||R>.3*(5<t)+.3)))&&(e=.5),!te.coal.value&&2<t&&(a*=.4),w&&(e=.6)),le("science")>e&&t||!b||b<2&&!te.paragon.value?a=0:.28<e&&(a=Math.max(a,Math.min(23,3*(2.6<game.getEffect("calcinerRatio"))+11+R+c*(game.getEffect("priceRatio")<-.07)+c*w)),8<t)&&t<a&&(ce("scholar")||($("#set-scholar-max")[0].innerText=ee("ui.max",[Math.ceil(a)])))}"miner"===T&&(game.science.get("writing").researched||(1<t&&(c?a=Math.round(.3*a+.4*game.science.get("currency").researched):a*=.8),te.paragon.value||1!==l.getJob("scholar").value||(a=1),!game.science.get("civil").researched&&te.kittens.value<11&&1<t&&(a=1)),game.workshop.get("geodesy").researched?((s||1e3<te.starchart.value&&15<t)&&(a*=.5),t<Math.min(25,a)&&!w&&(a*=4)):c<6&&(a=Math.round(a*(.94-.05*(p<35)-.01*c))),(C=te.minerals).maxValue/C.perTickCached<60&&(a=0),ne.get("spaceManufacturing").researched)&&(a*=.5),"priest"===T&&(e&&3===a&&($("#toggle-limited-priest").click(),ce("defaultPriest")),1e4<te.starchart.value&&R<3&&(a=Math.max(a,20)),R||3<c&&3===a&&t<3&&(t=0),te.paragon.value<100&&(a=2),b||(e=!0,a=0)),(!e||t<a)&&(F=t/a)<x&&(x=F,y=T)}}}}}return y&&(l.assignJob(l.getJob(y),1),r=1,Q("act.distribute",[ee("$village.job."+y)],"distributeFilter"),me("distribute",1)),r?(game.villageTab.updateTab(),l.updateResourceProduction(),1):void 0},autofeed:function(){var e,a=te.necrocorn;let t=a.value;t&&((e=game.religion.pactsManager.necrocornDeficit)&&t>Math.ceil(e)&&(game.religion.pactsManager.necrocornDeficit=0,te.necrocorn.value-=Math.ceil(e),game.religion.meta[3].meta[4].unlocked=!1,t=a.value),(e=game.diplomacy.get("leviathans")).unlocked)&&(a=game.diplomacy.getMarkerCap(),e.energy>=a||(1<=t?(game.diplomacy.feedElders(Math.min(t,a-e.energy)),Q("act.feed",[],"unicornSacrificeFilter"),me("feed",1)):.25*(1+game.getEffect("corruptionBoostRatio"))<1&&(me("feed",t),game.diplomacy.feedElders(),Q("dispose.necrocorn"))))},crypto:function(){var a=game.calendar.cryptoPrice,t=te.relic.value,i=te.blackcoin.value;if(!(!game.science.get("blackchain").researched&&0<!i||!game.diplomacy.get("leviathans").unlocked)){var r=null==ae.auto.options.items.crypto.subTrigger?"1e7-860-1060":ae.auto.options.items.crypto.subTrigger.toString().split("-");let e=parseFloat(r[0]);var l=parseFloat(r[1]),o=parseFloat(r[2]);if(3!==r.length||!e||!l||!o)return e=e||1e7,ae.auto.options.items.crypto.subTrigger=e+"-881-1060",B();a<l&&t>e?(game.diplomacy.buyBcoin(),r=te.blackcoin.value,l=game.getDisplayValueExt(r-i),Q("blackcoin.buy",[l,game.getDisplayValueExt(t)],"tradeFilter"),me("blackcoin.buy",1)):o<a&&0<te.blackcoin.value&&(game.diplomacy.sellBcoin(),r=te.relic.value,l=game.getDisplayValueExt(r-t),Q("blackcoin.sell",[l,game.getDisplayValueExt(i)],"tradeFilter"),me("blackcoin.sell",1))}},worship:function(){var t=ae.auto.faith.items,e=this.buildManager,L=this.craftManager,i=this.religionManager,a=ae.auto.faith.addition;let r=0,l,o;var n=game.prestige.getPerk("voidOrder").researched,s=game.prestige.getParagonProductionRatio(),c=game.time.getCFU("ressourceRetrieval").val,g=game.bld.getBuildingExt("ziggurat").meta.on;if(a.bestUnicornBuilding.enabled){var u=this.getBestUnicornBuilding(),m=te.tears.value,d=te.unicorns.value,p=oe.getZU("sunspire").on,h=game.prestige.getPerk("renaissance").researched;if(u&&(!h||!m||27<g)){h=!m&&1e3<=d&&g&&!game.ironWill;let a;var f=ue.other["auto.bestUnicorn"]?0:1,b=oe.getZU("blackPyramid"),v=b.val+(game.challenges.getChallenge("blackSky").researched&&!game.challenges.isActive("blackSky")?1:0),b=(te.unicorns.value+=te.unicorns.perTickCached*f,t.blackPyramid.enabled&&b.unlocked),b=1<p&&te.sorrow.value<5&&!v&&5e3<te.unobtainium.maxValue&&b;if(b&&(ce("bls"),1e4<=m)&&(te.tears.value-=1e4,te.sorrow.value+=1,ie("小喵把眼泪炼成悲伤")),"unicornPasture"!==u.name||h||b){let e;if(h)e=1,ce("tear");else for(a=dojo.clone(u.prices),o=0;o<a.length;o++){var k=a[o];k.val*=Math.pow(1.15,u.on),"tears"===k.name&&(k.val+=L.getStock("tears")+.01,e=k.val),"gold"===k.name&&(k.val*=1-game.getEffect("goldCostReduction"))}if(v&&(t.marker.enabled&&(v=oe.getZU("marker").on,m<(y=5e3*Math.pow(1.15,v)))&&p>Math.min(9+v,19)&&(e=Math.min(y,e)),game.calendar.day<1)&&!game.calendar.season&&Math.random()<.2&&f&&(game.diplomacy.unlockElders(),game.diplomacyTab.updateTab()),(e=b?1e4:e)>m){p=Math.floor((d-L.getStock("unicorns"))/2500),v=Math.ceil((e-m)/g);if(v<=p){var y=game.religionTab.sacrificeBtn;if(!y||!y.model)return game.religionTab.render();f=y.model.prices[0].val*v;f<d&&(m=g*v,p=y.controller.controllerOpts,game.resPool.addResEvent(y.model.prices[0].name,-f),game.resPool.addResEvent(p.gainedResource,m),game.stats.getStat("unicornsSacrificed").val+=f,me("unicorns",f,"resConsume"),me("tears",m,"resGain"),m=game.getDisplayValueExt(m),f=game.getDisplayValueExt(f),game.msg($I(p.logTextID,[f,m]),"notice",p.logfilterID),ie(ee("unicornSacrifice",[game.getDisplayValueExt(v),m]),"unicornSacrificeFilter"))}}!h&&!b&&game.resPool.hasRes(a)&&g&&(i.build(u.name,"z",1),r=1)}else d>=2*Math.pow(u.priceRatio+game.getEffect("priceRatio"),u.val)&&e.built(u.name,void 0,1)}}else ce("bestUnicorn"),ce("changeLeader"),ae.auto.unicorn.items.unicornPasture.enabled&&this.build({unicornPasture:{require:!1,enabled:!0}}),l=JSON.parse(JSON.stringify(ae.auto.unicorn.items)),delete(l=Object.assign(l,ae.auto.faith.items)).unicornPasture;if(a.tcRefine.enabled&&35<game.getEffect("relicRefineRatio")&&g&&!game.workshop.get("chronoforge").researched&&te.relic.value<6&&te.timeCrystal.value>a.tcRefine.subTrigger){let e=game.religionTab.refineTCBtn;e||(game.religionTab.render(),e=game.religionTab.refineTCBtn),e.controller._transform(e.model,1)}r+=this._worship(l||t);y=L.getResource("faith"),f=le("faith"),p=oe.getRU("transcendence"),v=p.on,m=oe.transcendenceTier;let x=v?m:0;var R=oe.faith;let w=oe.faithRatio;h=oe.getSolarRevolutionRatio(),b=game.getEffect("solarRevolutionLimit"),i=10+b,a.adore.subTrigger,d=101e-8*R*(x+1)*(x+1),e=w+d,g=.01+y.value*(1+.1*game.getUnlimitedDR(e,.1)),t=game.getLimitedDR(game.getUnlimitedDR(g,1e3)/100,i);let M=!1;var e=a.autoPraise.enabled,g=a.adore.enabled,D=ae.auto.timeCtrl.items.timeSkip.adore,E=D&&e&&g;let T=a.autoPraise.subTrigger;var F=game.space.getBuilding("moonOutpost").val;let C=F&&1e5<=R;var B=oe.getRU("apocripha").on,P=x||!w&&2e5<R,P=(C=C&&B&&P&&g,T<.98),U=ue.adore[0];if(F&&C&&P&&T&&(a.autoPraise.subTrigger=.98),Math.min(.999,Math.max(.98,T))<=f||E){var S=te.catnip.value,W=150+3850*(le("catnip")<.2);if(a.transcend.enabled&&v){let a;v=oe._getTranscendTotalPrice(x+1)-oe._getTranscendTotalPrice(x),v=0<=(v=this.catnipForReligion(v))||v<0&&0<S+W*v;for(10<x&&(a=1),x<11&&F&&B&&v&&(a=4);a;){w=oe.faithRatio,x=oe.transcendenceTier;var V=Math.pow((x+2)/(x+1),2),$=oe._getTranscendTotalPrice(x+1)-oe._getTranscendTotalPrice(x),q=$,O=oe.getTU("blackObelisk"),A=O.val;let e=(5*(x+1)*A+1e3)/(5*x*A+1e3);A=V*(e=.07<game.getEffect("shatterTCGain")&&game.calendar.trueYear<1400?1:e),V=(1-A+Math.sqrt(80*(A*A-1)*q+(A-1)*(A-1)))*A/(40*(1+A)*(1+A)*(A-1))+q+q/(A*A-1),q=w>V&&1e5<R,A=2.02*R*x+3.03*R>1e6*$&&w>$;if(q||A){oe.faithRatio-=$,oe.tcratio+=$,oe.transcendenceTier+=1;V=game.challenges.getChallenge("atheism");V.calculateEffects(V,game),O.calculateEffects(O,game),game.msg($I("religion.transcend.msg.success",[oe.transcendenceTier])),(x=oe.transcendenceTier)<10&&(M=!0);for(let e=0;e<oe.transcendenceUpgrades.length;e++){var I=oe.transcendenceUpgrades[e];(game.getFeatureFlag("MAUSOLEUM_PACTS")||"mausoleum"!==I.name)&&!I.unlocked&&x>=I.tier&&(I.unlocked=!0,r=1)}a--,Q("act.transcend",[game.getDisplayValueExt($),x],"transcendFilter"),me("transcend",1)}else a=0}}var B=game.resPool.isStorageLimited(p.prices),v=ae.auto.faith.items.transcendence,p=(!v.enabled&&R>p.faith&&g&&B&&(v.enabled=!0,G(["小猫贴心得无视超越按钮禁用","ks-default",ae.activityColor])),!oe.faithRatio||x),g=s<2?1.2+.1*(6<x)+(.5+.1*Math.log2(b))*(0<b):1+.005*x*x*(x<11),B=.5*Math.log(oe.faithRatio)+3.45,v=p<11||c?1.3+g*Math.min(.6,.06*x)+Math.log1p(b):1.32,p=game.getLimitedDR(g*v*Math.pow(Math.E,.65*B),100*i),b=a.adore.subTrigger,g=100*h<p;.001===b?C&&x&&((v=ue.other["adore.solar"])&&!g||(B=Math.min(p-45-x,90*i+3*x,94*i),((g=100*t<=Math.max(1,B))||h<t+.3&&t<9.7&&4<t)&&(C=!1),(p=Math.floor(100*p)/100)===v)||!g||c&&n||(ie(ee("summary.adore.solar",[p])),ue.other["adore.solar"]=p)):C=C&&10*b<t,C&&(B=this.catnipForReligion(),C=9<m||0<B||B<0&&0<S+W*B),(C||M)&&(E&&(ae.auto.timeCtrl.items.timeSkip.adore=!1),M=!0,oe._resetFaithInternal(1.01),Q("act.adore",[game.getDisplayValueExt(R),game.getDisplayValueExt(d)],"adoreFilter"),ue.adore[1]+=d,ue.adore[0]+=1)}v=.65*(.525*Math.log(oe.faithRatio)+3.45),g=n||U?1:.3,c=oe.getRU("stainedGlass").on,g=g*game.prestige.getPerk("vitruvianFeline").researched?1:.5-.1*!c,g=6<oe.getRU("solarchant").on?5-Math.sqrt(s):g,p=F<3?95:80,b=Math.max(1.8,game.getLimitedDR(.3*Math.pow(Math.E,v)*g,p*i)),a.autoPraise.expect=.01*b,t=oe.getRU("solarRevolution").on,P=!P&&T<=1,t&&P&&h<.01*b&&(S=c||te.gold.value<180||game.getEffect("culturePerTickBase")<.9,W=oe.getRU("basilica").on||te.gold.value<600||y.perTickCached<1.8||game.getEffect("culturePerTickBase")<2.7,B=le("culture"),S&&W||2<B)&&(T=0,r+=1),E=1+.1*game.getUnlimitedDR(w,.1);let z;h||n||(y.value>(1e3-R)/E&&R<1e3&&game.getEffect("faithRatioReligion")?(z=!0,ce("1000Faith")):y.value>(150-R)/E&&R<150&&(z=!0,ce("150Faith")));d=t||f<.98||!n&&te.gold.value<400;return(e&&f>=T&&.001<y.value&&d||M||z)&&(U=m<4?1e5:9e5,P&&!M&&f<.98&&!D&&(Date.now()>a.autoPraise.time+U||!ue.other["praise.msg"])&&h&&(a.autoPraise.time=Date.now(),s=game.getDisplayValueExt(b),ie(ee("summary.praise.msg",[s])),ue.other["praise.msg"]=s),F=oe.getApocryphaBonus(),p=(g=(v=te.faith).value+3*v.perTickCached)*(1+F),ue.praise[1]+=p,ue.praise[0]+=1,me("faith",g,"resConsume"),Q("act.praise",[game.getDisplayValueExt(g),game.getDisplayValueExt(p)],"faithFilter"),v.value=Math.max(g,0),oe.praise()),r},_worship:function(e){var a=ae.auto.faith.items;let t=JSON.parse(JSON.stringify(e||ae.auto.faith.items));var i,r=this.religionManager,e=this.bulkManager,l=oe.getRU("solarRevolution"),o=ue.other["auto.changeLeader"]?0:1,n=(oe.faith>l.faith||game.prestige.getPerk("voidOrder").researched)&&te.faith.maxValue>750-75*o,s=oe.transcendenceTier,o=!l.on&&n&&oe.getRU("solarchant").on&&s?.98+.2*(te.gold.maxValue>470-20*o):ae.auto.faith.trigger,n=(this.setTrait("wise"),game.getLimitedDR(.09+.01*(1+game.prestige.getBurnedParagonRatio()),1),!l.on&&n&&a.solarRevolution.enabled&&oe.faith>l.faith&&r.build("solarRevolution","s",1),oe.getRU("basilica").on),n=(n||(!oe.getRU("solarchant").on&&100<te.faith.value&&150<oe.faith&&r.build("solarchant","s",1),t.basilica.enabled&&(a=oe.getRU("stainedGlass").on,game.village.leader&&(t.goldenSpire.enabled=!1),a||(65e3<te.science.maxValue&&(t.scholasticism.enabled=!1),15e3<oe.faith&&4<s&&(t.sunAltar.enabled=!1)),7<s)&&(t.sunAltar.enabled=!1,t.goldenSpire.enabled=!1)),!game.ironWill&&game.getEffect("faithRatioReligion")<.8&&((te.unobtainium.maxValue<350||10<s)&&(t.templars.enabled=!1),!oe.getRU("templars").on&&3e3<te.faith.value&&75e3<oe.faith&&ce("templars"),s&&!game.getEffect("calcinerRatio")&&(t.goldenSpire.enabled=!1,7<s)&&(t.scholasticism.enabled=!1,t.sunAltar.enabled=!1),s<10)&&10<te.paragon.value&&(t.basilica.max=2,t.scholasticism.max=-1===t.scholasticism.max?3:t.scholasticism.max,ne.get("spaceManufacturing").researched||(t.goldenSpire.max=2,t.templars.max=0),!oe.getRU("sunAltar").on)&&4<s&&(t.goldenSpire.enabled=!1),s&&!oe.getRU("transcendence").on&&(t.apocripha.enabled=!1,6e3<te.faith.value)&&ce("apocripha"),oe.getSolarRevolutionRatio()>9.98+.9*game.getEffect("solarRevolutionLimit")&&ne.get("spaceManufacturing").researched&&ue.adore[0]&&["scholasticism","goldenSpire","stainedGlass","basilica","templars"].forEach(e=>{t[e].max=-1}),oe.getZU("marker")),a=n.unlocked,c=(oe.getZU("blackPyramid").getEffectiveValue(game)?(l.on||(t.blackPyramid.enabled=!1),(s=game.getEffect("relicRefineRatio"))<61&&game.getEffect("beaconRelicsPerDay")&&(te.burnedParagon.value<1e5&&(t.blackNexus.max=36),(l=game.nummon)&&-1===l.getBestRelicBuilding().indexOf("核心")&&(t.blackCore.max=0,ce("blackCore")),s<36)&&(t.singularity.max=5,t.blazar.max=1,t.blackRadiance.max=1,t.blackObelisk.max=Math.min(35,s+.2*s*(13<s)))):(a?((l=t.marker).enabled=!1,game.resPool.hasRes(n.prices)&&ce("marker"),te.burnedParagon.value<2e6&&(l.max=Math.max(80,l.max))):t.blackNexus.max=0,oe.getZU("sunspire").val<2&&(t.blackPyramid.enabled=!1),t.blackCore.max=0,game.getEffect("beaconRelicsPerDay")||(t.blackObelisk.max=0)),game.prestige.getPerk("codexLeviathanianus").researched||(t.blackLibrary.max=0),a||(t.blackRadiance.max=0),{});for(i in t){var g,u=t[i],m=r.getBuild(i,u.variant);"s"===u.variant&&(g=m.noStackable,(m.on&&g||oe.faith<m.faith)&&(u.enabled=!1),g)&&(u.max=1),"z"!==u.variant||game.bld.getBuildingExt("ziggurat").meta.on||(u.enabled=!1),"c"!==u.variant||game.science.get("cryptotheology").researched||(u.enabled=!1),c[i]=m}var d,p=e.bulk(t,c,o);let h=0;for(d in p){var f=p[d],b=f.count;0<b&&(r.build(f.id,f.variant,b),h+=1)}return h},chrono:function(){if(!game.timeTab.visible||!game.workshop.get("chronoforge").researched)return 0;let e=0;var a=JSON.parse(JSON.stringify(ae.auto.time.items)),t=this.timeManager,i=this.bulkManager,r=ae.auto.time.trigger,l=a.cryochambers,o=l.max,n=game.bld.getBuildingExt("chronosphere").meta.on+game.getEffect("cryochamberSupport"),l=(l.max=-1===o?n:Math.min(n,o),a.ressourceRetrieval);let s=l.max;var c,n=a.blastFurnace,g=(te.timeCrystal.value<1e10&&(n.max=4,.05<game.getEffect("shatterTCGain")&&(n.max=Math.round(127.35*game.getEffect("shatterTCGain")+11.393)),(o=te.paragon.value+te.burnedParagon.value)<1e7)&&game.calendar.trueYear()<2e3&&(s=32,o<2e4)&&(s=16),l.max=-1===s?100:Math.min(100,s),game.calendar.darkFutureYears(!0)<0&&(a.temporalImpedance.max=0),{});for(c in a){var u=a[c];"chrono"!==u.variant||game.workshop.get("chronoforge").researched||(u.enabled=!1),"void"!==u.variant||game.science.get("voidSpace").researched||(u.enabled=!1),g[c]=t.getBuild(c,u.variant)}var m,d=i.bulk(a,g,r,"time");for(m in d){var p=d[m];0<p.count&&(t.build(p.id,p.variant,p.count),e=1)}return e},upgrade:function(){let i,r,l;const o=ae.auto.upgrade.items,a=this.upgradeManager,n=this.craftManager,D=this.bulkManager,s=this.buildManager;var c=game.workshop.get("geodesy").researched,g=game.workshop.get("orbitalGeodesy").researched,u=oe.getSolarRevolutionRatio();let m=game.prestige.getParagonProductionRatio(),d=game.getEffect("priceRatio"),t=0;var p=game.bld.getBuildingExt("pasture").meta,h=game.bld.getBuildingExt("aqueduct").meta;if(this.setTrait("scientist"),o.techs.enabled&&game.libraryTab.visible){var U=game.science.techs,e=(o.techs.limited=!0,game.science.get("nanotechnology").researched),f=te.titanium.value,W=game.science.get("acoustics").researched,O=te.relic.value,b=te.parchment,v=1e5<te.starchart.value&&!game.science.get("drama").researched&&b.value<7500,k=te.science.maxValue;e:for(var y of U)if(!y.researched&&y.unlocked){if(o.techs.limited)switch(y.name){case"combustion":if(15e4<k&&f<5e3&&!game.science.get("metalurgy").researched||te.oil.maxValue<2e4&&f<1500&&!d)continue;break;case"biology":var I=c||!ue.other["auto.changeLeader"];if(k<123e3&&I||123e3<k&&f<5e3){ce("biology");continue}case"dimensionalPhysics":case"rocketry":if(v)continue;break;case"chemistry":if(!W&&u)continue;break;case"biochemistry":if(f<7e3)continue;break;case"ecology":case"ai":if(f<1e4||v)continue;break;case"physics":if(!W&&oe.transcendenceTier&&f<15&&6e4<k&&(te.compedium.value<120||te.steel.value<100)){ce("physics");continue}break;case"particlePhysics":if(2<m&&(!e&&2e5<k&&!v||!te.uranium.value&&18e4<k))continue;break;case"sattelites":if(1.75<m||k<2e5)break;case"oilProcessing":if(!e&&f<1e4||!g)continue;break;case"drama":if(te.manpower.perTickCached<14&&b.value<1e4+4e3*!m&&!te.eludium.value){5e3<b.value&&ce("drama");continue}break;case"quantumCryptography":if(game.getEffect("relicRefineRatio")<2&&game.religion.getZU("blackPyramid").on)continue;break;case"antimatter":if(2<m&&!game.getEffect("beaconRelicsPerDay")||!game.workshop.get("chronoforge").researched)continue;break;case"terraformation":if(2<m&&(!h.stage||te.sorrow.maxValue<17))continue;break;case"cryptotheology":if(O<105&&te.antimatter.value<4e3)continue;break;case"blackchain":continue}var x,z=dojo.clone(y.prices);for(x of game.village.getEffectLeader("scientist",z)){var G=x.name;if(a.getValue(G)<x.val)continue e}t=1,a.build(y,"science")}}if(o.upgrades.enabled&&game.workshopTab.visible){game.workshopTab.domNode||(t=2);var H=game.workshop.upgrades;let e=[];var R=te.starchart,w=R.value,M=(e=["biofuel","gmo","invisibleBlackHand","steelPlants","register","neuralNetworks"],game.getEffect("shatterTCGain")<.05&&2<m&&(e=e.concat(["amReactors","amReactorsMK2","amDrive"])),p.on&&0!==p.stage||(e=e.concat(["photovoltaic","thinFilm","qdot"])),h.on&&0!==h.stage||e.push("hydroPlantTurbines"),te.void.value<250&&e.push("voidAspiration"),d&&e.push("voidReactors"),["factoryAutomation","advancedAutomation","pneumaticPress"]),E=game.challenges.isActive("pacifism"),M=(game.bld.getBuildingExt("steamworks").meta.on<1-50*d?(E||(e=e.concat(["printingPress","offsetPress","photolithography"],M)),game.bld.getBuildingExt("steamworks").meta.on||e.push("combustionEngine")):game.opts.enableRedshift||(e=e.concat(M)),E&&(e=e.concat(["bolas","huntingArmor","steelArmor","alloyArmor","nanosuits","silos"])),game.village.getJob("engineer").value<5&&(e=e.concat(["spaceEngineers","aiEngineers","chronoEngineers","amFission","factoryRobotics","factoryOptimization"])),!u&&750<=te.faith.maxValue&&1e3<oe.faith&&e.push("caravanserai"),game.globalEffectsCached.titaniumPerTickAutoprod<.02&&te.ship.value<50&&((2<m&&te.titanium.value<15||1.6<u)&&e.push("titaniumAxe"),2.26<u)&&e.push("silos","astrolabe","titaniumBarns","alloyAxe","alloyArmor","alloyBarns","alloyWarehouses"),(u>8+23.2*d||g)&&!game.space.meta[0].meta[3].val&&w<1700&&(te.unobtainium.value||(e=e.concat(["geodesy","seti"])),g||(1<game.getEffect("calcinerRatio")&&e.push("fuelInjectors"),e=e.concat(["titaniumWarehouses","titaniumBarns","steelSaw","titaniumSaw","cadSystems"]))),c||(e.push("seti","silos"),g||(u<6&&300<w&&(e.push("titaniumSaw"),game.getEffect("calcinerRatio")||e.push("pumpjack")),M=le("coal"),te.oil.value<75e3&&(e=e.concat(["offsetPress","photolithography"]),.8<M&&le("oil")<.95&&e.push("fuelInjectors","pyrolysis","combustionEngine","coalFurnace"),.6<M)&&1<m&&e.push("coalFurnace"),e.push("titaniumWarehouses"),4<u&&.4<M&&e.push("fuelInjectors")),te.manpower.value||e.push("bolas"),te.ship.value)||e.push("cargoShips"),game.getEffect("smelterRatio")||e.push("concreteWarehouses","concreteBarns","barges","seti"),game.bld.getBuildingExt("factory").meta.val<3+2*c&&(e.push("factoryLogistics","refrigeration","barges","carbonSequestration","seti"),.7<le("oil"))&&1.5<m&&(1.8<m&&e.push("pumpjack","silos"),e=e.concat(["oilDistillation","oilRefinery"])),game.workshop.get("mWReactor").researched||(e.push("eludiumReflectors","amBases","coldFusion","amReactors","cryocomputing","darkEnergy"),1<m&&(e.push("lhc"),2<m&&4<u||le("unobtainium")<1)&&e.push("unobtainiumReflectors","astrophysicists")),0===game.bld.getBuildingExt("library").meta.stage&&(e=e.concat(["starlink","uplink","cryocomputing"])),game.bld.getBuildingExt("accelerator").meta.val<5&&(e.push("darkEnergy","stasisChambers","voidEnergy","tachyonAccelerators","lhc","assistance"),4<m)&&(e=e.concat(["stoneBarns","reinforcedBarns","titaniumBarns","alloyBarns","concreteBarns","alloyWarehouses","concreteWarehouses","storageBunkers","stasisChambers","voidEnergy","darkEnergy"])),game.bld.getBuildingExt("aiCore").meta.val<5&&(e=e.concat(["machineLearning","aiBases"]),E=te.ship.value<5e4,4<m&&(e=e.concat(["storageBunkers","tachyonAccelerators","darkEnergy","eludiumReflectors","amBases"])),E)&&e.push("thoriumEngine"),(game.bld.getBuildingExt("reactor").meta.val<2||te.ship.value<169)&&(e=e.concat(["reactorVessel","enrichedUranium"])),game.space.getBuilding("sattelite").val<6&&(e=e.concat(["solarSatellites","satelliteRadio"])),R.perTickCached?w.perTickCached<1&&game.challenges.isActive("blackSky")&&(e=e.concat(["geodesy"])):e=e.concat(["hubbleTelescope"]),game.bld.getBuildingExt("magneto").meta);M.val===M.on&&e.push("carbonSequestration"),(te.thorium.value<3e5||600<game.resPool.energyProd-game.resPool.energyCons)&&(e.push("thoriumReactors"),1<m&&(e.push("coldFusion"),w<2e5)&&e.push("amBases","eludiumCracker"),E=game.getEffect("hutPriceRatio"))&&-1.06<E&&e.push("astrophysicists"),(te.science.maxValue>12e4+1e5*c&&w<2075||te.titanium.value<5+10*u+5*!m)&&(e=e.concat(["astrolabe","unobtainiumReflectors","lhc","titaniumMirrors"])),game.challenges.isActive("anarchy")&&(e=e.concat(["logistics","augumentation","internet","neuralNetworks","register"])),game.ironWill?e=e.concat(["logistics","augumentation","internet","neuralNetworks","mineralHoes","ironHoes","miningDrill","mineralAxes","ironAxes","steelAxe","titaniumAxe","alloyAxe","ironwood","concreteHuts","unobtainiumHuts","eludiumHuts","geodesy","register","unobtainiumDrill","assistance","astrophysicists","register"]):game.workshop.get("concreteHuts").researched||(e=e.concat(["concreteWarehouses","concreteBarns","barges","seti"]),game.workshop.get("fuelInjectors").researched||e.push("offsetPress"),1<game.village.jobs[0].value&&1<m&&d&&(game.getEffect("woodJobRatio")<.7&&e.push("mineralHoes"),game.getEffect("woodJobRatio")<1.2)&&e.push("ironHoes"),c&&e.push("cadSystems"),1<m&&e.push("titaniumSaw"));e:for(var T of H)if(!T.researched&&T.unlocked){var J=T.name;if(-1===e.indexOf(J)){r=dojo.clone(T.prices);for(l of r=game.village.getEffectLeader("scientist",r))if(a.getValue(l.name,J)<l.val)continue e;t+=1,a.build(T,"workshop")}}}if(o.policies.enabled&&game.libraryTab.visible){var R=game.science,j=(R.policies.length,[]),N=R.get("astronomy").researched||te.burnedParagon.value<1e4&&te.culture.value<400||!game.getEffect("priceRatio")?1:3;let c=ae.policies;if(o.policies.auto)if(c=[],game.challenges.anyChallengeActive())o.policies.enabled=!1,$("#toggle-policies").prop("checked",!1),ce("anyChallengeActive");else if(!game.ironWill){R=te.ship.value;c=["clearCutting","outerSpaceTreaty","epicurianism","expansionism","necrocracy"];let e="liberty",a="sustainability",t="authocracy",i="",r="isolationism",l="cityOnAHill",o="extravagance",n="rationality",s="fascism";R>65+5*m&&(i="zebraRelationsAppeasement"),d?(n="mysticism",d<-.06&&(i="",a="fullIndustrialization",r="diplomacy",l="knowledgeSharing"),1e4<te.burnedParagon.value&&(e="tradition",t="monarchy",l="culturalExchange",s="communism",o="carnivale")):e="tradition",game.diplomacy.get("leviathans").unlocked&&1e4<R&&(i="zebraRelationsBellicosity"),c.push(e,a,t,r,l,n,s,o),i&&c.push(i)}var K=game.science.policyMetaCache;for(i in c){var F=K[c[i]];!F||F.researched||F.blocked||F.unlocked&&(void 0===F.requiredLeaderJob||null!=game.village.leader&&game.village.leader.job===F.requiredLeaderJob)&&j.push(F)}e:for(i of j){for(var _ of i.prices)if(n.getValueAvailable(_.name,!0)<_.val*N)continue e;a.build(i,"policy")}}var C=game.spaceTab;if(o.missions.enabled&&C.visible){let e=o.missions.subTrigger;var Y=game.space.meta[0].meta.length;let a=game.workshop.get("spaceManufacturing").researched,t=(4===e&&((M=te.starchart.value)<4e5&&(game.challenges.anyChallengeActive()&&(e=5),-.06<d)&&te.unobtainium.maxValue<350&&(e=2),60<te.antimatter.value||M>Math.min(2e5*(1+m)*(1+u),1e9)||2<te.alicorn.value)&&(e=7,26<te.relic.value)&&(e=12),0);var Z=!(g||te.unobtainium.value&&c),X=C.GCPanel,B=(X||C.render(),game.space.meta[0].meta);e:for(i=0;i<Y;i++){var P=B[i];if(P.val&&7!==i&&t++,!(!P.unlocked||P.val||i>=e)){if(Z)break;P=X.children[i];if(!P||!P.model.metadata){C.render();break}if((B[3].val||2!==i||3===e||game.challenges.isActive("blackSky"))&&!P.model.metadata.val&&!P.model.metadata.on){for(l of r=P.model.prices)if(n.getValueAvailable(l.name,!0)<l.val)continue e;P.model.enabled?(P.controller.build(P.model,1),a=2,ge(r),7===i||12===i?ie(ee("upgrade.space.mission",[B[i].label]),"spaceFilter"):ie(ee("upgrade.space",[B[i].label]),"spaceFilter")):P.controller.updateEnabled(P.model)}}}(C.planetPanels.length!==t&&!Z||1<a)&&C.render()}if(o.races.enabled&&game.diplomacy.hasUnlockedRaces()){let a=game.diplomacy.get("leviathans").unlocked?8:7;game.diplomacyTab.racePanels.length<a&&(E=function(e){game.diplomacy.get(e).unlocked||1e3<=n.getValueAvailable("manpower",!0)&&(te.manpower.value-=1e3,a="render",Q("upgrade.race",[game.diplomacy.unlockRandomRace().title],"tradeFilter"),me("manpower",1e3,"resConsume"))},(game.challenges.isActive("pacifism")||!game.village.sim.kittens.length||15<te.gold.value)&&(E("lizards"),E("sharks"),E("griffins")),1500<=te.culture.value&&E("nagas"),1<=te.ship.value&&E("zebras"),100<=te.ship.value&&125e3<te.science.maxValue&&E("spiders"),game.science.get("nuclearFission").researched)&&E("dragons"),game.diplomacyTab.racePanels.length&&"render"!==a||game.diplomacyTab.render()}if(o.buildings.enabled){var w=ae.auto.build.items,M=1===game.calendar.season?game.resPool.energyProd:game.resPool.energyWinterProd,E=game.challenges.isActive("energy"),S=1e3*(2e6<te.starchart.value),S=M-10-5*m-30*(9<u)-S<game.resPool.energyCons||E,V=0===p.stage?p.val:0,q=0===h.stage?h.val:0,A=(e,a)=>{var t=a.stages[1].prices;if(D.singleBuildPossible(a,t,1))return s.sellBuild(e),game.resPool.payPrices(t),a.stage=1,a.on=1,a.val=1,a.upgrades&&(a.updateEffects&&a.updateEffects(a,game),re(a.upgrades)),game.bld.getBuildingExt(e)._metaCache=null,s.manager.render(),ae.renderTime=0,Q("summary.upgrade.building."+e,[],"upgBldFilter"),me("upgrade.building."+e),ce("upg"+e.charAt(0).toUpperCase()+e.slice(1),!0),2};if(0===p.stage&&p.stages[1].stageUnlocked){var L=1===game.bld.getBuildingExt("amphitheatre").meta.stage,L=S&&L&&(game.getResourcePerTick("titanium",!0)>20+m-5*c||game.workshop.get("unobtainiumDrill").researched),q=n.getPotentialCatnip(!0,0,q);if((0<q||q<0&&0<te.catnip.value+2e3*q)&&L&&w.solarFarm.enabled&&.4<le("titanium"))return A("pasture",p);ce("upgPasture","","upgBldFilter")}if(0===h.stage&&h.stages[1].stageUnlocked&&1===p.stage){q=250*Math.pow(p.stages[1].priceRatio+d,p.val)>te.titanium.maxValue||E,L=n.getPotentialCatnip(!0,V,0);if((0<L||L<0&&0<te.catnip.value+(1e4+6e3*(u<8)-1e3*m)*L)&&q&&S&&w.hydroPlant.enabled)return A("aqueduct",h);ce("upgAqueduct","","upgBldFilter")}p=game.bld.getBuildingExt("library").meta;if(0===p.stage&&p.stages[1].stageUnlocked){V=.1*p.totalEffectsCached.scienceMax/(1+m),L=Math.max(1+game.prestige.getParagonProductionRatio(),2)/2,q=3*te.compedium.value>V/(1+.01*game.bld.getBuildingExt("biolab").meta.val)&&game.bld.getEffect("scienceMax")>3e4*(1+m)*(1+u),S=(q|=n.getTickVal(te.concrate)>600*L,1+m);if(q&&w.dataCenter.enabled){if(te.eludium.value>Math.pow(3,S)-74*(!m&&te.unobtainium.value)+70&&M>=game.resPool.energyCons+100*S&&!E&&.8<le("science"))return A("library",p)}else ce("upgLibrary","","upgBldFilter")}V=game.bld.getBuildingExt("amphitheatre").meta;if(0===V.stage&&V.stages[1].stageUnlocked){if(w.broadcastTower.enabled&&(2<game.getResourcePerTick("titanium",!0)||400<te.ship.value))return A("amphitheatre",V);ce("upgAmphitheatre","","upgBldFilter")}}return t},build:function(e){var a=this.buildManager,n=this.bulkManager,D=ae.auto.build.trigger;let t=0;var i={};let r;if("object"!=typeof e){var s=this.craftManager,c=game.ironWill,g=game.challenges.isActive("blackSky"),u=game.getEffect("priceRatio"),m=u<-.06,d=game.challenges.isActive("atheism"),p=null!==game.village.leader,h=game.prestige.getParagonProductionRatio(),f=ne.get("geodesy").researched,b=ne.get("orbitalGeodesy").researched;let l=ne.get("spaceManufacturing").researched;var v=game.space.getBuilding("sattelite").on,k=oe.getRU("solarRevolution"),y=oe.getSolarRevolutionRatio(),U=game.bld.getBuildingExt("calciner").meta,x=U.val,R=game.science,w=R.get("theology").researched;r={};let o=JSON.parse(JSON.stringify(ae.auto.build.items));var M=te.science,E=M.maxValue;let n=M.value/E;var M=(e,a,t)=>{var i=o[e],r=i.max;e&&(n<t?(i.max=-1===r?a:Math.min(a,r),game.bld.getBuildingExt(e).meta.val>=a&&!l&&ce("scienceBld")):i.max=-1===r?game.bld.getBuildingExt(e).meta.val+4:r)},T=te.starchart.value,M=(y<50&&(T<2e6||v<10)&&(M("observatory",(1e4<T?100:300)+game.getEffect("timeRatio")+Math.pow(3.2,h),.95),M("academy",22*(h+1),.98),M("biolab",200,.99)),s.getPotentialCatnip(!1)),s=R.get("machinery").researched,F=R.get("astronomy"),C=(n<.98&&(!s||F.unlocked)&&te.minerals.value&&h&&!F.researched&&(o.academy.max=6*(h+1),game.getEffect("maxKittens")<12&&1.5<h&&(o.academy.max=3),F.unlocked)&&ce("academy"),o.smelter),B=o.pasture,P=(!game.workshopTab.visible&&R.get("animal").researched&&(C.max=0,150===B.max)&&!game.challenges.isActive("winterIsComing")&&(5<M||400<te.minerals.value||3<game.village.jobs[0].value)&&(B.enabled=!1,ce("pasture")),w||($=game.bld.getBuildingExt("pasture").meta,S=game.bld.getBuildingExt("hut").meta.val-2,10<$.val&&(B.max=(1+3*u)*(6-h+game.bld.getBuildingExt("library").meta.val-12.5*(2==S))),($=o.library).max=0<S?Math.floor(11*S+100*u):$.max,s&&le("wood")<.9&&!c&&($.max=45),h&&S<4&&1<S&&(u&&(2==S&&(o.barn.max=1),3==S)&&(o.pasture.max=10),2+!u+m<M)&&(9<oe.transcendenceTier&&!s&&(5<M&&1<game.village.jobs[0].value&&(B.max=0),o.barn.max=0),R.get("civil").researched||(2==S&&($.max=13+h-3*m,o.mine.max=1,B.max=13),P=!game.bld.getBuildingExt("logHouse").meta.val&&m&&!c,3==S&&($.max=30-2*h-7*m,o.academy.max=5,P)&&(o.mine.max=7),4==S&&P&&(o.mine.max=7)),3<te.parchment.value)&&!te.culture.value&&(o.workshop.max=0),te.gold.value||h||(o.academy.max=5),R.get("currency").researched||(o.academy.max=1+h+!h),o.warehouse.max=20-5*h+50*m+2*S),!R.get("writing").researched&&te.minerals.value?(($=o.workshop).max=1,.9<le("minerals")&&($.max=3),ce("workshop")):ce("workshop",!0),o.reactor),S=(!l&&(125e3<te.titanium.maxValue||!v&&m)&&(P.max=25+10*g),te.oil.maxValue<55e3&&(o.quarry.max=35*(1+y)/(1+h)),g&&3e5<E&&!b&&!c&&(o.observatory.max=3+x),game.bld.getBuildingExt("magneto").meta),V=(game.challenges.isActive("pacifism")||($=o.mint,V=te.manpower.maxValue,q=game.bld.getBuildingExt("mint").meta.val,V<=2e4&&!game.workshop.get("unobtainiumDrill").researched?$.enabled=!1:!q||!v||game.getEffect("productionRatio")<.5?($.max=2+10*(4<y),o.temple.max=25):b||($.enabled=!1),l)||(200===(V=o.warehouse).max&&(V.max=Math.min(200*Math.log(1.064)/Math.log(1.15+u),200)),te.blueprint.value<10&&(o.chapel.max=23),c)||(q=S.on,h<1&&q<4&&q&&(o.steamworks.max=5),q<Math.max(1,7-h-4*p-3*(0<game.getEffect("calcinerRatio"))-.4*f+!h)?($=o.steamworks,game.bld.getBuildingExt("steamworks").meta.unlocked&&$.enabled&&19<te.gear.value&&(ce("steamworks"),$.enabled=!1)):ce("steamworks",!0)),o.brewery),S=((!R.get("metalurgy").researched||1e3<te.spice.value&&te.spice.value<1e4)&&(V.max=4),(!game.calendar.festivalDays||te.spice.value<1e3+500*h||!v&&M<0||te.parchment.value<5e3)&&(V.enabled=!1),o.temple),$=(p&&!game.getEffect("unobtainiumPerTickSpace")&&te.faith.maxValue<1e4&&(S.max=Math.max(21+10*b-h+5*u-4*m,10*(1+y))),y<.06&&(4!==V.max&&(V.max=30),o.chapel.max=19-18*!y+60*(100<te.ship.value),S.max=40-28*!f-3*p-h,q=game.bld.getBuildingExt("smelter").meta.val,M>7*game.village.happiness*(2-p)&&(B.max=0,ce("pasture")),te.wood.perTickCached<.09&&!game.ironWill&&(C.max=0),q)&&(2*te.wood.perTickCached<q-.5*s||te.minerals.perTickCached<q+.8-3*w-h-5*F.researched+u?(C.max=0,c||ce("smelter")):C.max=q+1),game.bld.getBuildingExt("temple").meta.val),V=o.tradepost,M=(oe.faith>k.faith||game.prestige.getPerk("voidOrder").researched,te.gold.value/te.gold.maxValue);if(game.getEffect("standingRatio")<.2&&1e4<te.ivory.value&&11<$&&(B=game.workshop.get("caravanserai")).unlocked&&!B.researched&&(S.enabled=!1,V.max=21-h,ce("caravanserai")),f)p&&!b&&te.kittens.maxValue<130&&game.workshop.get("concreteHuts").researched&&(o.hut.enabled&&a.built("hut",void 0,1),o.logHouse.enabled)&&a.built("logHouse",void 0,1),!h&&E<119e3&&(o.library.max=64);else{if(u&&y&&!l){s=oe.getRU("basilica").on;S.max=23-8.5*(u<0)-2*(3<y)-2*p+1.5*s;let e=12+2*$-5*h-3*Math.sqrt(y)-2*p+x+2*f+5*!u+(2+2*m)*s;c||(e=Math.max(Math.min(Math.floor(e),35),12)),V.max=e,ce("religion")}y||(V.max=40-25*(4<h)-5*p-5*d-7*!h)}k.on||d||!w?w&&(ce("temple",!0),ce("tradepost",!0),!b)&&25<$&&(S.enabled=!1):(ae.auto.faith.items.solarRevolution.enabled&&(F=!ue.other["auto.changeLeader"]&&u<-.07?1:0,te.faith.maxValue>750-75*F)&&te.gold.maxValue>500-50*F&&(ce("temple"),S.max=Math.floor((7.5-.7*F)/(1+game.prestige.getParagonStorageRatio()))+4*!p+3*!h,.961<le("gold"))&&(S.max=$+1),oe.transcendenceTier?V.max=21-2*h+ +(te.kittens.value<60)-5*p-2*(70<te.kittens.value):V.max=23-2*h-2*(55<te.kittens.value),.966<le("gold")&&(V.max=Math.min(18+h,game.bld.getBuildingExt("tradepost").meta.val+1)),ce("tradepost")),!w&&R.get("philosophy").researched&&M<.96&&!d&&(S.max=u<-.07?1:Math.floor(7.5/(1+game.prestige.getParagonStorageRatio()))-m,V.max=21-2*h-5*p-1.45*(43<te.kittens.value),ce("tradepost"));var q=o.calciner,B=q.max;if(b)l&&v||(s=Math.min(46+y,6*y+15+2*h+4*game.workshop.get("unobtainiumDrill").researched),q.max=-1===B?Math.min(s+s*game.getEffect("productionRatio"),95-35*g+game.space.meta[0].meta[0].on*g*10):Math.min(50,B)),m&&b&&ce("lower",!0);else{let e=21+10*(250<te.uranium.value)+5*(35e3<te.oil.value);(E<2e5||te.oil.maxValue<5e4)&&(e=Math.min(10+3*h+2*Math.sqrt(y),e)),q.max=-1===B?e:Math.min(e,B),game.workshop.get("fluidizedReactors").researched||(q.max=20),game.workshop.get("oxidation").researched||(q.max=5+y+.2*h+f),o.warehouse.max=45-200*u+50*(u<-.07)+5*R.get("electricity").researched+h+4*x*m+13*f*h*m,o.quarry.max=y+Math.max(h-1,1)+4+x*f,h||!p||ne.get("logistics").researched||(o.observatory.max=26,o.library.max=60),te.uranium.value<100&&(P.max=0)}var A,k=te.oil.perTickCached-.024*x,F=(k<.5-.1*m&&(q.max=+(1<h)+1+2*game.getEffect("calcinerRatio"),x&&ce("oilTick"),k<.085)&&(o.magneto.max=0),o.solarFarm),$=(le("titanium")<.9&&game.resPool.energyProd-10>game.resPool.energyCons&&(F.enabled=!1),game.bld.getBuildingExt("ziggurat").meta),w=($.val>8+m&&!te.alicorn.unlocked&&(te.blueprint.value<(5+y-1.5*l+ +!b)*Math.pow($.priceRatio+u,$.val)?o.ziggurat.max=0:o.ziggurat.max=$.val+1),o.mansion),M=o.broadcastTower,S=(R.get("archeology").researched,te.ship.value),v=b||600<S,B=(l?l&&o.barn.max<16&&.9<le("wood")&&(o.barn.max=-1):1e4-9e3*m<T&&!c&&1<h&&te.eludium.value&&(game.calendar.festivalDays||(o.observatory.max=70,o.chapel.max=10,o.factory.max=Math.floor(.05*x),o.amphitheatre.max=20,o.academy.max=60,o.harbor.max=10,M.max=10,o.logHouse.max=Math.min(70,game.bld.getBuildingExt("logHouse").meta.val+1),o.hut.max=game.bld.getBuildingExt("hut").meta.val+1,te.wood.perTickCached||(C.max=60),o.ziggurat.max=1,o.mansion.max=35),60<(s=game.resPool.resourceMap.kittens).maxValue-s.value)&&(o.logHouse.enabled=!1,o.hut.enabled=!1),R.get("electronics").researched&&!l?(ce("broadcastTower"),w.max=80):ce("broadcastTower",!0),te.titanium),p=o.biolab,W=(f||b?(v&&!w.max&&1===le("titanium")&&(w.max=45),l?(ce("biolab",!0),ce("mansion",!0),ce("scienceBld",!0),ce("smelter",!0),.1<y&&b&&ce("pasture",!0)):((le("titanium")<.98||game.getEffect("calcinerRatio")<2)&&(p.max=Math.max(20-y-h-15*(!b&&181e3<E&&19<x||x<20||19e4<E),21*(!h&&E<181e3)),f||(w.max=Math.max(Math.floor(17*(h+1)),135-game.village.maxKittens))),y&&game.getEffect("faithRatioReligion")<.2&&(V.max=Math.min(36+Math.max(4*f,22*b,.5*x)-5*m,50),o.workshop.enabled)&&(P=te.kittens.maxValue,1<h||P<125||135<P)&&(k=game.bld.getBuildingExt("workshop").meta,.95*te.minerals.maxValue>400*Math.pow(k.priceRatio+u,k.val)?(o.logHouse.enabled=!1,C.max=25+35*m,o.aqueduct.enabled=!1,o.amphitheatre.enabled=!1):u&&le("wood")<.7&&(o.mine.enabled=!1)))):(!c&&w.max&&(w.max=12-u-h,h&&100<T&&(w.max-=7),o.quarry.max=y+h+5+2*!h,25!==q.max&&te.oil.value||(w.max=0)),25<te.alloy.value&&R.get("biology").researched&&(p.max=0,ce("biolab"))),R.get("electricity").researched||(o.oilWell.max=1+h+y+10*m+B.perTickCached),game.space.getProgram("moonMission").on&&.9<le("titanium")?1!==le("titanium")&&T<1e6&&(F=M.max,M.max=-1===F?20:Math.min(20,F)):T<1e6&&(M.max=8+100*d),u&&te.unobtainium.value<13e3&&game.calendar.futureSeasonTemporalParadox<0&&!game.getEffect("resStasisRatio")&&(o.chronosphere.enabled=!1),game.challenges.isActive("anarchy")?o.aiCore.enabled=!0:(!game.getEffect("aiCoreProductivness")&&te.burnedParagon.value<2e4&&m&&(game.getEffect("beaconRelicsPerDay")?o.aiCore.max=game.getEffect("gflopsConsumption")?4+21*(3e3<game.calendar.year):3:o.aiCore.max=0,o.chronosphere.max=10+10*(2e3<te.paragon.value||200<game.calendar.year)),game.science.get("paradoxalKnowledge").researched&&te.unobtainium.maxValue<7e9&&game.calendar.trueYear()<2e3&&(m&&(o.harbor.max=300),2e4<te.burnedParagon.value)&&(o.harbor.max=400,o.chronosphere.max=Math.max(40,50*game.getEffect("gflopsPerTickBase")))),g&&(ae.auto.build.items.calciner.enabled&&U.unlocked&&!x&&a.built("calciner",void 0,1),game.ironWill)&&!ne.get("celestialMechanics").researched&&(o.library.max=0),["library","academy","pasture","barn","harbor","oilWell","warehouse","broadcastTower","accelerator","mansion","quarry","aqueduct","chapel","lumberMill","biolab","mint"]);for(A in o){var L=o[A];L.enabled&&L.max&&(-1===W.indexOf(A)?r[A]=L:i[A]=L)}}e=r||e;var $=a.getMetaDataList(e),l=n.bulk(e,$,D,"bonfire");if(l)for(let e=0;e<l.length;e++){var O=l[e].count,I=l[e].id;0<(O=a.count(I,O))&&(a.built(l[e].name||I,l[e].stage,O),t+=1)}if("{}"!==JSON.stringify(i)){var $=a.getMetaDataList(i),o=n.bulk(i,$,D,"bonfire");if(o)for(let e=0;e<o.length;e++){var z=o[e].count,G=o[e].id;0<(z=a.count(G,z))&&(a.built(o[e].name||G,o[e].stage,z),t+=1)}}return t},space:function(){if(game.spaceTab.visible&&game.space.meta[0].meta[0].on){var t=JSON.parse(JSON.stringify(ae.auto.space.items)),i=this.spaceManager,r=(this.craftManager,this.bulkManager);let e=ae.auto.space.trigger;var l=game.challenges.isActive("blackSky"),o=oe.getSolarRevolutionRatio(),n=te.starchart.value,s=(this.setTrait("chemist"),t.spaceStation),c=game.getEffect("unobtainiumPerTickSpace"),g=game.getEffect("priceRatio"),u=g<-.06,m=1.3-.5*u<o&&c||2<o,d=(l?(t.researchVessel.enabled=!1,s.enabled&&($("#toggle-spaceStation").click(),ce("spaceStation"))):!e&&m&&!game.space.meta[0].meta[3].val&&n<2400&&(e=9,ce("spaceTrigger")),game.space.getBuilding("sattelite").val),p=ne.get("spaceManufacturing").researched,h=l||5<o||c&&p;if(e)9!==e&&ce("spaceZero");else{var f=game.resPool.energyProd,b=game.resPool.energyCons,v=game.prestige.getParagonProductionRatio(),k=le("unobtainium"),y=game.space.getBuilding("spaceStation").val,x=game.space.getBuilding("containmentChamber").val,R=(-.6-g)*!u*(game.getEffect("hutPriceRatio")<-1),w=Math.pow(1.08,d),M=2300*w*(1-R),R=3e3*Math.pow(1.12,y)*(8*!o+R+.7+u*(-1.2*(te.titanium.maxValue<2500*w*(2.7+15*g))+.5)),w=t.sattelite,E=(M<n&&o<2&&(w.max=Math.max(d+1,w.max)),!c&&o&&(w.max=9+6*l),game.getEffect("productionRatio")<.6&&0<k&&5<o),M=((n<M&&o<2&&d||!game.workshop.get("orbitalGeodesy").researched||E)&&(w.max=0),R<n&&(s.max=y+1),game.challenges.isActive("energy")),E=((n<R||M||!c||x)&&(s.enabled&&ce("spaceStationStar"),s.max=0,M)&&(t.tectonic.enabled=!0,t.hrHarvester.enabled=!0),game.getEffect("lunarOutpostRatio")?o||(t.spaceElevator.max=40):1!==k&&(t.spaceElevator.max=7+Math.min(o,v)-6*(te.unobtainium.maxValue<500)+u,!u&&k<.5-10*g||!o&&!game.ironWill&&!ne.get("astrophysicists").researched||!u&&-1<game.getEffect("hutPriceRatio")&&g&&!game.ironWill)&&(t.spaceElevator.max=0),le("antimatter")<.8&&(t.terraformingStation.enabled=!1),game.getResourcePerTick("uranium",!0)),w=((E<2+10*p||1<=le("unobtainium"))&&(t.moonOutpost.max=1),game.prestige.getParagonStorageRatio()),R=(k<.8-g?(t.moonBase.max=140*(25<game.bld.getBuildingExt("aiCore").meta.val),ce("moonBase")):(y=game.space.getBuilding("moonBase")).val===y.on&&(t.moonBase.max=y.val+1),8<E&&n<1e6&&(t.planetCracker.max=7*(1e5<n)),n<Math.min(3e4*(1+o*o),1e7)&&(t.hydrofracturer.max=100*game.getEffect("spaceRatio")*(1+5*g)-v-o-23*l),o||(t.hydrofracturer.max=0,t.researchVessel.max=42+v,l)||(t.sunlifter.max=0),n<1e5&&(t.spiceRefinery.max=0),.9<le("antimatter")&&(t.sunlifter.max=0),game.space.getBuilding("cryostation").val),c=te.eludium.value,M=25*Math.pow(1.12,3*(1<w)+9*(100<w)+R+v+Math.sqrt(.5*w)),p=(M<c&&(t.cryostation.max=R+1),c<M&&(t.cryostation.max=0),t.containmentChamber),k=t.heatsink,y=te.antimatter,E=game.space.getBuilding("heatsink").val,n=(k.max=E+1,p.max=x+1,Math.max(50*(1+.01*E),5*x)),w=f<b+n+2,R=game.prestige.getPerk("numerology").researched&&(3===game.calendar.cycle||1===game.calendar.cycle),c=(u&&game.getEffect("gflopsConsumption")&&E<x+20&&14<x&&(p.enabled=!1),(y.value+(50-40*!v)*game.getEffect("antimatterProduction")<y.maxValue||w||R||!te.alicorn.value)&&(k.enabled=!1,p.enabled=!1),f<b+20&&(s.max=0,t.moonOutpost.max=0,t.moonBase.max=0),t.entangler);if(game.getEffect("beaconRelicsPerDay")){M=c.max;let e=0;13<game.bld.getBuildingExt("aiCore").meta.effects.aiLevel&&!game.getEffect("aiCoreProductivness")&&(e=1),!game.religion.getZU("blackPyramid").on||game.space.getBuilding("entangler").effects.hashRateLevel||(t.spaceBeacon.max=20),c.max=-1===M?game.getEffect("gflopsPerTickBase")/.1*(1+e):M,20<game.getEffect("relicRefineRatio")&&(f<b+100&&(t.tectonic.enabled=!0,t.moltenCore.enabled=!0,1e5<game.calendar.year)&&(t.hrHarvester.enabled=!0),t.sunforge.enabled=!0)}else game.calendar.year<1e3&&!(n=game.challenges.getChallenge("1000Years")).on&&n.active&&((x=(E=ae.auto).space.items).containmentChamber.enabled||$("#toggle-containmentChamber").click(),x.heatsink.enabled||$("#toggle-heatsink").click(),(y=E.timeCtrl).enabled||$("#toggle-timeCtrl").click(),y.items.timeSkip.enabled||$("#toggle-timeSkip").click(),E.build.items.chronosphere.enabled||$("#toggle-chronosphere").click(),E.build.items.aiCore.enabled||$("#toggle-aiCore").click(),E.options.items.useWorkers.enabled||(q.stop(),E.options.items.useWorkers.enabled=!0,V.items["toggle-useWorkers"]=!0,E.engine.enabled&&q.start()),(w=E.faith.items).marker.enabled||$("#toggle-marker").click(),w.blackPyramid.enabled||$("#toggle-blackPyramid").click(),l&&(A.zh["summary.auto.one1000years"]="聪明的小猫自动勾上了长挂所需要的选项<br>猫猫贴心提示煅烧炉和卫星价格变了具体可以参考百科挑战"),ce("one1000years",!1,"noFilter")),g<-.03&&!l&&(t.spaceBeacon.enabled=!1),u&&(t.sunforge.enabled=!1),l&&(t.spaceBeacon.enabled=!0),t.entangler.enabled=!1;R=t.orbitalArray,k=game.nummon;k&&(p=game.space.getBuilding("orbitalArray").val,k.getBestUnobtainiumBuilding()===$I("space.planet.piscine.orbitalArray.label")?!game.getEffect("shatterTCGain")||39<p||v<2?R.max=p+1:R.max=40:R.max<0&&(R.max=0)),v<.4&&!u&&(R.max=0)}game.ironWill&&(s.max=0,t.terraformingStation.max=0),(d<3+2*(9.7<o)&&2<game.getEffect("calcinerRatio")&&m||!d)&&(i.build("sattelite",1),ce("sattelite")),h&&(!l&&game.space.getBuilding("researchVessel").val<1&&t.sattelite.enabled&&i.build("researchVessel",1),game.space.getBuilding("researchVessel").val<4)&&(s.max=0);var T,F={};for(T in t)F[T]=i.getBuild(T);var C,B=r.bulk(t,F,e,"space");let a=0;for(C in B){var P=B[C],S=P.count;0<S&&(i.build(P.id,S),a=1)}return a}},craft:function(){var e=ae.auto.craft.items,a=this.craftManager,t=ae.auto.craft.trigger,i=!game.science.get("construction").researched||!game.bld.getBuildingExt("workshop").meta.on;let r,l,o,n,s,c;var g=.95===t;g&&(n=ne.get("orbitalGeodesy").researched,s=1===le("iron"),c=game.prestige.getParagonProductionRatio()<1.74),this.setTrait("metallurgist"),this.setTrait("engineer");for(const m of["ship","parchment","beam","wood","slab","alloy","gear","concrate","steel","plate","scaffold","tanker","manuscript","compedium","blueprint","kerosene","megalith","eludium","thorium"])if(o=(l=e[m]).require?a.getResource(l.require):"noRequire",r=0,l.enabled&&(!i||"wood"===m)&&a.getCraft(m).unlocked){let e=t;g&&(n&&(e=.9,"thorium"===m&&(e=1),"eludium"!==m&&"kerosene"!==m||(e=.98),"plate"===m)&&ne.get("spaceManufacturing").researched&&s&&(e=0),!c||"slab"!==m&&"beam"!==m&&"wood"!==m||(e=.99)),"noRequire"===o||o.value/o.maxValue>=e&&o.value<=2*o.maxValue?r=a.getLowestCraftAmount(m,l.limited,l.limRat,o.name):l.limited&&(r=a.getLowestCraftAmount(m,l.limited,l.limRat,!1)),1<=r&&a.craft(m,r)}var u=ae.auto.upgrade.items.upgrades;u.cache&&game.workshop.get(u.cache).researched&&(u.cache=!1)},holdFestival:function(){var e=game.prestige.getPerk("carnivals").researched,a=e&&(te.parchment.value<1e4||te.culture.value<15e3);if(game.science.get("drama").researched&&!(400<=game.calendar.festivalDays)&&(e&&!a||!(1<game.calendar.festivalDays))&&(!(game.village.getKittens()<5)||te.zebras.value)&&(!game.ironWill||game.prestige.getPerk("numeromancy").researched)){var a=this.craftManager,t=1500<4e3*a.getTickVal(te.manpower,!0),i=5e3<4e3*a.getTickVal(te.culture,!0),a=(a.getTickVal(te.parchment,!0),7e3<=te.parchment.value||te.manpower.perTickCached>20-game.prestige.getParagonProductionRatio());if(t&&i&&a){if(game.science.getPolicy("carnivale").researched)if(!te.furs.value||!te.ivory.value||!te.spice.value)return;t=game.villageTab,i=t.festivalBtn;if(!i||!i.model)return t.render();a=i.model.prices;game.resPool.hasRes(a)?(game.resPool.payPrices(a),t=e&&1e6<te.culture.value?50:1,game.village.holdFestival(t),ae.auto.trade.festival=void 0,me("festival",1),ge(a),400<game.calendar.festivalDays?Q("festival.extend",[],"festivalFilter"):Q("festival.hold",[],"festivalFilter")):ne.get("nanosuits").researched&&(te.parchment.value<2500||te.manpower.value<1500)&&(ae.auto.trade.festival=!0)}}},observeStars:function(){var t=game.calendar,i=game.ironWill||!ue.other["auto.changeLeader"];if(i&&((r=te.catnip).value=Math.min(r.maxValue,r.value+Math.max(0,r.perTickCached)+20)),null!=t.observeBtn){var r=te.science.value,l=te.starchart.value;t.observeHandler();let e="";r=te.science.value-r,l=(r&&(e+="，获得了 "+game.getDisplayValueExt(r)+" 科学"),te.starchart.value-l);l&&(e+="，获得了 "+l+" 个星图"),Q("act.observe",[e],"astronomicalEventFilter");let a=1;Math.random()<.2&&i&&(i=dojo.byId("observeButton"),t.observeBtn=dojo.create("input",{id:"observeBtn",type:"button",value:$I("navbar.observe")},i),t.observeHandler(),a=2),me("science",r*a,"resGain"),me("starchart",l*a,"resGain"),me("stars",1)}},hunt:function(){var t=te.manpower;if(!(t.value<100||game.challenges.isActive("pacifism"))){var i=game.getEffect("hunterRatio");if(!(3<le("manpower")&&i<3)){var r=game.bld.getBuildingExt("unicornPasture").meta.val;let e;r||(l=te.unicorns.value,i=game.achievements.get("unicornConspiracy").unlocked||l||i,e=!r&&i&&1e3<t.value&&l<3);r=ae.auto.options.items.hunt,i=r.subTrigger;game.resPool.addRes(t,Math.max(2*(.9<i)*t.perTickCached+game.getEffect("manpowerPerTickCon"),0),!1);let a=Math.floor(t.value/100);var l=r.subTrigger<=t.value/t.maxValue,i=!l&&ae.auto.trade.cache,o=this.craftManager.getAverageHunt(),n=game.science.get("writing").researched,s=!te.furs.value||te.parchment.value<Math.max(25,o.ivory)||game.ironWill?Math.max(30,Math.floor(.5*a)):0,n=n&&a>s&&0<s&&1!==le("culture");if((l||n||e||i||r.time)&&(n&&(a=s,game.ironWill||Q("act.hunt.mint","","huntFilter")),e&&(a=10,ie(ee("act.hunt.unicorn"))),i&&!r.time&&(a=Math.min(a,Math.max(Math.floor(t.perTickCached/50),1)),ae.auto.trade.cache=!1,Q("act.hunt.trade","","huntFilter")),r.time&&(r.time=!1),!(a<=0))){var c,l=game.ironWill?te.zebras.title:$I("effectsMgr.statics.maxKittens.title"),g=(game.resPool.addResEvent("manpower",100*-a),me("manpower",100*a,"resConsume"),{});for(c in o)g[c]=te[c].value;this.setTrait("manager"),game.village.gainHuntRes(a),this.setTrait(),1e3<=a&&(game.challenges.getChallenge("pacifism").unlocked=!0),ae.auto.cache.trait.manager?(Q("act.hunt",["管理者派出 "+a,l],"huntFilter"),me("hunt.manager",a)):(me("hunt",a),Q("act.hunt",[a,l],"huntFilter"));var u,m={};for(u in o){var d=te[u].value-g[u];m[u]=d,me(u,d,"resGain")}this.cacheManager.pushToCache({materials:m})}}}},trade:function(){var e,s={},c=ue.other["auto.changeLeader"]?0:2,a=game.calendar.day<0;for(e in te){var t=te[e],i=t.value,r=t.perTickCached;a||!r?s[e]=i:(r=Math.min(Math.max(0,r)*c+i,Math.max(i,t.maxValue||1/0)),isNaN(i)||i<1e-10?t.value=0:t.value=r,s[e]=r)}let g;var u=this.craftManager,m=this.tradeManager,d=this.cacheManager,p=[],h=ae.auto.trade,f=h.trigger;if(m.singleTradePossible(void 0)){var b=game.calendar,v=b.getCurSeason().name,k=le("gold"),y=le("titanium"),x=f<=k;let e,a=(this.setTrait("merchant"),0);var R=oe.getSolarRevolutionRatio(),w=te.faith.value,M=game.challenges.anyChallengeActive(),E=game.getEffect("priceRatio")<-.06,T=R||M&&!w||te.gold.maxValue<500-25*c,F=ne.get("spaceManufacturing").researched,W=!game.ironWill&&F&&R&&te.concrate.value>1e4/(1+R);let t=oe.getRU("stainedGlass").on||!R||w<200;var w=ae.auto.faith.items,C=oe.getRU("transcendence").on,B=C||!w.transcendence.enabled||!game.getEffect("unobtainiumPerTickSpace"),w=oe.getRU("apocripha").on||!w.apocripha.enabled||.22<oe.faithRatio||oe.faith<1e5;let i=B&&w||9<oe.transcendenceTier||game.village.sim.kittens.length<130;E&&.28<R&&(t&&!oe.getRU("basilica").on&&game.village.leader&&330<(B=te.gold.value)&&B<840&&(t=!1),.3<game.getEffect("productionRatio"))&&te.faith.maxValue>7500-375*c&&!C&&!te.unobtainium.value&&(i=!1);let r,l,o,n;var P=h.items;for(o in P)r=P[o],(l=m.getRace(o)).unlocked&&(game.diplomacyTab.racePanels[a]||game.diplomacyTab.render(),a++,"nagas"===o&&W||"dragons"===o&&2<R&&y<.7&&.1<le("uranium")||"lizards"===o&&.1<R||"sharks"===o&&!M&&3<R&&!r.limited||r.enabled&&r[v]&&((!(n=!!r.require&&u.getResource(r.require))||f<=n.value/n.maxValue)&&x?p.push(o):r.limited&&T&&i&&t&&("sharks"===o&&l.embassyLevel<10||m.getProfitability(o)&&(p.push(o),"leviathans"===o&&("zebras"!==o||te.titanium.value)||(e=!0)))));w=te.catnip.value+100*u.getPotentialCatnip(!0);if(w<0&&game.deadKittens<3e3&&!game.ironWill&&(B=game.diplomacy.get("sharks")).unlocked&&(C=m.getLowestTradeAmount("sharks"),B=m.getAverageTrade(B).catnip,m.trade("sharks",Math.max(Math.ceil(w/-B),C,1)+2),Q("trade.catnip")),0!==p.length){e=e&&!x?.3+.05*E+.1*!R*(1+2*game.science.get("theology").researched)+.05*game.workshop.get("geodesy").researched:1;let t=Math.floor(m.getLowestTradeAmount(void 0,!0,!1)*e);if((!M||!game.science.get("architecture").researched||te.furs.value)&&(!h.festival||b.festivalDays)&&!(t<1)){var S=[];for(g=0;g<p.length;g++){o=p[g],r=ae.auto.trade.items[o];var V=(!(n=!!r.require&&u.getResource(r.require))||f<=n.value/n.maxValue)&&f<=k,V=("leviathans"===o&&(e=1),Math.floor(m.getLowestTradeAmount(o,r.limited,V)*e));V<1?(p.splice(g,1),g--):S[g]=V}w=p.length;if(p.length){for(var B=game.getEffect("shatterTCGain"),O=te.steel.value>te.plate.value&&!B&&2!==b.season||.99<le("coal"),I=1<w&&!B&&(!R&&game.getEffect("unobtainiumPerTickSpace")||.4<le("uranium")),z=te.plate.value>10*te.steel.value&&.5<y&&1e4<te.titanium.value,G=1<b.season&&.5+.4*F<y,$={};0<p.length&&1<=t;)if(t<p.length){var q=Math.floor(Math.random()*p.length);$[p[q]]||($[p[q]]=0),$[p[q]]+=1,--t,p.splice(q,1),S.splice(q,1)}else{let e=Math.floor(t/p.length),a=0;for(g=0;g<p.length;g++)S[g]<e&&(e=S[g],a=g);"spiders"===(o=p[a])&&O&&(e=Math.floor(.2*e)),"dragons"===o&&I&&(e=Math.floor(.2*e)),"zebras"===o&&z&&(G&&(e=Math.min(Math.ceil(R),e)),e=Math.floor(.3*e)),"sharks"===o&&.98<=k&&!M&&(e=Math.floor(.5*e)),$[o]||($[o]=0),$[o]+=e,t-=e,p.splice(a,1),S.splice(a,1)}if(0!==$.length){for(var A in(.98<=k||!te.furs.value)&&(h.cache=!0),$)0<$[A]&&(m.getTradeButton(A)?m.trade(A,$[A]):game.diplomacyTab.render());var L,C=ae.auto.cache.cacheSum.manpower,D={},H=x||!C?.01:1-.4*E;for(L in te){var U=te[L].value-s[L];U&&(D[L]=U*H,0<U&&me(L,U,"resGain"),U<0)&&me(L,-U,"resConsume")}d.pushToCache({materials:D})}}}}}},miscOptions:function(){var l=this.craftManager;const i=this.buildManager;var o=ae.auto,a=o.options.items;let n=0;var e=game.calendar,t=o.cache,r=t.dataTimer,s=game.timer.ticksTotal,c=r.ticksTotal,g=e.trueYear(),u=game.telemetry.guid,u=((s-c<0||r.trueYear>g||r.saveId!==u)&&(t.dataTimer={},t.cacheSum={},o.filter.console={},N(),Y(),t.resUpg={},this.leaderTimer=0,this.leader=0,o.upgrade.items.upgrades.cache=null,(t=t.dataTimer).saveId=u,t.ticksTotal=s,t.trueYear=g),2e4<s-c&&(r.ticksTotal=s,o.cache.cacheSum={},ce("changeLeader",!0)),o.filter),t=oe.transcendenceTier;if(a.filterGame.enabled&&u.enabled&&3<t){var m,d=u.items,p=u.console,h=game.console.filters;for(m in h){var f=d[m+"Filter"],b=h[m];!b.unlocked||f&&!f.enabled||p[m]||(b.enabled=!1,p[m]=!0,n=1)}n&&game.ui.renderFilters()}if(a.buildEmbassies.enabled&&game.diplomacy.races[0].embassyPrices&&(game.ironWill||game.science.get("theology").researched)){g=te.culture,c=g.value,r=g.maxValue,s=c/r;let e=a.buildEmbassies.subTrigger;r<3200&&3e3<r&&(e=.968);u=c>5e3+5e3*(5<t)+5e3*Math.sqrt(2*oe.getSolarRevolutionRatio());if(e<=s&&s<2||u){let a,t,e,i;var v=game.diplomacyTab.racePanels;let r=l.getValueAvailable("culture",!0);var k,y=s>Math.max(.97,o.craft.trigger),x={},R=[],g=v.length-(game.diplomacy.get("leviathans").unlocked?1:0),w=o.trade.items;for(a=g-1;-1<a;a--)v[a].embassyButton?(t=v[a].race.name,e=game.diplomacy.get(t),(y||w[t].enabled)&&(k=1-game.getEffect("embassyCostReduction"),x[t]={val:0,basePrice:e.embassyPrices[0].val*k,currentEm:e.embassyLevel,priceSum:0,race:e},R.push(t))):game.diplomacyTab.render();if(0!==R.length){for(var M=game.science.get("astronomy").researched,E=Math.sqrt(oe.getSolarRevolutionRatio()+1);0<R.length;)for(a=0;a<R.length;a++){t=R[a];var T=(i=x[t]).currentEm+i.val,F=i.basePrice*Math.pow(1.15,T+game.getEffect("embassyFakeBought"));let e=!0;y||(T>14+E-10*("zebras"===t)&&M||"sharks"===t&&2<E&&!game.getEffect("unobtainiumPerTickSpace")&&te.furs.value||"dragons"===t&&!game.getEffect("unobtainiumPerTickSpace"))&&(e=!1),(!(F<=r&&e)||(r-=F,i.priceSum+=F,i.val+=1,y))&&(R.splice(a,1),a--)}for(t in x)0===(i=x[t]).val||(r=l.getValueAvailable("culture",!0),i.priceSum>r)||(te.culture.value-=i.priceSum,me("culture",i.priceSum,"resConsume"),i.race.embassyLevel+=i.val,me("embassy",i.val),n+=1,1===i.val?ie(ee("build.embassy",[i.val,i.race.title]),"embassyFilter"):ie(ee("build.embassies",[i.val,i.race.title]),"embassyFilter"))}}}if(a.fixCry.enabled&&0<game.time.getVSU("usedCryochambers").val){let e=0;for(var C=game.timeTab.vsPanel.children[0].children[0];C.controller.buyItem(C.model,{},function(){});)e+=1;0<e&&(Q("act.fix.cry",[e],"ks-fixCry"),me("fix.cry",e))}let B;r=(e,a,t)=>{ie(ee("summary."+e,[a])),me(e,a),t&&(B=i.getBuildButton(e))&&B.controller.onAll(B.model)},c=game.space.getBuilding("moonBase");let P=a.lastDayEnergy;P&&3!==e.season&&("moonBase"===P&&(c.on=c.val),a.lastDayEnergy=!1,P=!1);var t=game.bld.getBuildingExt("mint").meta,u=(t.on!==t.val&&3e4<te.manpower.maxValue&&.5<le("gold")&&(t.on=t.val),1<t.on&&te.manpower.maxValue<19e3&&!game.challenges.isActive("pacifism")&&(game.opts.enableRedshift||(t.on=0,r("mint"))),game.bld.getBuildingExt("factory").meta),s=(u.val&&u.on!==u.val&&game.workshop.get("spaceManufacturing").researched&&!P&&r("factory",void 0,!0),game.bld.getBuildingExt("magneto").meta),g=game.getResourcePerTick("oil",!0)>.05*s.val,t=5e6<game.bld.cathPollution&&50<game.bld.cathPollutionPerTick,g=(s.val&&!s.on&&g&&t&&!u.isAutomationEnabled&&r("magneto",void 0,!0),game.bld.getBuildingExt("steamworks").meta),t=(g.val&&g.on!==g.val&&s.on>10-6*(.3<game.getEffect("coalRatioGlobalReduction"))&&r("steamworks",void 0,!0),game.bld.getBuildingExt("reactor").meta),g=game.getResourcePerTick("uranium",!0),s=(t.val&&t.on!==t.val&&0<g&&r("reactor",void 0,!0),game.time.getCFU("temporalAccelerator")),t=(s.on&&!game.time.testShatter&&(s.isAutomationEnabled=!0,game.time.testShatter=1,r("temporalAccelerator")),game.resPool.energyProd),g=game.bld.getBuildingExt("biolab").meta,s=g.on&&game.workshop.get("biofuel").researched,S=l.getPotentialCatnip(),S=o.distribute.religion||S<0&&te.catnip.value+1e3*S<0;if(s&&S&&(ie(ee("summary.biolab.test",[""])+"(猫薄荷产量过低)"),g.on=0),t&&t<game.resPool.energyCons){if(s&&g.on)return o="冬季产出电:"+game.getDisplayValueExt(t)+"，消耗电:"+game.getDisplayValueExt(game.resPool.energyCons)+"，小猫担心电不够并关闭了",S=g.on,Q("summary.biolab.test",[o+S]),g.on=0,me("biolab.test",o+S),1;s=game.bld.getBuildingExt("oilWell").meta;if(s.isAutomationEnabled&&game.workshop.get("pumpjack").researched&&20<s.val)return s.isAutomationEnabled=!1,game.upgrade({buildings:["oilWell"]}),game.resPool.update(),r("pumpjack",1),1;t=game.bld.getBuildingExt("accelerator").meta;t.on&&(t.on-=Math.ceil(.5*t.on),r("accelerator",1)),game.getEffect("antimatterProduction")&&3===e.season&&97<=(g=e.day)&&g<99&&(u.on&&(u.on=0,a.lastDayEnergy=!0),c.on&&(c.on=0,r(a.lastDayEnergy="moonBase")),(o=game.bld.getBuildingExt("calciner").meta).on)&&(--o.on,ce("offCalciner"))}var S=te.spice.value,V=[{name:"brewery",metadata:game.bld.getBuildingExt("brewery").meta,Button:i.getBuildButton("brewery"),conditionOn:e.festivalDays&&1e4<S,conditionOff:game.bld.getBuildingExt("brewery").meta.on&&(!e.festivalDays||!S)}];game.opts.enableRedshift||(V.push({name:"chronocontrol",metadata:game.time.getVSU("chronocontrol"),Button:this.timeManager.getBuildButton("chronocontrol"),conditionOn:e.futureSeasonTemporalParadox<1&&98<e.day,conditionOff:game.time.getVSU("chronocontrol").on&&0<e.day}),s=game.bld.getBuildingExt("calciner").meta,!game.time.getCFU("ressourceRetrieval").on&&s.isAutomationEnabled&&(s.isAutomationEnabled=!1,game.upgrade({buildings:["calciner"]}),r("calciner")));for(let e=0;e<V.length;e++){var $=V[e];0<$.metadata.val&&($.conditionOn?$.metadata.val-$.metadata.on&&($.Button.controller.onAll($.Button.model),ie(ee("summary."+$.name+"On")),me($.name)):$.conditionOff&&($.Button.controller.offAll($.Button.model),ie(ee("summary."+$.name+"Off")),me($.name)))}return n},gameUpgrade:function(){var e=performance.now(),a=ae.auto,t=a.upgrade.items.upgrades,a=a.cache,i=a.upgrade;if(i){for(var r in game.upgrade(i),i)delete i[r];a.upgrade=null}else game.updateCaches();t.update&&(game.updateCaches(),t.update=null);a=performance.now()-e;this.time+=a},calculateTime:function(){var e=this.time,e=(performance.now(),performance.now()-e);ue.ksTime+=e,ue.totalTicks++,ae.auto.cache.stocks=null},setTrait:function(a){if(!ae.auto.distribute.enabled||!this.changeLeader)return ce("changeLeader");var e,t,i,r=game.village.leader;a?game.science.get("civil").researched&&r&&!game.challenges.isActive("anarchy")&&(e=ae.auto.cache,t=game.village.traits.some(e=>e.name===a),e.trait[a]||t&&(e.trait[a]=!0,i=["当"+(i=$I("village.bonus.desc."+a)).slice(0,2)+"项目时"+$I("village.trait."+a)+"猫猫自觉顶替当前领袖，其效果为"+i],1e4<game.ticks?ce("leader",!0):ce("leader","","leaderFilter"),Q("set.leader",[i],"leaderFilter")),ae.copyTrait||(i=r.trait.name,ae.copyTrait=i,e.trait[i]=!0),t||(e.trait[a]=!1),!t&&ae.copyTrait!==a||(r.trait.name=a)):ae.copyTrait&&r&&$I("village.trait."+ae.copyTrait)===r.trait.title&&(r.trait.name=ae.copyTrait,ae.copyTrait=void 0)},catnipForReligion:function(e){e=e||0;let a=1,t=oe.getRU("transcendence").on?oe.transcendenceTier:0;e&&(t+=1);var i,r=oe.faithRatio+oe.faith/1e6*(t+1)*(t+1)*1.01-e,r=.01+te.faith.value*(1+.1*game.getUnlimitedDR(r,.1)),r=game.getLimitedDR(game.getUnlimitedDR(r,1e3)/100,10+game.getEffect("solarRevolutionLimit"));return t<10&&(a=game.village.getResConsumption().catnip*(1+game.getEffect("catnipDemandRatio")),0<game.village.sim.kittens.length&&1<game.village.happiness&&(a+=a*Math.max(game.village.happiness*(1+game.getEffect("hapinnessConsumptionRatio"))-1,0)*(1+game.getEffect("catnipDemandWorkerRatioGlobal"))),i=1+oe.getSolarRevolutionRatio()*(1+game.bld.pollutionEffects.solarRevolutionPollution),a=(te.catnip.perTickCached-a)*(1+r)/i+a+game.globalEffectsCached.catnipPerTickCon),a<0&&(r=te.catnip.value,ae.auto.faith,ae.auto.distribute.religion||r+150*a<0&&(ae.auto.distribute.religion=!0),i=5*a,ae.auto.faith.addition.autoPraise.enabled)&&(e&&(Q("summary.transcend.catnip",[game.getDisplayValueExt(i)]),ue.other["transcend.catnip"]=i),e||(Q("summary.adore.catnip",[game.getDisplayValueExt(i)]),ue.other["adore.catnip"]=i)),a},getBestUnicornBuilding:function(){var s=game.bld.getBuildingExt("unicornPasture").meta;if(s.unlocked){let l=1/0,o="";var c=1-game.getEffect("goldCostReduction"),a=game.bld.getBuildingExt("ziggurat").meta.on,g=Math.max(a,1),u=game.getEffect("unicornsRatioReligion")+1,t=500*(.9+.1*u),m=game.prestige.getPerk("unicornmancy").researched?1.1:1,d=game.getEffect("riftChance")*m/2e4*t;let e="unicorns";var p=te.unicorns,t=p.perTickCached,i=game.calendar.cycleEffectsFestival({unicorns:1}).unicorns,h=p.perTickCached*game.getTicksPerSecondUI()/i;if(!h)return s;var r=h/Math.max(1,s.val),f=2*Math.pow(s.priceRatio+game.getEffect("priceRatio"),s.val),r=f/r,b=1.5*game.prestige.getParagonProductionRatio()+1.5,v=te.tears.value+2500*p.value/g>Math.max(1e6,b*te.ivory.value)||te.ivory.perTickCached*b*i<t&&2e4<te.manpower.maxValue;let n="tears";(v&=te.alicorn.unlocked)&&(n="ivory",e="ivory"),(r=v?3e3*r:r)<l&&(l=r,o=s);e:for(let e=0;e<6;e++){var k=oe.meta[0].meta[e];if(k.unlocked){let t,i=0,r=u;if(k.effects.unicornsRatioReligion&&(!v||k.effects.alicornChance)){var y=Math.pow(1.15,k.on);for(let e=0;e<k.prices.length;e++){var x=k.prices[e],R=x.name,x=x.val;if(R===n&&(i+=x*y*2500/g,r+=k.effects.unicornsRatioReligion),"gold"===R&&x*c*y>te.gold.maxValue)continue e;"tears"===R&&(t=x*y*2500/g)}let e=game.getEffect("riftChance");var w=k.effects,M=(w.riftChance&&(e+=w.riftChance),50*r+450),M=e*m/2e4*M;M-=d;let a=h*r/u;a=a-h+M,a=i/a,v&&w.tcRefineRatio&&(a*=.5-w.tcRefineRatio),a<l&&(l=a,o=k),v&&p.value>t+f&&(o=s)}}}return a&&(b=o.label||"独角兽牧场",b+="("+ee("$resources."+e+".title")+"性价比)",ue.other["auto.unicorn"]!==b)&&(ue.other["auto.unicorn"]=b,Q("summary.auto.unicorn",[b],"unicornSacrificeFilter")),o}}};let e=function(e){this.setTab(e)},o=(e.prototype={tab:void 0,render:function(){this.tab&&game.ui.activeTabId!==this.tab.tabId&&!this.tab._inherited&&setTimeout(()=>{this.tab.render()},200+Math.max(-Date.now()+game.timer.timestampStart,-200))},setTab:function(e){for(const a in game.tabs)if(game.tabs[a].tabId===e){this.tab=game.tabs[a];break}this.tab?this.render():l("unable to find tab "+e)}},function(){this.manager=new e("Religion"),this.bulkManager=new t}),g=(o.prototype={manager:void 0,bulkManager:void 0,build:function(e,a,t){var i=this.getBuild(e,a),e=this.getBuildButton(e,a);if(!e||!e.model.metadata)return game.religionTab.render();var r=e.model;if((r.enabled||(r.prices=e.controller.getPrices(r),e.controller.updateEnabled(r),r.enabled))&&0!==(t=this.bulkManager.construct(r,e,t))){ge(r.prices),game.stats.getStat("totalClicks").val+=1;e=i.label;if("s"===a){if(ae.auto.cache.trait.wise)return me("哲学家小猫祷告了 "+e,t,"faith"),Q("act.sun.discovers.leader",[e,t],"faithBuildFilter");Q("act.sun.discovers",[e,t],"faithBuildFilter"),me("小猫祷告了 "+e,t,"faith")}else me(e,t,"build"),Q("act.builds",[e,t],"buildFilter")}},getBuild:function(e,a){switch(a){case"z":return oe.getZU(e);case"s":return oe.getRU(e);case"c":return oe.getTU(e)}},getBuildButton:function(e,a){let t,i;switch(a){case"z":t=this.manager.tab.zgUpgradeButtons;break;case"s":t=this.manager.tab.rUpgradeButtons;break;case"c":t=this.manager.tab.children[0].children[0].children}var r=this.getBuild(e,a);for(i=0;i<t.length;i++)if(t[i]&&-1!==t[i].model.name.indexOf(r.label))return t[i]}},function(){this.manager=new e("Time"),this.crafts=new a,this.bulkManager=new t}),h=(g.prototype={manager:void 0,crafts:void 0,bulkManager:void 0,build:function(e,a,t){var i=this.getBuild(e,a),e=this.getBuildButton(e,a);return e&&e.model.metadata?e.model.enabled?(a=i.label,void(0!==(t=this.bulkManager.construct(e.model,e,t))&&(ge(e.model.prices),me(a,t,"build"),Q("act.builds",[a,t],"buildFilter")))):e.controller.updateEnabled(e.model):game.timeTab.render()},getBuild:function(e,a){return"chrono"===a?game.time.getCFU(e):game.time.getVSU(e)},getBuildButton:function(e,a){let t;t=("chrono"===a?this.manager.tab.children[2]:this.manager.tab.children[3]).children[0].children;var i,r=this.getBuild(e,a);for(i in t)if(-1!==t[i].model.name.indexOf(r.label))return t[i]}},function(){this.workManager=new e("Workshop"),this.sciManager=new e("Science"),this.crafts=new a}),u=(h.prototype={manager:void 0,crafts:void 0,build:function(e,a){let t;var i=this.getBuildButton(e,a);if(i&&i.model.metadata){if(i.model.enabled||(i.model.prices=i.controller.getPrices(i.model),i.controller.updateEnabled(i.model),i.model.enabled)){if("policy"===a){var r=i.model.metadata;if("theocracy"===r.name&&!game.village.leader)return;if(game.village.leader&&r.requiredLeaderJob&&game.village.leader.job!==r.requiredLeaderJob)return l=game.village.getJob(r.requiredLeaderJob).title,void game.msg($I("msg.policy.wrongLeaderJobForResearch",[r.label,l]),"important");if("transkittenism"===r.name&&15<=game.bld.getBuildingExt("aiCore").meta.effects.aiLevel)return void game.msg($I("msg.policy.aiNotMerges"),"alert","ai");if(!1===r.blocked)for(t=0;t<r.blocks.length;t++)if(game.science.getPolicy(r.blocks[t]).researched)return void(r.blocked=!0)}var l=ae.auto.upgrade.items.upgrades,o=(i.model.prices=i.controller.getPrices(i.model),i.controller.payPrice(i.model,{},function(){}),ge(i.model.prices),i.model.metadata);if(o.researched=!0,o.handler&&o.handler(game,o),o.unlocks&&game.unlock(o.unlocks),o.blocks)for(t in o.blocks)game.science.getPolicy(o.blocks[t]).blocked=!0;o.onResearch&&o.onResearch(game),o.upgrades&&("workshop"!==a||l.update||(l.update=!0),re(o.upgrades)),game.stats.getStat("totalClicks").val+=1;var i=e.label,n=(s=ae.auto.cache.trait.scientist)?"科学家小猫":"小猫",s=s?1:0;if("workshop"===a){me(i,s,"upgrade"),Q("upgrade.upgrade",[i,n],"upgradeFilter");e=e.name;if(e===l.cache||"geodesy"===e){l.cache=!1;var c,g=ae.auto.cache.resUpg;for(c in ae.auto.cache.resUpg)delete g[c]}o.effects&&o.effects.hutPriceRatio&&"Bonfire"!==game.ui.activeTabId&&setTimeout(()=>{game.bldTab.render()},2e3)}else"science"===a?(me(i,s,"research"),Q("upgrade.tech",[i,n],"researchFilter")):"policy"===a&&Q("upgrade.policy",[i],"policyFilter")}}else("workshop"===a?game.workshopTab:game.libraryTab).render()},getValue:function(e,a){var t=ae.auto.resources[e];let i=t&&t.enabled?t.stock:0;t=ae.auto.upgrade.items.upgrades.cache;return ae.auto.craft.oxidation&&"oxidation"!==a&&("science"===e&&5e3<te.steel.value&&5e4<te.science.value&&(i+=1e5),"steel"===e)&&(i+=5e3),"titanium"===e&&t!==a&&("orbitalGeodesy"===t&&("pumpjack"!==a||3e4<te.oil.value)&&(i+=1e3),t!==a)&&("rotaryKiln"===t&&(i+=5e3),"miningDrill"===t&&(i+=1750),"concreteHuts"===t&&(i+=3e3),"geodesy"===t)&&(i+=250),"iron"===e&&"ironwood"!==a&&ue.other["auto.ironwood"]&&1e4<te.science.value&&(i+=3e3),"alloy"===e&&t&&t!==a&&(i+=ae.auto.cache.resUpg[e]),"oil"===e&&"orbitalGeodesy"!==a&&20<game.bld.getBuildingExt("calciner").meta.val&&!game.workshop.metaCache.orbitalGeodesy.researched&&(i+=35e3),Math.max(te[e].value-i,0)},getBuildButton:function(e,a){let t;"workshop"===a?t=this.workManager.tab.buttons:"science"===a?t=this.sciManager.tab.buttons:"policy"===a&&(t=this.sciManager.tab.policyPanel.children);for(var i of t)if(i.model.name===e.label)return i}},function(){this.manager=new e("Bonfire"),this.crafts=new a,this.bulkManager=new t}),L=(u.prototype={manager:void 0,crafts:void 0,bulkManager:void 0,built:function(e,a,t){var i=this.getBuild(e),e=this.getBuildButton(e,a);if(i.meta.unlocked)return e&&e.model.metadata||(game.bldTab.activeGroup="all",e&&e.model.metadata)?e.model.enabled?(i=i.meta.label||i.meta.stages[a].label,void(0!==(t=this.bulkManager.construct(e.model,e,t))&&(ge(e.model.prices),me(i,t,"build"),(a=game.stats.statGroups[0].group)[8].val+=1,a[7].val+=t,Q("act.builds",[i,t],"buildFilter")))):e.controller.updateEnabled(e.model):game.bldTab.render()},count:function(e,r){if(r){let a;var l=ne.get("geodesy").researched;let t=ne.get("orbitalGeodesy").researched;var o=ne.get("spaceManufacturing").researched,n=game.getEffect("priceRatio");let i=n<-.06;var s=.9<le("titanium"),c=oe.getSolarRevolutionRatio(),g=e=>{i&&!t&&game.bld.getBuildingExt(e).meta.val&&(a=!0,ce("lower"))};switch(e){case"hut":case"logHouse":var u=game.village.happiness;if(l?ce("kittens",!0):(m=te.catnip,p=this.crafts.getPotentialCatnip(!1),d=game.challenges.isActive("anarchy"),p=p<1&&m.value+1e3*p*(le("catnip")<.1)-1400<0,(m.value<5e3-2e3*!game.calendar.season+100*u&&m.perTickCached<1.8*u*(1+2*d)&&(!game.science.get("agriculture").researched||d)||p)&&(r=0,ce("kittens"))),"logHouse"===e){var m=game.bld.getBuildingExt("amphitheatre").meta;if(m.val<5&&!m.stage&&m.unlocked&&u<3&&25<game.village.maxKittens)return ce("logHouse"),0}break;case"workshop":!t&&i&&!(d=game.bld.getBuildingExt("amphitheatre").meta).stage&&te.parchment.value>3*Math.pow(d.stages[0].priceRatio+game.getEffect("priceRatio"),d.val)&&d.val<8+5*(n<-.08)&&le("minerals")<.9&&!game.ironWill&&(a=!0);break;case"pasture":!t&&(l||te.wood.perTickCached&&i)&&le("wood")<.9&&(i&&!c&&(r*=.5),a=!0,ce("pasture"));break;case"aiCore":r=1,.6<game.getEffect("gflopsPerTickBase")&&1e5<te.burnedParagon.value&&(r=Math.floor(.5*r));break;case"temple":if(le("gold")<.8&&ne.get("miningDrill").researched&&t){if(i&&te.faith.maxValue<6750)return 1;a=!0,r*=.4-.2*i,ce("keepGold")}else r=1;break;case"mint":le("gold")<.95&&(!(p=game.getEffect("manpowerPerTickCon"))&&game.bld.getBuildingExt(e).meta.val||p<-2)&&(a=!0,r*=.1+.1*o+.1*s+.1*i-.1*!p,ce("keepGold"));break;case"field":if(t||!(game.bld.getBuildingExt(e).meta.val>50+85*i))return r;te.catnip.value<3e3+100*game.village.happiness&&(r=Math.floor(.3*r),a=!0);break;case"chapel":if("chapel"===e){if(game.bld.getBuildingExt(e).meta.val<18.9+c+2*l*i)break;game.calendar.festivalDays||(r=0),(!t||!i&&c<.5&&!te.unobtainium.value)&&(r*=.4-.06*l,a=!0)}break;case"aqueduct":this.crafts.getPotentialCatnip(!1)<4*game.village.happiness&&le("catnip")<.6||game.challenges.isActive("winterIsComing")?(ce("aqueductCatnip"),l&&!t&&n&&(r=0)):(o||(te.slab.value<4e5*(1+c)||!c&&le("minerals")<.98)&&(r=Math.floor(.4*r-.05*i),ce("aqueduct")),g(e));break;case"library":if("library"===e&&!game.science.get("writing").unlocked)break;case"academy":"academy"===e&&le("science")<1&&!t&&((m=game.bld.getBuildingExt(e).meta.val)>10+20*i&&(a=!0,ce("academy"),n)&&(r*=.9),i)&&c<1&&9<m&&(r*=.5);case"barn":if("barn"===e&&te.minerals.maxValue<1600)break;var u=te.minerals.value>.94*te.minerals.maxValue,d=te.wood.value>.94*te.wood.maxValue;if(u&&d)break;case"warehouse":if("warehouse"===e){if(te.minerals.maxValue<5e4&&(ne.get("deepMining").researched||game.bld.getBuildingExt(e).meta.val<20-10*i))break;i&&!o&&(r=Math.floor(.3*r))}case"lumberMill":if("lumberMill"===e)if(game.bld.getBuildingExt(e).meta.val<35+5*!te.paragon.value+7*(20<game.calendar.year)-5*i){if(!game.getEffect("lumberMillRatio")&&3.1<game.bld.getEffect("woodRatio")&&1200<te.iron.maxValue&&(r=0),te.gold.value||game.getEffect("ironPerTickAutoprod")<.3)break;i&&!game.science.get("astronomy").researched&&te.faith.value&&(a=!0)}else le("iron")<.5-4*n+.05*i+.05*o&&(a=!0,ce("lumberMill"));case"oilWell":if("oilWell"===e){var p=game.bld.getBuildingExt(e).meta.val,m=te.oil,u=m.value,d=m.maxValue;if(p<9+i||m.maxValue<2e4)break;if(!o){m=game.getEffect("calcinerRatio");if(1<m&&(!t&&u<35e3-5e3*i||2<m&&d<5e4))return r}if(p<199)if(55e3+35e3*(n<-.04)<d)r=Math.floor(.5*r);else if(2e4<d&&game.getEffect("calcinerRatio")<2&&(a=!0,33e3<d)&&l&&35e3<d)return r}g(e);break;case"quarry":ne.get("nuclearSmelters").researched&&!o&&(r*=.7-.2*i,a=!0),g(e);break;case"harbor":if("harbor"===e){u=game.bld.getBuildingExt(e).meta.val,m=game.bld.getBuildingExt("reactor").meta.val;if(c<1&&u<7+2*l)return 1;u<15?(ce("harbor"),a=!0,i||(r*=.9)):m<30?(i&&(r*=.5),a=!0,7.5<c&&(r*=.2)):o&&ce("harbor",!0),60+m<u&&le("iron")<.9&&(r=Math.floor(.5*r))}break;case"biolab":o?te.starchart.value<1e6*(2-!n)&&(r*=.5,a=!0):(n||2e5<te.science.maxValue)&&te.starchart.value<1e6&&(a=!0,i)&&(r*=.3);break;case"factory":p=game.bld.getBuildingExt(e).meta.val;if(o){if(game.space.getBuilding("sattelite").val||!p||c||(ae.auto.space.items.sattelite.enabled=!0,r=0),game.getEffect("productionRatio")<1&&(a=!0,game.getEffect("productionRatio")<.5))return 0}else if(!s)if(p){d=game.getEffect("productionRatio");if(c&&(.6<d||l&&-.08<n)&&p<2-(3+i)*!d+(10+50*n)*ne.get("nuclearSmelters").researched+i*(4*d-3-2*(6<c)-3*(2<c))-!l*(1+5*(d<.4))+3*l+2*!n)return r;r*=.7+(2+3*(6<p))*n,a=!0,ce("factory")}else r=1;break;case"accelerator":ne.get("energyRifts").researched||(r=0),o?game.space.getProgram("piscineMission").on?!s&&13e4<te.titanium.maxValue&&(a=!0):r=0:(s||(r*=.9,a=!0),(125e3<te.titanium.maxValue||game.bld.getBuildingExt("factory").meta.val<16&&c<6||game.getEffect("magnetoRatio")<.02&&!c)&&(r=0));break;case"mansion":!s&&(i||!i&&l&&te.kittens.value>124+10*!n)&&(!o&&1<game.prestige.getParagonProductionRatio()&&(ce("mansion"),r*=.7,a=!0),200<te.kittens.value&&(r*=.5,a=!0),te.starchart.perTickCached<4)&&"mansion"===e&&(a=!0)}return a?r=Math.floor(.5*r):c||l||(r=Math.ceil(.5*r)),r}},getBuild:function(e){return game.bld.getBuildingExt(e)},getBuildButton:function(e,a){var t=this.manager.tab.children,e=this.getBuild(e),i=(void 0===a?e.meta:e.meta.stages[a]).label;for(const r in t)if(-1!==t[r].model.name.indexOf(i))return t[r]},getMetaDataList:function(e){var a,t={},i=!ne.get("geodesy").researched||le("titanium")<.5||te.kittens.maxValue<110,r=null!==game.village.leader;for(a in e){var l=e[a],o=this.getBuild(l.name||a).meta;o.almostLimited&&r&&i&&(l.enabled=!1),o.stage!==l.stage&&(l.enabled=!1),t[a]=o}return t},getSumPrices:function(e,a){var t=(e.priceRatio||e.stages[e.stage].priceRatio)+game.getEffect("priceRatio");return(a.val-a.val*Math.pow(t,e.val-1))/(1-t)},sellBuild:function(e){var a=this.getBuild(e).meta,t=a.stages[a.stage].prices;for(let e=0;e<t.length;e++){var i,r=t[e];te[r.name].isRefundable()&&!r.isTemporary&&a.val&&(i=this.getSumPrices(a,r),game.resPool.addResEvent(r.name,.5*i))}a.on=0,a.val=0}},function(){this.manager=new e("Space"),this.crafts=new a,this.bulkManager=new t}),a=(L.prototype={manager:void 0,crafts:void 0,bulkManager:void 0,build:function(e,a){var t=this.getBuild(e),e=this.getBuildButton(e);if(t.unlocked)return e&&e.model.metadata?e.model.enabled?(t=t.label,void(0!==(a=this.bulkManager.construct(e.model,e,a))&&(ge(e.model.prices),me(t,a,"build"),game.stats.getStat("totalClicks").val+=1,Q("act.builds",[t,a],"spaceFilter")))):e.controller.updateEnabled(e.model):game.spaceTab.render()},getBuild:function(e){return game.space.getBuilding(e)},getBuildButton:function(e){var a=this.manager.tab.planetPanels;for(const i in a)for(var t in a[i].children)if(a[i].children[t].id===e)return a[i].children[t]}},function(){this.cacheManager=new b}),t=(a.prototype={craft:function(t,i){if(i=Math.floor(i),t&&!(i<1)&&this.canCraft(t,i)){var r=this.getCraft(t),l=game.getResCraftRatio(r.name)+1,o=ae.auto.cache.trait.engineer&&game.village.leader;let e="小猫制作了",a=(i=Math.ceil(i))*l;var n=dojo.clone(game.workshop.getCraftPrice(r));for(let e=n.length-1;0<=e;e--){var s=n[e];s.val*=i,me(s.name,s.val,"resConsume")}o&&(e="工匠小猫制作了 ",l=game.village.getEffectLeader("engineer",0),"metallurgist"===(c=te[t].tag)&&ae.auto.cache.trait.metallurgist&&(a+=i*l,e="冶金学家小猫制作了 "),"chemist"===c&&ae.auto.cache.trait.chemist&&(a+=.5*i*l,e="化学家小猫制作了 "),"parchment"===t)&&(a+=i*l),game.resPool.payPrices(n),game.resPool.addResEvent(r.name,a),r.upgrades&&re(r.upgrades);var c=game.stats,l=(c.getStat("totalCrafts").val++,c.getStatCurrent("totalCrafts").val++,c.getStat("totalClicks").val+=1,te[t].title);i=a,o?me(l,i,"craftLeader"):me(l,i,"craft"),Q("act.craft",[e+game.getDisplayValueExt(i),l],"craftFilter")}},canCraft:function(e,a){e=this.getCraft(e);let t=!1;if(e.unlocked){t=!0;var i,r=game.workshop.getCraftPrice(e);for(i in r){var l=r[i];te[l.name].value<l.val*a&&(t=!1)}}return t},getCraft:function(e){return game.workshop.getCraft(e)},getLowestCraftAmount:function(t,e,a,i){let r=Number.MAX_VALUE;var l=game.science,o=ne.get("geodesy").researched,n=this.getMaterials(t);if(!n)return 0;let s=te[t];var D=s.maxValue,c=s.value;if(c===1/0)return 0;let U=this.getLimRat(t,e,a);var g=this.getValueAvailable(t,!0);let u,m,W;var O=game.bld.getBuildingExt("temple").meta,a=game.getEffect("priceRatio"),I=Math.pow(O.priceRatio+a,O.val),d=a<-.08,p=this.getCraft(t);let h=ae.auto.craft,f=game.getResCraftRatio(p.name)+1,z=h.trigger;if("ship"===t&&e){var p=te.science.maxValue,b=(m=5e4<p&&(c<100||95e3<p||l.get("archeology").researched),p<56e3&&te.titanium.unlocked&&40<c&&(m=!1),oe.getSolarRevolutionRatio()),v=oe.transcendenceTier,k=!ne.get("oxidation").researched&&!h.oxidation||!b||v<6||!c||!d&&c<350&&b<3;if(m=k?m:!1){let e=40/Math.max(.2,Math.log1p(1.1*b))+10*b;b<.52&&(e=b<.23?Math.min(16/Math.log1p(b),139+30*!te.paragon.value):Math.min(23-120*a/Math.log1p(b),176)*(1+1.3*(a<-.06))),o&&((119e3<p||c<200||1200<te.scaffold.value&&p<115e3)&&(e=Math.min(243+5*v+b,400),9e4<oe.faith)&&11e4<p&&(e=450-100*a,.2<b)&&b<.5&&(e+=40),ce("shipGeodesy")),c<e&&3<f?(c&&(Date.now()>h.shipTime+2e6||!ue.other["auto.ship"])&&24<te.starchart.value&&(h.shipTime=Date.now(),k=game.getDisplayValueExt(e),ie(ee("summary.auto.ship",[k])),ue.other["auto.ship"]=k),r=1):m=!1}}let y=Number.MAX_VALUE/f+Number.MAX_VALUE/Math.pow(2,53)/f;var x=l.meta[0],v=l.get("navigation").researched;let R,w=ae.auto.cache;"beam"!==t&&"slab"!==t||(u=Object.keys(n)[0],le(u)<2&&(h.autoConsume[u]=0,500<te.scaffold.value&&.9<z&&e&&(h.autoConsume[u]=1,z=.9),!c&&3<te.slab.value&&(m=!0),"slab"!==t||a||(te.concrate.unlocked||(25<te.beam.value&&!c&&(r=1,m=!0),2500<te.minerals.value&&game.science.get("mechanization").researched&&25<te.steel.value&&(r=1,m=!0)),o&&!game.ironWill&&te.kittens.maxValue<135&&ne.get("concreteHuts").researched&&le("minerals")<.99&&(p=game.bld.getBuildingExt("mansion").meta,b=Math.pow(p.priceRatio+a,p.val),te.titanium.value>25*b)&&te.steel.value>75*b&&0<(k=Math.ceil((185*b-c)/f))&&te.minerals.value>250*k&&this.craft(t,k)))),"megalith"===t&&e&&(p=!s.unlocked&&15<game.diplomacy.get("nagas").embassyLevel&&!game.calendar.season&&!g,b=2500<te.unicorns.value&&!te.tears.value&&c<50,k=te.culture.maxValue<15e3&&game.bld.getBuildingExt("factory").meta.val&&c<80,p||b||k)&&(r=1,m=!0),"plate"===t&&e&&(p=game.getResourcePerTick("coal",!0),b=game.bld.getBuildingExt("reactor").meta,k=Math.pow(a+b.priceRatio,b.val),b=te.titanium.value>3500*k&&300<te.uranium.value&&g<5e3*k,0<p&&te.iron.value!==te.iron.maxValue&&150<g&&!b&&(.8<this.getValueAvailable("plate")/this.getValueAvailable("steel")&&h.items.steel.enabled&&(p=((V=this.getResource("coal").maxValue*z)-this.getValue("coal"))/p*Math.max(game.getResourcePerTick("iron",!0),0),r=Math.max(.008*(this.getValueAvailable("iron")-Math.max(V-p,0)),.1*te.iron.perTickCached)),!d)&&!ne.get("alloyBarns").researched&&20<te.alloy.value&&c<750&&(r=1,m=!0),b&&(r=Math.min(Math.ceil((5e3*k-g)/f),Math.floor(te.iron.value/125)),m=!0),g<150&&(te.faith.maxValue<750&&30<te.gold.value&&c<15*I&&(V=game.village.leader,2.8<f||10<te.iron.value/125*f||V&&3<V.rank)&&(m=!0,r=3),!game.getEffect("warehouseRatio")&&c&&c<50&&700<te.iron.value&&3e4<te.science.maxValue&&(m=!0,r=1),!te.ship.value)&&f>3-a&&24<te.starchart.value&&(r=1,m=!0),"fullIron"===(p=ae.auto.options.items.hunt).time)&&p.enabled&&(m=!0);var G=this.getValueAvailable("science",!0),M=le("science"),b=le("culture"),H=e=>{var a=w.science||"科学";m=!0,"油气处理"!==a&&(ae.auto.filter.items.miscFilter.enabled||(a=game.msg(ee("craft.force",[s.title,a]),null,null,!0),$(a.span).css("color","#ff589c")),me("craft"+se(e),1))};if("manuscript"===t&&e){var E=w.resources.manuscript;for(R=E?17:19,u=16;u<R;u++){var J=x.meta[u],T=E||J.prices[1].val;if(!J.researched||0<E){let e=750<te.faith.maxValue||20<c;e||l.get("theology").researched||1<=(N=O.val)&&f>4+.08*Math.pow(N,3)&&(e=!0);var j,N=10*I,T=e||N<c?T:10*I,T=(r=Math.ceil((T-g)/f),game.getEffect("manuscriptCultureCost")?1:0);1<=r&&(j=this.getValueAvailable("culture",!0)>(400-100*T)*r,this.getValueAvailable("parchment",!0)>r*(25-5*T))&&j&&(w.science=0<E?w.science:J.label,w.science=e?w.science:"神殿",H("manuscript"),w.resources.manuscript=0);break}}m||(b<2&&g<1e3&&(te.manpower.perTickCached<14&&.97<b||.9<b&&!v&&c<40)&&(m=!0,r=1),te.faith.value&&game.bld.getBuildingExt("chapel").meta.val<18&&!l.get("electricity").researched&&(l.get("archeology").researched||250<g)&&(m=!1),!game.ironWill&&!game.calendar.festivalDays&&te.unobtainium.value&&l.get("drama").unlocked&&(r=0))}if("compedium"===t&&e&&v){var F=w.resources.compedium;for(R=F?19:27,!i&&f<3&&(r=0),u=18;u<R&&(!game.prestige.getPerk("numerology").researched||game.calendar.festivalDays||!game.science.get("drama").unlocked);u++){var C,K,B=x.meta[u];if((!B.researched||0<F)&&"metaphysics"!==B.name&&"drama"!==B.name&&(!(u<23&&35<c)||l.get("physics").researched)){B.prices[1].name!==t&&!F||(C=F||B.prices[1].val,r=Math.ceil((C-g)/f),C=this.getValueAvailable("manuscript",!0),K=G>1e4*r,C>50*r&&1<=r?(w.science=0<F?w.science:B.label,M<=1&&K&&H("compedium"),w.resources.manuscript=0,w.resources.compedium=0):1<=r&&(w.resources.manuscript=50*r,w.science=0<F?w.science:B.label));break}}l.get("metalurgy").researched||(k=l.get("acoustics").researched,20===u&&c<60&&!k&&(m=!0,r=1),g<100+200*!a*k&&.995<M&&(V=te.science.maxValue,(!l.get("electricity").researched&&g<85&&.92<b||1===M&&V>x.meta[u].prices[1].val)&&(m=!0,r=1),.96<b&&(81e3<V&&(m=!0,r=1),3e3<te.titanium.value)&&119e3<V&&!ne.get("concreteHuts").researched&&te.kittens.maxValue&&(r=0),te.faith.value)&&k&&game.bld.getBuildingExt("chapel").meta.val<18&&l.get("archeology").researched&&(m=!1)),game.getEffect("scienceMaxCompendia")&&game.getEffect("alicornChance")>1e-4*(40-39*!a)&&2e4<te.manuscript.value&&(p=this.getCompendiaMax(),(V=10*c)<Math.max(2e4,p))&&(m=i,r=(p-V)/(10*f))}if("blueprint"===t&&e&&l.get("electricity").researched){var k=l.get("rocketry").researched,_=te.science.maxValue;if(te.unobtainium.value&&k&&!l.get("drama").researched)r=0;else if(!l.get("advExogeology").researched)for(u=30;u<44;u++){var P=x.meta[u];if(!P.researched){var Y=P.name,S=["quantumCryptography","blackchain","ecology","ai"],Z=P.prices;if(!(-1<S.indexOf(Y)||_<.95*Z[0].val)){S=Z[1];if(S.name===t&&(r=Math.ceil((S.val-(300<g-c?g:c))/f),Y=this.getValueAvailable("compedium",!0),Z=G>25e3*r||1<=M,Y>25*r&&1<=r?(w.science=P.label,M<1&&Z&&H("blueprint"),w.resources.manuscript=0,w.resources.compedium=0):1<=r&&(w.resources.compedium=25*r,w.science=P.label)),33!==u&&42!==u&&43!==u)break}}}c-g==150&&(r=0),k||(!l.get("metalurgy").researched&&c<60&&.98<M&&119e3<_||u>34+!a&&g<200&&.98<M&&.98<b&&11e4<_)&&(m=!0,r=1),game.getEffect("scienceMaxCompendia")&&game.getEffect("alicornChance")>1e-4*(40-39*!a)&&(p=this.getCompendiaMax(),(V=10*te.compedium.value)>Math.max(2e4,p)?(r=(V-p)/250,m=i):U=.15)}if("concrate"!==t||c||(m=!0,r=1),"parchment"===t){if(e=f<2.2-a+.2*d,te.minerals.value>600*(1-a)&&(c<6.1&&1.5<f||c<12.14+25*a&&2<f)&&(m=!0,r=1),!m&&(2<f&&te.furs.value<350||f<2.12-a))return void(1e3<te.furs.value&&l.get("writing").researched&&ce("furs"));v?a<-.06&&!l.get("acoustics").researched&&(e=!0):(120<g&&(e=!0,ce("parchment")),m||(r=2*(500-g)/f))}for(u in n){W=0;var X=n[u],Q=!e||m||0<te[u].maxValue&&i;W=Q?this.getValueAvailable(u,m)/X:U*((this.getValueAvailable(u,!0)+X/f*g)/X)-g/f,y=Math.min(W,y,r)}if("steel"===t&&e){k=game.bld.getBuildingExt("calciner").meta;let n=c;var b=this.getValueAvailable("steel"),b=(!h.oxidation&&h.items.plate.enabled&&b&&(V=v?1:0,p=Math.max(+!V,.3*Math.min(1,te.coal.perTickCached/te.iron.perTickCached)),te.plate.value<Math.max(75+(100-25*(a<-.06))*V*(3<f),1.25*p*te.steel.value)&&(!l.get("theology").researched||30<c)&&(y=0),!game.getEffect("warehouseRatio"))&&50<te.plate.value&&3e4<te.science.maxValue&&(c<50&&(m=!0,y=1),h.items.scaffold.enabled)&&te.scaffold.value<25&&this.craft("scaffold",1),ae.auto.upgrade.items.upgrades),v=(a,t)=>{let i;if((!a||(t=(i=ne.get(a)).prices,i.unlocked))&&(!a||!i.researched)){let e;for(var r in t){r=t[r];if("steel"===r.name&&(e=r.val),"science"===r.name&&te.science.value<.95*r.val)return}var l=Math.ceil((e-n)/f),o=te.iron.value>100*l&&te.coal.value>100*l;0<l&&o&&(y=l,m=!0,a)&&ie(ee("craft.forceSteel",[i.label]))}},a=(b.cache||h.oxidation||game.ironWill||(v("steelAxe"),v("steelArmor")),this.getUnResearched("oxidation")),V=k.on;if(V){k.isAutomationEnabled?game.time.getCFU("ressourceRetrieval").on<5&&ce("ironFactory"):(p=.0015*(1+.1*game.bld.getBuildingExt("reactor").meta.on)*(game.getEffect("calcinerRatio")+1)*game.bld.getAutoProductionRatio()*(game.getEffect("ironPolicyRatio")+1)*game.calendar.cycleEffectsFestival({iron:1}).iron*V,y=Math.max(0,y)+p,n<125&&(y+=1),k=.01*Math.min(te.coal.value,te.iron.value),(y>k||h.oxidation)&&(y=k),47===V&&!game.getEffect("productionRatio")&&250<te.uranium.value&&(y=0)),v("oxidation");p=te.titanium.value;if(a){let e=0;ae.auto.resources[t]&&(e=ae.auto.resources[t].stock);var k=Math.ceil((5e3-c+e)/f),q=te.iron,A=te.coal,A=(100*k-A.value)/A.perTickCached,k=(100*k-q.value)/this.getTickVal(q,te.ship.value<243&&o),q=2e4<te.science.value||te.starchart.value<1e4;let a=4500+200*(2<V)+300*(3<V)+500*(4<V)+300*(6<V)+200*(7<V);!d&&o&&te.ship.value<320&&(a-=1e3),A<a&&k<a&&q&&(h.oxidation=!0,ce("oxidation"))}A=te.alloy.value,k=this.getUnResearched("fluidizedReactors"),q=(this.getUnResearched("orbitalGeodesy")&&3e4<te.oil.value&&35e3<te.oil.maxValue&&te.uranium.value<1e3&&!k&&(q=Math.ceil((1e3-A)/f),L=te.titanium.value>10*q||300<te.alloy.value&&20<V||(10*q-p)/te.titanium.perTickCached<600||19<V||o&&300<game.calendar.year,0<q)&&L&&"orbitalGeodesy"!==b.cache&&(ae.auto.cache.resUpg.alloy=1e3,ie(ee("craft.CacheSteel",["轨道测地学"])),b.cache="orbitalGeodesy"),!k||(q=b.cache)&&"geodesy"!==q||(k=10*(L=Math.ceil((200-A)/f))<p||100<te.alloy.value||(10*L-p)/te.titanium.perTickCached<600||13<V,0<L&&9-3*d<V&&k&&!b.cache&&(ae.auto.cache.resUpg.alloy=200,b.cache="fluidizedReactors",ie(ee("craft.CacheSteel",["流化反应器"])))),this.getUnResearched("miningDrill")),p=(q&&1e5<te.science.value&&1750<g&&o&&!b.cache&&v("miningDrill"),ae.auto.cache.resUpg.alloy);p&&v("",[{name:"steel",val:75*Math.ceil((p-A)/f)}])}else game.challenges.isActive("blackSky")&&v("",[{name:"steel",val:1100}]);a||(h.oxidation=null);var L=ae.auto.options.items.hunt;L.time&&.98<le("iron")&&(L.time="fullIron")}return"alloy"===t&&e&&(V=(e,a)=>{var t,i,e=ne.get(e);!e.researched&&e.unlocked&&1<(t=Math.ceil((a-te.alloy.value)/f))&&te.steel.value>75*t&&te.titanium.value>10*t&&!h.oxidation&&(!(i=ae.auto.resources.titanium)||te.titanium.value-a>i.stock)&&(y=t,m=!0,oe.getSolarRevolutionRatio()<5.5||25<a)&&!ae.auto.upgrade.items.upgrades.cache&&ie(ee("craft.forceSteel",[e.label]))},game.getEffect("unobtainiumPerTickSpace")||"geodesy"===ae.auto.upgrade.items.upgrades.cache||(35e3<te.oil.value&&V("orbitalGeodesy",1e3),V("fluidizedReactors",200),ne.get("alloyAxe").researched?game.getEffect("hunterRatio")&&(V("alloyArmor",25),V("nanosuits",250)):te.wood.perTickCached&&V("alloyAxe",25),V("alloySaw",75),5e4<te.oil.value&&o&&239e3<te.science.maxValue&&te.starchart.perTickCached&&(V("hubbleTelescope",1250),game.village.leader)&&250<te.uranium.value&&f<4.5&&V("photolithography",1250))),(y="eludium"===t&&e&&(.99<le("unobtainium")&&y<1&&c&&(y=1),game.time.getCFU("ressourceRetrieval").on>11-d)&&!game.calendar.season?Math.max(Math.min(20,y),1):y)<1?0:(0<D&&y*f>D-c&&(y=(D-c)/f),!(f<4&&e)||m||i&&"noRequire"!==i||(y*=Math.max(Math.min(Math.log(f-1),1),.2)),y)},getMaterials:function(e){var a={},e=this.getCraft(e);if(e){var t=game.workshop.getCraftPrice(e);for(const r in t){var i=t[r];a[i.name]=i.val}return a}},getTickVal:function(e,a){var t,i,r,l=e.name;let o=game.getResourcePerTick(l,!0);if("timeCrystal"===l&&(r=game.getEffect("alicornChance"),t=game.getResourcePerTick("alicorn"),i=.04*(1+game.getEffect("tcRefineRatio")),r*=1+game.getLimitedDR(game.getEffect("alicornPerTickRatio"),1.2),r=.2*Math.min(r,1),o=(r+t)*i,25<game.getEffect("antimatterProduction"))&&le("unobtainium")<.6&&(o*=20),e.craftable){let e=Number.MAX_VALUE;var n,s=this.getMaterials(l),c=1+game.getResCraftRatio(l);for(n in s){var g=c/s[n],u=this.getTickVal(this.getResource(n));e=Math.min(u*g,e)}o+=e===Number.MAX_VALUE?0:e}return o<=0&&("spice"===l||"blueprint"===l)?"ignore":(a||(o+=+this.cacheManager.getResValue(l)),o)},getAverageHunt:function(){var e={},a=game.getEffect("hunterRatio")+game.village.getEffectLeader("manager",0);return e.furs=40+32.5*a,e.ivory=50*Math.min(.225+.01*a,.5)+40*a*Math.min(.225+.01*a,.5),e.unicorns=.05,10<=this.getValue("zebras")&&(e.bloodstone=0===this.getValue("bloodstone")?.05:5e-4),game.ironWill&&game.workshop.get("goldOre").researched&&(e.gold=.625+.625*a),e},getResource:function(e){var a=te[e];return a||(l("unable to find resource "+e),null)},getValue:function(e){return this.getResource(e).value},getStock:function(e){var a=ae.auto,t=a.resources[e];let i=t?t.stock:0,r=a.cache.stocks;return r||(this.getAutoStocks(),r=a.cache.stocks),r[e]&&(i+=r[e]),i},getAutoStocks:function(){let b=ae.auto,v=b.cache;if(v.stocks={},!ne.get("spaceManufacturing").researched){let g=ne.get("orbitalGeodesy").researched,u=game.village.leader,m=game.ironWill,d=game.village.sim.kittens.length,p=v.resUpg.alloy,h=game.getEffect("priceRatio"),f=(e,a,t)=>{v.stocks[t]+=e,ce(a)};["wood","minerals","iron","alloy","titanium","steel","gear","beam","blueprint"].forEach(r=>{let e=v.stocks[r]=0;var a=te.titanium;switch(r){case"wood":!te.paragon.value&&8===d&&game.getEffect("skillXP")&&te.wood.value<196&&(e+=196),this.getUnResearched("ironwood")&&2800<te.iron.value&&20<d&&(e+=15e3);break;case"minerals":d<130&&ne.get("concreteHuts").researched&&!m&&!h&&le(r)<.99&&3<=game.getEffect("craftRatio")&&(t=game.bld.getBuildingExt("logHouse").meta,ce("logHouseMineral"),e+=250*Math.pow(t.priceRatio+h,t.val));break;case"iron":var t=game.bld.getBuildingExt("lumberMill").meta,l=game.bld.getBuildingExt("temple").meta,o=te.gold.value<50*Math.pow(h+l.priceRatio,l.val)+2,n=400<50*Math.pow(h+t.priceRatio,t.val),t=t.val>18-40*h;if(l.on>2+h||749<te.faith.maxValue||o&&t||18<te.plate.value||n&&!h){let i=te[r].value;var l=te[r].maxValue,o=(e,a,t)=>{e&&i<1e4&&d<115&&f(a,t,r)},n=this.getUnResearched("reinforcedSaw")&&200<i&&1e3<l,s=te.burnedParagon.value<1e5,t=this.getUnResearched("crossbow")&&t&&1500<l&&s,l=this.getUnResearched("ironwood")&&i>700*(1-h)&&3e3<l&&3e4<te.science.maxValue&&20<d&&s;o(n,1e3,"reinforcedSaw"),o(t,1500,"crossbow"),o(l,3e3,"ironwood"),ne.get("spaceManufacturing").researched&&(ce("ironwood",!0),ce("crossbow",!0),ce("ironwood",!0))}break;case"alloy":p&&(e+=p);break;case"steel":s=game.challenges.isActive("blackSky"),n=a.value,t=te[r].value,o=(this.getUnResearched("steelAxe")&&3e3<te.coal.value&&!m&&(29<game.bld.getBuildingExt("lumberMill").meta.val||10<t)&&f(75,"steelAxe",r),this.getUnResearched("steelSaw")&&250<t&&!v.stocks.titanium&&5e4<te.science.maxValue&&d<85&&f(750,"steelSaw",r),this.getUnResearched("oxidation")&&(ae.auto.craft.oxidation&&(e+=5e3),this.getUnResearched("titaniumWarehouses"))&&50<n&&ne.get("geodesy").researched&&500<te.scaffold.value&&(e+=500),this.getUnResearched("titaniumBarns")&&70<te.ship.value&&25<n&&250<te.scaffold.value&&(e+=200),s&&!n.perTickCached&&t<1100&&6e3<te.oil.value&&(e+=1100),b.upgrade.items.upgrades),l=("miningDrill"===o.cache&&1450<a.value&&(e+=750,ce("miningDrill")),v.resUpg.steel);l&&(e+=l),p&&(e+=75*Math.max(0,p-te.alloy.value)/(1+game.getEffect("craftRatio")));break;case"titanium":var s=game.bld.getBuildingExt("calciner").meta.val,n=ne.get("geodesy").researched,t=game.getEffect("calcinerRatio"),o=a.value,l=ae.auto.upgrade.items,i=h<-.06,i=(this.getUnResearched("rotaryKiln")&&5e3<a.maxValue&&(1500<o&&5+5*i<s&&n&&250<te.ship.value||g&&17<s)&&(f(5e3,"rotaryKiln",r),(i=l.upgrades).cache||(i.cache="rotaryKiln")),this.getUnResearched("titaniumMirrors")&&40<te.ship.value&&te.science.maxValue<57e3&&o<15&&(e+=15),oe.getSolarRevolutionRatio()),c=this.getUnResearched("geodesy");!m&&c&&te.starchart.value>350-50*!t&&i<3.3&&(s||100<a.value)&&(f(250,"titaniumGeodesy",r),(t=l.upgrades).cache||(t.cache="geodesy")),n&&this.getUnResearched("miningDrill")&&675<o&&((i=l.upgrades).cache||(i.cache="miningDrill"),e+=1750),this.getUnResearched("concreteHuts")&&12e4<te.science.maxValue&&te.uranium.value<250&&d<124+16*(h<-.07)+57*!u&&!m&&45<te.concrate.value&&(n&&750<o||c&&1e3<o)&&(f(3e3,"concreteHuts",r),(s=l.upgrades).cache||(s.cache="concreteHuts")),this.getUnResearched("spaceManufacturing")&&24<game.bld.getBuildingExt("reactor").meta.val&&125e3<a.maxValue&&f(125e3,"spaceManufacturing",r),p&&(e+=5*p);break;case"gear":t=a.value,i=(this.getUnResearched("combustionEngine")&&game.getEffect("coalRatioGlobal")&&te.coal.value<1e3&&(e+=25),this.getUnResearched("rotaryKiln")&&4e3<t&&138e3<te.science.maxValue&&(e+=500),this.getUnResearched("fuelInjectors")&&2e4<te.oil.value&&(game.getEffect("calcinerRatio")<1||te.coal.value<3e3)&&oe.getSolarRevolutionRatio()<5&&game.getEffect("coalRatioGlobal")&&(ce("fuelInjectors"),e+=250),le("oil")<.8&&te.starchart.value<250&&150<te.steel.value||te.oil.perTickCached<.4);this.getUnResearched("pumpjack")&&200<t&&i&&-.06<h&&(e+=125),this.getUnResearched("logistics")&&1e3<te.scaffold.value&&u&&d<100&&(e+=100),this.getUnResearched("oilRefinery")&&1750<t&&125e3<te.science.maxValue&&i&&(e+=500);break;case"beam":this.getUnResearched("deepMining")&&1200<te.iron.value&&(e+=5e3);break;case"blueprint":15<game.bld.getBuildingExt("calciner").meta.val&&!game.science.get("sattelites").researched&&181e3<te.science.maxValue&&ne.get("rotaryKiln").researched&&!te.unobtainium.value&&te.blueprint.value<150&&(e+=125),75<te.alloy.value&&!game.science.get("nanotechnology").researched&&2e5<te.science.maxValue&&ne.get("rotaryKiln").researched&&!te.unobtainium.value&&(ce("nanotechnology"),e+=150),!game.science.get("orbitalEngineering").researched&&1===le("unobtainium")&&.5<game.getEffect("ProductionRatio")&&(e+=250)}v.stocks[r]+=e})}},getValueAvailable:function(a,e,t){let i=this.getValue(a),r=this.getStock(a),l;l=t||0===t?t:void 0===t?1:ae.auto.craft.trigger,"catnip"===a&&(o=this.getPotentialCatnip(!1),s=0!==game.calendar.season||this.getResource(a).maxValue*l<i||game.getResourcePerTick("catnip",!0)<0,o<0)&&s&&(s=game.calendar,n=game.calcResourcePerTick("catnip"),r-=1500*o,0<n&&(o=s.season<3?100*(2-s.season)+100-s.day:0,r=Math.max(0,r-10*game.calcResourcePerTick("catnip")*o)),ae.auto.options.catnipMsg+4e6<Date.now()||!ue.other["auto.craftCatnip"])&&(game.stats.getStat("totalResets").val<5&&ie(ee("msg.catnip")),ce("craftCatnip"),ae.auto.options.catnipMsg=Date.now()),i=Math.max(i-r,0);var o,n=t&&!e?i:this.getResource(a).maxValue;if(!e&&0<n){var s=ae.auto.resources[a];let e=(s&&s.enabled&&void 0!==s.consume?s:ae).consume;(ae.auto.craft.autoConsume[a]&&!t||"coal"===a)&&(e=1),i-=Math.min(n,i)*(1-e),"unobtainium"===a&&i+r<1e3&&this.getResource(a).value===n&&1e3<=this.getResource(a).value&&(i=this.getResource(a).value)}return i},getUnResearched:function(e){e=game.workshop.metaCache[e];return!e.researched&&e.unlocked},getLimRat:function(a,e,t){if(e){var i=game.science.get("navigation"),r=te[a],l=te.ship.value,o=game.space,n=o.getProgram("piscineMission"),s=game.bld,c=s.getBuildingExt("reactor").meta,g=c.val,u=game.getEffect("priceRatio"),m=u<-.07,d=s.getBuildingExt("steamworks").meta,p=s.getBuildingExt("magneto").meta,h=oe.getSolarRevolutionRatio();let e;switch(a){case"wood":var f=te.catnip,b=.09+r.perTickCached<f.perTickCached/game.workshop.getCraft("wood").prices[0].val,v=!game.getEffect("scienceRatio")&&1e3<f.value&&game.ironWill,b=(t=b||v?1:.5-.1*(f.perTickCached<10),s.getBuildingExt("field").meta),v=Math.pow(b.priceRatio+u,b.val);t=f.maxValue>10*v&&1<h&&!game.ironWill&&r.value||!this.getValueAvailable(a,!0)&&r.value?0:t;break;case"beam":b=i.unlocked||te.gold.maxValue<500||1e3<te.iron.value&&!te.coal.value;t=te.scaffold.value<500+500*h+4500*!h?t:.02,t=b?t:.005;break;case"slab":f=r.value,v=te.faith.maxValue<750&&f<51&&35<te.gold.value,b=te.scaffold.value;t=b||v||g&&f<2500?t:.005,t=b<500&&l<210||500<b&&f<615?t:.1,t=2500<b&&r.value>2500*(1+h)*(1+.05*c.on)*(1+h)?.04:t;break;case"ship":var v=te.starchart.value,f=te.titanium.maxValue,b=5*g+225,k=(y=!n.on&&l&&o.getBuilding("sattelite").val<9||!n.on&&ne.get("spaceManufacturing").researched)&&5.5<h&&f<125e3&&!n.val,y=y&&6<h&&12e4<f,x=ne.get("geodesy").researched;t=.4,x&&h<9-2*m+3*!game.village.leader-4.5*y&&(M=te.unobtainium.perTickCached,R=h<.8?1+3*(0<M):1.2*(l<400),R=(25*u+Math.log1p(h)+1.5*(0<M&&-.06<u)+2.2+R-2.2*(2<h))*b,w=400<game.calendar.year&&g,l<Math.min(R,500*(!y||w)+1e3))&&v<1500&&(t=.7+.2*(l<400-4*h-50*m||w)+.3*(0<M),ce("shipLess")),t=.75*b<l&&3+2*x<h&&v<1e5&&y?.3:t,t=k||.7<le("titanium")||1e5<l?.05:t,t=y&&(!game.workshop.get("satnav").researched||123e3<f)&&v<1e4?0:t,t=l>Math.max(400,.5*f)?0:t;break;case"plate":var R=s.getBuildingExt("temple").meta,w=Math.pow(R.priceRatio+u,R.val),M=r.value,b=M<2500&&3500<te.titanium.value,x=R.on&&R.on<15-3*m&&h&&M<15*w;t=game.getEffect("calcinerRatio")||x||b?t+.2:.35,t=M<150&&i.researched&&10<te.starchart.value&&te.scaffold.value>50-100*u?.92:t,t=ae.auto.craft.oxidation&&!game.workshop.get("oxidation").researched?0:t;break;case"alloy":game.globalEffectsCached.titaniumPerTickAutoprod;k=s.getBuildingExt("calciner").meta.val,y=(e=Math.pow(p.priceRatio+u,p.val),t=k<4&&d.on<p.on||k<2||k<3&&!te.titanium.value<22-h?.45:.76,!g&&31<p.val),v=(t=r.value>Math.max(1250,10*e)&&ae.auto.build.items.magneto.enabled||y?.01:t,k<6&&!te.starchart.unlocked);t=te.titanium.value<17&&!k||v||!game.science.get("electricity").researched?0:t;break;case"steel":t=ae.auto.craft.oxidation?1:.65;break;case"eludium":t=.05<game.getEffect("shatterTCGain")?.1:.6,t=r.value<125&&-1.06<game.getEffect("hutPriceRatio")?1:t;break;case"megalith":f=s.getBuildingExt("ziggurat").meta,R=(e=Math.pow(f.priceRatio+u,f.val),Math.pow(c.priceRatio+u,g));t=game.workshop.get("spaceManufacturing").researched?t:.15,t=r.value>Math.max(100,50*e)?.005:t,t=te.plate.value<Math.max(5e3,50*R)?.1:t,!(50<r.value||f.on||te.unicorns.value<1e3)||game.workshop.get("orbitalGeodesy").researched||(t=.001);break;case"concrate":w=o.getBuilding("moonOutpost").val,w=150*Math.pow(1.12,w),x=(e=Math.pow(c.priceRatio+u,g),s.getBuildingExt("library").meta),b=Math.pow(x.priceRatio+u,x.val)*x.stage;t=g?.6:.14,t=r.value>Math.max(w,50*e,10*b)?.01:t;break;case"gear":e=Math.pow(d.priceRatio+u,d.val);M=this.getUnResearched("logistics")&&1e3<te.scaffold.value,y=this.getUnResearched("fuelInjectors")&&1e4<te.oil.value&&le("coal")<.6+u&&r.value<250&&200<te.titanium.value&&te.steel.value>240+40*u,k=game.getEffect("calcinerRatio")&&2<h;t=y||M?.75:.3+.15*k,t=r.value>Math.max(500,20*e)?.005:t,t=d.val||game.science.get("chemistry").researched||!te.furs.unlocked&&r.value<50?t:0;break;case"kerosene":t=.25+.3*(te.kerosene.value<2e3&&8<h&&n.on),t=!n.val&&1400<te.starchart.value&&r.value<250&&3<h?.8:t,t=!n.on&&250<r.value?0:t,t=o.getProgram("moonMission").val?t:0;break;case"manuscript":t=game.prestige.getPerk("numeromancy").researched&&!game.calendar.festivalDays&&game.science.get("drama").unlocked?.25:.49,t=g?.4:t;v=s.getBuildingExt("chapel").meta,v=Math.pow(v.priceRatio+u,v.val),R=s.getBuildingExt("brewery").meta;te.culture.maxValue>750*Math.pow(R.priceRatio+u,R.val)&&.5<le("culture")&&te.parchment.value>Math.max(1e6,260*v)&&g&&(t=1);break;case"compedium":t=h?t:.3,t=game.science.get("architecture").unlocked?t:0;break;case"blueprint":t=game.science.get("industrialization").unlocked?t:0;break;case"scaffold":f=r.value,x=s.getBuildingExt("observatory").meta,w=f<50*(e=Math.pow(game.getLimitedDR(u,.1)+1.1,x.val))&&te.iron.value>750*e,b=te.science.maxValue,y=game.village.leader,M=f<1e3&&this.getUnResearched("logistics")&&y&&2<y.rank&&95e3<b,k=150<te.plate.value&&f<100&&47500<b;t=w||M||k?.75+.1*(b<6e4):t,t=i.unlocked?(t=750<te.iron.value||game.science.get("chemistry").researched?t:0,f<880+120*M&&b<119e3&&200-25*M<l||-.06<game.getEffect("priceRatio")&&k?1:t):0;break;case"tanker":t=.01;break;case"thorium":t=r.value?.01:1e-4}}return t},getCompendiaMax:function(){let e=game.bld.getEffect("scienceMax");var a,t=game.getEffect("scienceMaxCompendia");return game.ironWill&&(e*=10),game.prestige.getPerk("codexLeviathanianus").researched&&(a=1+(a=oe.getTU("blackLibrary")).val*(a.effects.compendiaTTBoostRatio+game.getEffect("blackLibraryBonus")),e*=1+.05*a*oe.transcendenceTier),e+t},getPotentialCatnip:function(e,a,t){let i=game.getEffect("catnipPerTickBase");e?(i=(i*=.1)*(1+game.getLimitedDR(game.getEffect("coldHarshness"),1)),game.getEffect("factoryCostReduction")&&(i=0)):(e=game.calendar.year<4?0:.15,i*=game.calendar.seasons[3].modifiers.catnip-e),game.village.resourceProduction||game.village.updateResourceProduction();var e=game.village.resourceProduction.catnip,e=e?e*(1+game.getEffect("catnipJobRatio")):0;let r=i+e;void 0===t?r*=1+game.getEffect("catnipRatio"):(o=(e=game.space.getBuilding("hydroponics")).effects.catnipRatio,r*=1+game.bld.getBuildingExt("aqueduct").meta.stages[0].effects.catnipRatio*t+o*e.val);t=game.challenges.isActive("winterIsComing")?0:game.prestige.getParagonProductionRatio();r=(r=(r*=1+t)*(1+oe.getSolarRevolutionRatio()*(1+game.bld.pollutionEffects.solarRevolutionPollution)))*(1+game.getEffect("blsProductionBonus")*te.sorrow.value),r=game.calendar.cycleEffectsFestival({catnip:r}).catnip,r=(r*=1+game.bld.pollutionEffects.catnipPollutionRatio)+!ue.other["auto.changeLeader"]*(.1*r+1);let l=game.village.getResConsumption().catnip;var o=game.bld.getBuildingExt("unicornPasture").meta.val;return l*=void 0===a?1+game.getEffect("catnipDemandRatio"):1+game.getLimitedDR(-.005*a+-.0015*o,1),0<game.village.sim.kittens.length&&1<game.village.happiness&&(e=Math.max(game.village.happiness*(1+game.getEffect("hapinnessConsumptionRatio"))-1,0),game.challenges.isActive("anarchy")?l*=1+e*(1+game.getEffect("catnipDemandWorkerRatioGlobal")):l*=1+e*(1+game.getEffect("catnipDemandWorkerRatioGlobal"))*(1-game.village.getFreeKittens()/game.village.sim.kittens.length)),r=(r+=l+.2*!ue.other["auto.changeLeader"])+game.getResourcePerTickConvertion("catnip")}},function(){this.craftManager=new a}),f=(t.prototype={craftManager:void 0,bulk:function(e,a,t,n){let i,s,c,r,l;var g=[],u=[];let o=0;for(const C in e)if((l=e[C]).enabled&&(i=a[C],!(-1!==l.max&&l.max<=i.val))&&!1!==i.unlocked){var m=!!l.require&&te[l.require];if(!m||t<=m.value/m.maxValue){let e=(i.stages?i.stages[i.stage]:i).prices;"s"===l.variant&&(e=game.village.getEffectLeader("wise",dojo.clone(i.prices))),c=this.getPriceRatio(i,n),g[o]={};var m=g[o],d=(m.id=C,m.label=l.label,m.name=l.name,m.stage=l.stage,m.variant=l.variant,u[o]={},u[o]),m=(d.id=C,d.name=l.name,d.count=0,d.spot=o,d.prices=[],game.getLimitedDR(game.getEffect(C+"CostReduction"),1)),p=1-m;for(r in e){var h=e[r],f=game.getLimitedDR(game.getEffect(h.name+"CostReduction"),1);d.prices.push({val:h.val*p*(1-f),name:h.name})}d.priceRatio=c,d.source=n,d.limit=isNaN(l.max)?-1:l.max,d.val=i.val,this.singleBuildPossible(i,d.prices,c,n)?o++:u.pop()}}if(0!==u.length){var b,v={};for(b in te)v[b]=this.craftManager.getValueAvailable(b,!0);let e=0,o;for(;0!==u.length;){e:for(let l=0;l<u.length;l++){var k=u[l],y=(i=a[k.id]).val,x=e+y;s=k.prices,c=k.priceRatio||Number.MAX_VALUE,n=k.source;for(let r=0;r<s.length;r++){var R=s[r];let e,a,t,i=!1;var w=R.name,M=v[w];if("space"===n&&"oil"===w?(e=!0,t=R.val*(1-game.getLimitedDR(game.getEffect("oilReductionRatio"),.75))):"cryochambers"===k.id&&"karma"===w&&(a=!0,i=R.val*(1-game.getLimitedDR(.01*game.prestige.getBurnedParagonRatio(),1))),o=e?v.oil<t*Math.pow(1.05,x):a?v.karma<i*Math.pow(c,x):M<R.val*Math.pow(c,x)){for(let e=0;e<r;e++){var E,T=s[e],F=T.name;"space"===n&&"oil"===F?(E=T.val*(1-game.getLimitedDR(game.getEffect("oilReductionRatio"),.75)),v.oil+=E*Math.pow(1.05,x)):"cryochambers"===k.id&&"karma"===F?(E=T.val*(1-game.getLimitedDR(.01*game.prestige.getBurnedParagonRatio(),1)),v.karma+=E*Math.pow(c,x)):(T=T.val*Math.pow(c,x),v[F]+="void"===F?Math.ceil(T):T)}-1!==k.limit&&(k.count=Math.max(0,Math.min(k.count,k.limit-k.val))),g[k.spot].count=k.count,u.splice(l,1),l--;continue e}e?v.oil-=t*Math.pow(1.05,x):a?v.karma-=i*Math.pow(c,x):(M=R.val*Math.pow(c,x),v[w]-="void"===w?Math.ceil(M):M,v[w]||(v[w]=0))}k.count++}e++}return g}},construct:function(e,a,t){var i,r=e.metadata;let l=0;if("number"==typeof r.limitBuild&&r.limitBuild-r.val<t&&(t=r.limitBuild-r.val),e.enabled||a.controller.updateEnabled(e),e.enabled&&a.controller.hasResources(e)||game.devMode){for(;a.controller.hasResources(e)&&0<t;)e.prices=a.controller.getPrices(e),a.controller.payPrice(e),a.controller.incrementValue(e),l++,t--;r.breakIronWill&&(game.ironWill=!1,(i=game.science.getPolicy("liberty")).calculateEffects(i,game)),r.unlockScheme&&r.val>=r.unlockScheme.threshold&&game.ui.unlockScheme(r.unlockScheme.name),r.unlocks&&game.unlock(r.unlocks),r.upgrades&&(r.updateEffects&&r.updateEffects(r,game),re(r.upgrades))}return l},getPriceRatio:function(e,a){var t=e.stages?e.priceRatio||e.stages[e.stage].priceRatio:e.priceRatio;let i=0;return"bonfire"===a&&(i=game.getEffect(e.name+"PriceRatio")+game.getEffect("priceRatio")+game.getEffect("mapPriceReduction"),i=game.getLimitedDR(i,t-1)),t+i},singleBuildPossible:function(t,i,r,l){var o,n=1-game.getLimitedDR(game.getEffect(t.name+"CostReduction"),1);for(o in i){var s=i[o],c=s.name,g=game.getLimitedDR(game.getEffect(c+"CostReduction"),1);let e=s.val*n*(1-g),a=("cryochambers"===t.name&&"karma"===c&&(e*=1-game.getLimitedDR(.01*game.prestige.getBurnedParagonRatio(),1)),"space"===l&&"oil"===c&&(e*=1-game.getLimitedDR(game.getEffect("oilReductionRatio"),.75),r=1.05),this.craftManager.getValueAvailable(c,!0));if("time"===l&&"timeCrystal"===c&&(a-=300),a<e*Math.pow(r,t.val))return!1}return!0}},function(){this.craftManager=new a,this.manager=new e("Trade")}),b=(f.prototype={craftManager:void 0,manager:void 0,trade:function(e,a){(!e||a<1)&&l(e+"-"+a+"贸易可能出点问题");var t=this.getRace(e),i=this.getTradeButton(t.name),r=ae.auto.cache.trait.merchant?"商人小猫与 ":"小猫与 ";if(!i.model.enabled)return i.controller.updateEnabled(i.model);"sharks"===e||ae.auto.trade.items[e].enabled||l("贸易可能出点问题"),game.diplomacy.tradeMultiple(t,a),game.stats.getStat("totalClicks").val+=1,me(r+" "+t.title,a,"trade"),Q("act.trade",[game.getDisplayValueExt(a),r+se(t.title)],"tradeFilter")},getProfitability:function(e){let a,t;var i=this.getRace(e),r=oe.getSolarRevolutionRatio();if("leviathans"===e&&(te.relic.value<5*(0<r)||te.timeCrystal.value<200*(1+50*game.getEffect("shatterTCGain"))))return!0;var l=this.getMaterials(e);let o=0;var n,s=game.calendar.season,c=ne.get("geodesy").researched;for(n in l)if("ivory"!==n){if(a=this.craftManager.getTickVal(this.craftManager.getResource(n),!1),"zebras"===e&&(c?1===s?460<te.ship.value?a*=1.04:a*=.8:((te.ship.value<300||r<.2)&&(a*=.2),3===s&&(a*=.01)):(.03<r&&r<.5&&te.titanium.value<250&&3!==s&&(a*=1.04),r&&(1!==s||2<s)&&(a*=.2))),a<=0){if("leviathans"===e&&"gold"===n)continue;return!1}o+=l[n]/a}var g,u=this.getAverageTrade(i);let m=0;for(g in u){var d=te[g];"ignore"===(a=this.craftManager.getTickVal(d))||!a||"catnip"===g&&le("catnip")>.1+.1*c-.05*(s<2)||(a<0&&(t=!0),m+=0<d.maxValue?Math.min(u[g],Math.max(d.maxValue-d.value,0))/a:u[g]/a)}let p=!0;var h=te.spice.value+100*game.getResourcePerTick("spice",!0)<0,f=le("titanium"),b=te.titanium,v=b.value;if("nagas"===e){if(te.concrate.unlocked||game.ironWill||(p=!1),i.embassyLevel<10&&!game.ironWill)return!1;var k=1+game.prestige.getParagonProductionRatio(),y=(h&&k<1&&(p=!0),te.concrate.value);if(y<100*k*(1+r+10*(1e4<v))&&10<i.embassyLevel&&y&&(te.titanium.value>30*k||h&&game.calendar.festivalDays||y<50)&&(t=!0),c&&!oe.getRU("basilica").on&&0<te.faith.value)return!1;250*(1+r)*k*(1+r)<y&&f<.8&&3e3<te.slab.value&&(p=!1)}if("griffins"===e){if(!game.getEffect("standingRatio")&&2<te.blueprint.value&&!te.paragon.value)return!1;if(2===s){if(te.iron.value<1200&&te.gold.value>100+600*game.getEffect("priceRatio")&&!game.science.get("theology").researched&&-.05<game.getEffect("priceRatio")&&le("iron")<.9&&(t=!0),v<500&&1.3<r&&r&&(p=!1),game.challenges.isActive("blackSky")&&v<500&&oe.getRU("basilica").on&&(t=!0),te.steel.value>5*te.plate.value&&500<v&&(t=!0),c&&!oe.getRU("basilica").on&&0<te.faith.value)return!1}else te.ship.value&&(200<te.ship.value||game.getEffect("productionRatio"))&&(p=!1);t=t||h&&game.calendar.festivalDays}if("zebras"===e){var k=game.bld.getBuildingExt("calciner").meta.val,y=ae.auto.trade.items.griffins,x=(y.enabled&&y.autumn&&2===s&&2<k&&p&&(y=this.craftManager.getTickVal(te.iron),x=Math.min(Math.max(b.maxValue-v,0),u.titanium)/b.perTickCached,y=this.getAverageTrade(this.getRace("griffins")).iron/y<u.iron/y+x,p=y&&f<.3),200<te.gold.value||40<te.faith.value&&1e4<oe.faith);if(x&&!oe.getRU("stainedGlass").on&&r)return;y=oe.getRU("basilica").on;if(y?(v<30||ae.auto.cache.resUpg.alloy<1e3)&&(t=!0):k&&3.5<r&&(p=!1),1===s&&(c&&le("titanium")<.5&&1e4<te.slab.value&&(t=!0),40<te.ship.value)&&(v<5&&te.science.maxValue<55e3&&(t=!0),240<te.ship.value)&&(te.steel.value>te.plate.value||f<.5)&&(t=!0),c){if(r&&!y||1===k&&te.ship.value<243&&500<v&&1!==s)return!1;var x=game.getEffect("calcinerRatio");(x&&x<2.7||this.craftManager.getUnResearched("concreteHuts")||game.getEffect("productionRatio")&&1.35*v<te.plate.value&&le("titanium")<.93||le("iron")<.2&&1<k)&&(t=!0)}if(v&&!this.craftManager.getValueAvailable("titanium",!0)&&3!==s&&(t=!0),!ne.get("caravanserai").researched&&r<4&&u.titanium<1)return!1;t=t||h&&game.calendar.festivalDays}if("spiders"===e&&(p=2===s?.4<f:.5<f&&le("coal")<.5,3===s&&(p=.9<f&&le("coal")<.5&&.95<le("gold")),t||(y=game.prestige.getParagonProductionRatio()+1,x=le("coal")<1&&te.steel.value<.8*y*te.plate.value,t=x&&b.value>600*(1+r)*y&&te.iron.value>1e4+1e4*r,p)||(t=t||game.challenges.isActive("atheism")&&4<i.embassyLevel),te.scaffold.value<7e3+7e3*r))return!1;return"dragons"===e&&(k=game.science.get("nanotechnology").researched,p=game.space.getProgram("centaurusSystemMission").on&&.5<f||k&&le("uranium")<.35&&.1<le("iron")||200<te.ship.value&&!r,t=t&&k&&te.titanium.value>5e3*r),!("sharks"===e&&(!te.furs.value&&.9<le("gold")&&9<i.embassyLevel&&te.manuscript.value&&(t=!0),2<game.prestige.getParagonProductionRatio())&&!te.titanium.value&&te.furs.value)&&(t||o<=m&&p)},getAverageTrade:function(e){var a,t,i,r=game.getEffect("standingRatio")+game.diplomacy.calculateStandingFromPolicies(e.name,game),l=1+.02*e.energy,o=1+game.diplomacy.getTradeRatio()+game.diplomacy.calculateTradeBonusFromPolicies(e.name,game)+game.challenges.getChallenge("pacifism").getTradeBonusEffect(game),n=e.standing<0?e.standing+r:0,s=n<0?1+n:1,c=0<e.standing?Math.min(e.standing+r/2,1):0,g={};for(a of e.sells)this.isValidTrade(a,e)&&(i=a.minLevel?a.chance*(1+game.getLimitedDR(.01*e.embassyLevel,.75)):a.chance,t=a.seasons?1+a.seasons[game.calendar.getCurSeason().name]:1,i=((s-c)*Math.min(i,1)+1.25*(c*Math.min(i,1)))*a.value*l*t*o,g[a.name]=i);"zebras"===e.name&&(n=te.ship.value,r=game.getEffect("zebraRelationModifier")*game.bld.getBuildingExt("tradepost").meta.effects.tradeRatio,u=Math.min(.15+.0035*n,1),g.titanium=(1.5+.03*n)*(1+r)*u*s,oe.getSolarRevolutionRatio()<1)&&n<50&&game.getEffect("titaniumPerTickAutoprod")<.003&&(g.titanium*=.5);var r=e.embassyPrices?.35*(1+.01*e.embassyLevel):.35,u=s*Math.min(r,1);return g.spice=25*u+50*u*o/2,g.blueprint=.1*s,g},isValidTrade:function(e,a){return!(e.minLevel&&a.embassyLevel<e.minLevel)&&(te[e.name].unlocked||"titanium"===e.name||"uranium"===e.name||"leviathans"===a.name)},getLowestTradeAmount:function(e,a,t){let i,r,l,o;var n=this.getMaterials(e),s=this.getRace(e);for(o in n)i="manpower"===o?this.craftManager.getValueAvailable(o,!0)/n[o]:this.craftManager.getValueAvailable(o,!a,ae.auto.trade.trigger)/n[o],r=void 0===r||i<r?i:r;if(0===(r=Math.floor(r)))return 0;if(null===s||ae.auto.trade.items[e].allowCapped)return r;var c,g=te.plate.value>te.steel.value||!t,u=this.getAverageTrade(s),m=s.sells;for(c in m){var d,p=m[c].name,h=this.craftManager.getResource(p);h.maxValue&&(d=u[p],p=Math.max((h.maxValue-h.value-Math.max(0,(g||"iron"!==p?1:0)*(ae.interval/200+2)*h.perTickCached))/d,0),l=p<l?l:p)}return 0===(l=Math.ceil(l))?0:(r=l<r?Math.max(l-1,1):r,Math.floor(r))},getMaterials:function(e){var a=game.challenges.isActive("postApocalypse")?game.bld.getPollutionLevel():1,t={manpower:a*(50-game.getEffect("tradeCatpowerDiscount")),gold:a*(15-game.getEffect("tradeGoldDiscount"))};if(void 0!==e){var i=this.getRace(e).buys;for(const l in i){var r=i[l];t[r.name]=r.val}}return t},getRace:function(e){return void 0===e?null:game.diplomacy.get(e)},getTradeButton:function(e){for(var a in this.manager.tab.racePanels){a=this.manager.tab.racePanels[a];if(a.race.name===e)return a.tradeBtn}},singleTradePossible:function(e){var a,t=this.getMaterials(e);for(a in t)if(this.craftManager.getValueAvailable(a,!0)<t[a])return!1;return!0}},function(){});b.prototype={pushToCache:function(e){var a,t=ae.auto.cache.cacheSum,i=e.materials;for(a in i)t[a]||(t[a]=0),t[a]+=i[a]},getResValue:function(e){var a,t=ae.auto.cache,i=t.dataTimer,t=t.cacheSum;return t[e]?(i=i.ticksTotal,a=game.timer.ticksTotal,t[e]/(a-i)):0}};function i(e){document.styleSheets[0].insertRule(e,0)}var r="body[data-ks-style]:not(.scheme_sleek)";i("body {font-family: inherit;font-size: inherit;}"),i(r+" #game {min-width: 1300px;top: 32px;}"),i(r+" .column {min-height: inherit;max-width: inherit !important;padding: 1%;margin: 0;overflow-y: auto;}"),i(r+" #leftColumn {height: 92%;width: 26%;}"),i(r+" #midColumn {height: 90%;width: 49%;}"),i(r+" #rightColumn {overflow-y: auto;height: 92%;width: 19%;top: 5px;font-size: 12px;font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,Helvetica,Arial,PingFang SC,Hiragino Sans GB,Microsoft YaHei,sans-serif;}"),i("body #gamePageContainer #game #rightColumn {overflow-y: auto;}"),i(r+" #gameLog {overflow-y: hidden !important;width: 100% !important;padding-top: 5px !important;}"),i(r+" #resContainer .maxRes {color: #676766;}"),i(r+" #game .btn {border-radius: 0px;font-family: monospace;font-size: 12px !important;margin: 0 5px 7px 0;width: 290px;}"),i(r+" #game .map-viewport {height: 340px;max-width: 500px;overflow: visible;}"),i(" #game .map-dashboard {height: 120px;width: 292px;}"),i("#ks-options ul {list-style: none;margin: 0 0 5px;padding: 0;}"),i('#ks-options ul:after {clear: both;content: " ";display: block;height: 0;}'),i("#ks-options ul li {display: block;float: left;width: 100%;}"),i("#ks-options #toggle-list-resources .stockWarn *,#ks-options #toggle-reset-list-resources .stockWarn * {color: "+ae.stockWarnColor+";}"),i(".right-tab {height: unset !important;}");let V,D=()=>{V={version:3,toggles:{},items:{},resources:{},triggers:{},reset:{reset:!1,times:0,paragonLastTime:0,paragonTotal:0,karmaLastTime:0,karmaTotal:0},policies:[]}},U=(D(),["build","space","craft","upgrade","trade","faith","time","timeCtrl","distribute","options","filter"]),W=function(){U.forEach(e=>{$("#items-list-"+e).find("input[id^='toggle-']").each(function(){var e=$(this);"radio"!==e.attr("type")&&(V.items[e.attr("id")]=e.prop("checked"))})}),V.items["toggle-leaderJob-woodcutter"]=!0,V.items["toggle-leaderTrait-manager"]=!0,game.ironWill||(1<game.stats.getStat("totalResets").val&&game.msg("注意：非钢铁意志模式，故勾上了喵喵建筑","alert"),["hut","logHouse","mansion"].forEach(e=>{ae.auto.build.items[e].enabled||$("#toggle-"+e).click()})),B()},B=function(){V.toggles={build:ae.auto.build.enabled,space:ae.auto.space.enabled,craft:ae.auto.craft.enabled,upgrade:ae.auto.upgrade.enabled,trade:ae.auto.trade.enabled,faith:ae.auto.faith.enabled,time:ae.auto.time.enabled,timeCtrl:ae.auto.timeCtrl.enabled,distribute:ae.auto.distribute.enabled,options:ae.auto.options.enabled,filter:ae.auto.filter.enabled},V.resources=ae.auto.resources,V.triggers={faith:ae.auto.faith.trigger,time:ae.auto.time.trigger,build:ae.auto.build.trigger,space:ae.auto.space.trigger,craft:ae.auto.craft.trigger,trade:ae.auto.trade.trigger},V.policies=ae.policies,localStorage["cbc.kitten-scientists"]=JSON.stringify(V)},O=function(){var e,a=JSON.parse(localStorage["cbc.kitten-scientists"]||"null");if(!a||3<a.version)return e=game.msg("你只需要勾需要的大项目，项目内max和启用Cheney已经帮你精心勾选好了<br>要对大家...保密哦🤍 <br>如需不知道点什么政策 升级里可以勾选自动推荐政策<br>默认设置可以一直以最快速度用到毕业<br>已经勾选的项目都已经是自动化了"),$(e.span).css("color","#ff589c"),W();if(1===a.version&&(a.version=2,a.reset={reset:!1,times:0,paragonLastTime:0,paragonTotal:0,karmaLastTime:0,karmaTotal:0}),2===a.version&&(a.version=3,a.policies=[]),3===a.version){let e;if((V=a).toggles)for(const g in a.toggles)"engine"!==g&&ae.auto[g]&&(ae.auto[g].enabled=!!a.toggles[g],(e=$("#toggle-"+g)).prop("checked",ae.auto[g].enabled));for(const u in V.items){var t=V.items[u],i=(e=$("#"+u)).data("option"),r=u.split("-");if(void 0===i)delete V.items[u];else if("set"===r[0]?(e[0].title=t,"max"===r[r.length-1]?e.text(ee("ui.max",[t])):"min"===r[r.length-1]&&e.text(ee("ui.min",[t]))):e.prop("checked",t),2===r.length)i.enabled=t;else if("reset"===r[1]&&4<=r.length){var l=r[2],o=r[3];switch(r[0]){case"toggle":ae.auto[l].items[o].checkForReset=t;break;case"set":ae.auto[l].items[o].triggerForReset=t}}else"limited"===r[1]?i.limited=t:"leaderJob"===r[1]&&t||"leaderTrait"===r[1]&&t?i[r[1]]=r[2]:i[r[2]]=t}var n=$("#toggle-list-resources"),s=$("#toggle-reset-list-resources");for(const m in V.resources){var c=V.resources[m];c.enabled&&(0===$("#resource-"+m).length&&n.append(S(m,void 0)),"stock"in c&&k(m,c.stock),"consume"in c)&&R(m,c.consume),c.checkForReset&&(0===$("#resource-reset-"+m).length&&s.append(S(m,void 0,!0)),"stockForReset"in c)&&k(m,c.stockForReset||1/0,!0)}a.triggers&&(ae.auto.faith.trigger=a.triggers.faith,ae.auto.time.trigger=a.triggers.time,ae.auto.build.trigger=a.triggers.build,ae.auto.space.trigger=a.triggers.space,ae.auto.craft.trigger=a.triggers.craft,ae.auto.trade.trigger=a.triggers.trade,$("#trigger-faith")[0].title=ae.auto.faith.trigger,$("#trigger-time")[0].title=ae.auto.time.trigger,$("#trigger-build")[0].title=ae.auto.build.trigger,$("#trigger-space")[0].title=ae.auto.space.trigger,$("#trigger-craft")[0].title=ae.auto.craft.trigger,$("#trigger-trade")[0].title=ae.auto.trade.trigger),ae.policies=a.policies}},se=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},P={cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"},v=function(a,e,t=!1){var t=t?"#resource-reset-"+a:"#resource-"+a,i=($(t).removeClass("stockWarn"),game.resPool.resources.filter(e=>e.name===a)[0].maxValue);(i<e&&0!==i||e===1/0)&&$(t).addClass("stockWarn")},k=function(e,a,t=!1){let i,r=Number(a);isNaN(r)||r<0?l("ignoring non-numeric or invalid stock value "+a):(ae.auto.resources[e]||(ae.auto.resources[e]={}),t?(i="#resource-reset-"+e+" #stock-value-"+e,r=r<0?1/0:r,ae.auto.resources[e].checkForReset=!0,ae.auto.resources[e].stockForReset=r):(i="#resource-"+e+" #stock-value-"+e,ae.auto.resources[e].enabled=!0,ae.auto.resources[e].stock=r),$(i).text(ee("resources.stock",[r===1/0?"∞":game.getDisplayValueExt(r)])),v(e,r,t))},R=function(e,a){var t=parseFloat(a);isNaN(t)||t<0||1<t?l("ignoring non-numeric or invalid consume rate "+a):(ae.auto.resources[e]||(ae.auto.resources[e]={}),ae.auto.resources[e].consume=t,$("#consume-rate-"+e).text(ee("resources.consume",[t.toFixed(2)])))},w=function(e,a=!1){var t=ae.auto.resources[e];a?t.checkForReset=!1:t.enabled=!1,t.enabled||t.checkForReset||delete ae.auto.resources[e]},S=function(a,t,e=!1){let i;var r=te[a],l=(t=t||r.title||se(a),ae.auto.resources[a]);i=e&&l&&l.stockForReset?l.stockForReset:!e&&l&&l.stock?l.stock:0;let o=(l&&void 0!==l.consume?l:ae).consume,n=$("<div/>",{id:(e?"resource-reset-":"resource-")+a,css:{display:"inline-block",width:"100%"}}),s;"uncommon"===r.type&&(s="#FF7F50"),"rare"===r.type&&(s="#FFA500"),s=r.color||s;var c,g,r=$("<div/>",{id:"resource-label-"+a,text:t,css:{display:"inline-block",color:s,width:"95px"}}),u=(i=$("<div/>",{id:"stock-value-"+a,text:ee("resources.stock",[i===1/0?"∞":game.getDisplayValueExt(i)]),css:{cursor:"pointer",display:"inline-block",width:"80px"}}),o=$("<div/>",{id:"consume-rate-"+a,text:ee("resources.consume",[o.toFixed(2)]),css:{cursor:"pointer",display:"inline-block"}}),$("<div/>",{id:"resource-delete-"+a,text:ee("resources.del"),css:P}));return e?n.append(r,i,u):n.append(r,i,o,u),void 0!==l&&void 0!==l.stock&&v(a,l.stock),r=i,c=e,r.on("click",function(){q.stop(!1);var e=window.prompt(ee("resources.stock.set",[t]));ae.auto.engine.enabled&&q.start(!1),null!==e&&(k(a,e,c),B())}),o.on("click",function(){q.stop(!1);var e=window.prompt(ee("resources.consume.set",[t]));ae.auto.engine.enabled&&q.start(!1),null!==e&&(R(a,e),B())}),g=e,u.on("click",function(){"毛皮"!==t&&window.confirm(ee("resources.del.confirm",[t]))&&(n.remove(),w(a,g),B())}),n};{["workshopTab","libraryTab","villageTab"].forEach(e=>{game[e]&&game.ui.activeTabId!==game[e].tabId&&!game[e]._inherited&&game[e].render()});{let e,a,t,i;var I=new o;let r=ae.auto.faith.items;for(e in r)i=r[e],(t=I.getBuild(i.name||e,i.variant))&&(r[e].label=t.label);var z=new g;for(e in r=ae.auto.time.items)i=r[e],(t=z.getBuild(i.name||e,i.variant))&&(r[e].label=t.label);var H=new u;for(e in r=ae.auto.build.items)i=r[e],(t=H.getBuild(i.name||e))&&("stage"in i?r[e].label=t.meta.stages[i.stage].label:r[e].label=t.meta.label);var J,j=new L;for(a in r=ae.auto.space.items)(t=j.getBuild(a))&&(J=t.title||t.label,r[a].label=J)}0;let n=function(a){var t=[],e=a?"#resource-reset-":"#resource-",r=game.resPool.resources;let l=ae.auto.resources;var o,n=["elderBox","burnedParagon","blackcoin","gflops","hashrates","wrappingPaper","kittens","paragon","alicorn","zebras"];for(o in r){var s=r[o];let i=s.name;var c=(c=l[i])&&c.enabled;if((a||!(-1<n.indexOf(s.name)||c))&&(i&&0===$(e+i).length)){let e;"uncommon"===s.type&&(e="#FF7F50"),"rare"===s.type&&(e="#FFA500"),e=s.color||e;c=$("<div/>",{id:"resource-add-"+i,text:se(s.title||i),css:{cursor:"pointer",color:e}});!function(e,a,t){a.on("click",function(){a.remove(),l[i]||(l[i]={}),(t?(l[i].checkForReset=!0,l[i].stockForReset=1/0,$("#toggle-reset-list-resources")):(l[i].enabled=!0,l[i].stock=0,l[i].consume=ae.consume,$("#toggle-list-resources"))).append(S(i,e.title,t)),B()})}(s,c,a),t.push(c)}}return t},d=function(e=!1){var a,t,i=$("<ul/>",{id:e?"toggle-reset-list-resources":"toggle-list-resources",css:{display:"none",paddingLeft:"20px"}}),r=$("<div/>",{id:"resources-add",text:ee("resources.add"),css:{cursor:"pointer",display:"inline-block",textShadow:"3px 3px 4px gray",borderBottom:"1px solid rgba(185, 185, 185, 0.7)"}});let l=$("<ul/>",{id:"available-resources-list",css:{display:"none",paddingLeft:"20px"}});for(t in a=e,r.on("click",function(){l.toggle(),l.empty(),"none"!==l[0].style.display&&n(a).forEach(e=>{l.append(e)})}),i.append(r,l),ae.auto.resources){var o=ae.auto.resources[t];(e&&o.checkForReset||!e&&o.enabled)&&i.append(S(t,void 0,e))}return i},p=function(a){let t=$("<ul/>",{id:"items-list-"+a,css:{display:"none",paddingLeft:"20px"}});var e;return-1===["distribute","space","time"].indexOf(a)&&((e=$("<div/>",{id:"toggle-all-items-"+a,text:ee("ui.disable.all"),css:{cursor:"pointer",display:"inline-block",textShadow:"3px 3px 4px gray",marginRight:"8px"}})).on("click",function(){var e=t.children().children(":checkbox");e.prop("checked",!1),e.change(),t.children().children(":checkbox").change()}),t.append(e),(e=$("<div/>",{id:"toggle-all-items-"+a,text:ee("ui.enable.all"),css:{cursor:"pointer",display:"inline-block",textShadow:"3px 3px 4px gray"}})).on("click",function(){var e=t.children().children(":checkbox");e.prop("checked",!0),e.change(),t.children().children(":checkbox").change(),"filter"===a&&ae.auto.filter.items.miscFilter.enabled&&$("#toggle-miscFilter").click()}),t.append(e)),t},h=function(t){let e,a,i,r,l=se(ee("ui."+t)),o=ae.auto[t];var n=$("<li/>",{id:"ks-"+t}),s=$("<label/>",{for:"toggle-"+t,text:l});let c=$("<input/>",{id:"toggle-"+t,type:"checkbox"});if(o.enabled&&c.prop("checked",!0),"engine"!==t&&c.on("change",function(){c.is(":checked")&&!o.enabled?(o.enabled=!0,"filter"===t||"options"===t?C("status.sub.enable",[l]):C("status.auto.enable",[l]),B()):!c.is(":checked")&&o.enabled&&(o.enabled=!1,"filter"===t||"options"===t?C("status.sub.disable",[l]):C("status.auto.disable",[l]),B())}),n.append(c,s),o.items){if(n.css("borderBottom","1px  solid rgba(185, 185, 185, 0.7)"),i=$("<div/>",{css:{display:"inline-block",float:"right"}}),r=$("<div/>",{id:"toggle-items-"+t,text:ee("ui.items"),css:P}),n.append(r),e=p(t),"faith"===t)for(a in ae.auto.unicorn.items)e.append(v(a,ae.auto.unicorn.items[a]));for(a in o.items)switch(t){case"trade":e.append(function(e,a){let t=se(ee("$trade.race."+e)),i=v(e,a,t),r=(i.css("borderBottom","1px solid rgba(185, 185, 185, 0.7)"),$("<label/>",{for:"toggle-limited-"+e,title:ee("trade.limited",[t]),text:ee("ui.tradeLimit")})),l=$("<input/>",{id:"toggle-limited-"+e,type:"checkbox"}).data("option",a);if(a.limited)l.prop("checked",true);l.on("change",function(){if(l.is(":checked")&&a.limited===false){a.limited=true;C("trade.limited",[t])}else if(!l.is(":checked")&&a.limited){a.limited=false;let e=a.require?"需同时满足资源黄金和"+te[a.require].title+"的触发条件才":"资源满足黄金的触发条件就会";C("trade.unlimited",[t,e])}V.items[l.attr("id")]=a.limited;B()}),i.append(l,r);let o=$("<div/>",{id:"toggle-seasons-"+e,text:ee("trade.seasons"),css:P}),n=$("<ul/>",{id:"seasons-list-"+e,css:{display:"none",paddingLeft:"20px"}});return n.append(f(e,"spring",a)),n.append(f(e,"summer",a)),n.append(f(e,"autumn",a)),n.append(f(e,"winter",a)),o.on("click",function(){n.toggle()}),i.append(o,n),i}(a,o.items[a]));break;case"craft":e.append(function(e,t){let i=se(ee("$resources."+e+".title"));if(e==="ship")i=se(ee("$workshop.crafts."+e+".label"));let r=v(e,t,i);if("parchment"!==e){var l=$("<label/>",{for:"toggle-limited-"+e,title:ee("craft.limitedTitle"),text:ee("ui.craftLimit")});let a=$("<input/>",{id:"toggle-limited-"+e,type:"checkbox"}).data("option",t);t.limited&&a.prop("checked",!0),a.on("change",function(){var e;a.is(":checked")&&!t.limited?(t.limited=!0,C("craft.limited",[i]),ce("craftLimited")):!a.is(":checked")&&t.limited&&(t.limited=!1,e=t.require?te[t.require].title+"满足触发资源的触发条件才会制作，":"无，当资源满足制作条件就会制作",C("craft.unlimited",[i,e])),V.items[a.attr("id")]=t.limited,B()}),r.append(a,l)}return r}(a,o.items[a]));break;case"timeCtrl":e.append(function(l,o){let n,u=v(l,o);if(l==="timeSkip"){n=$("<div/>",{id:"set-timeSkip-subTrigger",text:ee("ui.trigger"),title:o.subTrigger,css:P}).data("option",o);n.on("click",function(){let e;q.stop(false);e=window.prompt(ee("time.skip.trigger.set",[]),o.subTrigger);if(ae.auto.engine.enabled)q.start(false);if(e!==null){o.subTrigger=parseFloat(e);V.items[n.attr("id")]=o.subTrigger;B();n[0].title=o.subTrigger}});let a=$("<div/>",{id:"set-timeSkip-maximum",text:ee("ui.maximum"),title:o.max,css:P}).data("option",o);a.on("click",function(){let e;q.stop(false);e=window.prompt(ee("ui.max.set",["每次燃烧时间水晶"]),o.maximum.toString());if(ae.auto.engine.enabled)q.start(false);if(e!==null){o.maximum=parseFloat(e);V.items[a.attr("id")]=o.maximum;B();a[0].title=o.maximum}});let e=$("<div/>",{id:"toggle-cycle-"+l,text:ee("ui.cycles"),css:P});let t=$("<ul/>",{id:"cycles-list-"+l,css:{display:"none",paddingLeft:"20px"}});for(let e in game.calendar.cycles)t.append(x(e,o));let i=$("<div/>",{id:"toggle-seasons-"+l,text:ee("trade.seasons"),css:P});let r=$("<ul/>",{id:"seasons-list-"+l,css:{display:"none",paddingLeft:"20px"}});r.append(b("spring",o));r.append(b("summer",o));r.append(b("autumn",o));r.append(b("winter",o));e.on("click",function(){t.toggle();r.toggle(false)});i.on("click",function(){t.toggle(false);r.toggle()});u.append(e,i,a,n,t,r)}else if(l==="reset"){let e;let a=p("reset-build");let t=p("reset-space");let i=d(true);let r=p("reset-religion");let l=p("reset-time");for(e in ae.auto.build.items)a.append(R(e,"build",ae.auto.build.items[e]));for(e in ae.auto.space.items)t.append(R(e,"space",ae.auto.space.items[e]));for(e in ae.auto.unicorn.items)r.append(R(e,"unicorn",ae.auto.unicorn.items[e]));for(e in ae.auto.faith.items)r.append(R(e,"faith",ae.auto.faith.items[e]));for(e in ae.auto.time.items)l.append(R(e,"time",ae.auto.time.items[e]));let o=$("<div/>",{id:"toggle-reset-build",text:ee("ui.build"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let n=$("<div/>",{id:"toggle-reset-space",text:ee("ui.space"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let s=$("<div/>",{id:"toggle-reset-resources",text:ee("ui.craft.resources"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let c=$("<div/>",{id:"toggle-reset-religion",text:ee("ui.faith"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});let g=$("<div/>",{id:"toggle-reset-time",text:ee("ui.time"),css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",textShadow:"3px 3px 4px gray"}});o.on("click",function(){a.toggle();t.toggle(false);i.toggle(false);r.toggle(false);l.toggle(false)});n.on("click",function(){a.toggle(false);t.toggle();i.toggle(false);r.toggle(false);l.toggle(false)});s.on("click",function(){a.toggle(false);t.toggle(false);i.toggle();r.toggle(false);l.toggle(false)});c.on("click",function(){a.toggle(false);t.toggle(false);i.toggle(false);r.toggle();l.toggle(false)});g.on("click",function(){a.toggle(false);t.toggle(false);i.toggle(false);r.toggle(false);l.toggle()});u.append(o,n,s,c,g,a,t,i,r,l)}else{n=$("<div/>",{id:"set-"+l+"-subTrigger",text:ee("ui.trigger"),title:o.subTrigger,css:P}).data("option",o);n.on("click",function(){let e;e=window.prompt(ee("ui.trigger.set",[o.label]),o.subTrigger);if(e!==null){o.subTrigger=parseFloat(e);V.items[n.attr("id")]=o.subTrigger;B();n[0].title=o.subTrigger}});u.append(n)}return u}(a,o.items[a]));break;case"options":e.append(function(i,r){if("festival"!==i){let t;var e=v(i,r),a,l,o;if("style"===i&&((t=e.children("input")).unbind("change"),t.on("change",function(e){r.enabled=t.prop("checked"),V.items[t.attr("id")]=r.enabled,e.originalEvent&&B();e=document.getElementById("toggleCenter").style;r.enabled?(document.body.setAttribute("data-ks-style",""),game.ui.isCenter||(e.display="none")):(document.body.removeAttribute("data-ks-style"),e.display="")})),"useWorkers"===i&&(t=e.children("input")).on("click",function(){var e=confirm(ee("ui.trigger.useWorkers.alert"));e&&!r.enabled?(q.stop(),r.enabled=!0,V.items[t.attr("id")]=r.enabled,ae.auto.engine.enabled&&q.start()):e&&r.enabled&&(q.stop(),r.enabled=!1,V.items[t.attr("id")]=r.enabled,ae.auto.engine.enabled)&&q.start()}),"saves"===i&&((t=e.children("input")).on("click",function(){var e,a;q.stop(!1),window.confirm("点击确认会导出珂学家的配置.txt文件")&&(e=$("#download-link"),a=JSON.stringify(window.localStorage["cbc.kitten-scientists"]),a=game.compressLZData(a,!1),a=new Blob([a],{type:"text/plain"}),e.attr("href",window.URL.createObjectURL(a)),a="小猫珂学家配置"+(game.stats.getStat("totalResets").val+1)+"周目",e.attr("download",a+".txt"),e.get(0).dispatchEvent(new MouseEvent("click"))),ae.auto.engine.enabled&&q.start(!1)}),(a=$("<div/>",{id:"loadKS",text:"导入配置",css:P}).data("option",r)).on("click",function(){q.stop(!1);var a=window.prompt("窗口内填入后你需要导入的珂学家配置，确认后会导入配置","");if(ae.auto.engine.enabled&&q.start(!1),a&&10<=a.length){let e;"{"!==a.charAt(0)&&(e=JSON.parse(LZString.decompressFromBase64(a))),window.localStorage["cbc.kitten-scientists"]=e,O()}}),(l=$("<div/>",{id:"ressetKS",text:"恢复初始默认配置",css:{cursor:"pointer",display:"inline-block",float:"right",paddingRight:"5px",color:"#FF6347"}})).on("click",function(){var e;confirm("确定要初始化珂学家配置吗，点击确认后初始化珂学家配置\n已经替你完美配置好不需要你改任何设置\n只需勾上你需要的对应的大项目就是最快速度发展了\n\n为了照顾钢铁模式，默认配置小屋、木屋、宅邸默认不勾，请有需要的自行勾上")&&(q.stop(),e=sessionStorage.getItem("options"),delete localStorage["cbc.kitten-scientists"],e?($("#ks-options").remove(),ae.auto=JSON.parse(e).auto,D(),E=$("<div/>",{id:"ks-options",css:{marginBottom:"10px"}}),(T=$("<ul/>")).append(h("engine")),U.forEach(e=>{T.append(h(e))}),E.append(T),M.prepend(E),K(),W()):(game.save(),window.location.reload()))}),e.append(a),e.append(l)),"donate"===i&&((t=e.children("input")).unbind("change"),t.on("change",function(e){r.enabled=t.prop("checked"),V.items[t.attr("id")]=r.enabled,e.originalEvent&&B();let a=document.getElementById("ks-donate").style;r.enabled?a.display="block":a.display="none",a=null})),"wiki"===i&&(o=$("<a/>",{css:{display:"inline-block",transformOrigin:"bottom",fontStyle:"italic",transform:"scale(0.63)"},href:"https://petercheney.gitee.io/",target:"_blank",text:"Cheney"}),e.append(o),(t=e.children("input")).on("click",function(){window.open().location="https://petercheney.gitee.io/baike/?file=004-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B7%A5%E5%85%B7/02-%E5%B0%8F%E7%8C%AB%E7%A7%91%E5%AD%A6%E5%AE%B6",G(["如果还有问题可以在猫国群询问，有BUG或意见可以联系Cheney。初始默认配置即推荐挂机高效配置","ks-default",ae.activityColor])})),void 0!==r.subTrigger){let a=$("<div/>",{id:"set-"+i+"-subTrigger",text:ee("ui.trigger"),title:r.subTrigger,css:P}).data("option",r);a.on("click",function(){let e;q.stop(!1),e="crypto"===i?window.prompt(ee("ui.trigger.crypto.set",[r.label]),r.subTrigger):"filterGame"===i?window.prompt(ee("ui.trigger.filterGame.set"),r.subTrigger):window.prompt(ee("ui.trigger.set",[r.label]),r.subTrigger),ae.auto.engine.enabled&&q.start(!1),null!==e&&("crypto"===i?r.subTrigger=e:"filterGame"===i?(r.subTrigger=parseFloat(e),_()):r.subTrigger=parseFloat(e),V.items[a.attr("id")]=r.subTrigger,B(),a[0].title=r.subTrigger)}),e.append(a)}return e}}(a,o.items[a]));break;case"upgrade":e.append(function(t,o){let i=ee("ui.upgrade."+t),n=v(t,o,i);if(t==="policies"){let i=$("<ul/>",{id:"items-list-policies",css:{display:"none",paddingLeft:"20px"}});let e=$("<label/>",{for:"toggle-policies-auto",text:"自动推荐政策",css:{display:"inline-block",minWidth:"80px",color:"#FF6600"}});let a=$("<input/>",{id:"toggle-policies-auto",type:"checkbox"}).data("option",o);if(o.auto)a.prop("checked",true);a.on("change",function(){if(a.is(":checked")&&!o.auto){q.stop(false);let e=window.confirm("珂学家自动根据Cheney写的萌新指导和政策解析自动点推荐的政策\n不重置的慎用建议看百科\n注意确认后会优先自动的而不是读取的列表(挑战模式自动会取消勾选政策)\n如需想自己选政策请按取消\n需要启用政策\n\n\n让聪明的猫猫来帮你选择吧❤");if(ae.auto.engine.enabled)q.start(false);if(e){o.auto=true;F("自动点推荐政策(代替列表)")}}if(!a.is(":checked")&&o.auto){o.auto=false;F("取消自动点推荐政策代替列表")}V.items[a.attr("id")]=o.auto;B()});n.append(a,e);let t=$("<a/>",{id:"toggle-upgrade-policies-wiki",text:"政策推荐",href:"https://petercheney.gitee.io/baike/?file=000-%E7%8C%AB%E5%9B%BD%E8%90%8C%E6%96%B0%E6%8C%87%E5%AF%BC/02-%E6%94%BF%E7%AD%96%E6%95%88%E6%9E%9C%E8%A7%A3%E6%9E%90#%E5%86%85%E4%BA%8B",target:"_blank",css:P});let r=$("<div/>",{id:"toggle-upgrade-policies-load",text:ee("ui.upgrade.policies.load"),css:P});let l=$("<div/>",{id:"toggle-upgrade-policies-show",text:ee("ui.upgrade.policies.show"),css:P});r.on("click",function(){const a=[];for(const t in game.science.policies){let e=game.science.policies[t];if(e.researched)a.push(e.name)}ae.policies=a;B();i.empty();k().forEach(e=>{i.append(e)})});l.on("click",function(){i.toggle();i.empty();k().forEach(e=>{i.append(e)})});n.append(l,r,t,i)}if(o.subTrigger!==undefined&&t==="missions"){let a=$("<div/>",{id:"set-"+t+"-subTrigger",text:ee("ui.trigger"),title:o.subTrigger,css:P}).data("option",o);a.on("click",function(){let e;q.stop(false);if(t==="missions")e=window.prompt(ee("ui.trigger.missions.set"),o.subTrigger.toString());else e=window.prompt(ee("ui.trigger.set"),o.subTrigger.toString());if(ae.auto.engine.enabled)q.start(false);if(e!==null){o.subTrigger=parseFloat(e);V.items[a.attr("id")]=o.subTrigger;B();a[0].title=o.subTrigger}});n.append(a)}if(t==="upgrades"||t==="techs"){let e=$("<label/>",{for:"toggle-limited-"+t,text:ee("ui.upgradesLimit")});let a=$("<input/>",{id:"toggle-limited-"+t,type:"checkbox"}).data("option",o);if(o.limited)a.prop("checked",true);a.on("change",function(){if(a.is(":checked")&&!o.limited){o.limited=true;C("upgrade.limited",[i])}else if(!a.is(":checked")&&o.limited){o.limited=false;C("upgrade.unlimited",[i])}V.items[a.attr("id")]=o.limited;B()});n.append(a,e)}return n}(a,o.items[a]));break;case"distribute":e.append(function(e,a){if(e==="leader")return w(e,a);let t=se(ee("$village.job."+e)),i=v(e,a,t),r=(i.css("borderBottom","1px solid rgba(185, 185, 185, 0.7)"),$("<label/>",{for:"toggle-limited-"+e,text:ee("ui.distributeLimit")})),l=$("<input/>",{id:"toggle-limited-"+e,type:"checkbox"}).data("option",a);if(a.limited)l.prop("checked",true);l.on("change",function(){if(l.is(":checked")&&!a.limited){a.limited=true;C("distribute.limited",[t])}else if(!l.is(":checked")&&a.limited){a.limited=false;C("distribute.unlimited",[t])}V.items[l.attr("id")]=a.limited;B()}),i.append(l,r);let o=$("<div/>",{id:"set-"+e+"-max",text:ee("ui.max",[a.max]),title:a.max,css:P}).data("option",a);var n=t;return o.on("click",function(){let e;q.stop(false);e=window.prompt(ee("ui.max.set",[n])+" （按max比例分配）",a.max.toString());if(ae.auto.engine.enabled)q.start(false);if(e!==null){a.max=Math.max(0,parseInt(e));V.items[o.attr("id")]=a.max;B();o[0].title=a.max;o[0].innerText=ee("ui.max",[a.max])}}),i.append(o),i}(a,o.items[a]));break;case"build":case"faith":case"space":case"time":e.append(y(a,o.items[a]));break;default:e.append(v(a,o.items[a]))}r.on("click",function(){e.toggle()})}if(void 0!==o.trigger){let a=$("<div/>",{id:"trigger-"+t,text:ee("ui.trigger"),title:o.trigger,css:P});a.on("click",function(){let e;q.stop(!1),e="faith"===t?window.prompt(ee("ui.trigger.set",[l+"("+$I("resources.faith.title")+")"]),o.trigger.toString()):"trade"===t?window.prompt(ee("ui.trigger.set",[l+" 的触发值\n需同时满足 种族触发资源 和 "+$I("resources.gold.title")+" 的"]),o.trigger.toString()):window.prompt(ee("ui.trigger.set",[l]),o.trigger.toString()),ae.auto.engine.enabled&&q.start(!1),null!==e&&(o.trigger=parseFloat(e),B(),a[0].title=o.trigger)}),n.append(a)}if("craft"===t){s=$("<div/>",{id:"toggle-resource-controls",text:ee("ui.craft.resources"),css:P});const g=d();r.on("click",function(){g.toggle(!1)}),s.on("click",function(){e.toggle(!1),g.toggle()}),n.append(s),n.append(g)}else if("faith"===t){s=$("<div/>",{id:"toggle-addition-controls",text:ee("ui.faith.addition"),title:"太阳教团的自动化项目",css:P});const u=function(){var e,a=p("faith-addition");let t=ae.auto.faith.addition;for(e in t){let i=t[e];var l,o=v(e,i);"bestUnicornBuilding"===e&&(o.children("label").prop("title",ee("option.faith.best.unicorn.desc")),(l=o.children("input")).unbind("change"),l.on("change",e=>{var a=t.bestUnicornBuilding;e.target.checked&&!a.enabled?(a.enabled=!0,C("status.sub.enable",[ee("option.faith.best.unicorn")]),C("option.faith.best.unicorn.desc")):!e.target.checked&&a.enabled&&(a.enabled=!1,C("status.sub.disable",[ee("option.faith.best.unicorn")])),V.items[e.target.id]=a.enabled,B()}));let r=i.subTrigger;void 0!==r&&(l=$("<div/>",{id:"set-"+e+"-subTrigger",text:ee("ui.trigger"),title:r,css:P}).data("option",i),function(a,t){"adore"!==a&&"autoPraise"!==a&&"tcRefine"!==a||t.on("click",function(){var e;q.stop(!1),e=window.prompt(ee(a+".trigger.set"),r+""),ae.auto.engine.enabled&&q.start(!1),null!==e&&(i.subTrigger=parseFloat(e),V.items[t[0].id]=i.subTrigger,B(),t[0].title=i.subTrigger)})}(e,l),o.append(l)),a.append(o)}return a}();r.on("click",function(){u.toggle(!1)}),s.on("click",function(){e.toggle(!1),u.toggle()}),n.append(s);for(const m in ae.auto.unicorn.items)e.children().children("#toggle-"+m).on("change",function(e){$(e.target).is(":checked")||((e=$("#toggle-bestUnicornBuilding")).prop("checked",!1),e.trigger("change"))});n.append(u)}return o.items&&n.append(i,e),n},f=function(e,a,t){let i=se(ee("$trade.race."+e)),r=se(ee("$calendar.season."+a));var l=$("<li/>"),o=$("<label/>",{for:"toggle-"+e+"-"+a,text:se(r)});let n=$("<input/>",{id:"toggle-"+e+"-"+a,type:"checkbox"}).data("option",t);return t[a]&&n.prop("checked",!0),n.on("change",function(){n.is(":checked")&&!t[a]?(t[a]=!0,C("trade.season.enable",[i,r])):!n.is(":checked")&&t[a]&&(t[a]=!1,C("trade.season.disable",[i,r])),V.items[n.attr("id")]=t[a],B()}),l.append(n,o),l},b=function(e,a){let t=se(ee("$calendar.season."+e));var i=$("<li/>"),r=$("<label/>",{for:"toggle-timeSkip-"+e,text:se(t)});let l=$("<input/>",{id:"toggle-timeSkip-"+e,type:"checkbox"}).data("option",a);return a[e]&&l.prop("checked",!0),l.on("change",function(){l.is(":checked")&&!a[e]?(a[e]=!0,C("time.skip.season.enable",[t])):!l.is(":checked")&&a[e]&&(a[e]=!1,C("time.skip.season.disable",[t])),V.items[l.attr("id")]=a[e],B()}),i.append(l,r),i},v=function(e,a,t){var i=$("<li/>");let r=t||a.label||se(e);t=(t=a.require)?game.resPool.get(t).title:ee("ui.none");let l=ee("ui.trigger.resource")+": "+t;void 0===a.require&&(l=null);t=$("<label/>",{for:"toggle-"+e,text:r,title:l,css:{display:"inline-block",minWidth:"80px"}});let o=$("<input/>",{id:"toggle-"+e,type:"checkbox"}).data("option",a);return a.enabled&&o.prop("checked",!0),o.on("change",function(){o.is(":checked")&&!a.enabled?(a.enabled=!0,-1<e.indexOf("Filter")?C("filter.enable",[r]):a.misc?C("status.sub.enable",[r]):(C("status.auto.enable",[r]),"wood"===e&&C("msg.catnip"))):!o.is(":checked")&&a.enabled&&(a.enabled=!1,-1<e.indexOf("Filter")?C("filter.disable",[r]):a.misc?C("status.sub.disable",[r]):C("status.auto.disable",[r])),V.items[o.attr("id")]=a.enabled,"saves"!==e&&B()}),i.append(o,t),i},k=function(e){var a,t=[];for(a in ae.policies){let e=ae.policies[a];"authocracy"===e&&(e="autocracy"),t.push($("<div/>",{id:"policy-"+e,text:ee("$policy."+e+".label"),css:{cursor:"pointer",textShadow:"3px 3px 4px gray"}}))}return t},y=function(e,a,t){var i=$("<li/>");let r=t||a.label||se(e);t=a.require?game.resPool.get(a.require).title:ee("ui.none"),t=$("<label/>",{for:"toggle-"+e,text:r,title:ee("ui.trigger.resource")+": "+t,css:{display:"inline-block",minWidth:"80px"}});let l=$("<input/>",{id:"toggle-"+e,type:"checkbox"}).data("option",a),o=(a.enabled&&l.prop("checked",!0),l.on("change",function(){l.is(":checked")&&!a.enabled?(a.enabled=!0,-1<e.indexOf("Filter")?C("filter.enable",[r]):a.misc?C("status.sub.enable",[r]):(C("status.auto.enable",[r]),"field"===e&&C("msg.catnip"))):!l.is(":checked")&&a.enabled&&(a.enabled=!1,-1<e.indexOf("Filter")?C("filter.disable",[r]):a.misc?C("status.sub.disable",[r]):C("status.auto.disable",[r])),V.items[l.attr("id")]=a.enabled,B()}),$("<div/>",{id:"set-"+e+"-max",text:ee("ui.max",[a.max]),title:a.max,css:P}).data("option",a));return o.on("click",function(){var e;q.stop(!1),e=window.prompt(ee("ui.max.set",[a.label])+"\n -1为没有上限",a.max.toString()),ae.auto.engine.enabled&&q.start(!1),null!==e&&(a.max=parseInt(e),V.items[o.attr("id")]=a.max,B(),o[0].title=a.max,o[0].innerText=ee("ui.max",[a.max]))}),i.append(l,t,o),i},x=function(e,a){let t=game.calendar.cycles[e];var i=$("<li/>"),r=$("<label/>",{for:"toggle-timeSkip-"+e,text:t.title});let l=$("<input/>",{id:"toggle-timeSkip-"+e,type:"checkbox"}).data("option",a);return a[e]&&l.prop("checked",!0),l.on("change",function(){l.is(":checked")&&!a[e]?(a[e]=!0,C("time.skip.cycle.enable",[t.title])):!l.is(":checked")&&a[e]&&(a[e]=!1,C("time.skip.cycle.disable",[t.title])),V.items[l.attr("id")]=a[e],B()}),i.append(l,r),i},R=function(e,a,t){var i=$("<li/>");let r=t.label;var l=$("<label/>",{for:"toggle-reset-"+a+"-"+e,text:r,css:{display:"inline-block",minWidth:"80px"}});let o=$("<input/>",{id:"toggle-reset-"+a+"-"+e,type:"checkbox"}).data("option",t),n=(t.checkForReset&&o.prop("checked",!0),o.on("change",function(){o.is(":checked")&&!t.checkForReset?(t.checkForReset=!0,C("status.reset.check.enable",[r])):!o.is(":checked")&&t.checkForReset&&(t.checkForReset=!1,C("status.reset.check.disable",[r])),V.items[o.attr("id")]=t.checkForReset,B()}),$("<div/>",{id:"set-reset-"+a+"-"+e+"-min",text:ee("ui.min",[t.triggerForReset]),title:t.triggerForReset,css:P}).data("option",t));return n.on("click",function(){var e=window.prompt(ee("reset.check.trigger.set",[t.label]),t.triggerForReset.toString());null!==e&&(t.triggerForReset=parseInt(e),V.items[n.attr("id")]=t.triggerForReset,B(),n[0].title=t.triggerForReset,n[0].innerText=ee("ui.min",[t.triggerForReset]))}),i.append(o,l,n),i},w=function(e,a){let t;var i=se(ee("distribute.makeLeader")),i=v(e,a,i);i.css("borderBottom","1px solid rgba(185, 185, 185, 0.7)");let r=$("<ul/>",{id:"items-list-traits",css:{display:"none",paddingLeft:"20px"}});var l=$("<div/>",{id:"toggle-leaderTrait"+e,text:ee("$village.trait.filter.all"),css:P});for(t in window.com.nuclearunicorn.game.village.Kitten().traits)r.append(c(t,a));l.on("click",function(){o.toggle(!1),r.toggle()});let o=$("<ul/>",{id:"items-list-jobs",css:{display:"none",paddingLeft:"20px"}});e=$("<div/>",{id:"toggle-leaderJob"+e,text:ee("$village.panel.job"),css:P});for(t in game.village.jobs)o.append(s(t,a));return e.on("click",function(){r.toggle(!1),o.toggle()}),i.append(l,e,r,o),i},s=function(e,a){let t=game.village.jobs,i=t[e];var e=$("<li/>"),r=$("<label/>",{for:"toggle-leaderJob-"+i.name,text:i.title,css:{cursor:"pointer",textShadow:"3px 3px 4px gray"}}),l=$("<input/>",{id:"toggle-leaderJob-"+i.name,name:"leaderJob",value:i.name,type:"radio"}).data("option",a);return l.prop("value")===a.leaderJob&&l.prop("checked",!0),l.on("change",function(){C("distribute.leaderJob",[i.title]),a.leaderJob=$("input[name='leaderJob']:checked").val(),t.forEach(e=>{delete V.items["toggle-leaderJob-"+e.name]}),V.items["toggle-leaderJob-"+a.leaderJob]=!0,B()}),e.append(l,r),e},c=function(e,a){let t=window.com.nuclearunicorn.game.village.Kitten().traits;const i=t[e];var e=$("<li/>"),r=$("<label/>",{for:"toggle-leaderTrait-"+i.name,text:i.title,css:{cursor:"pointer",textShadow:"3px 3px 4px gray"}}),l=$("<input/>",{id:"toggle-leaderTrait-"+i.name,name:"leaderTrait",value:i.name,type:"radio"}).data("option",a);return l.prop("value")===a.leaderTrait&&l.prop("checked",!0),l.on("change",function(){C("distribute.leaderTrait",[i.title]),a.leaderTrait=$(this).val(),t.forEach(e=>{delete V.items["toggle-leaderTrait-"+e.name]}),V.items["toggle-leaderTrait-"+a.leaderTrait]=!0,B()}),e.append(l,r),e},M=$("#rightColumn"),E=$("<div/>",{id:"ks-options",css:{marginBottom:"10px"}}),T=$("<ul/>");T.append(h("engine")),U.forEach(e=>{T.append(h(e))});r="1HDV6VEnXH9m8PJuT4eQD7v8jRnucbneaq",(r=$("<li/>",{id:"ks-donate"}).append($("<a/>",{href:"bitcoin:"+r+"?amount=0.00048&label=Kittens Donation",target:"_blank",text:r})).prepend($('<img alt="bit" src="https://s1.ax1x.com/2022/04/30/OSmUAK.png" height="15px" />',{css:{height:"15px",width:"15px",padding:"3px 4px 0 4px",verticalAlign:"bottom"}}))).css("padding","5px"),T.append(r),E.append(T),M.prepend(E)}r=ae.auto.build.items;ae.auto.build.items=Object.assign({amphitheatre:r.amphitheatre,reactor:r.reactor,magneto:r.magneto,steamworks:r.steamworks},r),r=ae.auto.space.items,ae.auto.space.items=Object.assign({researchVessel:r.researchVessel,moonOutpost:r.moonOutpost},r);let ce=(e,a,t)=>{if(a)ue.other["auto."+e]=null;else{if(ue.other["auto."+e])return!0;t=t||"miscFilter",ie(ee("summary.auto."+e),t),me("auto."+e)}},ge=e=>{for(var a in e){a=e[a];me(a.name,a.val,"resConsume")}},ue,N=function(){var e=game.calendar;ue={lastYear:e.year,lastTrueYear:e.trueYear(),lastDay:e.day,lastSeason:e.season,ksTime:0,totalTicks:0,praise:[0,0],adore:[0,0],craft:{},trade:{},build:{},other:{},resGain:{},resConsume:{},research:{}}},me=(N(),function(e,a,t){void 0===a&&(a=1),void 0===t&&(t="other"),void 0===ue[t]&&(ue[t]={}),void 0===ue[t][e]?ue[t][e]=parseFloat(a):ue[t][e]+=parseFloat(a)});let M=e=>{var a=ue[e],t=a[0],a=game.getDisplayValueExt(a[1]);t&&x("summary."+e,[game.getDisplayValueExt(t),a])};var r=$("<div/>",{id:"activity-box",css:{display:"inline-block",verticalAlign:"top"}}),n=$("<a/>",{id:"showActivityHref",text:ee("summary.show"),href:"#",css:{verticalAlign:"top"}});n.on("click",function(){game.console.messages.length>game.console.maxMessages-250&&game.clearLog(),Y();var e="=".repeat(24);let a,t,i;var r=ue.resGain;for(t in r){var l=r[t];l&&(i=game.msg("小喵共获得了 "+game.getDisplayValueExt(l)+" "+$I("resources."+t+".title"),null,null,!0),$(i.span).css("color","#ff589c"))}i&&(game.msg(e,"notice"),i=null);var o=ue.resConsume,n=game.resPool.resources;for(let e=n.length-1;0<e&&o;e--){var s=o[t=n[e].name];s&&(i=game.msg("小喵共消耗了 "+game.getDisplayValueExt(s)+" "+$I("resources."+t+".title"),null,null,!0),$(i.span).css("color","#DC143C"))}i&&game.msg(e,"notice");var c=ue.other;for(const k in c){var g=c[k];g&&(g="number"==typeof g?game.getDisplayValueExt(g):g,x("summary."+k,[g]))}M("praise"),M("adore");var u=ue.research;for(t in u)a=(a=u[t])?"科学家":"",x("summary.tech",[a+"小猫研究了 "+se(t)]);for(t in ue.upgrade)a=(a=ue.upgrade[t])?"科学家":"",x("summary.upgrade",[a+"小猫发明了 "+se(t)]);["faith","build","craft","craftLeader","trade"].forEach(e=>{var a,t=ue[e];for(a in t)x("summary."+e,[game.getDisplayValueExt(t[a]),se(a)])});var m=ue.lastYear,d=ue.lastDay;if(m+d){var p=game.calendar,m=p.year-m,d=p.day-d,h=p.trueYear()-ue.lastTrueYear,f=p.season-ue.lastSeason,b=p.daysPerSeason,v=p.seasonsPerYear;let e="";400<=(d=d+400*m+f*b)&&(e=(e+=m+" ")+(1==m?ee("summary.year"):ee("summary.years"))),0<=d&&(0<m&&(e+=ee("summary.separator")),e=(e+=(f=d%400,+(Math.round(+(f+"e+2"))+"e-2")+" "))+(1==d?ee("summary.day"):ee("summary.days"))),x("summary.head",[e]),0<h&&(m=game.toDisplaySeconds(h*v*b*p.ticksPerDay/game.ticksPerSecond))&&y("总共 "+m+" 的小喵种田时间")}f=ae.auto.filter,f.enabled&&f.items.craftFilter.enabled&&f.items.buildFilter.enabled&&!game.console.filters.faith.enabled&&!game.console.filters.astronomicalEvent.enabled||game.msg("喵喵提示：游戏(珂学家)日志消耗性能会比较多!","alert"),d=ue.ksTime;if(d){h=ue.totalTicks;let i=Math.pow(10,2+game.opts.forceHighPrecision);y(ee("time.ks",[h,(e=>{var a=Math.round(e*i)/i;let t=Math.round(e%1e3*i)/i;return t=1e3<e?game.toDisplaySeconds(Math.floor(a/1e3))+t:t})(d),Math.round(d*i/h)/i])),y(e)}N()}),r.append(n),$("#clearLog").append(r);const s=$("<div/>",{id:"important-msg-box",class:"dialog help",css:{display:"none",width:"auto",height:"auto"}});n=$("<a/>",{text:ee("ui.close"),href:"#",css:{position:"absolute",top:"10px",right:"15px"}});n.on("click",function(){s.toggle()});let E=$("<h1/>",{id:"mb-title",text:"test text"}),T=$("<h1/>",{id:"mb-content",text:"test text"});s.append(n,E,T),$("#gamePageContainer").append(s);let q=new p,c,K=()=>{(c=$("#toggle-engine")).on("change",function(){let e=ae.auto.engine;c.is(":checked")?(e.enabled=!0,q.start(),Y(),setTimeout(()=>{e.enabled&&(F("如需查看小喵做过什么，可以点击小猫总结(清空日志旁边)"),F("如需没网络也能离线打开珂学家，可以点击左上角 ML 右边第一个 C 进入Cheney的备用站,该网站离线可以用珂学家"))},4e3),ae.auto.options.enabled&&(ie("小喵杂项已开启~智慧喵喵<br>1. 喵喵自动节日已开启<br>2. 喵喵冬季最后一天的能源管理<br>3. 喵喵自动打开因资源耗尽关闭的工业建筑"),game.stats.statGroups[0].group[2].val<1e3)&&(ae.auto.filter.items.miscFilter.enabled=!1),-.03<game.getEffect("priceRatio")&&oe.transcendenceTier<4&&(ce("ksHelp",!1,"noFilter"),ce("ksHelp2",!1,"noFilter"),!game.stats.getStat("totalResets").val&&1e4<oe.faith&&ce("ksHelp3",!1,"noFilter"),ce("ksHelp4",!1,"noFilter"),ce("ksHelp5",!1,"noFilter")),ce("miao",!1,"noFilter")):(e.enabled=!1,q.stop())});var e=$("<a/>",{css:{display:"inline-block",textShadow:"1px 1px 1px gray",transformOrigin:"bottom",fontStyle:"italic",transform:"scale(0.8)",paddingLeft:"3px"},text:m,target:"_blank",href:"https://petercheney.gitee.io/scientists/updateLog.html?v="+(new Date).getDate()});$("#ks-engine").append(e)},_=(K(),ae.auto.cache.dataTimer.trueYear=game.calendar.trueYear(),ae.auto.cache.dataTimer.ticksTotal=game.timer.ticksTotal,ae.auto.cache.dataTimer.saveId=game.telemetry.guid,sessionStorage.setItem("options",JSON.stringify(ae)),O(),()=>{game.console.maxMessages=Math.min(Math.max(300,ae.auto.options.items.filterGame.subTrigger),2e3)}),Y=(_(),$("#toggle-style").trigger("change"),$("#toggle-donate").trigger("change"),$("#ks-donate")[0].style.display="none",console&&console.log&&console.log(d+" loaded"),game._publish("kitten_scientists/ready",d),()=>{var e,a=ae.auto.resources;let t;for(e in a){var i,r=a[e];r.enabled&&(r.stock?"furs"===e&&350===r.stock||(t=!0,i=game.msg($I("resources."+e+".title")+"库存："+game.getDisplayValueExt(r.stock),null,null,!0),$(i.span).css("color","#ff589c")):.6===r.consume&&delete ae.auto.resources[e])}t&&(ie("小喵留下设置好的库存："),F("可爱的猫猫珂学家提示设置库存会影响挂机效率")),ce("ksHelp4")});V.reset&&V.reset.reset?(V.reset.karmaTotal+=te.karma.value-Number(V.reset.karmaLastTime),V.reset.paraonTotal+=te.paragon.value-Number(V.reset.paragonLastTime),V.reset.reset=!1,r=ee("summary.time.reset.title",[V.reset.times]),n=ee("summary.time.reset.content",[V.reset.karmaTotal,V.reset.paragonTotal]),E.html(r),T.html(n),s.toggle(),c.prop("checked",!0),c.trigger("change"),C("reset.after")):V.reset={reset:!1,times:0,paragonLastTime:0,paragonTotal:0,karmaLastTime:0,karmaTotal:0},B();let Z=setInterval(function(){var e;!ae.auto.engine.enabled&&ae.auto.options.items.autoScientists.enabled?0===(e=ae.countdown)?(c.click(),clearInterval(Z),C("reset.after")):10<e?(e%60==0&&C("auto.tip"),e%10==0&&Q("auto.countdown",[e]),--ae.countdown):e<=10&&(C("reset.countdown."+e),--ae.countdown):clearInterval(Z)},1e3)},window.loadTest=function(){let a=window.location.host;let t;if(["gitee","127","localhost","lolita","kittensgame"].forEach(function(e){-1<a.indexOf(e)&&(t=!0)}),!t)if("Cheney_MR"!==window.prompt("不在最新正确的网址\n如需要使用请输入正确密码或者导入到推荐到最新网站"))return;if("undefined"==typeof gamePage||"undefined"==typeof i18nLang)setTimeout(function(){window.loadTest()},1e3);else{var e,i=game.workshop.upgrades;for(e in i){var r=i[e];game.workshop.metaCache[r.name]=r}game.workshop.metaCache[void 0]=null,delete game.workshop.metaCache[void 0],"disable"!==localStorage["zh.kgp.enable"]&&$('<style id="KGPBorder">.res-table { border-spacing: 0 3px; }</style>').appendTo("head");var l,o=game.science.policies;for(l in game.science.policyMetaCache={},o){var n=o[l];game.science.policyMetaCache[n.name]=n}window.run(),window.loadTest=null,window.run=null}},setTimeout(function(){window.loadTest()},1e3);